{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-09-02T16:52:26.230600Z", "invocation_id": "072c6525-33dd-41c6-8da2-369fa776e1ff", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-02T16:52:02.152586Z", "completed_at": "2024-09-02T16:52:02.165768Z"}, {"name": "execute", "started_at": "2024-09-02T16:52:02.166318Z", "completed_at": "2024-09-02T16:52:04.892801Z"}], "thread_id": "Thread-1", "execution_time": 2.7417709827423096, "adapter_response": {"_message": "CREATE TABLE (1.2k rows, 55.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 1183, "bytes_processed": 56784, "bytes_billed": 10485760, "location": "US", "project_id": "first-project-262802", "job_id": "26779f41-4fc0-46ac-8691-92db9ae2d807", "slot_ms": 7201}, "message": "CREATE TABLE (1.2k rows, 55.5 KiB processed)", "failures": null, "unique_id": "model.stock_analysis.base_spus_2019_2024", "compiled": true, "compiled_code": "select \n  date\n  , close_last\n  , volume\n  , open\n  , high\n  , low\nfrom `first-project-262802`.`stock`.`spus_2019_2024`", "relation_name": "`first-project-262802`.`stock_analysis`.`base_spus_2019_2024`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-02T16:52:04.897408Z", "completed_at": "2024-09-02T16:52:04.901496Z"}, {"name": "execute", "started_at": "2024-09-02T16:52:04.901818Z", "completed_at": "2024-09-02T16:52:26.223323Z"}], "thread_id": "Thread-1", "execution_time": 21.32696223258972, "adapter_response": {"_message": "CREATE TABLE (1.2k rows, 37.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1183, "bytes_processed": 39414292, "bytes_billed": 39845888, "location": "US", "project_id": "first-project-262802", "job_id": "996ca3bf-5982-40fd-9aad-b0ce77d6c276", "slot_ms": 180804}, "message": "CREATE TABLE (1.2k rows, 37.6 MiB processed)", "failures": null, "unique_id": "model.stock_analysis.stg_spus_2019_2024", "compiled": true, "compiled_code": "with \n\nstock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )\n\n, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )\n\n, base as \n(\n    select \n        *\n        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price\n    from stock\n    left join calendar using (date)\n)\n\n, weekly_price as \n(\n    select \n        year_full\n        , week_number\n        , round(avg(avg_daily_price),2) as avg_weekly_price\n    from base\n    group by 1,2\n)\n\n, monthly_price as \n(\n    select \n        year_full\n        , month_number\n        , round(avg(avg_daily_price),2) as avg_monthly_price\n    from base\n    group by 1,2\n)\n\n\n\n\n, first_avg_daily_price_per_week as \n(\n    select \n        year_full\n        , week_number\n        , avg_daily_price as avg_daily_price_week_start\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1\n)\n\n, last_avg_daily_price_per_week as \n(\n    select \n        year_full\n        , week_number\n        , avg_daily_price as avg_daily_price_week_end\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1\n)\n\n, daily_price_movement_in_week as \n(\n    select\n        year_full\n        , week_number\n        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week\n        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct\n    from base\n    left join first_avg_daily_price_per_week using (year_full,week_number)\n    left join last_avg_daily_price_per_week using (year_full,week_number)\n)\n\n\n\n\n, first_avg_daily_price_per_month as \n(\n    select \n        year_full\n        , month_number\n        , avg_daily_price as avg_daily_price_month_start\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1\n)\n\n, last_avg_daily_price_per_month as \n(\n    select \n        year_full\n        , month_number\n        , avg_daily_price as avg_daily_price_month_end\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1\n)\n\n, daily_price_movement_in_month as \n(\n    select\n        year_full\n        , month_number\n        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month\n        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct\n    from base\n    left join first_avg_daily_price_per_month using (year_full,month_number)\n    left join last_avg_daily_price_per_month using (year_full,month_number)\n)\n\n\n\n\n\n\n, first_avg_daily_price_per_year as \n(\n    select \n        year_full\n        , avg_daily_price as avg_daily_price_year_start\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1\n)\n\n, last_avg_daily_price_per_year as \n(\n    select \n        year_full\n        , avg_daily_price as avg_daily_price_year_end\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1\n)\n\n, daily_price_movement_in_year as \n(\n    select\n        year_full\n        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year\n        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct\n    from base\n    left join first_avg_daily_price_per_year using (year_full)\n    left join last_avg_daily_price_per_year using (year_full)\n)\n\n\n\n\nselect\n    distinct *\nfrom base\nleft join weekly_price using (year_full,week_number)\nleft join monthly_price using (year_full,month_number)\nleft join daily_price_movement_in_week using (year_full,week_number)\nleft join daily_price_movement_in_month using (year_full,month_number)\nleft join daily_price_movement_in_year using (year_full)", "relation_name": "`first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`"}], "elapsed_time": 24.906810998916626, "args": {"select": ["base_spus_2019_2024+"], "source_freshness_run_project_hooks": false, "strict_mode": false, "log_level": "info", "log_path": "/Users/ahmed/Desktop/dbt/stock_analysis/logs", "project_dir": "/Users/ahmed/Desktop/dbt/stock_analysis", "use_colors": true, "version_check": true, "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "log_level_file": "debug", "favor_state": false, "print": true, "macro_debugging": false, "require_resource_names_without_spaces": false, "log_format": "default", "static_parser": true, "invocation_command": "dbt run --select base_spus_2019_2024+", "empty": false, "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "/Users/ahmed/.dbt", "populate_cache": true, "partial_parse_file_diff": true, "log_format_file": "debug", "introspect": true, "show_resource_report": false, "which": "run", "partial_parse": true, "printer_width": 80, "quiet": false, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "vars": {}, "enable_legacy_logger": false, "exclude": [], "indirect_selection": "eager", "use_colors_file": true, "write_json": true, "defer": false}}