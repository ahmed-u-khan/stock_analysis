{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-09-20T00:21:37.105427Z", "invocation_id": "78398c2c-64ba-4a8b-ab5f-50c125c8da09", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T00:21:04.640009Z", "completed_at": "2024-09-20T00:21:04.778145Z"}, {"name": "execute", "started_at": "2024-09-20T00:21:04.781466Z", "completed_at": "2024-09-20T00:21:12.556817Z"}], "thread_id": "Thread-3", "execution_time": 7.926849126815796, "adapter_response": {"_message": "CREATE TABLE (128.5k rows, 1.1 GiB processed)", "code": "CREATE TABLE", "rows_affected": 128478, "bytes_processed": 1140675140, "bytes_billed": 1140850688, "location": "US", "project_id": "first-project-262802", "job_id": "de74070e-dbf0-4472-b436-8033be036299", "slot_ms": 335908}, "message": "CREATE TABLE (128.5k rows, 1.1 GiB processed)", "failures": null, "unique_id": "model.stock_analysis.stg_all_stock_yearly_price_movement", "compiled": true, "compiled_code": "with \n\nbase as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )\n\n, first_avg_daily_price_per_year as \n(\n    select \n        year_full\n        , symbol\n        , avg_daily_price as avg_daily_price_year_start\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1\n)\n\n, last_avg_daily_price_per_year as \n(\n    select \n        year_full\n        , symbol\n        , avg_daily_price as avg_daily_price_year_end\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1\n)\n\n, daily_price_movement_in_year as \n(\n    select\n        year_full\n        , symbol\n        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year\n        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct\n    from base\n    left join first_avg_daily_price_per_year using (year_full, symbol)\n    left join last_avg_daily_price_per_year using (year_full, symbol)\n)\n\n\n\n\n\n\n\n\n\n-- select\n--     distinct *\n-- from base\n-- left join daily_price_movement_in_year using (year_full, symbol)\n\nselect distinct * from daily_price_movement_in_year", "relation_name": "`first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T00:21:04.637700Z", "completed_at": "2024-09-20T00:21:04.641342Z"}, {"name": "execute", "started_at": "2024-09-20T00:21:04.654340Z", "completed_at": "2024-09-20T00:21:13.537369Z"}], "thread_id": "Thread-2", "execution_time": 8.908185005187988, "adapter_response": {"_message": "CREATE TABLE (6.4m rows, 1.2 GiB processed)", "code": "CREATE TABLE", "rows_affected": 6360698, "bytes_processed": 1262356904, "bytes_billed": 1262485504, "location": "US", "project_id": "first-project-262802", "job_id": "403193de-cda3-4ff2-b7a7-60e56a329a5d", "slot_ms": 486352}, "message": "CREATE TABLE (6.4m rows, 1.2 GiB processed)", "failures": null, "unique_id": "model.stock_analysis.stg_all_stock_weekly_price_movement", "compiled": true, "compiled_code": "with \n\nbase as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )\n\n, first_avg_daily_price_per_week as \n(\n    select \n        year_full\n        , week_number\n        , symbol\n        , avg_daily_price as avg_daily_price_week_start\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1\n)\n\n, last_avg_daily_price_per_week as \n(\n    select \n        year_full\n        , week_number\n        , symbol\n        , avg_daily_price as avg_daily_price_week_end\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1\n)\n\n, daily_price_movement_in_week as \n(\n    select\n        year_full\n        , week_number\n        , symbol\n        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week\n        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct\n    from base\n    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)\n    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)\n)\n\n\n\n\n\n\n-- select\n--     distinct *\n-- from base\n-- left join daily_price_movement_in_week using (year_full, week_number, symbol)\n\nselect distinct * from daily_price_movement_in_week", "relation_name": "`first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T00:21:04.630642Z", "completed_at": "2024-09-20T00:21:04.641007Z"}, {"name": "execute", "started_at": "2024-09-20T00:21:04.641566Z", "completed_at": "2024-09-20T00:21:16.235174Z"}], "thread_id": "Thread-1", "execution_time": 11.606618881225586, "adapter_response": {"_message": "CREATE TABLE (1.5m rows, 1.3 GiB processed)", "code": "CREATE TABLE", "rows_affected": 1459587, "bytes_processed": 1384038668, "bytes_billed": 1384120320, "location": "US", "project_id": "first-project-262802", "job_id": "1af9d267-26db-4d4f-b0f6-cdab7568e3be", "slot_ms": 607453}, "message": "CREATE TABLE (1.5m rows, 1.3 GiB processed)", "failures": null, "unique_id": "model.stock_analysis.stg_all_stock_monthly_price_movement", "compiled": true, "compiled_code": "with \n\nbase as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )\n\n, first_avg_daily_price_per_month as \n(\n    select \n        year_full\n        , month_number\n        , symbol\n        , avg_daily_price as avg_daily_price_month_start\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1\n)\n\n, last_avg_daily_price_per_month as \n(\n    select \n        year_full\n        , month_number\n        , symbol\n        , avg_daily_price as avg_daily_price_month_end\n    from base\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1\n)\n\n, daily_price_movement_in_month as \n(\n    select\n        year_full\n        , month_number\n        , symbol\n        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month\n        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct\n    from base\n    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)\n    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)\n)\n\n\n\n\n\n\n-- select\n--     distinct *\n-- from base\n-- left join daily_price_movement_in_month using (year_full, month_number, symbol)\n\nselect distinct * from daily_price_movement_in_month", "relation_name": "`first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-20T00:21:16.242119Z", "completed_at": "2024-09-20T00:21:16.249824Z"}, {"name": "execute", "started_at": "2024-09-20T00:21:16.250130Z", "completed_at": "2024-09-20T00:21:37.097727Z"}], "thread_id": "Thread-5", "execution_time": 20.856719970703125, "adapter_response": {"_message": "CREATE TABLE (30.4m rows, 11.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 30420441, "bytes_processed": 12612430725, "bytes_billed": 12613320704, "location": "US", "project_id": "first-project-262802", "job_id": "32857c68-6c3d-4f09-b3c2-ccde9bd8d3c8", "slot_ms": 3074471}, "message": "CREATE TABLE (30.4m rows, 11.7 GiB processed)", "failures": null, "unique_id": "model.stock_analysis.int_all_stock_history", "compiled": true, "compiled_code": "with \n\nall_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )\n\n, all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )\n\n, all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )\n\n, all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )\n\n\n\nselect\n    distinct *\nfrom all_stock_history_weekly_monthly_yearly_price\nleft join all_stock_weekly_price_movement using (year_full, week_number, symbol)\nleft join all_stock_monthly_price_movement using (year_full, month_number, symbol)\nleft join all_stock_yearly_price_movement using (year_full, symbol)", "relation_name": "`first-project-262802`.`stock_analysis`.`int_all_stock_history`"}], "elapsed_time": 33.414793968200684, "args": {"require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "quiet": false, "use_colors": true, "invocation_command": "dbt run --select stg_all_stock_weekly_price_movement stg_all_stock_monthly_price_movement stg_all_stock_yearly_price_movement int_all_stock_history", "macro_debugging": false, "defer": false, "printer_width": 80, "indirect_selection": "eager", "enable_legacy_logger": false, "project_dir": "/Users/ahmed/Desktop/dbt/stock_analysis", "log_path": "/Users/ahmed/Desktop/dbt/stock_analysis/logs", "partial_parse_file_diff": true, "version_check": true, "log_level": "info", "vars": {}, "profiles_dir": "/Users/ahmed/.dbt", "write_json": true, "log_format": "default", "strict_mode": false, "log_level_file": "debug", "static_parser": true, "show_resource_report": false, "log_format_file": "debug", "source_freshness_run_project_hooks": false, "populate_cache": true, "select": ["stg_all_stock_weekly_price_movement", "stg_all_stock_monthly_price_movement", "stg_all_stock_yearly_price_movement", "int_all_stock_history"], "require_explicit_package_overrides_for_builtin_materializations": true, "which": "run", "introspect": true, "partial_parse": true, "use_colors_file": true, "favor_state": false, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "cache_selected_only": false, "empty": false, "print": true}}