{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2025-04-25T14:09:46.436439Z", "invocation_id": "392a6cc1-9a6b-4869-826f-e0300bc7ba1b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-25T14:09:28.325343Z", "completed_at": "2025-04-25T14:09:28.338847Z"}, {"name": "execute", "started_at": "2025-04-25T14:09:28.339236Z", "completed_at": "2025-04-25T14:09:29.670478Z"}], "thread_id": "Thread-1", "execution_time": 1.3460350036621094, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "first-project-262802", "job_id": "9f4a1f0b-c1c4-4b9a-9f74-4b70dedd5336", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.stock_analysis.stg_polygon_stock_histories_1m", "compiled": true, "compiled_code": "\n\nwith \n\nstock as ( select * from `first-project-262802`.`stock_analysis`.`base_polygon_stock_histories_1m` )\n\n, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )\n\n, base as \n(\n    select \n        *\n        , round(((open + close + high + low)/4.00),2) as avg_minute_price\n        , case when cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) >= 9.30 and cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) < 16.0 then 1 else 0 end as minute_within_regular_trading_hours\n        , case when cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) < 9.30 then 1 else 0 end as minute_within_pre_market_trading_hours\n        , case when cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) >= 16.0 then 1 else 0 end as minute_within_post_market_trading_hours\n        , case\n            when cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) >= 9.30 and cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) < 16.0 then 'minute_within_regular_trading_hours'\n            when cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) < 9.30 then 'minute_within_pre_market_trading_hours'\n            when cast( concat(hour,'.',trim( CAST( minute AS STRING FORMAT '00') )) as numeric ) >= 16.0 then 'minute_within_post_market_trading_hours'\n            else NULL\n        end as minute_in_pre_market_regular_market_post_market_hours\n    from stock\n    left join calendar using (date)\n)\n\nselect * from base", "relation_name": "`first-project-262802`.`stock_analysis`.`stg_polygon_stock_histories_1m`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-25T14:09:29.674916Z", "completed_at": "2025-04-25T14:09:29.678763Z"}, {"name": "execute", "started_at": "2025-04-25T14:09:29.679061Z", "completed_at": "2025-04-25T14:09:31.181543Z"}], "thread_id": "Thread-3", "execution_time": 1.5077111721038818, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "first-project-262802", "job_id": "7bf1a44f-3f92-4315-9259-a2d4e3a73209", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.stock_analysis.int_stock_analysis_1m", "compiled": true, "compiled_code": "\n\nwith base as \n(\n    select \n        * \n    from `first-project-262802`.`stock_analysis`.`stg_polygon_stock_histories_1m`\n)\n\n-- , counting_mins_per_day_per_ticker as \n-- (\n--     select \n--         symbol\n--         , date\n--         , minute_in_pre_market_regular_market_post_market_hours\n--         , count(*) as minute_count \n--     from base\n--     group by all\n-- )\n\n-- , validating_mins_per_day_per_ticker as \n-- (\n--     select \n--         symbol\n--         , date\n--         , case when minute_in_pre_market_regular_market_post_market_hours = 'minute_within_pre_market_trading_hours' and ifnull(minute_count,0) = 330 then 1 else NULL end as date_for_ticker_has_all_pre_market_trading_hour_data\n--         , case when minute_in_pre_market_regular_market_post_market_hours = 'minute_within_regular_trading_hours' and ifnull(minute_count,0) = 390 then 1 else NULL end as date_for_ticker_has_all_regular_trading_hour_data\n--         , case when minute_in_pre_market_regular_market_post_market_hours = 'minute_within_post_market_trading_hours' and ifnull(minute_count,0) = 240 then 1 else NULL end as date_for_ticker_has_all_post_market_trading_hour_data\n--     from counting_mins_per_day_per_ticker\n-- )\n\nselect \n    *\nfrom base\n-- left join validating_mins_per_day_per_ticker using (symbol, date)", "relation_name": "`first-project-262802`.`stock_analysis`.`int_stock_analysis_1m`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-25T14:09:31.188212Z", "completed_at": "2025-04-25T14:09:31.196139Z"}, {"name": "execute", "started_at": "2025-04-25T14:09:31.196527Z", "completed_at": "2025-04-25T14:09:46.426649Z"}], "thread_id": "Thread-5", "execution_time": 15.239856004714966, "adapter_response": {"_message": "CREATE TABLE (6.6m rows, 522.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 6639078, "bytes_processed": 547897294, "bytes_billed": 548405248, "location": "US", "project_id": "first-project-262802", "job_id": "0c341404-863b-4f93-931e-b2a90d63095e", "slot_ms": 859175}, "message": "CREATE TABLE (6.6m rows, 522.5 MiB processed)", "failures": null, "unique_id": "model.stock_analysis.stock_analysis_1m", "compiled": true, "compiled_code": "\n\n\nselect \n    *\nfrom `first-project-262802`.`stock_analysis`.`int_stock_analysis_1m`", "relation_name": "`first-project-262802`.`stock_analysis`.`stock_analysis_1m`"}], "elapsed_time": 19.26148819923401, "args": {"introspect": true, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "favor_state": false, "use_colors_file": true, "require_resource_names_without_spaces": false, "strict_mode": false, "static_parser": true, "source_freshness_run_project_hooks": false, "print": true, "cache_selected_only": false, "macro_debugging": false, "empty": false, "version_check": true, "select": ["stg_polygon_stock_histories_1m+"], "vars": {}, "use_colors": true, "defer": false, "log_path": "/Users/ahmed/Desktop/dbt/stock_analysis/logs", "partial_parse": true, "which": "run", "enable_legacy_logger": false, "populate_cache": true, "printer_width": 80, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "quiet": false, "log_format_file": "debug", "profiles_dir": "/Users/ahmed/.dbt", "exclude": [], "invocation_command": "dbt run --select stg_polygon_stock_histories_1m+", "log_level": "info", "log_file_max_bytes": 10485760, "indirect_selection": "eager", "partial_parse_file_diff": true, "write_json": true, "show_resource_report": false, "project_dir": "/Users/ahmed/Desktop/dbt/stock_analysis", "send_anonymous_usage_stats": true}}