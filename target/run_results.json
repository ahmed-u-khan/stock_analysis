{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2025-04-18T12:43:13.081375Z", "invocation_id": "5e60761c-8c06-4537-97fd-6976561f5f9b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T12:43:00.420908Z", "completed_at": "2025-04-18T12:43:00.427441Z"}, {"name": "execute", "started_at": "2025-04-18T12:43:00.427737Z", "completed_at": "2025-04-18T12:43:01.510669Z"}], "thread_id": "Thread-2", "execution_time": 1.0951769351959229, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "first-project-262802", "job_id": "fe6b357e-2dca-41f3-b61a-156180ce5f30", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.stock_analysis.base_polygon_stock_histories_1m", "compiled": true, "compiled_code": "\n\nselect\n    date(datetime_est) as date\n    , time(datetime_est) as time\n    , extract (hour from datetime_est ) as minute\n    , extract (minute from datetime_est ) as hour\n    , open\n    , high\n    , low\n    , close\n    , volume\n    , transactions\n    , vwap\n    , date(ETL_Date) as etl_date\n    , Symbol as symbol\nfrom `first-project-262802`.`stock`.`polygon_all_different_stock_histories_1m`", "relation_name": "`first-project-262802`.`stock_analysis`.`base_polygon_stock_histories_1m`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T12:43:00.416904Z", "completed_at": "2025-04-18T12:43:00.440380Z"}, {"name": "execute", "started_at": "2025-04-18T12:43:00.448660Z", "completed_at": "2025-04-18T12:43:01.541954Z"}], "thread_id": "Thread-1", "execution_time": 1.1271591186523438, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "first-project-262802", "job_id": "ccb2b011-3f15-4ffa-9656-45d1d79bdaf1", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.stock_analysis.base_calendar", "compiled": true, "compiled_code": "\n\nselect \n    is_workday\n    , is_holiday\n    , is_holiday_leave\n    , a_date\n    , a_date as date\n    , extract(year from a_date) as year_of_date\n    , extract(month from a_date) as month_of_date\n    , extract(day from a_date) as day_of_date\n    , day_full\n    , day_full_capital_case\n    , day_full_lower_case\n    , day_abbrev\n    , is_weekday\n    , is_weekday_by_regex\n    , day_of_week\n    , day_of_month\n    , day_of_year\n    , week_of_month\n    -- , format_date('%W', a_date) as week_number\n    , CAST(format_date('%W', a_date) AS INT64) as week_number\n    , trim(month_full) as month_full\n    , lower(trim(month_full)) as month_full_lower_case\n    , month_abbrev\n    , month_number\n    , quarter\n    , year_short\n    , year_full\n    , fiscal_quarter\n    , fiscal_year\n    , fiscal_year_full\n    , tomorrow\n    , one_week_later\n    , one_month_later\n    , three_months_later\n    , one_year_later\nfrom `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`", "relation_name": "`first-project-262802`.`stock_analysis`.`base_calendar`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T12:43:01.545059Z", "completed_at": "2025-04-18T12:43:01.550425Z"}, {"name": "execute", "started_at": "2025-04-18T12:43:01.550681Z", "completed_at": "2025-04-18T12:43:02.721464Z"}], "thread_id": "Thread-4", "execution_time": 1.177206039428711, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "first-project-262802", "job_id": "f00d4b17-4248-4b6a-86f9-27bd11dac7f7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.stock_analysis.stg_calendar", "compiled": true, "compiled_code": "\n\nwith \n\nbase_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )\n\n, adding_month_start_and_end as \n(\n    select\n        *\n        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start\n        , case \n            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE \n            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE \n            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE \n            else FALSE \n        end as is_month_end   \n    from base_calendar\n)\n\n, adding_quarter_start_and_end as \n(\n    select\n        *\n        , case \n            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE\n            else False\n        end as is_quarter_start\n        , case \n            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE\n            else False\n        end as is_quarter_end    \n    from adding_month_start_and_end\n)\n\n, adding_week_start_and_end as \n(\n    select\n        *\n        , case \n            when day_of_week = 1 then TRUE\n            else False\n        end as is_week_start\n        , case \n            when day_of_week = 7 then TRUE\n            else False\n        end as is_week_end\n        , case \n            when day_of_week = 1 then TRUE\n            else False\n        end as is_typical_trading_week_start\n        , case \n            when day_of_week = 5 then TRUE\n            else False\n        end as is_typical_trading_week_end\n    from adding_quarter_start_and_end\n)\n\n, base as (select * from adding_week_start_and_end )\n\n, adding_first_working_day_of_year as \n(\n    select\n        TRUE as is_first_working_day_of_year\n        , *\n    from base\n    where is_workday = 1\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1\n)\n\n, adding_last_working_day_of_year as \n(\n    select\n        TRUE as is_last_working_day_of_year\n        , *\n    from base\n    where is_workday = 1\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1\n)\n\n, adding_first_working_day_of_month as \n(\n    select\n        TRUE as is_first_working_day_of_month \n        , *\n    from base\n    where is_workday = 1\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1\n)\n\n, adding_last_working_day_of_month as \n(\n    select\n        TRUE as is_last_working_day_of_month \n        , *\n    from base\n    where is_workday = 1\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1\n)\n\n, adding_first_working_day_of_week as \n(\n    select\n        TRUE as is_first_working_day_of_week\n        , *\n    from base\n    where is_workday = 1\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1\n)\n\n, adding_last_working_day_of_week as \n(\n    select\n        TRUE as is_last_working_day_of_week\n        , *\n    from base\n    where is_workday = 1\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1\n)\n\n\nselect \n    base.*\n\n    , concat(base.year_full,'-',base.week_number) as year_week\n    , concat(base.year_full,'-',base.month_abbrev,'-',base.week_number) as year_month_week\n    , concat(base.year_full,'-',base.month_abbrev) as year_month\n\n    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year\n    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year \n    \n    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month\n    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month\n    \n    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week\n    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week\n\nfrom base\nleft join adding_first_working_day_of_year using (date)\nleft join adding_last_working_day_of_year using (date)\nleft join adding_first_working_day_of_month using (date)\nleft join adding_last_working_day_of_month using (date)\nleft join adding_first_working_day_of_week using (date)\nleft join adding_last_working_day_of_week using (date)", "relation_name": "`first-project-262802`.`stock_analysis`.`stg_calendar`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T12:43:02.726463Z", "completed_at": "2025-04-18T12:43:02.733366Z"}, {"name": "execute", "started_at": "2025-04-18T12:43:02.733749Z", "completed_at": "2025-04-18T12:43:03.850474Z"}], "thread_id": "Thread-6", "execution_time": 1.1251857280731201, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "first-project-262802", "job_id": "1ca9502b-c86a-43a4-a8f4-ea563e44c1cd", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.stock_analysis.stg_polygon_stock_histories_1m", "compiled": true, "compiled_code": "\n\nwith \n\nstock as ( select * from `first-project-262802`.`stock_analysis`.`base_polygon_stock_histories_1m` )\n\n, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )\n\n, base as \n(\n    select \n        *\n        , round(((open + close + high + low)/4.00),2) as avg_minute_price\n    from stock\n    left join calendar using (date)\n)\n\nselect * from base", "relation_name": "`first-project-262802`.`stock_analysis`.`stg_polygon_stock_histories_1m`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-18T12:43:03.857082Z", "completed_at": "2025-04-18T12:43:03.863002Z"}, {"name": "execute", "started_at": "2025-04-18T12:43:03.863451Z", "completed_at": "2025-04-18T12:43:13.071936Z"}], "thread_id": "Thread-8", "execution_time": 9.216341972351074, "adapter_response": {"_message": "CREATE TABLE (6.6m rows, 522.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 6639078, "bytes_processed": 547897294, "bytes_billed": 548405248, "location": "US", "project_id": "first-project-262802", "job_id": "c53be3dd-38a3-4513-8410-23fc93715a68", "slot_ms": 466256}, "message": "CREATE TABLE (6.6m rows, 522.5 MiB processed)", "failures": null, "unique_id": "model.stock_analysis.stock_analysis_1m", "compiled": true, "compiled_code": "\n\n\nselect \n    *\nfrom `first-project-262802`.`stock_analysis`.`stg_polygon_stock_histories_1m`", "relation_name": "`first-project-262802`.`stock_analysis`.`stock_analysis_1m`"}], "elapsed_time": 13.737366914749146, "args": {"populate_cache": true, "log_file_max_bytes": 10485760, "version_check": true, "enable_legacy_logger": false, "source_freshness_run_project_hooks": false, "printer_width": 80, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "profiles_dir": "/Users/ahmed/.dbt", "quiet": false, "strict_mode": false, "show_resource_report": false, "write_json": true, "send_anonymous_usage_stats": true, "log_path": "/Users/ahmed/Desktop/dbt/stock_analysis/logs", "use_colors": true, "print": true, "require_resource_names_without_spaces": false, "log_format_file": "debug", "exclude": [], "invocation_command": "dbt run --select base_calendar stg_calendar base_polygon_stock_histories_1m+", "cache_selected_only": false, "log_level": "info", "which": "run", "partial_parse": true, "select": ["base_calendar", "stg_calendar", "base_polygon_stock_histories_1m+"], "project_dir": "/Users/ahmed/Desktop/dbt/stock_analysis", "log_level_file": "debug", "macro_debugging": false, "use_colors_file": true, "indirect_selection": "eager", "empty": false, "partial_parse_file_diff": true, "static_parser": true, "log_format": "default", "vars": {}, "favor_state": false}}