[0m10:14:32.857986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d58c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d58df0>]}


============================== 10:14:32.860538 | e7936a34-163f-4b1b-9927-ea3729ab9904 ==============================
[0m10:14:32.860538 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:14:32.860817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:14:33.580472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123feac10>]}
[0m10:14:33.606404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3c340>]}
[0m10:14:33.606673 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m10:14:33.617966 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:14:33.618468 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:14:33.618674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249682b0>]}
[0m10:14:34.416147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125547130>]}
[0m10:14:34.483825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253d5d90>]}
[0m10:14:34.484137 [info ] [MainThread]: Found 2 models, 6 seeds, 4 data tests, 469 macros
[0m10:14:34.484308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255800a0>]}
[0m10:14:34.485156 [info ] [MainThread]: 
[0m10:14:34.485445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:14:34.487957 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m10:14:34.488220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:35.098131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m10:14:35.099225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:35.588401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125494640>]}
[0m10:14:35.589861 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m10:14:35.590535 [info ] [MainThread]: 
[0m10:14:35.596030 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_category_map
[0m10:14:35.596945 [info ] [Thread-1  ]: 1 of 6 START seed file ruggable.rugs_usa_category_map .......................... [RUN]
[0m10:14:35.597639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now seed.ruggable.rugs_usa_category_map)
[0m10:14:35.598121 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_category_map
[0m10:14:35.598560 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_category_map
[0m10:14:35.858987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:40.413262 [debug] [Thread-1  ]: On seed.ruggable.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "seed.ruggable.rugs_usa_category_map"} */

    alter table `first-project-262802`.`ruggable`.`rugs_usa_category_map` set OPTIONS()
  
[0m10:14:40.796720 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5116c8d4-5558-4d7d-bacf-ffc132ea412c&page=queryresults
[0m10:14:41.320865 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ruggable.rugs_usa_category_map"
[0m10:14:41.352561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a6e880>]}
[0m10:14:41.353266 [info ] [Thread-1  ]: 1 of 6 OK loaded seed file ruggable.rugs_usa_category_map ...................... [[32mINSERT 51265[0m in 5.75s]
[0m10:14:41.353942 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_category_map
[0m10:14:41.354402 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_color_map
[0m10:14:41.355070 [info ] [Thread-1  ]: 2 of 6 START seed file ruggable.rugs_usa_color_map ............................. [RUN]
[0m10:14:41.355643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_category_map, now seed.ruggable.rugs_usa_color_map)
[0m10:14:41.355990 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_color_map
[0m10:14:41.356306 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_color_map
[0m10:14:41.422079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:45.480718 [debug] [Thread-1  ]: On seed.ruggable.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "seed.ruggable.rugs_usa_color_map"} */

    alter table `first-project-262802`.`ruggable`.`rugs_usa_color_map` set OPTIONS()
  
[0m10:14:45.930739 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dfabca0b-cab4-47f0-ad23-7fd135bd3a78&page=queryresults
[0m10:14:46.510461 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ruggable.rugs_usa_color_map"
[0m10:14:46.520373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12553e1f0>]}
[0m10:14:46.521779 [info ] [Thread-1  ]: 2 of 6 OK loaded seed file ruggable.rugs_usa_color_map ......................... [[32mINSERT 17232[0m in 5.16s]
[0m10:14:46.523408 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_color_map
[0m10:14:46.524325 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_links
[0m10:14:46.525489 [info ] [Thread-1  ]: 3 of 6 START seed file ruggable.rugs_usa_links ................................. [RUN]
[0m10:14:46.526356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_color_map, now seed.ruggable.rugs_usa_links)
[0m10:14:46.526952 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_links
[0m10:14:46.527471 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_links
[0m10:14:46.628857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:50.721656 [debug] [Thread-1  ]: On seed.ruggable.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "seed.ruggable.rugs_usa_links"} */

    alter table `first-project-262802`.`ruggable`.`rugs_usa_links` set OPTIONS()
  
[0m10:14:51.090521 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:41b4d859-bbc3-4f0e-a4db-4c3d44e2a11b&page=queryresults
[0m10:14:51.656164 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ruggable.rugs_usa_links"
[0m10:14:51.666045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12549df10>]}
[0m10:14:51.667371 [info ] [Thread-1  ]: 3 of 6 OK loaded seed file ruggable.rugs_usa_links ............................. [[32mINSERT 5565[0m in 5.14s]
[0m10:14:51.668957 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_links
[0m10:14:51.670212 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:51.671168 [info ] [Thread-1  ]: 4 of 6 START seed file ruggable.rugs_usa_pads_upsell ........................... [RUN]
[0m10:14:51.672361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_links, now seed.ruggable.rugs_usa_pads_upsell)
[0m10:14:51.673240 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:51.674476 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:54.405209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:59.477881 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m10:14:59.479449 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 154; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 154; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 86 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 295 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 403 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 614 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 721 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 905 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1005 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1205 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1313 column_index: 6 column_name: "stock" column_type: INT64 value: "222.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1516 column_index: 6 column_name: "stock" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 1709 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 1809 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2011 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2118 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2303 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2403 column_index: 6 column_name: "stock" column_type: INT64 value: "980.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 2609 column_index: 6 column_name: "stock" column_type: INT64 value: "1849.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 2715 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 2915 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3024 column_index: 6 column_name: "stock" column_type: INT64 value: "105.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3235 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 3343 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 3545 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 3653 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 3838 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 3938 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 4162 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 4270 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 4472 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 4581 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 4767 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 4955 column_index: 6 column_name: "stock" column_type: INT64 value: "133.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 5056 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 5260 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 5368 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 5592 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 5700 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 5924 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 6032 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 6233 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 6342 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 6528 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 6628 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 6831 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 6939 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 7125 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 7313 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 7412 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 7621 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 7734 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 7945 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 8057 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 8268 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 8383 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 8579 column_index: 6 column_name: "stock" column_type: INT64 value: "6.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 8782 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 8883 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 9094 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 9206 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 9419 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 9533 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 9754 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 9871 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 10092 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 10209 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 102 byte_offset_to_start_of_line: 10429 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 103 byte_offset_to_start_of_line: 10546 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 105 byte_offset_to_start_of_line: 10766 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 106 byte_offset_to_start_of_line: 10883 column_index: 6 column_name: "stock" column_type: INT64 value: "1585.0"
  Error while reading data, error message: Unable to parse; line_number: 108 byte_offset_to_start_of_line: 11078 column_index: 6 column_name: "stock" column_type: INT64 value: "525.0"
  Error while reading data, error message: Unable to parse; line_number: 109 byte_offset_to_start_of_line: 11182 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 111 byte_offset_to_start_of_line: 11378 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 112 byte_offset_to_start_of_line: 11483 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 114 byte_offset_to_start_of_line: 11677 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 115 byte_offset_to_start_of_line: 11783 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 117 byte_offset_to_start_of_line: 11962 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 119 byte_offset_to_start_of_line: 12143 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 120 byte_offset_to_start_of_line: 12241 column_index: 6 column_name: "stock" column_type: INT64 value: "218.0"
  Error while reading data, error message: Unable to parse; line_number: 122 byte_offset_to_start_of_line: 12438 column_index: 6 column_name: "stock" column_type: INT64 value: "1157.0"
  Error while reading data, error message: Unable to parse; line_number: 123 byte_offset_to_start_of_line: 12542 column_index: 6 column_name: "stock" column_type: INT64 value: "979.0"
  Error while reading data, error message: Unable to parse; line_number: 125 byte_offset_to_start_of_line: 12743 column_index: 6 column_name: "stock" column_type: INT64 value: "1837.0"
  Error while reading data, error message: Unable to parse; line_number: 127 byte_offset_to_start_of_line: 12931 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 128 byte_offset_to_start_of_line: 13029 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 130 byte_offset_to_start_of_line: 13226 column_index: 6 column_name: "stock" column_type: INT64 value: "1875.0"
  Error while reading data, error message: Unable to parse; line_number: 131 byte_offset_to_start_of_line: 13332 column_index: 6 column_name: "stock" column_type: INT64 value: "103.0"
  Error while reading data, error message: Unable to parse; line_number: 133 byte_offset_to_start_of_line: 13538 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 134 byte_offset_to_start_of_line: 13644 column_index: 6 column_name: "stock" column_type: INT64 value: "288.0"
  Error while reading data, error message: Unable to parse; line_number: 136 byte_offset_to_start_of_line: 13864 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 137 byte_offset_to_start_of_line: 13970 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 139 byte_offset_to_start_of_line: 14150 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 141 byte_offset_to_start_of_line: 14332 column_index: 6 column_name: "stock" column_type: INT64 value: "131.0"
  Error while reading data, error message: Unable to parse; line_number: 142 byte_offset_to_start_of_line: 14431 column_index: 6 column_name: "stock" column_type: INT64 value: "1814.0"
  Error while reading data, error message: Unable to parse; line_number: 144 byte_offset_to_start_of_line: 14629 column_index: 6 column_name: "stock" column_type: INT64 value: "2136.0"
  Error while reading data, error message: Unable to parse; line_number: 145 byte_offset_to_start_of_line: 14735 column_index: 6 column_name: "stock" column_type: INT64 value: "226.0"
  Error while reading data, error message: Unable to parse; line_number: 147 byte_offset_to_start_of_line: 14932 column_index: 6 column_name: "stock" column_type: INT64 value: "4657.0"
  Error while reading data, error message: Unable to parse; line_number: 148 byte_offset_to_start_of_line: 15038 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 150 byte_offset_to_start_of_line: 15218 column_index: 6 column_name: "stock" column_type: INT64 value: "197.0"
  Error while reading data, error message: Unable to parse; line_number: 152 byte_offset_to_start_of_line: 15400 column_index: 6 column_name: "stock" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 153 byte_offset_to_start_of_line: 15497 column_index: 6 column_name: "stock" column_type: INT64 value: "2015.0"
  Error while reading data, error message: Unable to parse; line_number: 155 byte_offset_to_start_of_line: 15702 column_index: 6 column_name: "stock" column_type: INT64 value: "8586.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:14:59.511580 [debug] [Thread-1  ]: Runtime Error in seed rugs_usa_pads_upsell (seeds/rugs_usa_pads_upsell.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 154; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 154; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 86 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 295 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 403 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 614 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 721 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 905 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1005 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1205 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1313 column_index: 6 column_name: "stock" column_type: INT64 value: "222.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1516 column_index: 6 column_name: "stock" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 1709 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 1809 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2011 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2118 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2303 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2403 column_index: 6 column_name: "stock" column_type: INT64 value: "980.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 2609 column_index: 6 column_name: "stock" column_type: INT64 value: "1849.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 2715 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 2915 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3024 column_index: 6 column_name: "stock" column_type: INT64 value: "105.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3235 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 3343 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 3545 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 3653 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 3838 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 3938 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 4162 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 4270 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 4472 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 4581 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 4767 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 4955 column_index: 6 column_name: "stock" column_type: INT64 value: "133.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 5056 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 5260 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 5368 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 5592 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 5700 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 5924 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 6032 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 6233 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 6342 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 6528 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 6628 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 6831 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 6939 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 7125 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 7313 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 7412 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 7621 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 7734 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 7945 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 8057 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 8268 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 8383 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 8579 column_index: 6 column_name: "stock" column_type: INT64 value: "6.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 8782 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 8883 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 9094 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 9206 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 9419 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 9533 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 9754 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 9871 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 10092 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 10209 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 102 byte_offset_to_start_of_line: 10429 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 103 byte_offset_to_start_of_line: 10546 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 105 byte_offset_to_start_of_line: 10766 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 106 byte_offset_to_start_of_line: 10883 column_index: 6 column_name: "stock" column_type: INT64 value: "1585.0"
  Error while reading data, error message: Unable to parse; line_number: 108 byte_offset_to_start_of_line: 11078 column_index: 6 column_name: "stock" column_type: INT64 value: "525.0"
  Error while reading data, error message: Unable to parse; line_number: 109 byte_offset_to_start_of_line: 11182 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 111 byte_offset_to_start_of_line: 11378 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 112 byte_offset_to_start_of_line: 11483 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 114 byte_offset_to_start_of_line: 11677 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 115 byte_offset_to_start_of_line: 11783 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 117 byte_offset_to_start_of_line: 11962 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 119 byte_offset_to_start_of_line: 12143 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 120 byte_offset_to_start_of_line: 12241 column_index: 6 column_name: "stock" column_type: INT64 value: "218.0"
  Error while reading data, error message: Unable to parse; line_number: 122 byte_offset_to_start_of_line: 12438 column_index: 6 column_name: "stock" column_type: INT64 value: "1157.0"
  Error while reading data, error message: Unable to parse; line_number: 123 byte_offset_to_start_of_line: 12542 column_index: 6 column_name: "stock" column_type: INT64 value: "979.0"
  Error while reading data, error message: Unable to parse; line_number: 125 byte_offset_to_start_of_line: 12743 column_index: 6 column_name: "stock" column_type: INT64 value: "1837.0"
  Error while reading data, error message: Unable to parse; line_number: 127 byte_offset_to_start_of_line: 12931 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 128 byte_offset_to_start_of_line: 13029 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 130 byte_offset_to_start_of_line: 13226 column_index: 6 column_name: "stock" column_type: INT64 value: "1875.0"
  Error while reading data, error message: Unable to parse; line_number: 131 byte_offset_to_start_of_line: 13332 column_index: 6 column_name: "stock" column_type: INT64 value: "103.0"
  Error while reading data, error message: Unable to parse; line_number: 133 byte_offset_to_start_of_line: 13538 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 134 byte_offset_to_start_of_line: 13644 column_index: 6 column_name: "stock" column_type: INT64 value: "288.0"
  Error while reading data, error message: Unable to parse; line_number: 136 byte_offset_to_start_of_line: 13864 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 137 byte_offset_to_start_of_line: 13970 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 139 byte_offset_to_start_of_line: 14150 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 141 byte_offset_to_start_of_line: 14332 column_index: 6 column_name: "stock" column_type: INT64 value: "131.0"
  Error while reading data, error message: Unable to parse; line_number: 142 byte_offset_to_start_of_line: 14431 column_index: 6 column_name: "stock" column_type: INT64 value: "1814.0"
  Error while reading data, error message: Unable to parse; line_number: 144 byte_offset_to_start_of_line: 14629 column_index: 6 column_name: "stock" column_type: INT64 value: "2136.0"
  Error while reading data, error message: Unable to parse; line_number: 145 byte_offset_to_start_of_line: 14735 column_index: 6 column_name: "stock" column_type: INT64 value: "226.0"
  Error while reading data, error message: Unable to parse; line_number: 147 byte_offset_to_start_of_line: 14932 column_index: 6 column_name: "stock" column_type: INT64 value: "4657.0"
  Error while reading data, error message: Unable to parse; line_number: 148 byte_offset_to_start_of_line: 15038 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 150 byte_offset_to_start_of_line: 15218 column_index: 6 column_name: "stock" column_type: INT64 value: "197.0"
  Error while reading data, error message: Unable to parse; line_number: 152 byte_offset_to_start_of_line: 15400 column_index: 6 column_name: "stock" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 153 byte_offset_to_start_of_line: 15497 column_index: 6 column_name: "stock" column_type: INT64 value: "2015.0"
  Error while reading data, error message: Unable to parse; line_number: 155 byte_offset_to_start_of_line: 15702 column_index: 6 column_name: "stock" column_type: INT64 value: "8586.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:14:59.512702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12553e1f0>]}
[0m10:14:59.513797 [error] [Thread-1  ]: 4 of 6 ERROR loading seed file ruggable.rugs_usa_pads_upsell ................... [[31mERROR[0m in 7.84s]
[0m10:14:59.514923 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:59.515193 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_parent
[0m10:14:59.515552 [info ] [Thread-1  ]: 5 of 6 START seed file ruggable.rugs_usa_parent ................................ [RUN]
[0m10:14:59.515820 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_pads_upsell, now seed.ruggable.rugs_usa_parent)
[0m10:14:59.516022 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_parent
[0m10:14:59.516211 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_parent
[0m10:14:59.686079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:15:03.692899 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m10:15:03.696817 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 5538; errors: 61; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 626 byte_offset_to_start_of_line: 515979 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 682 byte_offset_to_start_of_line: 562755 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 744 byte_offset_to_start_of_line: 614606 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 805 byte_offset_to_start_of_line: 665135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1105 byte_offset_to_start_of_line: 925918 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1137 byte_offset_to_start_of_line: 950170 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1180 byte_offset_to_start_of_line: 985105 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1283 byte_offset_to_start_of_line: 1075556 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1304 byte_offset_to_start_of_line: 1091943 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1357 byte_offset_to_start_of_line: 1135173 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1373 byte_offset_to_start_of_line: 1148625 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1417 byte_offset_to_start_of_line: 1186756 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1533 byte_offset_to_start_of_line: 1285319 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1635 byte_offset_to_start_of_line: 1370267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1760 byte_offset_to_start_of_line: 1475910 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1833 byte_offset_to_start_of_line: 1534713 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1878 byte_offset_to_start_of_line: 1574149 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2156 byte_offset_to_start_of_line: 1798610 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2268 byte_offset_to_start_of_line: 1887585 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2386 byte_offset_to_start_of_line: 1981363 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2397 byte_offset_to_start_of_line: 1989582 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2497 byte_offset_to_start_of_line: 2074495 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2572 byte_offset_to_start_of_line: 2133458 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 3250 byte_offset_to_start_of_line: 2668226 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 627 byte_offset_to_start_of_line: 517051 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 683 byte_offset_to_start_of_line: 563848 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 745 byte_offset_to_start_of_line: 615684 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1106 byte_offset_to_start_of_line: 926974 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1181 byte_offset_to_start_of_line: 986153 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1358 byte_offset_to_start_of_line: 1136232 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1418 byte_offset_to_start_of_line: 1187833 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1420 byte_offset_to_start_of_line: 1188645 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1636 byte_offset_to_start_of_line: 1371306 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1761 byte_offset_to_start_of_line: 1476984 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1834 byte_offset_to_start_of_line: 1535772 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2157 byte_offset_to_start_of_line: 1799664 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2387 byte_offset_to_start_of_line: 1982160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2398 byte_offset_to_start_of_line: 1990375 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2498 byte_offset_to_start_of_line: 2075267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 628 byte_offset_to_start_of_line: 517058 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 684 byte_offset_to_start_of_line: 563855 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 746 byte_offset_to_start_of_line: 615691 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1107 byte_offset_to_start_of_line: 926981 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1182 byte_offset_to_start_of_line: 986160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1359 byte_offset_to_start_of_line: 1136239 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1421 byte_offset_to_start_of_line: 1188646 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1637 byte_offset_to_start_of_line: 1371313 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1762 byte_offset_to_start_of_line: 1476991 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1835 byte_offset_to_start_of_line: 1535779 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1879 byte_offset_to_start_of_line: 1574884 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 2158 byte_offset_to_start_of_line: 1799671 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 806 byte_offset_to_start_of_line: 665886 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 1419 byte_offset_to_start_of_line: 1187840 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 8 columns.; line_number: 1138 byte_offset_to_start_of_line: 950795 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1284 byte_offset_to_start_of_line: 1076335 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1305 byte_offset_to_start_of_line: 1092562 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1374 byte_offset_to_start_of_line: 1149300 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1534 byte_offset_to_start_of_line: 1285994 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2269 byte_offset_to_start_of_line: 1888347 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2573 byte_offset_to_start_of_line: 2134135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 3251 byte_offset_to_start_of_line: 2668988 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:03.725380 [debug] [Thread-1  ]: Runtime Error in seed rugs_usa_parent (seeds/rugs_usa_parent.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 5538; errors: 61; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 626 byte_offset_to_start_of_line: 515979 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 682 byte_offset_to_start_of_line: 562755 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 744 byte_offset_to_start_of_line: 614606 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 805 byte_offset_to_start_of_line: 665135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1105 byte_offset_to_start_of_line: 925918 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1137 byte_offset_to_start_of_line: 950170 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1180 byte_offset_to_start_of_line: 985105 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1283 byte_offset_to_start_of_line: 1075556 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1304 byte_offset_to_start_of_line: 1091943 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1357 byte_offset_to_start_of_line: 1135173 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1373 byte_offset_to_start_of_line: 1148625 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1417 byte_offset_to_start_of_line: 1186756 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1533 byte_offset_to_start_of_line: 1285319 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1635 byte_offset_to_start_of_line: 1370267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1760 byte_offset_to_start_of_line: 1475910 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1833 byte_offset_to_start_of_line: 1534713 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1878 byte_offset_to_start_of_line: 1574149 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2156 byte_offset_to_start_of_line: 1798610 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2268 byte_offset_to_start_of_line: 1887585 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2386 byte_offset_to_start_of_line: 1981363 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2397 byte_offset_to_start_of_line: 1989582 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2497 byte_offset_to_start_of_line: 2074495 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2572 byte_offset_to_start_of_line: 2133458 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 3250 byte_offset_to_start_of_line: 2668226 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 627 byte_offset_to_start_of_line: 517051 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 683 byte_offset_to_start_of_line: 563848 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 745 byte_offset_to_start_of_line: 615684 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1106 byte_offset_to_start_of_line: 926974 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1181 byte_offset_to_start_of_line: 986153 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1358 byte_offset_to_start_of_line: 1136232 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1418 byte_offset_to_start_of_line: 1187833 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1420 byte_offset_to_start_of_line: 1188645 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1636 byte_offset_to_start_of_line: 1371306 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1761 byte_offset_to_start_of_line: 1476984 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1834 byte_offset_to_start_of_line: 1535772 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2157 byte_offset_to_start_of_line: 1799664 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2387 byte_offset_to_start_of_line: 1982160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2398 byte_offset_to_start_of_line: 1990375 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2498 byte_offset_to_start_of_line: 2075267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 628 byte_offset_to_start_of_line: 517058 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 684 byte_offset_to_start_of_line: 563855 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 746 byte_offset_to_start_of_line: 615691 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1107 byte_offset_to_start_of_line: 926981 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1182 byte_offset_to_start_of_line: 986160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1359 byte_offset_to_start_of_line: 1136239 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1421 byte_offset_to_start_of_line: 1188646 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1637 byte_offset_to_start_of_line: 1371313 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1762 byte_offset_to_start_of_line: 1476991 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1835 byte_offset_to_start_of_line: 1535779 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1879 byte_offset_to_start_of_line: 1574884 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 2158 byte_offset_to_start_of_line: 1799671 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 806 byte_offset_to_start_of_line: 665886 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 1419 byte_offset_to_start_of_line: 1187840 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 8 columns.; line_number: 1138 byte_offset_to_start_of_line: 950795 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1284 byte_offset_to_start_of_line: 1076335 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1305 byte_offset_to_start_of_line: 1092562 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1374 byte_offset_to_start_of_line: 1149300 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1534 byte_offset_to_start_of_line: 1285994 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2269 byte_offset_to_start_of_line: 1888347 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2573 byte_offset_to_start_of_line: 2134135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 3251 byte_offset_to_start_of_line: 2668988 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:03.727418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12553ecd0>]}
[0m10:15:03.729029 [error] [Thread-1  ]: 5 of 6 ERROR loading seed file ruggable.rugs_usa_parent ........................ [[31mERROR[0m in 4.21s]
[0m10:15:03.730642 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_parent
[0m10:15:03.731081 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_variant
[0m10:15:03.731732 [info ] [Thread-1  ]: 6 of 6 START seed file ruggable.rugs_usa_variant ............................... [RUN]
[0m10:15:03.732243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_parent, now seed.ruggable.rugs_usa_variant)
[0m10:15:03.732576 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_variant
[0m10:15:03.732884 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_variant
[0m10:15:05.314895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:15:10.131844 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m10:15:10.134160 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 276 column_index: 11 column_name: "stock_level" column_type: INT64 value: "279.0"
  Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 432 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1299.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 593 column_index: 11 column_name: "stock_level" column_type: INT64 value: "509.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 736 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3186.0"
  Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 888 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1594.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1049 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1193 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2763.0"
  Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1348 column_index: 11 column_name: "stock_level" column_type: INT64 value: "11293.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1495 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1821.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1657 column_index: 11 column_name: "stock_level" column_type: INT64 value: "462.0"
  Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1808 column_index: 11 column_name: "stock_level" column_type: INT64 value: "882.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1970 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2856.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2126 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2270 column_index: 11 column_name: "stock_level" column_type: INT64 value: "514.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2435 column_index: 11 column_name: "stock_level" column_type: INT64 value: "73.0"
  Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2585 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4542.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2732 column_index: 11 column_name: "stock_level" column_type: INT64 value: "799.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2878 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13534.0"
  Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "78.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3197 column_index: 11 column_name: "stock_level" column_type: INT64 value: "70.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3358 column_index: 11 column_name: "stock_level" column_type: INT64 value: "68.0"
  Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3508 column_index: 11 column_name: "stock_level" column_type: INT64 value: "427.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3653 column_index: 11 column_name: "stock_level" column_type: INT64 value: "16175.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3811 column_index: 11 column_name: "stock_level" column_type: INT64 value: "718.0"
  Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3957 column_index: 11 column_name: "stock_level" column_type: INT64 value: "581.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4103 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4257 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2611.0"
  Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4417 column_index: 11 column_name: "stock_level" column_type: INT64 value: "41.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4572 column_index: 11 column_name: "stock_level" column_type: INT64 value: "83.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4723 column_index: 11 column_name: "stock_level" column_type: INT64 value: "140.0"
  Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 4876 column_index: 11 column_name: "stock_level" column_type: INT64 value: "238.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1221.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5199 column_index: 11 column_name: "stock_level" column_type: INT64 value: "185.0"
  Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5364 column_index: 11 column_name: "stock_level" column_type: INT64 value: "428.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5529 column_index: 11 column_name: "stock_level" column_type: INT64 value: "249.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5698 column_index: 11 column_name: "stock_level" column_type: INT64 value: "79.0"
  Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 5864 column_index: 11 column_name: "stock_level" column_type: INT64 value: "121.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6015 column_index: 11 column_name: "stock_level" column_type: INT64 value: "96.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6166 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6311 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6451 column_index: 11 column_name: "stock_level" column_type: INT64 value: "72.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6591 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3.0"
  Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 6746 column_index: 11 column_name: "stock_level" column_type: INT64 value: "61.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 6906 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7046 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7201 column_index: 11 column_name: "stock_level" column_type: INT64 value: "29.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7360 column_index: 11 column_name: "stock_level" column_type: INT64 value: "-17.0"
  Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7675 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 7823 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 7966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "112.0"
  Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 8112 column_index: 11 column_name: "stock_level" column_type: INT64 value: "717.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 8267 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 8422 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13.0"
  Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 8564 column_index: 11 column_name: "stock_level" column_type: INT64 value: "71.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 8710 column_index: 11 column_name: "stock_level" column_type: INT64 value: "556.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 8869 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2.0"
  Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 9021 column_index: 11 column_name: "stock_level" column_type: INT64 value: "25.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 9171 column_index: 11 column_name: "stock_level" column_type: INT64 value: "156.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 9330 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 9643 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 9803 column_index: 11 column_name: "stock_level" column_type: INT64 value: "151.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 9966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 10131 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 10286 column_index: 11 column_name: "stock_level" column_type: INT64 value: "63.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 10447 column_index: 11 column_name: "stock_level" column_type: INT64 value: "378.0"
  Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 10603 column_index: 11 column_name: "stock_level" column_type: INT64 value: "43.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 10747 column_index: 11 column_name: "stock_level" column_type: INT64 value: "393.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 10909 column_index: 11 column_name: "stock_level" column_type: INT64 value: "605.0"
  Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 11071 column_index: 11 column_name: "stock_level" column_type: INT64 value: "101.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 11236 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 11394 column_index: 11 column_name: "stock_level" column_type: INT64 value: "147.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 11559 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 11707 column_index: 11 column_name: "stock_level" column_type: INT64 value: "110.0"
  Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 11854 column_index: 11 column_name: "stock_level" column_type: INT64 value: "696.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 12012 column_index: 11 column_name: "stock_level" column_type: INT64 value: "931.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 12170 column_index: 11 column_name: "stock_level" column_type: INT64 value: "400.0"
  Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 12321 column_index: 11 column_name: "stock_level" column_type: INT64 value: "127.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 12470 column_index: 11 column_name: "stock_level" column_type: INT64 value: "603.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 12641 column_index: 11 column_name: "stock_level" column_type: INT64 value: "810.0"
  Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 12805 column_index: 11 column_name: "stock_level" column_type: INT64 value: "255.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 12973 column_index: 11 column_name: "stock_level" column_type: INT64 value: "32.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 13143 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3242.0"
  Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 13303 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2086.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 13463 column_index: 11 column_name: "stock_level" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 13618 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 13767 column_index: 11 column_name: "stock_level" column_type: INT64 value: "206.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 13917 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1573.0"
  Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 14078 column_index: 11 column_name: "stock_level" column_type: INT64 value: "5112.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 14245 column_index: 11 column_name: "stock_level" column_type: INT64 value: "371.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 14413 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 14568 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1095.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 14720 column_index: 11 column_name: "stock_level" column_type: INT64 value: "172.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 14871 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3149.0"
  Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 15032 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1709.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 15203 column_index: 11 column_name: "stock_level" column_type: INT64 value: "104.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 15371 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 15521 column_index: 11 column_name: "stock_level" column_type: INT64 value: "48.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 15676 column_index: 11 column_name: "stock_level" column_type: INT64 value: "306.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 15827 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4000.0"
  Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 15996 column_index: 11 column_name: "stock_level" column_type: INT64 value: "69.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.170640 [debug] [Thread-1  ]: Runtime Error in seed rugs_usa_variant (seeds/rugs_usa_variant.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 276 column_index: 11 column_name: "stock_level" column_type: INT64 value: "279.0"
  Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 432 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1299.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 593 column_index: 11 column_name: "stock_level" column_type: INT64 value: "509.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 736 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3186.0"
  Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 888 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1594.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1049 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1193 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2763.0"
  Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1348 column_index: 11 column_name: "stock_level" column_type: INT64 value: "11293.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1495 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1821.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1657 column_index: 11 column_name: "stock_level" column_type: INT64 value: "462.0"
  Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1808 column_index: 11 column_name: "stock_level" column_type: INT64 value: "882.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1970 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2856.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2126 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2270 column_index: 11 column_name: "stock_level" column_type: INT64 value: "514.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2435 column_index: 11 column_name: "stock_level" column_type: INT64 value: "73.0"
  Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2585 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4542.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2732 column_index: 11 column_name: "stock_level" column_type: INT64 value: "799.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2878 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13534.0"
  Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "78.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3197 column_index: 11 column_name: "stock_level" column_type: INT64 value: "70.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3358 column_index: 11 column_name: "stock_level" column_type: INT64 value: "68.0"
  Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3508 column_index: 11 column_name: "stock_level" column_type: INT64 value: "427.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3653 column_index: 11 column_name: "stock_level" column_type: INT64 value: "16175.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3811 column_index: 11 column_name: "stock_level" column_type: INT64 value: "718.0"
  Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3957 column_index: 11 column_name: "stock_level" column_type: INT64 value: "581.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4103 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4257 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2611.0"
  Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4417 column_index: 11 column_name: "stock_level" column_type: INT64 value: "41.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4572 column_index: 11 column_name: "stock_level" column_type: INT64 value: "83.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4723 column_index: 11 column_name: "stock_level" column_type: INT64 value: "140.0"
  Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 4876 column_index: 11 column_name: "stock_level" column_type: INT64 value: "238.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1221.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5199 column_index: 11 column_name: "stock_level" column_type: INT64 value: "185.0"
  Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5364 column_index: 11 column_name: "stock_level" column_type: INT64 value: "428.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5529 column_index: 11 column_name: "stock_level" column_type: INT64 value: "249.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5698 column_index: 11 column_name: "stock_level" column_type: INT64 value: "79.0"
  Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 5864 column_index: 11 column_name: "stock_level" column_type: INT64 value: "121.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6015 column_index: 11 column_name: "stock_level" column_type: INT64 value: "96.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6166 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6311 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6451 column_index: 11 column_name: "stock_level" column_type: INT64 value: "72.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6591 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3.0"
  Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 6746 column_index: 11 column_name: "stock_level" column_type: INT64 value: "61.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 6906 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7046 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7201 column_index: 11 column_name: "stock_level" column_type: INT64 value: "29.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7360 column_index: 11 column_name: "stock_level" column_type: INT64 value: "-17.0"
  Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7675 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 7823 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 7966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "112.0"
  Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 8112 column_index: 11 column_name: "stock_level" column_type: INT64 value: "717.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 8267 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 8422 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13.0"
  Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 8564 column_index: 11 column_name: "stock_level" column_type: INT64 value: "71.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 8710 column_index: 11 column_name: "stock_level" column_type: INT64 value: "556.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 8869 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2.0"
  Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 9021 column_index: 11 column_name: "stock_level" column_type: INT64 value: "25.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 9171 column_index: 11 column_name: "stock_level" column_type: INT64 value: "156.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 9330 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 9643 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 9803 column_index: 11 column_name: "stock_level" column_type: INT64 value: "151.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 9966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 10131 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 10286 column_index: 11 column_name: "stock_level" column_type: INT64 value: "63.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 10447 column_index: 11 column_name: "stock_level" column_type: INT64 value: "378.0"
  Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 10603 column_index: 11 column_name: "stock_level" column_type: INT64 value: "43.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 10747 column_index: 11 column_name: "stock_level" column_type: INT64 value: "393.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 10909 column_index: 11 column_name: "stock_level" column_type: INT64 value: "605.0"
  Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 11071 column_index: 11 column_name: "stock_level" column_type: INT64 value: "101.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 11236 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 11394 column_index: 11 column_name: "stock_level" column_type: INT64 value: "147.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 11559 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 11707 column_index: 11 column_name: "stock_level" column_type: INT64 value: "110.0"
  Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 11854 column_index: 11 column_name: "stock_level" column_type: INT64 value: "696.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 12012 column_index: 11 column_name: "stock_level" column_type: INT64 value: "931.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 12170 column_index: 11 column_name: "stock_level" column_type: INT64 value: "400.0"
  Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 12321 column_index: 11 column_name: "stock_level" column_type: INT64 value: "127.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 12470 column_index: 11 column_name: "stock_level" column_type: INT64 value: "603.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 12641 column_index: 11 column_name: "stock_level" column_type: INT64 value: "810.0"
  Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 12805 column_index: 11 column_name: "stock_level" column_type: INT64 value: "255.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 12973 column_index: 11 column_name: "stock_level" column_type: INT64 value: "32.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 13143 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3242.0"
  Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 13303 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2086.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 13463 column_index: 11 column_name: "stock_level" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 13618 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 13767 column_index: 11 column_name: "stock_level" column_type: INT64 value: "206.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 13917 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1573.0"
  Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 14078 column_index: 11 column_name: "stock_level" column_type: INT64 value: "5112.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 14245 column_index: 11 column_name: "stock_level" column_type: INT64 value: "371.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 14413 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 14568 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1095.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 14720 column_index: 11 column_name: "stock_level" column_type: INT64 value: "172.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 14871 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3149.0"
  Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 15032 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1709.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 15203 column_index: 11 column_name: "stock_level" column_type: INT64 value: "104.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 15371 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 15521 column_index: 11 column_name: "stock_level" column_type: INT64 value: "48.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 15676 column_index: 11 column_name: "stock_level" column_type: INT64 value: "306.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 15827 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4000.0"
  Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 15996 column_index: 11 column_name: "stock_level" column_type: INT64 value: "69.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.173020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102713d30>]}
[0m10:15:10.174739 [error] [Thread-1  ]: 6 of 6 ERROR loading seed file ruggable.rugs_usa_variant ....................... [[31mERROR[0m in 6.44s]
[0m10:15:10.176370 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_variant
[0m10:15:10.177795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:10.178063 [debug] [MainThread]: Connection 'seed.ruggable.rugs_usa_variant' was properly closed.
[0m10:15:10.178331 [info ] [MainThread]: 
[0m10:15:10.178587 [info ] [MainThread]: Finished running 6 seeds in 0 hours 0 minutes and 35.69 seconds (35.69s).
[0m10:15:10.182189 [debug] [MainThread]: Command end result
[0m10:15:10.210380 [info ] [MainThread]: 
[0m10:15:10.210665 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:15:10.210826 [info ] [MainThread]: 
[0m10:15:10.211644 [error] [MainThread]:   Runtime Error in seed rugs_usa_pads_upsell (seeds/rugs_usa_pads_upsell.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 154; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 154; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 86 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 295 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 403 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 614 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 721 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 905 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1005 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1205 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1313 column_index: 6 column_name: "stock" column_type: INT64 value: "222.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1516 column_index: 6 column_name: "stock" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 1709 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 1809 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2011 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2118 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2303 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2403 column_index: 6 column_name: "stock" column_type: INT64 value: "980.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 2609 column_index: 6 column_name: "stock" column_type: INT64 value: "1849.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 2715 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 2915 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3024 column_index: 6 column_name: "stock" column_type: INT64 value: "105.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3235 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 3343 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 3545 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 3653 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 3838 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 3938 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 4162 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 4270 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 4472 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 4581 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 4767 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 4955 column_index: 6 column_name: "stock" column_type: INT64 value: "133.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 5056 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 5260 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 5368 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 5592 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 5700 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 5924 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 6032 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 6233 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 6342 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 6528 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 6628 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 6831 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 6939 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 7125 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 7313 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 7412 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 7621 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 7734 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 7945 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 8057 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 8268 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 8383 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 8579 column_index: 6 column_name: "stock" column_type: INT64 value: "6.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 8782 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 8883 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 9094 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 9206 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 9419 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 9533 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 9754 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 9871 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 10092 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 10209 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 102 byte_offset_to_start_of_line: 10429 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 103 byte_offset_to_start_of_line: 10546 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 105 byte_offset_to_start_of_line: 10766 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 106 byte_offset_to_start_of_line: 10883 column_index: 6 column_name: "stock" column_type: INT64 value: "1585.0"
  Error while reading data, error message: Unable to parse; line_number: 108 byte_offset_to_start_of_line: 11078 column_index: 6 column_name: "stock" column_type: INT64 value: "525.0"
  Error while reading data, error message: Unable to parse; line_number: 109 byte_offset_to_start_of_line: 11182 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 111 byte_offset_to_start_of_line: 11378 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 112 byte_offset_to_start_of_line: 11483 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 114 byte_offset_to_start_of_line: 11677 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 115 byte_offset_to_start_of_line: 11783 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 117 byte_offset_to_start_of_line: 11962 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 119 byte_offset_to_start_of_line: 12143 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 120 byte_offset_to_start_of_line: 12241 column_index: 6 column_name: "stock" column_type: INT64 value: "218.0"
  Error while reading data, error message: Unable to parse; line_number: 122 byte_offset_to_start_of_line: 12438 column_index: 6 column_name: "stock" column_type: INT64 value: "1157.0"
  Error while reading data, error message: Unable to parse; line_number: 123 byte_offset_to_start_of_line: 12542 column_index: 6 column_name: "stock" column_type: INT64 value: "979.0"
  Error while reading data, error message: Unable to parse; line_number: 125 byte_offset_to_start_of_line: 12743 column_index: 6 column_name: "stock" column_type: INT64 value: "1837.0"
  Error while reading data, error message: Unable to parse; line_number: 127 byte_offset_to_start_of_line: 12931 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 128 byte_offset_to_start_of_line: 13029 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 130 byte_offset_to_start_of_line: 13226 column_index: 6 column_name: "stock" column_type: INT64 value: "1875.0"
  Error while reading data, error message: Unable to parse; line_number: 131 byte_offset_to_start_of_line: 13332 column_index: 6 column_name: "stock" column_type: INT64 value: "103.0"
  Error while reading data, error message: Unable to parse; line_number: 133 byte_offset_to_start_of_line: 13538 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 134 byte_offset_to_start_of_line: 13644 column_index: 6 column_name: "stock" column_type: INT64 value: "288.0"
  Error while reading data, error message: Unable to parse; line_number: 136 byte_offset_to_start_of_line: 13864 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 137 byte_offset_to_start_of_line: 13970 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 139 byte_offset_to_start_of_line: 14150 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 141 byte_offset_to_start_of_line: 14332 column_index: 6 column_name: "stock" column_type: INT64 value: "131.0"
  Error while reading data, error message: Unable to parse; line_number: 142 byte_offset_to_start_of_line: 14431 column_index: 6 column_name: "stock" column_type: INT64 value: "1814.0"
  Error while reading data, error message: Unable to parse; line_number: 144 byte_offset_to_start_of_line: 14629 column_index: 6 column_name: "stock" column_type: INT64 value: "2136.0"
  Error while reading data, error message: Unable to parse; line_number: 145 byte_offset_to_start_of_line: 14735 column_index: 6 column_name: "stock" column_type: INT64 value: "226.0"
  Error while reading data, error message: Unable to parse; line_number: 147 byte_offset_to_start_of_line: 14932 column_index: 6 column_name: "stock" column_type: INT64 value: "4657.0"
  Error while reading data, error message: Unable to parse; line_number: 148 byte_offset_to_start_of_line: 15038 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 150 byte_offset_to_start_of_line: 15218 column_index: 6 column_name: "stock" column_type: INT64 value: "197.0"
  Error while reading data, error message: Unable to parse; line_number: 152 byte_offset_to_start_of_line: 15400 column_index: 6 column_name: "stock" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 153 byte_offset_to_start_of_line: 15497 column_index: 6 column_name: "stock" column_type: INT64 value: "2015.0"
  Error while reading data, error message: Unable to parse; line_number: 155 byte_offset_to_start_of_line: 15702 column_index: 6 column_name: "stock" column_type: INT64 value: "8586.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.212937 [info ] [MainThread]: 
[0m10:15:10.213653 [error] [MainThread]:   Runtime Error in seed rugs_usa_parent (seeds/rugs_usa_parent.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 5538; errors: 61; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 626 byte_offset_to_start_of_line: 515979 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 682 byte_offset_to_start_of_line: 562755 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 744 byte_offset_to_start_of_line: 614606 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 805 byte_offset_to_start_of_line: 665135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1105 byte_offset_to_start_of_line: 925918 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1137 byte_offset_to_start_of_line: 950170 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1180 byte_offset_to_start_of_line: 985105 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1283 byte_offset_to_start_of_line: 1075556 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1304 byte_offset_to_start_of_line: 1091943 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1357 byte_offset_to_start_of_line: 1135173 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1373 byte_offset_to_start_of_line: 1148625 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1417 byte_offset_to_start_of_line: 1186756 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1533 byte_offset_to_start_of_line: 1285319 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1635 byte_offset_to_start_of_line: 1370267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1760 byte_offset_to_start_of_line: 1475910 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1833 byte_offset_to_start_of_line: 1534713 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1878 byte_offset_to_start_of_line: 1574149 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2156 byte_offset_to_start_of_line: 1798610 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2268 byte_offset_to_start_of_line: 1887585 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2386 byte_offset_to_start_of_line: 1981363 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2397 byte_offset_to_start_of_line: 1989582 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2497 byte_offset_to_start_of_line: 2074495 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2572 byte_offset_to_start_of_line: 2133458 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 3250 byte_offset_to_start_of_line: 2668226 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 627 byte_offset_to_start_of_line: 517051 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 683 byte_offset_to_start_of_line: 563848 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 745 byte_offset_to_start_of_line: 615684 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1106 byte_offset_to_start_of_line: 926974 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1181 byte_offset_to_start_of_line: 986153 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1358 byte_offset_to_start_of_line: 1136232 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1418 byte_offset_to_start_of_line: 1187833 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1420 byte_offset_to_start_of_line: 1188645 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1636 byte_offset_to_start_of_line: 1371306 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1761 byte_offset_to_start_of_line: 1476984 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1834 byte_offset_to_start_of_line: 1535772 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2157 byte_offset_to_start_of_line: 1799664 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2387 byte_offset_to_start_of_line: 1982160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2398 byte_offset_to_start_of_line: 1990375 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2498 byte_offset_to_start_of_line: 2075267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 628 byte_offset_to_start_of_line: 517058 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 684 byte_offset_to_start_of_line: 563855 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 746 byte_offset_to_start_of_line: 615691 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1107 byte_offset_to_start_of_line: 926981 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1182 byte_offset_to_start_of_line: 986160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1359 byte_offset_to_start_of_line: 1136239 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1421 byte_offset_to_start_of_line: 1188646 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1637 byte_offset_to_start_of_line: 1371313 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1762 byte_offset_to_start_of_line: 1476991 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1835 byte_offset_to_start_of_line: 1535779 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1879 byte_offset_to_start_of_line: 1574884 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 2158 byte_offset_to_start_of_line: 1799671 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 806 byte_offset_to_start_of_line: 665886 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 1419 byte_offset_to_start_of_line: 1187840 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 8 columns.; line_number: 1138 byte_offset_to_start_of_line: 950795 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1284 byte_offset_to_start_of_line: 1076335 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1305 byte_offset_to_start_of_line: 1092562 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1374 byte_offset_to_start_of_line: 1149300 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1534 byte_offset_to_start_of_line: 1285994 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2269 byte_offset_to_start_of_line: 1888347 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2573 byte_offset_to_start_of_line: 2134135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 3251 byte_offset_to_start_of_line: 2668988 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.214477 [info ] [MainThread]: 
[0m10:15:10.215283 [error] [MainThread]:   Runtime Error in seed rugs_usa_variant (seeds/rugs_usa_variant.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 276 column_index: 11 column_name: "stock_level" column_type: INT64 value: "279.0"
  Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 432 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1299.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 593 column_index: 11 column_name: "stock_level" column_type: INT64 value: "509.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 736 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3186.0"
  Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 888 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1594.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1049 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1193 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2763.0"
  Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1348 column_index: 11 column_name: "stock_level" column_type: INT64 value: "11293.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1495 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1821.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1657 column_index: 11 column_name: "stock_level" column_type: INT64 value: "462.0"
  Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1808 column_index: 11 column_name: "stock_level" column_type: INT64 value: "882.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1970 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2856.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2126 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2270 column_index: 11 column_name: "stock_level" column_type: INT64 value: "514.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2435 column_index: 11 column_name: "stock_level" column_type: INT64 value: "73.0"
  Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2585 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4542.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2732 column_index: 11 column_name: "stock_level" column_type: INT64 value: "799.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2878 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13534.0"
  Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "78.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3197 column_index: 11 column_name: "stock_level" column_type: INT64 value: "70.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3358 column_index: 11 column_name: "stock_level" column_type: INT64 value: "68.0"
  Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3508 column_index: 11 column_name: "stock_level" column_type: INT64 value: "427.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3653 column_index: 11 column_name: "stock_level" column_type: INT64 value: "16175.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3811 column_index: 11 column_name: "stock_level" column_type: INT64 value: "718.0"
  Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3957 column_index: 11 column_name: "stock_level" column_type: INT64 value: "581.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4103 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4257 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2611.0"
  Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4417 column_index: 11 column_name: "stock_level" column_type: INT64 value: "41.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4572 column_index: 11 column_name: "stock_level" column_type: INT64 value: "83.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4723 column_index: 11 column_name: "stock_level" column_type: INT64 value: "140.0"
  Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 4876 column_index: 11 column_name: "stock_level" column_type: INT64 value: "238.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1221.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5199 column_index: 11 column_name: "stock_level" column_type: INT64 value: "185.0"
  Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5364 column_index: 11 column_name: "stock_level" column_type: INT64 value: "428.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5529 column_index: 11 column_name: "stock_level" column_type: INT64 value: "249.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5698 column_index: 11 column_name: "stock_level" column_type: INT64 value: "79.0"
  Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 5864 column_index: 11 column_name: "stock_level" column_type: INT64 value: "121.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6015 column_index: 11 column_name: "stock_level" column_type: INT64 value: "96.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6166 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6311 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6451 column_index: 11 column_name: "stock_level" column_type: INT64 value: "72.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6591 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3.0"
  Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 6746 column_index: 11 column_name: "stock_level" column_type: INT64 value: "61.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 6906 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7046 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7201 column_index: 11 column_name: "stock_level" column_type: INT64 value: "29.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7360 column_index: 11 column_name: "stock_level" column_type: INT64 value: "-17.0"
  Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7675 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 7823 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 7966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "112.0"
  Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 8112 column_index: 11 column_name: "stock_level" column_type: INT64 value: "717.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 8267 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 8422 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13.0"
  Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 8564 column_index: 11 column_name: "stock_level" column_type: INT64 value: "71.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 8710 column_index: 11 column_name: "stock_level" column_type: INT64 value: "556.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 8869 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2.0"
  Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 9021 column_index: 11 column_name: "stock_level" column_type: INT64 value: "25.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 9171 column_index: 11 column_name: "stock_level" column_type: INT64 value: "156.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 9330 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 9643 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 9803 column_index: 11 column_name: "stock_level" column_type: INT64 value: "151.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 9966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 10131 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 10286 column_index: 11 column_name: "stock_level" column_type: INT64 value: "63.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 10447 column_index: 11 column_name: "stock_level" column_type: INT64 value: "378.0"
  Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 10603 column_index: 11 column_name: "stock_level" column_type: INT64 value: "43.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 10747 column_index: 11 column_name: "stock_level" column_type: INT64 value: "393.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 10909 column_index: 11 column_name: "stock_level" column_type: INT64 value: "605.0"
  Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 11071 column_index: 11 column_name: "stock_level" column_type: INT64 value: "101.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 11236 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 11394 column_index: 11 column_name: "stock_level" column_type: INT64 value: "147.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 11559 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 11707 column_index: 11 column_name: "stock_level" column_type: INT64 value: "110.0"
  Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 11854 column_index: 11 column_name: "stock_level" column_type: INT64 value: "696.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 12012 column_index: 11 column_name: "stock_level" column_type: INT64 value: "931.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 12170 column_index: 11 column_name: "stock_level" column_type: INT64 value: "400.0"
  Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 12321 column_index: 11 column_name: "stock_level" column_type: INT64 value: "127.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 12470 column_index: 11 column_name: "stock_level" column_type: INT64 value: "603.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 12641 column_index: 11 column_name: "stock_level" column_type: INT64 value: "810.0"
  Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 12805 column_index: 11 column_name: "stock_level" column_type: INT64 value: "255.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 12973 column_index: 11 column_name: "stock_level" column_type: INT64 value: "32.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 13143 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3242.0"
  Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 13303 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2086.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 13463 column_index: 11 column_name: "stock_level" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 13618 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 13767 column_index: 11 column_name: "stock_level" column_type: INT64 value: "206.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 13917 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1573.0"
  Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 14078 column_index: 11 column_name: "stock_level" column_type: INT64 value: "5112.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 14245 column_index: 11 column_name: "stock_level" column_type: INT64 value: "371.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 14413 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 14568 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1095.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 14720 column_index: 11 column_name: "stock_level" column_type: INT64 value: "172.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 14871 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3149.0"
  Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 15032 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1709.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 15203 column_index: 11 column_name: "stock_level" column_type: INT64 value: "104.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 15371 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 15521 column_index: 11 column_name: "stock_level" column_type: INT64 value: "48.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 15676 column_index: 11 column_name: "stock_level" column_type: INT64 value: "306.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 15827 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4000.0"
  Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 15996 column_index: 11 column_name: "stock_level" column_type: INT64 value: "69.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.216455 [info ] [MainThread]: 
[0m10:15:10.216630 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m10:15:10.218011 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 37.40876, "process_user_time": 9.711935, "process_kernel_time": 1.627989, "process_mem_max_rss": "624394240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:15:10.218323 [debug] [MainThread]: Command `dbt seed` failed at 10:15:10.218274 after 37.41 seconds
[0m10:15:10.218549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253d5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d12490>]}
[0m10:15:10.218756 [debug] [MainThread]: Flushing usage events
[0m11:03:52.604242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812de50>]}


============================== 11:03:52.606974 | 7e9b4545-3b76-4736-a9b6-39bba2c2e881 ==============================
[0m11:03:52.606974 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:03:52.607298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:03:53.321678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e9b4545-3b76-4736-a9b6-39bba2c2e881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1470ce1f0>]}
[0m11:03:53.347421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e9b4545-3b76-4736-a9b6-39bba2c2e881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080df9d0>]}
[0m11:03:53.347703 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:03:53.358946 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:03:53.449267 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 6 files added, 0 files changed.
[0m11:03:53.449619 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_category_map.sql
[0m11:03:53.449797 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m11:03:53.449950 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m11:03:53.450098 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:03:53.450250 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_color_map.sql
[0m11:03:53.450399 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_links.sql
[0m11:03:53.450584 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_first_dbt_model.sql
[0m11:03:53.450713 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_second_dbt_model.sql
[0m11:03:53.572002 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ruggable.base_rugs_usa_category_map' (models/1_base/base_rugs_usa_category_map.sql) depends on a source named 'ruggable.raw_rugs_usa_category_map' which was not found
[0m11:03:53.573611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.016891, "process_user_time": 4.057981, "process_kernel_time": 0.23496, "process_mem_max_rss": "191512576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:03:53.573913 [debug] [MainThread]: Command `dbt run` failed at 11:03:53.573866 after 1.02 seconds
[0m11:03:53.574115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa6bb0>]}
[0m11:03:53.574302 [debug] [MainThread]: Flushing usage events
[0m11:08:41.663183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af9ee0>]}


============================== 11:08:41.665837 | 51c57809-3dd4-4599-b9df-29de47208360 ==============================
[0m11:08:41.665837 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:08:41.666148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:08:42.420918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108922a00>]}
[0m11:08:42.447668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b26cc70>]}
[0m11:08:42.447993 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:08:42.460460 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:08:42.547075 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 0 files changed.
[0m11:08:42.547442 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_color_map.sql
[0m11:08:42.547628 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_links.sql
[0m11:08:42.547794 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:08:42.547982 [debug] [MainThread]: Partial parsing: added file: ruggable://models/sources.yml
[0m11:08:42.548138 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m11:08:42.548281 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m11:08:42.548427 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_category_map.sql
[0m11:08:42.548614 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_first_dbt_model.sql
[0m11:08:42.548746 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_second_dbt_model.sql
[0m11:08:42.777680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1580c5130>]}
[0m11:08:42.845601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b6929a0>]}
[0m11:08:42.845969 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:08:42.846163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b688d30>]}
[0m11:08:42.847084 [info ] [MainThread]: 
[0m11:08:42.847439 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:08:42.850074 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:08:42.850353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:43.423925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:08:43.424796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:43.910122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b65c5b0>]}
[0m11:08:43.911204 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:08:43.911683 [info ] [MainThread]: 
[0m11:08:43.915902 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m11:08:43.916636 [info ] [Thread-1  ]: 1 of 6 START sql table model ruggable.base_rugs_usa_category_map ............... [RUN]
[0m11:08:43.917253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m11:08:43.917838 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m11:08:43.929290 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m11:08:43.930170 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m11:08:43.961402 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m11:08:43.962172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:44.025779 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m11:08:44.791896 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:02d17261-6c2b-422e-b082-9f95af2a760b&page=queryresults
[0m11:08:46.790755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1582c28b0>]}
[0m11:08:46.791474 [info ] [Thread-1  ]: 1 of 6 OK created sql table model ruggable.base_rugs_usa_category_map .......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 2.87s]
[0m11:08:46.792029 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m11:08:46.792394 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m11:08:46.792900 [info ] [Thread-1  ]: 2 of 6 START sql table model ruggable.base_rugs_usa_color_map .................. [RUN]
[0m11:08:46.793492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m11:08:46.794080 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m11:08:46.797418 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m11:08:46.798215 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m11:08:46.800878 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m11:08:46.801361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:46.872521 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m11:08:47.761571 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0fb56f63-81b7-4795-ae7b-8e6020e1b5a1&page=queryresults
[0m11:08:50.101074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1582c2400>]}
[0m11:08:50.102432 [info ] [Thread-1  ]: 2 of 6 OK created sql table model ruggable.base_rugs_usa_color_map ............. [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.31s]
[0m11:08:50.103834 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m11:08:50.104501 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m11:08:50.105338 [info ] [Thread-1  ]: 3 of 6 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m11:08:50.106104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m11:08:50.106623 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m11:08:50.111559 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m11:08:50.112781 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m11:08:50.118009 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m11:08:50.118873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:50.195713 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m11:08:50.934524 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f40537ad-070d-40bd-aa22-75dcf64f0e72&page=queryresults
[0m11:08:53.007033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15837f790>]}
[0m11:08:53.009509 [info ] [Thread-1  ]: 3 of 6 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 2.90s]
[0m11:08:53.010809 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m11:08:53.011422 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:53.012624 [info ] [Thread-1  ]: 4 of 6 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:08:53.013240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:08:53.014347 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:53.018057 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:08:53.019271 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:53.022385 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:08:53.023149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:53.096600 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:08:53.908311 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:52270266-c665-4376-93de-5455ad2c3e5a&page=queryresults
[0m11:08:57.008585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158348a00>]}
[0m11:08:57.010220 [info ] [Thread-1  ]: 4 of 6 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.00s]
[0m11:08:57.011410 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:57.012018 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m11:08:57.012679 [info ] [Thread-1  ]: 5 of 6 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m11:08:57.013325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m11:08:57.013749 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m11:08:57.018074 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m11:08:57.019343 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m11:08:57.022878 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m11:08:57.023753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:57.100216 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m11:08:57.797405 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c98bd599-4eff-41fd-9394-22508058d6b6&page=queryresults
[0m11:09:00.099542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158348a00>]}
[0m11:09:00.101049 [info ] [Thread-1  ]: 5 of 6 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.09s]
[0m11:09:00.102000 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m11:09:00.103221 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m11:09:00.104248 [info ] [Thread-1  ]: 6 of 6 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m11:09:00.105065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m11:09:00.105592 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m11:09:00.110484 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:00.111842 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m11:09:00.117852 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:00.118622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:00.194885 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m11:09:00.869604 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:25154525-d415-496e-a529-b79ffcc930a1&page=queryresults
[0m11:09:01.025202 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: variant at [15:7]; reason: invalidQuery, location: query, message: Unrecognized name: variant at [15:7]')
[0m11:09:01.685327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:59a0cd33-4fa6-40de-a161-0e277c832854&page=queryresults
[0m11:09:01.892381 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:59a0cd33-4fa6-40de-a161-0e277c832854&page=queryresults
[0m11:09:01.935807 [debug] [Thread-1  ]: Database Error in model base_rugs_usa_variant (models/1_base/base_rugs_usa_variant.sql)
  Unrecognized name: variant at [15:7]
  compiled Code at target/run/ruggable/models/1_base/base_rugs_usa_variant.sql
[0m11:09:01.936251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1582f9b20>]}
[0m11:09:01.936754 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model ruggable.base_rugs_usa_variant ........... [[31mERROR[0m in 1.83s]
[0m11:09:01.937182 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m11:09:01.938014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:01.938216 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_variant' was properly closed.
[0m11:09:01.938471 [info ] [MainThread]: 
[0m11:09:01.938690 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.09 seconds (19.09s).
[0m11:09:01.939583 [debug] [MainThread]: Command end result
[0m11:09:01.963965 [info ] [MainThread]: 
[0m11:09:01.964344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:01.964527 [info ] [MainThread]: 
[0m11:09:01.964753 [error] [MainThread]:   Database Error in model base_rugs_usa_variant (models/1_base/base_rugs_usa_variant.sql)
  Unrecognized name: variant at [15:7]
  compiled Code at target/run/ruggable/models/1_base/base_rugs_usa_variant.sql
[0m11:09:01.964937 [info ] [MainThread]: 
[0m11:09:01.965132 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:09:01.966571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 20.352846, "process_user_time": 5.321499, "process_kernel_time": 0.258307, "process_mem_max_rss": "201834496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:09:01.966909 [debug] [MainThread]: Command `dbt run` failed at 11:09:01.966853 after 20.35 seconds
[0m11:09:01.967150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b26cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083dba60>]}
[0m11:09:01.967365 [debug] [MainThread]: Flushing usage events
[0m11:09:47.314060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a01340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a01160>]}


============================== 11:09:47.316809 | dbb89884-05fe-40cd-b6b4-6785ab041628 ==============================
[0m11:09:47.316809 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:09:47.317154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select base_rugs_usa_variant', 'send_anonymous_usage_stats': 'True'}
[0m11:09:47.788036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e2580>]}
[0m11:09:47.814681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167e39190>]}
[0m11:09:47.815005 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:09:47.825552 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:09:47.904968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:09:47.905387 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m11:09:48.070044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168478100>]}
[0m11:09:48.130426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168269be0>]}
[0m11:09:48.130756 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:09:48.130950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16825b8b0>]}
[0m11:09:48.131547 [info ] [MainThread]: 
[0m11:09:48.131850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:09:48.132312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:09:48.132526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:48.683690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:09:48.685135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:49.197833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16844ff70>]}
[0m11:09:49.198999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:09:49.199489 [info ] [MainThread]: 
[0m11:09:49.202263 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m11:09:49.202969 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m11:09:49.203516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_variant)
[0m11:09:49.203900 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m11:09:49.215097 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:49.216243 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m11:09:49.252160 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:49.252849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:49.317759 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m11:09:50.022778 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f69af36b-e47e-4d0c-88f1-31d355576845&page=queryresults
[0m11:09:52.659215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168546be0>]}
[0m11:09:52.659984 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.45s]
[0m11:09:52.660588 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m11:09:52.661672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:52.661971 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_variant' was properly closed.
[0m11:09:52.662246 [info ] [MainThread]: 
[0m11:09:52.662543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m11:09:52.663121 [debug] [MainThread]: Command end result
[0m11:09:52.691748 [info ] [MainThread]: 
[0m11:09:52.692162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:52.692393 [info ] [MainThread]: 
[0m11:09:52.692610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:09:52.693995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.432384, "process_user_time": 4.631961, "process_kernel_time": 0.160312, "process_mem_max_rss": "199016448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:09:52.694427 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:52.694338 after 5.43 seconds
[0m11:09:52.694718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092efa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168268310>]}
[0m11:09:52.694978 [debug] [MainThread]: Flushing usage events
[0m11:51:23.443631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a412e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a41100>]}


============================== 11:51:23.446402 | f81c69ad-fb8d-4d3b-9445-3ba20fdc3941 ==============================
[0m11:51:23.446402 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:51:23.446753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_rugs_usa_pads_upsell', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:51:24.158173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088caa30>]}
[0m11:51:24.183939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f0dc0>]}
[0m11:51:24.184235 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:51:24.195735 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:51:24.281451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:51:24.281768 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_rugs_usa_parent.sql
[0m11:51:24.281985 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:51:24.442073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7ce130>]}
[0m11:51:24.503448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f2d5c40>]}
[0m11:51:24.503722 [info ] [MainThread]: Found 6 seeds, 7 models, 6 sources, 469 macros
[0m11:51:24.503901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f6877f0>]}
[0m11:51:24.504463 [info ] [MainThread]: 
[0m11:51:24.504724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:24.505143 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:51:24.505344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:25.090520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:51:25.091324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:25.630128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f6e66a0>]}
[0m11:51:25.631287 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:51:25.632305 [info ] [MainThread]: 
[0m11:51:25.637112 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:25.637976 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:51:25.638794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:51:25.639257 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:25.649422 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:51:25.650901 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:25.665413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:26.226151 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:51:26.227056 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:51:26.838921 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ddee4b16-a4c1-473f-bdbe-746fc011d7d9&page=queryresults
[0m11:51:29.499554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ea496a0>]}
[0m11:51:29.500083 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.86s]
[0m11:51:29.500526 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:29.501299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:29.501510 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_pads_upsell' was properly closed.
[0m11:51:29.501694 [info ] [MainThread]: 
[0m11:51:29.501911 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m11:51:29.502322 [debug] [MainThread]: Command end result
[0m11:51:29.525129 [info ] [MainThread]: 
[0m11:51:29.525438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:29.525608 [info ] [MainThread]: 
[0m11:51:29.525782 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:29.527278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.133024, "process_user_time": 2.908499, "process_kernel_time": 1.963486, "process_mem_max_rss": "198885376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:51:29.527569 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:29.527519 after 6.13 seconds
[0m11:51:29.527778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7be250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f6e3850>]}
[0m11:51:29.527969 [debug] [MainThread]: Flushing usage events
[0m11:52:53.249128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f9ee0>]}


============================== 11:52:53.251456 | 551a9bb2-455f-4ca1-adce-adba241f1d11 ==============================
[0m11:52:53.251456 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:52:53.251797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:52:53.716592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef2a00>]}
[0m11:52:53.742724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cacc70>]}
[0m11:52:53.743010 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:52:53.753806 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:52:53.832914 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m11:52:53.833237 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/2_staging/stg_rugs_usa_parent.sql
[0m11:52:53.833482 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m11:52:53.999468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14622fd90>]}
[0m11:52:54.059343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14611fd00>]}
[0m11:52:54.059668 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:52:54.059868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14612b070>]}
[0m11:52:54.060671 [info ] [MainThread]: 
[0m11:52:54.060964 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:54.063422 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:52:54.063628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:54.553307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:52:54.553819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:55.099117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d61b50>]}
[0m11:52:55.100119 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:52:55.100802 [info ] [MainThread]: 
[0m11:52:55.104150 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m11:52:55.104857 [info ] [Thread-1  ]: 1 of 6 START sql table model ruggable.base_rugs_usa_category_map ............... [RUN]
[0m11:52:55.105646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m11:52:55.106289 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m11:52:55.116690 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m11:52:55.117458 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m11:52:55.131947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:55.636818 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m11:52:55.637563 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m11:52:56.234944 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c88ec0e3-d2c8-4369-b420-f93bc4daa75e&page=queryresults
[0m11:52:58.718429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137502670>]}
[0m11:52:58.719274 [info ] [Thread-1  ]: 1 of 6 OK created sql table model ruggable.base_rugs_usa_category_map .......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.61s]
[0m11:52:58.719900 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m11:52:58.720318 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m11:52:58.720825 [info ] [Thread-1  ]: 2 of 6 START sql table model ruggable.base_rugs_usa_color_map .................. [RUN]
[0m11:52:58.721269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m11:52:58.721584 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m11:52:58.724492 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m11:52:58.725304 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m11:52:58.727580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:59.268617 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m11:52:59.271847 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m11:52:59.713248 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5f681502-13bb-4104-93b5-52581d9f5611&page=queryresults
[0m11:53:02.035556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146504a60>]}
[0m11:53:02.037736 [info ] [Thread-1  ]: 2 of 6 OK created sql table model ruggable.base_rugs_usa_color_map ............. [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.31s]
[0m11:53:02.038678 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m11:53:02.039222 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m11:53:02.039828 [info ] [Thread-1  ]: 3 of 6 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m11:53:02.040401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m11:53:02.040785 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m11:53:02.044815 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m11:53:02.045738 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m11:53:02.048652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:02.565097 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m11:53:02.567387 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m11:53:03.095150 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cb6f075a-be51-47a8-b3f5-0fb65dcd37fd&page=queryresults
[0m11:53:05.238369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:05.239360 [info ] [Thread-1  ]: 3 of 6 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.20s]
[0m11:53:05.240122 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m11:53:05.240651 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:05.241301 [info ] [Thread-1  ]: 4 of 6 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:53:05.241846 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:53:05.242224 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:05.248172 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:53:05.249331 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:05.251806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:05.776602 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:53:05.779056 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:53:06.373680 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b80ec534-2fb2-4249-a621-6b8d62b2fa43&page=queryresults
[0m11:53:09.007895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:09.009131 [info ] [Thread-1  ]: 4 of 6 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.77s]
[0m11:53:09.010039 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:09.010610 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m11:53:09.011327 [info ] [Thread-1  ]: 5 of 6 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m11:53:09.012270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m11:53:09.013004 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m11:53:09.017795 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m11:53:09.018721 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m11:53:09.022143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:09.541917 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m11:53:09.543919 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m11:53:09.992327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:200e0dc1-d7be-4ca9-a296-08cacaea90f7&page=queryresults
[0m11:53:12.440168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:12.441698 [info ] [Thread-1  ]: 5 of 6 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.43s]
[0m11:53:12.442686 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m11:53:12.443380 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m11:53:12.444809 [info ] [Thread-1  ]: 6 of 6 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m11:53:12.445709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m11:53:12.446273 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m11:53:12.451514 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m11:53:12.453207 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m11:53:12.456839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:12.969686 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m11:53:12.972147 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m11:53:13.418081 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dcb2e481-b11e-4ed2-8f71-513fd8151845&page=queryresults
[0m11:53:15.772140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:15.773461 [info ] [Thread-1  ]: 6 of 6 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.33s]
[0m11:53:15.774338 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m11:53:15.776298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:15.776809 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_variant' was properly closed.
[0m11:53:15.777198 [info ] [MainThread]: 
[0m11:53:15.777515 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.72 seconds (21.72s).
[0m11:53:15.778665 [debug] [MainThread]: Command end result
[0m11:53:15.808994 [info ] [MainThread]: 
[0m11:53:15.809358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:15.809561 [info ] [MainThread]: 
[0m11:53:15.809755 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:53:15.811154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.614563, "process_user_time": 5.224697, "process_kernel_time": 0.195066, "process_mem_max_rss": "201228288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:15.811485 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:15.811432 after 22.61 seconds
[0m11:53:15.811713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14654dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bee340>]}
[0m11:53:15.811934 [debug] [MainThread]: Flushing usage events
[0m11:55:07.772390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e3da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b5190>]}


============================== 11:55:07.775454 | cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8 ==============================
[0m11:55:07.775454 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:55:07.775829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_rugs_usa_pads_upsell', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:55:08.521154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10363a7c0>]}
[0m11:55:08.548678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b530a30>]}
[0m11:55:08.549054 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:55:08.560454 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:55:08.642433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:08.642781 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:55:08.804846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba8d100>]}
[0m11:55:08.864516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba8df70>]}
[0m11:55:08.864802 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:55:08.864988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b946ee0>]}
[0m11:55:08.865547 [info ] [MainThread]: 
[0m11:55:08.865813 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:08.866230 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:55:08.866426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:09.392840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:55:09.393241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:09.878191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba7a100>]}
[0m11:55:09.878986 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:55:09.879395 [info ] [MainThread]: 
[0m11:55:09.882800 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:09.883408 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:55:09.884063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:55:09.884811 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:09.894950 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:55:09.895712 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:09.908046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:10.478398 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:55:10.479286 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:55:10.924447 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:af7f416e-9ef2-4164-9bd3-81c3f2aa4574&page=queryresults
[0m11:55:13.809708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ad39610>]}
[0m11:55:13.810653 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.92s]
[0m11:55:13.811412 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:13.812884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:13.813234 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_pads_upsell' was properly closed.
[0m11:55:13.813532 [info ] [MainThread]: 
[0m11:55:13.813850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m11:55:13.814517 [debug] [MainThread]: Command end result
[0m11:55:13.864153 [info ] [MainThread]: 
[0m11:55:13.864654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:13.864880 [info ] [MainThread]: 
[0m11:55:13.865085 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:55:13.868964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1503725, "process_user_time": 3.531666, "process_kernel_time": 1.207687, "process_mem_max_rss": "200507392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:13.871548 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:13.871401 after 6.15 seconds
[0m11:55:13.871950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e3da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ca3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bbc5be0>]}
[0m11:55:13.872232 [debug] [MainThread]: Flushing usage events
[0m12:03:36.173045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107735310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107735130>]}


============================== 12:03:36.175675 | 65094216-0644-4300-ab0f-cc8eb28cf7ad ==============================
[0m12:03:36.175675 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:03:36.175997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_category_map stg_color_map', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:03:36.904652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff40d0>]}
[0m12:03:36.933696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd700>]}
[0m12:03:36.934119 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:03:36.946677 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:03:37.036127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:03:37.036521 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_color_map.sql
[0m12:03:37.036706 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_category_map.sql
[0m12:03:37.216796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee4e130>]}
[0m12:03:37.285455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ede98e0>]}
[0m12:03:37.285793 [info ] [MainThread]: Found 6 seeds, 8 models, 6 sources, 469 macros
[0m12:03:37.285980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee3e070>]}
[0m12:03:37.286680 [info ] [MainThread]: 
[0m12:03:37.286986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:03:37.289266 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:03:37.289480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:37.855867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:03:37.856791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:38.388846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d9a30>]}
[0m12:03:38.390278 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:03:38.390901 [info ] [MainThread]: 
[0m12:03:38.394558 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m12:03:38.395283 [info ] [Thread-1  ]: 1 of 2 START sql table model ruggable.stg_category_map ......................... [RUN]
[0m12:03:38.395829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_category_map)
[0m12:03:38.396399 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m12:03:38.406900 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m12:03:38.408411 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m12:03:38.442293 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m12:03:38.442903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:03:38.507651 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m12:03:39.183942 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ab5e3e51-d783-4107-933d-1f46fceea27c&page=queryresults
[0m12:03:41.275127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef0df10>]}
[0m12:03:41.275974 [info ] [Thread-1  ]: 1 of 2 OK created sql table model ruggable.stg_category_map .................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 2.88s]
[0m12:03:41.276641 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m12:03:41.277088 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m12:03:41.277676 [info ] [Thread-1  ]: 2 of 2 START sql table model ruggable.stg_color_map ............................ [RUN]
[0m12:03:41.278194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m12:03:41.278561 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m12:03:41.281632 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m12:03:41.282652 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m12:03:41.285652 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m12:03:41.286342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:03:41.358593 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m12:03:42.095802 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2c1bbb1e-8ec5-41fa-bfcf-1d38ab8c355d&page=queryresults
[0m12:03:44.222876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef0d880>]}
[0m12:03:44.223808 [info ] [Thread-1  ]: 2 of 2 OK created sql table model ruggable.stg_color_map ....................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 2.94s]
[0m12:03:44.224724 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m12:03:44.225804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:44.226096 [debug] [MainThread]: Connection 'model.ruggable.stg_color_map' was properly closed.
[0m12:03:44.226394 [info ] [MainThread]: 
[0m12:03:44.226993 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.94 seconds (6.94s).
[0m12:03:44.227809 [debug] [MainThread]: Command end result
[0m12:03:44.260330 [info ] [MainThread]: 
[0m12:03:44.260671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:44.260917 [info ] [MainThread]: 
[0m12:03:44.261172 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:03:44.262929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.136831, "process_user_time": 4.678226, "process_kernel_time": 0.230401, "process_mem_max_rss": "199098368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:03:44.263332 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:44.263265 after 8.14 seconds
[0m12:03:44.263609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071247c0>]}
[0m12:03:44.263857 [debug] [MainThread]: Flushing usage events
[0m12:16:31.863237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076803a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076801c0>]}


============================== 12:16:31.866096 | 3314d1e3-97b3-42b7-a79e-682deca5233f ==============================
[0m12:16:31.866096 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:16:31.866479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_links', 'send_anonymous_usage_stats': 'True'}
[0m12:16:32.408213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c1da430>]}
[0m12:16:32.436920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bcac0>]}
[0m12:16:32.437379 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:16:32.447958 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:16:32.534769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:16:32.535161 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_links.sql
[0m12:16:32.535388 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m12:16:32.699044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d097eb0>]}
[0m12:16:32.760124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620c430>]}
[0m12:16:32.760404 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:16:32.760595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c6af9d0>]}
[0m12:16:32.761195 [info ] [MainThread]: 
[0m12:16:32.761464 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:32.761900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:16:32.762116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:33.398281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:16:33.398982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:33.900411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574aa90>]}
[0m12:16:33.901714 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:16:33.902239 [info ] [MainThread]: 
[0m12:16:33.905883 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:16:33.906752 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:16:33.907356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_links)
[0m12:16:33.907958 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:16:33.918794 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:16:33.919708 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:16:33.953362 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:16:33.953970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:34.018550 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as (select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent`

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:16:34.601556 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a9807078-71cf-40e8-9982-c1ad942cb1af&page=queryresults
[0m12:16:34.602872 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [17:17]; reason: invalidQuery, location: query, message: Syntax error: Unexpected "(" at [17:17]')
[0m12:16:35.830925 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:53f0bb93-557b-4b7d-9eef-a5bc70d7bb70&page=queryresults
[0m12:16:35.833295 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:53f0bb93-557b-4b7d-9eef-a5bc70d7bb70&page=queryresults
[0m12:16:35.877152 [debug] [Thread-1  ]: Database Error in model stg_links (models/2_staging/stg_links.sql)
  Syntax error: Unexpected "(" at [17:17]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:35.878514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d3aeee0>]}
[0m12:16:35.879008 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_links ....................... [[31mERROR[0m in 1.97s]
[0m12:16:35.879403 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:16:35.880219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:35.880445 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:16:35.880669 [info ] [MainThread]: 
[0m12:16:35.880907 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m12:16:35.881332 [debug] [MainThread]: Command end result
[0m12:16:35.906269 [info ] [MainThread]: 
[0m12:16:35.906601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:35.906779 [info ] [MainThread]: 
[0m12:16:35.906998 [error] [MainThread]:   Database Error in model stg_links (models/2_staging/stg_links.sql)
  Syntax error: Unexpected "(" at [17:17]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:35.907164 [info ] [MainThread]: 
[0m12:16:35.907338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:16:35.908678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0934305, "process_user_time": 4.415043, "process_kernel_time": 0.184434, "process_mem_max_rss": "199245824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:35.909005 [debug] [MainThread]: Command `dbt run` failed at 12:16:35.908955 after 4.09 seconds
[0m12:16:35.909254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d39e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bcac0>]}
[0m12:16:35.909461 [debug] [MainThread]: Flushing usage events
[0m12:16:55.559034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81160>]}


============================== 12:16:55.561217 | 6b50f5cb-c63c-4867-8a13-05037e95923d ==============================
[0m12:16:55.561217 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:16:55.561618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_links', 'send_anonymous_usage_stats': 'True'}
[0m12:16:56.004870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f62580>]}
[0m12:16:56.030775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fdba2b0>]}
[0m12:16:56.031074 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:16:56.041510 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:16:56.125013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:56.125401 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_links.sql
[0m12:16:56.283982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157518e50>]}
[0m12:16:56.343140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1570e32b0>]}
[0m12:16:56.343404 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:16:56.343594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15702e580>]}
[0m12:16:56.344179 [info ] [MainThread]: 
[0m12:16:56.344452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:56.344883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:16:56.345080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:56.905413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:16:56.906165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:57.413280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15711ef70>]}
[0m12:16:57.414245 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:16:57.414662 [info ] [MainThread]: 
[0m12:16:57.418190 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:16:57.418793 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:16:57.419275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_links)
[0m12:16:57.419626 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:16:57.429022 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:16:57.429873 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:16:57.462108 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:16:57.462689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:57.525795 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:16:58.254923 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e7e08b99-379a-4de4-a858-a0c5f423327c&page=queryresults
[0m12:16:58.419937 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column internal_name in USING clause not found on right side of join at [37:30]; reason: invalidQuery, location: query, message: Column internal_name in USING clause not found on right side of join at [37:30]')
[0m12:16:58.986657 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3855fbb9-08df-417d-a4bf-e8b7a7e71261&page=queryresults
[0m12:16:59.133115 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3855fbb9-08df-417d-a4bf-e8b7a7e71261&page=queryresults
[0m12:16:59.180446 [debug] [Thread-1  ]: Database Error in model stg_links (models/2_staging/stg_links.sql)
  Column internal_name in USING clause not found on right side of join at [37:30]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:59.181804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157632040>]}
[0m12:16:59.182292 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_links ....................... [[31mERROR[0m in 1.76s]
[0m12:16:59.182696 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:16:59.183481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:59.183671 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:16:59.183862 [info ] [MainThread]: 
[0m12:16:59.184064 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m12:16:59.184469 [debug] [MainThread]: Command end result
[0m12:16:59.208985 [info ] [MainThread]: 
[0m12:16:59.209402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:59.209587 [info ] [MainThread]: 
[0m12:16:59.209859 [error] [MainThread]:   Database Error in model stg_links (models/2_staging/stg_links.sql)
  Column internal_name in USING clause not found on right side of join at [37:30]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:59.210061 [info ] [MainThread]: 
[0m12:16:59.210266 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:16:59.211694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.702446, "process_user_time": 4.664231, "process_kernel_time": 0.153331, "process_mem_max_rss": "198934528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:59.212043 [debug] [MainThread]: Command `dbt run` failed at 12:16:59.211990 after 3.70 seconds
[0m12:16:59.212287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f62580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1570e32b0>]}
[0m12:16:59.212514 [debug] [MainThread]: Flushing usage events
[0m12:17:17.479797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102280a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf91c0>]}


============================== 12:17:17.481934 | 99a1bb8e-3916-4918-b737-06a456183ad4 ==============================
[0m12:17:17.481934 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:17.482277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_links', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:17.914726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb8580>]}
[0m12:17:17.940549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a879160>]}
[0m12:17:17.940870 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:17:17.951272 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:17:18.028909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:18.029163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:18.055333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abd5130>]}
[0m12:17:18.147371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abc29a0>]}
[0m12:17:18.147693 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:17:18.147888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abf42b0>]}
[0m12:17:18.148577 [info ] [MainThread]: 
[0m12:17:18.148863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:17:18.151036 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:17:18.151257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:18.692270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:17:18.693143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:19.244662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020e6cd0>]}
[0m12:17:19.246132 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:17:19.246826 [info ] [MainThread]: 
[0m12:17:19.251198 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m12:17:19.251857 [info ] [Thread-1  ]: 1 of 3 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m12:17:19.252467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_links)
[0m12:17:19.252986 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m12:17:19.264702 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m12:17:19.265585 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m12:17:19.280535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:17:19.842449 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m12:17:19.843256 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m12:17:20.329376 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9a2e2ad4-e199-4b33-91ba-ddf4ae5f5796&page=queryresults
[0m12:17:22.703870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a97cca0>]}
[0m12:17:22.704435 [info ] [Thread-1  ]: 1 of 3 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.45s]
[0m12:17:22.704851 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m12:17:22.705124 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m12:17:22.705407 [info ] [Thread-1  ]: 2 of 3 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m12:17:22.705691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_parent)
[0m12:17:22.705915 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m12:17:22.708236 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m12:17:22.708813 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m12:17:22.710419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:17:23.212852 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m12:17:23.215180 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m12:17:23.647371 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6f030ae9-59e7-4411-98c1-2ee5e11114fc&page=queryresults
[0m12:17:26.224119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae2f610>]}
[0m12:17:26.225672 [info ] [Thread-1  ]: 2 of 3 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.52s]
[0m12:17:26.226319 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m12:17:26.227341 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:17:26.228036 [info ] [Thread-1  ]: 3 of 3 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:17:26.228491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.stg_links)
[0m12:17:26.228831 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:17:26.232551 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:17:26.233152 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:17:26.235873 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:17:26.236351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:17:26.310835 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:17:26.925010 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5d0211b6-3a03-467a-87f4-295da212ea68&page=queryresults
[0m12:17:29.568240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae09940>]}
[0m12:17:29.568867 [info ] [Thread-1  ]: 3 of 3 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (45.1k rows, 1.6 MiB processed)[0m in 3.34s]
[0m12:17:29.569396 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:17:29.570212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:29.570424 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:17:29.570674 [info ] [MainThread]: 
[0m12:17:29.570917 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.42 seconds (11.42s).
[0m12:17:29.571581 [debug] [MainThread]: Command end result
[0m12:17:29.598493 [info ] [MainThread]: 
[0m12:17:29.598849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:29.599045 [info ] [MainThread]: 
[0m12:17:29.599230 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:17:29.600585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.170541, "process_user_time": 4.714351, "process_kernel_time": 0.156514, "process_mem_max_rss": "194248704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:17:29.600939 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:29.600885 after 12.17 seconds
[0m12:17:29.601185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102280a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abc24f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ab6fca0>]}
[0m12:17:29.601421 [debug] [MainThread]: Flushing usage events
[0m12:18:12.931243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022b4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45160>]}


============================== 12:18:12.933935 | e83d237f-999b-4628-92f6-035ac03804cd ==============================
[0m12:18:12.933935 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:18:12.934266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_links', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:13.547864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c26580>]}
[0m12:18:13.576870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c7a2b0>]}
[0m12:18:13.577343 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:18:13.590582 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:18:13.696072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:13.696494 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m12:18:13.863671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270d9eb0>]}
[0m12:18:13.925754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270f1fa0>]}
[0m12:18:13.926040 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:18:13.926230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126fa33d0>]}
[0m12:18:13.926921 [info ] [MainThread]: 
[0m12:18:13.927193 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:13.929429 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:18:13.929632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:14.546343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:18:14.546956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:15.162138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025e7b80>]}
[0m12:18:15.163218 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:18:15.163644 [info ] [MainThread]: 
[0m12:18:15.167770 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m12:18:15.168329 [info ] [Thread-1  ]: 1 of 3 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m12:18:15.168759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_links)
[0m12:18:15.169112 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m12:18:15.178610 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m12:18:15.179408 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m12:18:15.194106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:15.765195 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m12:18:15.766193 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m12:18:16.284355 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f078a885-49eb-4d1d-9435-b20a5dc7b78c&page=queryresults
[0m12:18:18.387560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271a51c0>]}
[0m12:18:18.388438 [info ] [Thread-1  ]: 1 of 3 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.22s]
[0m12:18:18.389350 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m12:18:18.389802 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m12:18:18.390406 [info ] [Thread-1  ]: 2 of 3 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m12:18:18.390976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_parent)
[0m12:18:18.391343 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m12:18:18.394656 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m12:18:18.395540 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m12:18:18.397852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:19.047968 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m12:18:19.049485 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m12:18:19.561633 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8cb90049-3133-4ae3-be86-da0065220367&page=queryresults
[0m12:18:21.607469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127190ca0>]}
[0m12:18:21.608685 [info ] [Thread-1  ]: 2 of 3 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.22s]
[0m12:18:21.609416 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m12:18:21.610219 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:18:21.610711 [info ] [Thread-1  ]: 3 of 3 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:18:21.611175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.stg_links)
[0m12:18:21.611994 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:18:21.617305 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:18:21.618424 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:18:21.621182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:22.140309 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:18:22.142763 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:18:22.632482 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2fd766b8-c0f4-465d-b341-5004c2f90654&page=queryresults
[0m12:18:25.408238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12727dfd0>]}
[0m12:18:25.409319 [info ] [Thread-1  ]: 3 of 3 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (45.1k rows, 1.6 MiB processed)[0m in 3.80s]
[0m12:18:25.410119 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:18:25.411538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:25.411953 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:18:25.412401 [info ] [MainThread]: 
[0m12:18:25.412806 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.49 seconds (11.49s).
[0m12:18:25.413917 [debug] [MainThread]: Command end result
[0m12:18:25.446225 [info ] [MainThread]: 
[0m12:18:25.446621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:25.446845 [info ] [MainThread]: 
[0m12:18:25.447129 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:18:25.448796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.573102, "process_user_time": 3.672658, "process_kernel_time": 1.27354, "process_mem_max_rss": "201392128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:25.449219 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:25.449152 after 12.57 seconds
[0m12:18:25.449487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022b4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c7a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651b7c0>]}
[0m12:18:25.449743 [debug] [MainThread]: Flushing usage events
[0m12:19:24.781580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104549c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104549e50>]}


============================== 12:19:24.783830 | 9a5df956-7d22-4f20-944e-893dfd194c68 ==============================
[0m12:19:24.783830 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:19:24.784180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:19:25.290987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c32d040>]}
[0m12:19:25.317180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103948130>]}
[0m12:19:25.317579 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:19:25.330203 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:19:25.416479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:25.416908 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m12:19:25.581373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c8d8dc0>]}
[0m12:19:25.641855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3e93d0>]}
[0m12:19:25.642150 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:19:25.642343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c6a3490>]}
[0m12:19:25.643222 [info ] [MainThread]: 
[0m12:19:25.643508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:19:25.645875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:19:25.646076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:26.204136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:19:26.204503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:26.700624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3d3e50>]}
[0m12:19:26.701817 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:19:26.702370 [info ] [MainThread]: 
[0m12:19:26.705398 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m12:19:26.705842 [info ] [Thread-1  ]: 1 of 9 START sql table model ruggable.base_rugs_usa_category_map ............... [RUN]
[0m12:19:26.706244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m12:19:26.706531 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m12:19:26.713307 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m12:19:26.714063 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m12:19:26.727580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:27.273608 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m12:19:27.274304 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m12:19:27.734184 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6c1a415f-6f5c-445d-abab-4f46107bad75&page=queryresults
[0m12:19:30.356420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9a2910>]}
[0m12:19:30.357283 [info ] [Thread-1  ]: 1 of 9 OK created sql table model ruggable.base_rugs_usa_category_map .......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.65s]
[0m12:19:30.357901 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m12:19:30.358347 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m12:19:30.358881 [info ] [Thread-1  ]: 2 of 9 START sql table model ruggable.base_rugs_usa_color_map .................. [RUN]
[0m12:19:30.359472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m12:19:30.359812 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m12:19:30.363043 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m12:19:30.363935 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m12:19:30.366157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:30.927636 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m12:19:30.929818 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m12:19:31.435769 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1ed96c71-200f-4525-a1b2-192b4eac9ef5&page=queryresults
[0m12:19:34.030467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c991c70>]}
[0m12:19:34.031581 [info ] [Thread-1  ]: 2 of 9 OK created sql table model ruggable.base_rugs_usa_color_map ............. [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.67s]
[0m12:19:34.032406 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m12:19:34.032998 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m12:19:34.033728 [info ] [Thread-1  ]: 3 of 9 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m12:19:34.034427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m12:19:34.034886 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m12:19:34.038342 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m12:19:34.039102 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m12:19:34.041777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:34.571491 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m12:19:34.573016 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m12:19:34.904773 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:24c38324-7e3e-43b7-933c-aba8d272c6a9&page=queryresults
[0m12:19:37.175767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c991ca0>]}
[0m12:19:37.177182 [info ] [Thread-1  ]: 3 of 9 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.14s]
[0m12:19:37.178014 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m12:19:37.178573 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:37.179411 [info ] [Thread-1  ]: 4 of 9 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m12:19:37.179940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m12:19:37.180250 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:37.182937 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m12:19:37.183603 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:37.185702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:37.676260 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m12:19:37.677658 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m12:19:38.207498 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a0c937c6-f9cc-47e4-89e5-b580018b22f1&page=queryresults
[0m12:19:40.711277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb7ae50>]}
[0m12:19:40.712331 [info ] [Thread-1  ]: 4 of 9 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.53s]
[0m12:19:40.713102 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:40.713631 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m12:19:40.714245 [info ] [Thread-1  ]: 5 of 9 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m12:19:40.714807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m12:19:40.715217 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m12:19:40.718105 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m12:19:40.718799 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m12:19:40.720739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:41.240785 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m12:19:41.242272 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m12:19:41.814602 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a0a69f18-d170-43f1-90bd-5b5c33eecf06&page=queryresults
[0m12:19:44.350216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb30ee0>]}
[0m12:19:44.351213 [info ] [Thread-1  ]: 5 of 9 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.64s]
[0m12:19:44.352072 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m12:19:44.352619 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m12:19:44.353289 [info ] [Thread-1  ]: 6 of 9 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m12:19:44.353962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m12:19:44.354412 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m12:19:44.358140 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m12:19:44.358714 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m12:19:44.360389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:44.897638 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m12:19:44.899387 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m12:19:45.432810 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3e1815b1-e7c2-47da-a94f-38e74759abee&page=queryresults
[0m12:19:47.704814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb945b0>]}
[0m12:19:47.705756 [info ] [Thread-1  ]: 6 of 9 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.35s]
[0m12:19:47.706666 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m12:19:47.707257 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m12:19:47.707895 [info ] [Thread-1  ]: 7 of 9 START sql table model ruggable.stg_category_map ......................... [RUN]
[0m12:19:47.708448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_category_map)
[0m12:19:47.708854 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m12:19:47.712104 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m12:19:47.712738 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m12:19:47.714287 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:48.209814 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m12:19:48.211256 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m12:19:48.638709 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:15e94698-7fd2-49b4-94d3-0561854931e2&page=queryresults
[0m12:19:50.825570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb90e50>]}
[0m12:19:50.826256 [info ] [Thread-1  ]: 7 of 9 OK created sql table model ruggable.stg_category_map .................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.12s]
[0m12:19:50.826815 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m12:19:50.827200 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m12:19:50.827712 [info ] [Thread-1  ]: 8 of 9 START sql table model ruggable.stg_color_map ............................ [RUN]
[0m12:19:50.828199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m12:19:50.828601 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m12:19:50.833410 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m12:19:50.834593 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m12:19:50.837837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:51.423230 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m12:19:51.424543 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m12:19:51.926878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7f953070-80ab-49b1-8c31-05f875b1bd2e&page=queryresults
[0m12:19:53.922628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9a24c0>]}
[0m12:19:53.923717 [info ] [Thread-1  ]: 8 of 9 OK created sql table model ruggable.stg_color_map ....................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.09s]
[0m12:19:53.924623 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m12:19:53.925203 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:19:53.925906 [info ] [Thread-1  ]: 9 of 9 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:19:53.926470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m12:19:53.926891 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:19:53.931200 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:19:53.931958 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:19:53.935844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:54.427445 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:19:54.429314 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:19:55.303730 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7cbff8e7-3310-4fff-9ba5-474bf3db1d34&page=queryresults
[0m12:19:58.193506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c80fc10>]}
[0m12:19:58.195126 [info ] [Thread-1  ]: 9 of 9 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (45.1k rows, 1.6 MiB processed)[0m in 4.27s]
[0m12:19:58.195896 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:19:58.197319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:58.197723 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:19:58.198182 [info ] [MainThread]: 
[0m12:19:58.198576 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 32.55 seconds (32.55s).
[0m12:19:58.200955 [debug] [MainThread]: Command end result
[0m12:19:58.234163 [info ] [MainThread]: 
[0m12:19:58.234543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:58.234773 [info ] [MainThread]: 
[0m12:19:58.235009 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:19:58.236570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.506535, "process_user_time": 3.696968, "process_kernel_time": 2.114464, "process_mem_max_rss": "200753152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:19:58.236965 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:58.236903 after 33.51 seconds
[0m12:19:58.237218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3e93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c32d040>]}
[0m12:19:58.237456 [debug] [MainThread]: Flushing usage events
[0m13:16:40.841959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c68af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e0160>]}


============================== 13:16:40.844771 | 32942157-9cbe-41d3-bbf4-1709521a221d ==============================
[0m13:16:40.844771 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:16:40.845105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_links', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:41.579534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c2580>]}
[0m13:16:41.607821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14557a2b0>]}
[0m13:16:41.608236 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:16:41.618904 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:16:41.707595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:16:41.707955 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_upsell.sql
[0m13:16:41.708170 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_links.sql
[0m13:16:41.708360 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m13:16:41.881091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459d6130>]}
[0m13:16:41.943598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145892c40>]}
[0m13:16:41.943905 [info ] [MainThread]: Found 6 seeds, 10 models, 6 sources, 469 macros
[0m13:16:41.944101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458b2490>]}
[0m13:16:41.944733 [info ] [MainThread]: 
[0m13:16:41.945015 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:41.945478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:16:41.945720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:42.485860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:16:42.486601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:43.026119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145900eb0>]}
[0m13:16:43.027697 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:16:43.028489 [info ] [MainThread]: 
[0m13:16:43.033187 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:16:43.033813 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_links ................................ [RUN]
[0m13:16:43.034378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_links)
[0m13:16:43.034845 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:16:43.045598 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:16:43.047099 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:16:43.063764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:43.648954 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:16:43.649692 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:16:44.242469 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:90888251-0b8c-422b-b3ab-73976cb891fa&page=queryresults
[0m13:16:46.597821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c816a0>]}
[0m13:16:46.598537 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.56s]
[0m13:16:46.599086 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:16:46.600062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:46.600285 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m13:16:46.600515 [info ] [MainThread]: 
[0m13:16:46.600775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m13:16:46.601308 [debug] [MainThread]: Command end result
[0m13:16:46.641813 [info ] [MainThread]: 
[0m13:16:46.642165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:46.642343 [info ] [MainThread]: 
[0m13:16:46.642516 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:46.643815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8512535, "process_user_time": 3.434929, "process_kernel_time": 1.391559, "process_mem_max_rss": "198180864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:16:46.644116 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:46.644072 after 5.85 seconds
[0m13:16:46.644332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c68af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14557a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145900340>]}
[0m13:16:46.644520 [debug] [MainThread]: Flushing usage events
[0m13:18:46.435477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d80a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705e80>]}


============================== 13:18:46.437764 | 73fb49f1-d308-430a-b35e-77ac9935f7fe ==============================
[0m13:18:46.437764 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:18:46.438099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:46.924985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb8640>]}
[0m13:18:46.952892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b04310>]}
[0m13:18:46.953310 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:18:46.964256 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:18:47.048215 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 2 files changed.
[0m13:18:47.048652 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_parent.sql
[0m13:18:47.048880 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_pads_upsell.sql
[0m13:18:47.049115 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/2_staging/stg_upsell.sql
[0m13:18:47.049358 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m13:18:47.049586 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m13:18:47.234833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433c3130>]}
[0m13:18:47.295388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143126460>]}
[0m13:18:47.295727 [info ] [MainThread]: Found 6 seeds, 11 models, 6 sources, 469 macros
[0m13:18:47.295902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433b4040>]}
[0m13:18:47.296856 [info ] [MainThread]: 
[0m13:18:47.297144 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:47.299869 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:18:47.300233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:47.772435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:18:47.773003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:48.281438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433b4040>]}
[0m13:18:48.282501 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:18:48.283000 [info ] [MainThread]: 
[0m13:18:48.285634 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m13:18:48.286317 [info ] [Thread-1  ]: 1 of 11 START sql table model ruggable.base_rugs_usa_category_map .............. [RUN]
[0m13:18:48.286865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m13:18:48.287275 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m13:18:48.297880 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m13:18:48.298925 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m13:18:48.314085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:48.897877 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m13:18:48.898849 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m13:18:49.441584 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12d9408a-b42f-4213-8666-9c2fd3cd665f&page=queryresults
[0m13:18:51.643739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434a8700>]}
[0m13:18:51.644357 [info ] [Thread-1  ]: 1 of 11 OK created sql table model ruggable.base_rugs_usa_category_map ......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.36s]
[0m13:18:51.644866 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m13:18:51.645208 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m13:18:51.645656 [info ] [Thread-1  ]: 2 of 11 START sql table model ruggable.base_rugs_usa_color_map ................. [RUN]
[0m13:18:51.646131 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m13:18:51.646427 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m13:18:51.648968 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m13:18:51.649588 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m13:18:51.652023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:52.213888 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m13:18:52.215829 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m13:18:52.640660 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:29c60ca3-2b3b-44c9-b134-b3cb33544e30&page=queryresults
[0m13:18:55.523569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14349f760>]}
[0m13:18:55.525085 [info ] [Thread-1  ]: 2 of 11 OK created sql table model ruggable.base_rugs_usa_color_map ............ [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.88s]
[0m13:18:55.526149 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m13:18:55.526753 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m13:18:55.527502 [info ] [Thread-1  ]: 3 of 11 START sql table model ruggable.base_rugs_usa_links ..................... [RUN]
[0m13:18:55.528753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m13:18:55.529482 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m13:18:55.534476 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m13:18:55.535688 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m13:18:55.541914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:56.109734 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m13:18:56.113165 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m13:18:56.632889 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c349bf65-b595-4178-9b10-6d9f1d99b382&page=queryresults
[0m13:18:58.883571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434a8700>]}
[0m13:18:58.884544 [info ] [Thread-1  ]: 3 of 11 OK created sql table model ruggable.base_rugs_usa_links ................ [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.36s]
[0m13:18:58.885312 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m13:18:58.885803 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:18:58.886490 [info ] [Thread-1  ]: 4 of 11 START sql table model ruggable.base_rugs_usa_pads_upsell ............... [RUN]
[0m13:18:58.887187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m13:18:58.887648 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m13:18:58.891422 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:18:58.892393 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m13:18:58.895159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:59.401610 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:18:59.403727 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:18:59.908892 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a358df3e-973f-4a90-8a02-3e5e669cc267&page=queryresults
[0m13:19:02.519491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14354b910>]}
[0m13:19:02.521762 [info ] [Thread-1  ]: 4 of 11 OK created sql table model ruggable.base_rugs_usa_pads_upsell .......... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.63s]
[0m13:19:02.522599 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:19:02.522998 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m13:19:02.523521 [info ] [Thread-1  ]: 5 of 11 START sql table model ruggable.base_rugs_usa_parent .................... [RUN]
[0m13:19:02.524017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m13:19:02.524324 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m13:19:02.527646 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m13:19:02.529402 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m13:19:02.531574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:03.066124 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m13:19:03.068064 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:19:03.858071 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:de08a218-c2ed-4f38-acd3-6a6f2f9c6e17&page=queryresults
[0m13:19:06.665181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14352ce20>]}
[0m13:19:06.667605 [info ] [Thread-1  ]: 5 of 11 OK created sql table model ruggable.base_rugs_usa_parent ............... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 4.14s]
[0m13:19:06.668645 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m13:19:06.669476 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:19:06.670379 [info ] [Thread-1  ]: 6 of 11 START sql table model ruggable.base_rugs_usa_variant ................... [RUN]
[0m13:19:06.671019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m13:19:06.671398 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:19:06.675603 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:19:06.677794 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:19:06.683155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:07.192349 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:19:07.196098 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:19:07.587654 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:68ddd571-9c09-4e2d-9000-30346c531404&page=queryresults
[0m13:19:09.836199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14357ccd0>]}
[0m13:19:09.836987 [info ] [Thread-1  ]: 6 of 11 OK created sql table model ruggable.base_rugs_usa_variant .............. [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.17s]
[0m13:19:09.837589 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:19:09.837963 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m13:19:09.838458 [info ] [Thread-1  ]: 7 of 11 START sql table model ruggable.stg_pads_upsell ......................... [RUN]
[0m13:19:09.838917 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_pads_upsell)
[0m13:19:09.839230 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m13:19:09.842522 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m13:19:09.843320 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m13:19:09.845788 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_pads_upsell"
[0m13:19:09.846296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:09.916935 [debug] [Thread-1  ]: On model.ruggable.stg_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , regexp_replace(regexp_replace(size, '"', '_in'), "'", '_ft') as actual_size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:19:10.520463 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:988c5a50-2ab1-41ca-9b40-9bf66968afda&page=queryresults
[0m13:19:13.602305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434f06a0>]}
[0m13:19:13.604787 [info ] [Thread-1  ]: 7 of 11 OK created sql table model ruggable.stg_pads_upsell .................... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.76s]
[0m13:19:13.606238 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m13:19:13.607008 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m13:19:13.607867 [info ] [Thread-1  ]: 8 of 11 START sql table model ruggable.stg_parent .............................. [RUN]
[0m13:19:13.608506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m13:19:13.608970 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m13:19:13.616239 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m13:19:13.617576 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m13:19:13.622077 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_parent"
[0m13:19:13.623013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:13.701411 [debug] [Thread-1  ]: On model.ruggable.stg_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:19:14.393917 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f6486c22-fb3c-465e-849e-6dadaac4bca7&page=queryresults
[0m13:19:16.724336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143535940>]}
[0m13:19:16.726512 [info ] [Thread-1  ]: 8 of 11 OK created sql table model ruggable.stg_parent ......................... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.12s]
[0m13:19:16.727774 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m13:19:16.728454 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m13:19:16.729265 [info ] [Thread-1  ]: 9 of 11 START sql table model ruggable.stg_category_map ........................ [RUN]
[0m13:19:16.729918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_parent, now model.ruggable.stg_category_map)
[0m13:19:16.730387 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m13:19:16.736827 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m13:19:16.738213 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m13:19:16.744416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:17.318401 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m13:19:17.321574 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m13:19:17.724616 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:97623790-56f4-4f85-ab52-ac82b92a456e&page=queryresults
[0m13:19:20.172072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14353ba30>]}
[0m13:19:20.174076 [info ] [Thread-1  ]: 9 of 11 OK created sql table model ruggable.stg_category_map ................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.44s]
[0m13:19:20.175134 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m13:19:20.175608 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m13:19:20.175990 [info ] [Thread-1  ]: 10 of 11 START sql table model ruggable.stg_color_map .......................... [RUN]
[0m13:19:20.176625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m13:19:20.177082 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m13:19:20.179907 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m13:19:20.180666 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m13:19:20.182457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:20.798073 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m13:19:20.800328 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m13:19:21.240092 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:05bda71d-40a3-4a91-947d-f3ba21e09424&page=queryresults
[0m13:19:23.486958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1435ca430>]}
[0m13:19:23.488086 [info ] [Thread-1  ]: 10 of 11 OK created sql table model ruggable.stg_color_map ..................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.31s]
[0m13:19:23.488750 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m13:19:23.489211 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:19:23.490263 [info ] [Thread-1  ]: 11 of 11 START sql table model ruggable.stg_links .............................. [RUN]
[0m13:19:23.490919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m13:19:23.491301 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:19:23.495084 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:19:23.496052 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:19:23.498521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:23.961497 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:19:23.963514 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:19:24.381808 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2846b627-d246-4bcd-b55d-1fc0198a3d2f&page=queryresults
[0m13:19:26.724366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14354b910>]}
[0m13:19:26.725852 [info ] [Thread-1  ]: 11 of 11 OK created sql table model ruggable.stg_links ......................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.23s]
[0m13:19:26.726770 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:19:26.728502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:26.728906 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m13:19:26.729378 [info ] [MainThread]: 
[0m13:19:26.729782 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 39.43 seconds (39.43s).
[0m13:19:26.732399 [debug] [MainThread]: Command end result
[0m13:19:26.767692 [info ] [MainThread]: 
[0m13:19:26.768095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:26.768361 [info ] [MainThread]: 
[0m13:19:26.768680 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:19:26.770277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.384266, "process_user_time": 4.318355, "process_kernel_time": 1.857985, "process_mem_max_rss": "198508544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:26.770645 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:26.770584 after 40.38 seconds
[0m13:19:26.770911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d80a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14330b700>]}
[0m13:19:26.771151 [debug] [MainThread]: Flushing usage events
[0m13:25:44.445407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104080a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a05c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a05e20>]}


============================== 13:25:44.448113 | 3d9bf235-8f94-465d-868f-5b35efbabd09 ==============================
[0m13:25:44.448113 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:25:44.448425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:45.164729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b87f0>]}
[0m13:25:45.191144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597fdf0>]}
[0m13:25:45.191510 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:25:45.204042 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:25:45.289317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:25:45.289707 [debug] [MainThread]: Partial parsing: added file: ruggable://models/3_final/pads.sql
[0m13:25:45.289915 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_pads_upsell.sql
[0m13:25:45.290107 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_parent.sql
[0m13:25:45.457117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c55130>]}
[0m13:25:45.519080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b29bb0>]}
[0m13:25:45.519377 [info ] [MainThread]: Found 6 seeds, 12 models, 6 sources, 469 macros
[0m13:25:45.519574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a3f640>]}
[0m13:25:45.520484 [info ] [MainThread]: 
[0m13:25:45.520758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:25:45.523254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:25:45.523454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:46.070662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:25:46.071329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:46.616511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105882580>]}
[0m13:25:46.617497 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:25:46.617902 [info ] [MainThread]: 
[0m13:25:46.621850 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m13:25:46.622710 [info ] [Thread-1  ]: 1 of 11 START sql table model ruggable.base_rugs_usa_category_map .............. [RUN]
[0m13:25:46.623220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m13:25:46.623604 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m13:25:46.635168 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m13:25:46.636660 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m13:25:46.650685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:47.182225 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m13:25:47.183156 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m13:25:47.668882 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3056322c-f25c-4f63-87d8-cc4edb1380e2&page=queryresults
[0m13:25:50.092382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e28ac0>]}
[0m13:25:50.092871 [info ] [Thread-1  ]: 1 of 11 OK created sql table model ruggable.base_rugs_usa_category_map ......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.47s]
[0m13:25:50.093301 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m13:25:50.093596 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m13:25:50.093906 [info ] [Thread-1  ]: 2 of 11 START sql table model ruggable.base_rugs_usa_color_map ................. [RUN]
[0m13:25:50.094303 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m13:25:50.094541 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m13:25:50.096605 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m13:25:50.097138 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m13:25:50.098889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:50.579882 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m13:25:50.583089 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m13:25:51.051980 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7722c5e0-0f7c-4b50-8f99-a1523924c7c9&page=queryresults
[0m13:25:53.233334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e28610>]}
[0m13:25:53.234343 [info ] [Thread-1  ]: 2 of 11 OK created sql table model ruggable.base_rugs_usa_color_map ............ [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.14s]
[0m13:25:53.235128 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m13:25:53.235639 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m13:25:53.236348 [info ] [Thread-1  ]: 3 of 11 START sql table model ruggable.base_rugs_usa_links ..................... [RUN]
[0m13:25:53.237151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m13:25:53.237598 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m13:25:53.244046 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m13:25:53.245088 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m13:25:53.248024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:53.722531 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m13:25:53.724282 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m13:25:54.355076 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6847326f-111f-409b-9c0f-113cc12fdbca&page=queryresults
[0m13:25:56.583909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ee42b0>]}
[0m13:25:56.585340 [info ] [Thread-1  ]: 3 of 11 OK created sql table model ruggable.base_rugs_usa_links ................ [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.35s]
[0m13:25:56.586702 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m13:25:56.587649 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:25:56.588570 [info ] [Thread-1  ]: 4 of 11 START sql table model ruggable.base_rugs_usa_pads_upsell ............... [RUN]
[0m13:25:56.589597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m13:25:56.590148 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m13:25:56.594557 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:25:56.595753 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m13:25:56.598789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:57.128996 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:25:57.131138 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:25:57.716644 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e4c8cdd4-e7b9-4941-bbf7-58411bf40895&page=queryresults
[0m13:26:00.619154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ee42b0>]}
[0m13:26:00.620341 [info ] [Thread-1  ]: 4 of 11 OK created sql table model ruggable.base_rugs_usa_pads_upsell .......... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.03s]
[0m13:26:00.621087 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:26:00.621578 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m13:26:00.622223 [info ] [Thread-1  ]: 5 of 11 START sql table model ruggable.base_rugs_usa_parent .................... [RUN]
[0m13:26:00.622936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m13:26:00.623334 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m13:26:00.627555 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m13:26:00.628570 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m13:26:00.631569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:01.182006 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m13:26:01.185504 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:26:01.800307 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7fb7ac45-6352-4300-b75f-bd477192b104&page=queryresults
[0m13:26:03.854526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ee42b0>]}
[0m13:26:03.856114 [info ] [Thread-1  ]: 5 of 11 OK created sql table model ruggable.base_rugs_usa_parent ............... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.23s]
[0m13:26:03.857197 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m13:26:03.857820 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:26:03.858655 [info ] [Thread-1  ]: 6 of 11 START sql table model ruggable.base_rugs_usa_variant ................... [RUN]
[0m13:26:03.859507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m13:26:03.859958 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:26:03.867485 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:26:03.868605 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:26:03.872047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:04.459191 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:26:04.460508 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:26:04.970947 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c31ba584-3f24-45a8-90c3-a377e3fa5ad8&page=queryresults
[0m13:26:07.737387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e1bd30>]}
[0m13:26:07.739062 [info ] [Thread-1  ]: 6 of 11 OK created sql table model ruggable.base_rugs_usa_variant .............. [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.88s]
[0m13:26:07.740731 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:26:07.741431 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m13:26:07.742237 [info ] [Thread-1  ]: 7 of 11 START sql table model ruggable.stg_category_map ........................ [RUN]
[0m13:26:07.742949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_category_map)
[0m13:26:07.743399 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m13:26:07.747724 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m13:26:07.748750 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m13:26:07.751780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:08.272308 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m13:26:08.274819 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m13:26:08.759889 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f0737bee-7a25-4e62-a417-2e30d492ef58&page=queryresults
[0m13:26:11.405859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ec88b0>]}
[0m13:26:11.407457 [info ] [Thread-1  ]: 7 of 11 OK created sql table model ruggable.stg_category_map ................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.66s]
[0m13:26:11.408468 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m13:26:11.409137 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m13:26:11.409849 [info ] [Thread-1  ]: 8 of 11 START sql table model ruggable.stg_color_map ........................... [RUN]
[0m13:26:11.410473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m13:26:11.411004 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m13:26:11.416968 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m13:26:11.418383 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m13:26:11.421923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:11.943984 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m13:26:11.946718 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m13:26:12.338820 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bd4bde37-4109-410a-890e-de4986d6f7d9&page=queryresults
[0m13:26:14.636020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e841c0>]}
[0m13:26:14.637522 [info ] [Thread-1  ]: 8 of 11 OK created sql table model ruggable.stg_color_map ...................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.23s]
[0m13:26:14.638408 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m13:26:14.639001 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:26:14.639964 [info ] [Thread-1  ]: 9 of 11 START sql table model ruggable.stg_links ............................... [RUN]
[0m13:26:14.641049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m13:26:14.641607 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:26:14.649446 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:26:14.650547 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:26:14.653684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:15.145532 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:26:15.146744 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:26:15.622831 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:def114ba-8008-4639-86a1-a2b1854b99c9&page=queryresults
[0m13:26:17.871317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130f1f9a0>]}
[0m13:26:17.872705 [info ] [Thread-1  ]: 9 of 11 OK created sql table model ruggable.stg_links .......................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.23s]
[0m13:26:17.873556 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:26:17.874320 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m13:26:17.875369 [info ] [Thread-1  ]: 10 of 11 START sql table model ruggable.stg_pads_upsell ........................ [RUN]
[0m13:26:17.876067 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_links, now model.ruggable.stg_pads_upsell)
[0m13:26:17.876520 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m13:26:17.881229 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m13:26:17.882356 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m13:26:17.885422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:18.385134 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_pads_upsell"
[0m13:26:18.388224 [debug] [Thread-1  ]: On model.ruggable.stg_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , regexp_replace(regexp_replace(size, '"', '_in'), "'", '_ft') as actual_size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
    );
  
[0m13:26:18.899080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:982dcb41-a961-497f-9962-a7c500bab071&page=queryresults
[0m13:26:21.394016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e8edf0>]}
[0m13:26:21.394951 [info ] [Thread-1  ]: 10 of 11 OK created sql table model ruggable.stg_pads_upsell ................... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.52s]
[0m13:26:21.395637 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m13:26:21.396089 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m13:26:21.396846 [info ] [Thread-1  ]: 11 of 11 START sql table model ruggable.stg_parent ............................. [RUN]
[0m13:26:21.397683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m13:26:21.398142 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m13:26:21.402545 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m13:26:21.403297 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m13:26:21.405800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:21.920928 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_parent"
[0m13:26:21.923279 [debug] [Thread-1  ]: On model.ruggable.stg_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
    );
  
[0m13:26:22.485038 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d9a0a0a1-e2af-4c89-86ff-e85a86fd86fc&page=queryresults
[0m13:26:25.626266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130edff70>]}
[0m13:26:25.627128 [info ] [Thread-1  ]: 11 of 11 OK created sql table model ruggable.stg_parent ........................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 4.23s]
[0m13:26:25.627739 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m13:26:25.628968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:25.629310 [debug] [MainThread]: Connection 'model.ruggable.stg_parent' was properly closed.
[0m13:26:25.629681 [info ] [MainThread]: 
[0m13:26:25.629994 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 40.11 seconds (40.11s).
[0m13:26:25.631825 [debug] [MainThread]: Command end result
[0m13:26:25.665333 [info ] [MainThread]: 
[0m13:26:25.665703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:25.665922 [info ] [MainThread]: 
[0m13:26:25.666132 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:26:25.668137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 41.272552, "process_user_time": 5.647261, "process_kernel_time": 0.63582, "process_mem_max_rss": "201883648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:26:25.668494 [debug] [MainThread]: Command `dbt run` succeeded at 13:26:25.668425 after 41.27 seconds
[0m13:26:25.668752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104080a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f4dc0>]}
[0m13:26:25.668998 [debug] [MainThread]: Flushing usage events
[0m13:28:33.790696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077453a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077451c0>]}


============================== 13:28:33.793150 | e4a452f6-e79c-453f-857a-cce6c264d0c1 ==============================
[0m13:28:33.793150 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:28:33.793448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_variant', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:34.305950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d91640>]}
[0m13:28:34.332436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d6fe80>]}
[0m13:28:34.332772 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:28:34.343434 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:28:34.425629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:28:34.425973 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_variant.sql
[0m13:28:34.426185 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/pads.sql
[0m13:28:34.598406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e202130>]}
[0m13:28:34.656956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e203910>]}
[0m13:28:34.657241 [info ] [MainThread]: Found 6 seeds, 13 models, 6 sources, 469 macros
[0m13:28:34.657437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0f9340>]}
[0m13:28:34.658059 [info ] [MainThread]: 
[0m13:28:34.658342 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:34.658783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:28:34.658998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:35.177024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:28:35.177738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:35.697326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0d4d90>]}
[0m13:28:35.698324 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:28:35.699142 [info ] [MainThread]: 
[0m13:28:35.702296 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:28:35.703105 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_variant .............................. [RUN]
[0m13:28:35.703732 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_variant)
[0m13:28:35.704150 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:28:35.716226 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:28:35.717382 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:28:35.748751 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:28:35.749385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:35.812463 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:28:36.631657 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4b5be5e3-5771-4c8b-a62c-6d1ca6068f5c&page=queryresults
[0m13:28:36.836534 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: size at [17:37]; reason: invalidQuery, location: query, message: Unrecognized name: size at [17:37]')
[0m13:28:37.756297 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e3efc0ce-d510-48b3-ab92-29c6bb47e0a9&page=queryresults
[0m13:28:37.876567 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e3efc0ce-d510-48b3-ab92-29c6bb47e0a9&page=queryresults
[0m13:28:37.922872 [debug] [Thread-1  ]: Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: size at [17:37]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:37.924190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e2ea250>]}
[0m13:28:37.924693 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_variant ..................... [[31mERROR[0m in 2.22s]
[0m13:28:37.925117 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:28:37.925894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:37.926080 [debug] [MainThread]: Connection 'model.ruggable.stg_variant' was properly closed.
[0m13:28:37.926264 [info ] [MainThread]: 
[0m13:28:37.926475 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m13:28:37.926862 [debug] [MainThread]: Command end result
[0m13:28:37.952395 [info ] [MainThread]: 
[0m13:28:37.952777 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:37.952957 [info ] [MainThread]: 
[0m13:28:37.953187 [error] [MainThread]:   Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: size at [17:37]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:37.953357 [info ] [MainThread]: 
[0m13:28:37.953609 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:28:37.954850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2117066, "process_user_time": 4.385475, "process_kernel_time": 0.179396, "process_mem_max_rss": "200474624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:28:37.955212 [debug] [MainThread]: Command `dbt run` failed at 13:28:37.955153 after 4.21 seconds
[0m13:28:37.955452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d914c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0d43d0>]}
[0m13:28:37.955663 [debug] [MainThread]: Flushing usage events
[0m13:28:50.211898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b411c0>]}


============================== 13:28:50.214119 | 70e591cc-2afe-46ac-bceb-a8a55038e367 ==============================
[0m13:28:50.214119 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:28:50.214438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_variant', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:50.660905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e2ef6d0>]}
[0m13:28:50.686553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e33a190>]}
[0m13:28:50.686865 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:28:50.697121 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:28:50.774851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:50.775245 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_variant.sql
[0m13:28:50.934797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f182dc0>]}
[0m13:28:50.991629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1bb130>]}
[0m13:28:50.991900 [info ] [MainThread]: Found 6 seeds, 13 models, 6 sources, 469 macros
[0m13:28:50.992090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1b5c40>]}
[0m13:28:50.992712 [info ] [MainThread]: 
[0m13:28:50.992981 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:50.993416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:28:50.993643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:51.499291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:28:51.500050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:52.030396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0dac0>]}
[0m13:28:52.031654 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:28:52.032051 [info ] [MainThread]: 
[0m13:28:52.034272 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:28:52.034774 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_variant .............................. [RUN]
[0m13:28:52.035171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_variant)
[0m13:28:52.035476 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:28:52.045011 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:28:52.045754 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:28:52.074899 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:28:52.075458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:52.137610 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(actual_size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:28:52.913969 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:db238ff2-ec24-43ef-a449-206b357bc13f&page=queryresults
[0m13:28:53.116014 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]; reason: invalidQuery, location: query, message: Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]')
[0m13:28:54.109560 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9d5e9e6c-55cc-4fe5-a8e5-0ea967efbc74&page=queryresults
[0m13:28:54.264122 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9d5e9e6c-55cc-4fe5-a8e5-0ea967efbc74&page=queryresults
[0m13:28:54.305466 [debug] [Thread-1  ]: Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:54.306789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3abee0>]}
[0m13:28:54.307302 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_variant ..................... [[31mERROR[0m in 2.27s]
[0m13:28:54.307742 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:28:54.308725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:54.308956 [debug] [MainThread]: Connection 'model.ruggable.stg_variant' was properly closed.
[0m13:28:54.309177 [info ] [MainThread]: 
[0m13:28:54.309403 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m13:28:54.309844 [debug] [MainThread]: Command end result
[0m13:28:54.334508 [info ] [MainThread]: 
[0m13:28:54.334840 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:54.335026 [info ] [MainThread]: 
[0m13:28:54.335250 [error] [MainThread]:   Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:54.335428 [info ] [MainThread]: 
[0m13:28:54.335607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:28:54.336851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1711135, "process_user_time": 4.666152, "process_kernel_time": 0.152545, "process_mem_max_rss": "200245248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:28:54.337157 [debug] [MainThread]: Command `dbt run` failed at 13:28:54.337109 after 4.17 seconds
[0m13:28:54.337371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e33a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3e1e20>]}
[0m13:28:54.337602 [debug] [MainThread]: Flushing usage events
[0m13:29:32.025415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106981100>]}


============================== 13:29:32.027460 | b641d9a5-b51a-4b4e-8ee3-cbc970295bf5 ==============================
[0m13:29:32.027460 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:29:32.027792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select base_rugs_usa_variant stg_variant', 'send_anonymous_usage_stats': 'True'}
[0m13:29:32.485964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfadbe0>]}
[0m13:29:32.514025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfebb20>]}
[0m13:29:32.514401 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:29:32.525252 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:29:32.623107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:32.623619 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m13:29:32.791699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d642f70>]}
[0m13:29:32.848757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d6540a0>]}
[0m13:29:32.849035 [info ] [MainThread]: Found 6 seeds, 13 models, 6 sources, 469 macros
[0m13:29:32.849226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d0cc430>]}
[0m13:29:32.849936 [info ] [MainThread]: 
[0m13:29:32.850210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:29:32.852281 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:29:32.852500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:33.348537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:29:33.349386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:33.858626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfce2e0>]}
[0m13:29:33.860129 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:29:33.860901 [info ] [MainThread]: 
[0m13:29:33.863938 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:29:33.864594 [info ] [Thread-1  ]: 1 of 2 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m13:29:33.865115 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_variant)
[0m13:29:33.865541 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:29:33.877303 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:29:33.878276 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:29:33.892608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:34.425048 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:29:34.426133 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:29:34.895973 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2935f2b1-97b9-4bf8-80d0-9154e6c0bdcf&page=queryresults
[0m13:29:37.239044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9016d0>]}
[0m13:29:37.239607 [info ] [Thread-1  ]: 1 of 2 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.37s]
[0m13:29:37.240040 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:29:37.240601 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:29:37.240933 [info ] [Thread-1  ]: 2 of 2 START sql table model ruggable.stg_variant .............................. [RUN]
[0m13:29:37.241266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_variant)
[0m13:29:37.241486 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:29:37.243813 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:29:37.244434 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:29:37.246539 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:29:37.246926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:37.309779 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(actual_size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:29:38.173080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:546a7bfc-1ca4-44bd-9ef4-23ddeedd3265&page=queryresults
[0m13:29:40.515101 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d7a1a60>]}
[0m13:29:40.516212 [info ] [Thread-1  ]: 2 of 2 OK created sql table model ruggable.stg_variant ......................... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.27s]
[0m13:29:40.516959 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:29:40.518325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:40.518733 [debug] [MainThread]: Connection 'model.ruggable.stg_variant' was properly closed.
[0m13:29:40.519130 [info ] [MainThread]: 
[0m13:29:40.519500 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m13:29:40.520323 [debug] [MainThread]: Command end result
[0m13:29:40.553045 [info ] [MainThread]: 
[0m13:29:40.553466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:40.553686 [info ] [MainThread]: 
[0m13:29:40.553915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:29:40.555364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.576408, "process_user_time": 2.981702, "process_kernel_time": 1.897471, "process_mem_max_rss": "200114176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:29:40.555763 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:40.555699 after 8.58 seconds
[0m13:29:40.556026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106376700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfebb20>]}
[0m13:29:40.556280 [debug] [MainThread]: Flushing usage events
[0m13:35:51.853058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c69c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c69e50>]}


============================== 13:35:51.855845 | 6091cd1f-1620-4319-a10a-507dacad8e7c ==============================
[0m13:35:51.855845 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:35:51.856177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:52.565416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13084d0d0>]}
[0m13:35:52.591008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1e9d0>]}
[0m13:35:52.591281 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:35:52.602990 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:35:52.687798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m13:35:52.688128 [debug] [MainThread]: Partial parsing: added file: ruggable://models/3_final/variants.sql
[0m13:35:52.688307 [debug] [MainThread]: Partial parsing: added file: ruggable://models/3_final/parents.sql
[0m13:35:52.688493 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/pads.sql
[0m13:35:52.850418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130dc5df0>]}
[0m13:35:52.911842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130caf790>]}
[0m13:35:52.912106 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m13:35:52.912288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d9c1f0>]}
[0m13:35:52.913255 [info ] [MainThread]: 
[0m13:35:52.913534 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:35:52.916159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:35:52.916372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:53.453083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:35:53.454332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:53.947686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614aa90>]}
[0m13:35:53.948795 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:35:53.949753 [info ] [MainThread]: 
[0m13:35:53.953369 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m13:35:53.954055 [info ] [Thread-1  ]: 1 of 15 START sql table model ruggable.base_rugs_usa_category_map .............. [RUN]
[0m13:35:53.954724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m13:35:53.955235 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m13:35:53.966595 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m13:35:53.967631 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m13:35:53.982618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:54.511540 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m13:35:54.512376 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m13:35:55.092874 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cb3ee84a-9492-4ae9-82c9-58c2ee12f656&page=queryresults
[0m13:35:57.258457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310c3d00>]}
[0m13:35:57.259052 [info ] [Thread-1  ]: 1 of 15 OK created sql table model ruggable.base_rugs_usa_category_map ......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.30s]
[0m13:35:57.259543 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m13:35:57.259856 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m13:35:57.260275 [info ] [Thread-1  ]: 2 of 15 START sql table model ruggable.base_rugs_usa_color_map ................. [RUN]
[0m13:35:57.260690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m13:35:57.260941 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m13:35:57.263188 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m13:35:57.263744 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m13:35:57.265626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:57.714841 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m13:35:57.717041 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m13:35:58.112522 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9a965534-0161-4d01-b3a4-4418ffa28a12&page=queryresults
[0m13:36:00.317475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310adf10>]}
[0m13:36:00.318002 [info ] [Thread-1  ]: 2 of 15 OK created sql table model ruggable.base_rugs_usa_color_map ............ [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.06s]
[0m13:36:00.318431 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m13:36:00.318711 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m13:36:00.319099 [info ] [Thread-1  ]: 3 of 15 START sql table model ruggable.base_rugs_usa_links ..................... [RUN]
[0m13:36:00.319514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m13:36:00.319768 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m13:36:00.321912 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m13:36:00.322413 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m13:36:00.324076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:00.926518 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m13:36:00.929070 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m13:36:01.479749 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:72ab4122-9704-4128-bd0d-7cc9b26b581f&page=queryresults
[0m13:36:03.563997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13115efa0>]}
[0m13:36:03.565588 [info ] [Thread-1  ]: 3 of 15 OK created sql table model ruggable.base_rugs_usa_links ................ [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.24s]
[0m13:36:03.566689 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m13:36:03.567297 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:03.568368 [info ] [Thread-1  ]: 4 of 15 START sql table model ruggable.base_rugs_usa_pads_upsell ............... [RUN]
[0m13:36:03.569574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m13:36:03.570191 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:03.574872 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:36:03.575941 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:03.578841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:04.058405 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:36:04.059982 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:36:04.915700 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b16346e2-5b85-4e14-9524-651aa945da3e&page=queryresults
[0m13:36:07.753070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310fb310>]}
[0m13:36:07.756063 [info ] [Thread-1  ]: 4 of 15 OK created sql table model ruggable.base_rugs_usa_pads_upsell .......... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.18s]
[0m13:36:07.756931 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:07.757384 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m13:36:07.758197 [info ] [Thread-1  ]: 5 of 15 START sql table model ruggable.base_rugs_usa_parent .................... [RUN]
[0m13:36:07.759111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m13:36:07.759539 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m13:36:07.763733 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m13:36:07.765105 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m13:36:07.767918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:08.219220 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m13:36:08.221770 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:36:08.806271 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9c4a209d-3bb4-4ab8-8438-5cdd9f592ae0&page=queryresults
[0m13:36:10.856717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311e92b0>]}
[0m13:36:10.858500 [info ] [Thread-1  ]: 5 of 15 OK created sql table model ruggable.base_rugs_usa_parent ............... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.10s]
[0m13:36:10.859650 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m13:36:10.860145 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:36:10.860943 [info ] [Thread-1  ]: 6 of 15 START sql table model ruggable.base_rugs_usa_variant ................... [RUN]
[0m13:36:10.861826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m13:36:10.862183 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:36:10.865881 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:36:10.866782 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:36:10.869118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:11.352117 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:36:11.354125 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:36:11.878063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06c1bd5f-ae96-4ac0-b06e-ef4418510dff&page=queryresults
[0m13:36:14.165649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311ad4f0>]}
[0m13:36:14.168017 [info ] [Thread-1  ]: 6 of 15 OK created sql table model ruggable.base_rugs_usa_variant .............. [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.30s]
[0m13:36:14.169339 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:36:14.170158 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m13:36:14.171214 [info ] [Thread-1  ]: 7 of 15 START sql table model ruggable.stg_category_map ........................ [RUN]
[0m13:36:14.172071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_category_map)
[0m13:36:14.172711 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m13:36:14.176620 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m13:36:14.177551 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m13:36:14.180250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:14.747653 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m13:36:14.750725 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m13:36:15.253414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a9e24010-ad14-440e-b210-e8b64119ed7e&page=queryresults
[0m13:36:17.282100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310adf70>]}
[0m13:36:17.284512 [info ] [Thread-1  ]: 7 of 15 OK created sql table model ruggable.stg_category_map ................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.11s]
[0m13:36:17.285743 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m13:36:17.286631 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m13:36:17.287547 [info ] [Thread-1  ]: 8 of 15 START sql table model ruggable.stg_color_map ........................... [RUN]
[0m13:36:17.288153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m13:36:17.288531 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m13:36:17.292270 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m13:36:17.293197 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m13:36:17.297829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:17.778672 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m13:36:17.781718 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m13:36:18.223309 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:321b25db-f55d-404b-abdf-a9ab97f4e3dd&page=queryresults
[0m13:36:20.435031 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311a3790>]}
[0m13:36:20.435565 [info ] [Thread-1  ]: 8 of 15 OK created sql table model ruggable.stg_color_map ...................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.15s]
[0m13:36:20.435966 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m13:36:20.436254 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:36:20.436589 [info ] [Thread-1  ]: 9 of 15 START sql table model ruggable.stg_links ............................... [RUN]
[0m13:36:20.436906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m13:36:20.437123 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:36:20.439423 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:36:20.439903 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:36:20.441360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:20.955056 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:36:20.957997 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:36:21.546506 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:76140d4e-cd61-44a3-be7e-0806738b9193&page=queryresults
[0m13:36:23.783752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311a8640>]}
[0m13:36:23.785081 [info ] [Thread-1  ]: 9 of 15 OK created sql table model ruggable.stg_links .......................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.35s]
[0m13:36:23.785928 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:36:23.786514 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m13:36:23.787860 [info ] [Thread-1  ]: 10 of 15 START sql table model ruggable.stg_pads_upsell ........................ [RUN]
[0m13:36:23.788697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_links, now model.ruggable.stg_pads_upsell)
[0m13:36:23.789227 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m13:36:23.794054 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m13:36:23.795320 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m13:36:23.798695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:24.336685 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_pads_upsell"
[0m13:36:24.339771 [debug] [Thread-1  ]: On model.ruggable.stg_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , regexp_replace(regexp_replace(size, '"', '_in'), "'", '_ft') as actual_size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
    );
  
[0m13:36:24.879547 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fbbcef71-68ff-446f-9409-e3074ed6bbbc&page=queryresults
[0m13:36:28.250876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311c8b80>]}
[0m13:36:28.253265 [info ] [Thread-1  ]: 10 of 15 OK created sql table model ruggable.stg_pads_upsell ................... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.46s]
[0m13:36:28.254221 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m13:36:28.255091 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m13:36:28.255690 [info ] [Thread-1  ]: 11 of 15 START sql table model ruggable.stg_parent ............................. [RUN]
[0m13:36:28.256127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m13:36:28.256388 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m13:36:28.259575 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m13:36:28.260351 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m13:36:28.263180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:28.797051 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_parent"
[0m13:36:28.799539 [debug] [Thread-1  ]: On model.ruggable.stg_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
    );
  
[0m13:36:29.276500 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cfa853b4-903c-42b5-b7af-b2a5e67225a6&page=queryresults
[0m13:36:31.526811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310f4040>]}
[0m13:36:31.528112 [info ] [Thread-1  ]: 11 of 15 OK created sql table model ruggable.stg_parent ........................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.27s]
[0m13:36:31.529122 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m13:36:31.529997 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:36:31.530736 [info ] [Thread-1  ]: 12 of 15 START sql table model ruggable.stg_variant ............................ [RUN]
[0m13:36:31.531357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_parent, now model.ruggable.stg_variant)
[0m13:36:31.531728 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:36:31.535585 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:36:31.536589 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:36:31.539209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:32.067157 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:36:32.069008 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(actual_size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:36:32.558493 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e5264be0-75fa-4b2c-a9c8-620bc05fad8d&page=queryresults
[0m13:36:35.096991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310f60a0>]}
[0m13:36:35.098465 [info ] [Thread-1  ]: 12 of 15 OK created sql table model ruggable.stg_variant ....................... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.57s]
[0m13:36:35.099371 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:36:35.100718 [debug] [Thread-1  ]: Began running node model.ruggable.pads
[0m13:36:35.101635 [info ] [Thread-1  ]: 13 of 15 START sql table model ruggable.pads ................................... [RUN]
[0m13:36:35.102290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_variant, now model.ruggable.pads)
[0m13:36:35.102660 [debug] [Thread-1  ]: Began compiling node model.ruggable.pads
[0m13:36:35.107065 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.pads"
[0m13:36:35.108322 [debug] [Thread-1  ]: Began executing node model.ruggable.pads
[0m13:36:35.111720 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.pads"
[0m13:36:35.112576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:35.186431 [debug] [Thread-1  ]: On model.ruggable.pads: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.pads"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`pads`
      
    
    

    OPTIONS()
    as (
      with

pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , parent as ( select * from `first-project-262802`.`ruggable`.`stg_parent` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    pads.*
    -- , 
from pads
-- left join parent using (pid)
-- left join variant using (pid)
    );
  
[0m13:36:35.833604 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f2532e6d-c2ee-4c1e-bc04-1a3acf0e1167&page=queryresults
[0m13:36:38.904085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13112a130>]}
[0m13:36:38.906490 [info ] [Thread-1  ]: 13 of 15 OK created sql table model ruggable.pads .............................. [[32mCREATE TABLE (96.7k rows, 11.1 MiB processed)[0m in 3.80s]
[0m13:36:38.907848 [debug] [Thread-1  ]: Finished running node model.ruggable.pads
[0m13:36:38.908658 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m13:36:38.909565 [info ] [Thread-1  ]: 14 of 15 START sql table model ruggable.parents ................................ [RUN]
[0m13:36:38.910110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.pads, now model.ruggable.parents)
[0m13:36:38.910436 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m13:36:38.914284 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m13:36:38.915161 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m13:36:38.920208 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.parents"
[0m13:36:38.921026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:38.991704 [debug] [Thread-1  ]: On model.ruggable.parents: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.parents"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`parents`
      
    
    

    OPTIONS()
    as (
      with

parent as ( select * from `first-project-262802`.`ruggable`.`stg_parent` )

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    parent.*
    -- , 
from parent
-- left join pads using (pid)
-- left join variant using (pid)
    );
  
[0m13:36:39.724406 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:026709d1-5f18-4afb-adf8-1fd1a8aeebd4&page=queryresults
[0m13:36:41.783667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707da60>]}
[0m13:36:41.786138 [info ] [Thread-1  ]: 14 of 15 OK created sql table model ruggable.parents ........................... [[32mCREATE TABLE (5.5k rows, 3.6 MiB processed)[0m in 2.87s]
[0m13:36:41.787498 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m13:36:41.787837 [debug] [Thread-1  ]: Began running node model.ruggable.variants
[0m13:36:41.788280 [info ] [Thread-1  ]: 15 of 15 START sql table model ruggable.variants ............................... [RUN]
[0m13:36:41.788681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.parents, now model.ruggable.variants)
[0m13:36:41.788942 [debug] [Thread-1  ]: Began compiling node model.ruggable.variants
[0m13:36:41.791789 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.variants"
[0m13:36:41.792377 [debug] [Thread-1  ]: Began executing node model.ruggable.variants
[0m13:36:41.794700 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.variants"
[0m13:36:41.795318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:41.859773 [debug] [Thread-1  ]: On model.ruggable.variants: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.variants"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`variants`
      
    
    

    OPTIONS()
    as (
      with

variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

-- , parent as ( select * from `first-project-262802`.`ruggable`.`stg_parent` )

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

select
    distinct
    variant.*
    -- , 
from variant
-- left join parent using (pid)
-- left join variant using (pid)
    );
  
[0m13:36:42.489581 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d44cb7e8-2714-4e1a-94fc-c4f897f34ba8&page=queryresults
[0m13:36:45.259927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310c37c0>]}
[0m13:36:45.261352 [info ] [Thread-1  ]: 15 of 15 OK created sql table model ruggable.variants .......................... [[32mCREATE TABLE (38.6k rows, 6.8 MiB processed)[0m in 3.47s]
[0m13:36:45.262317 [debug] [Thread-1  ]: Finished running node model.ruggable.variants
[0m13:36:45.264041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:45.264706 [debug] [MainThread]: Connection 'model.ruggable.variants' was properly closed.
[0m13:36:45.265473 [info ] [MainThread]: 
[0m13:36:45.265973 [info ] [MainThread]: Finished running 15 table models in 0 hours 0 minutes and 52.35 seconds (52.35s).
[0m13:36:45.269653 [debug] [MainThread]: Command end result
[0m13:36:45.306517 [info ] [MainThread]: 
[0m13:36:45.306872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:45.307080 [info ] [MainThread]: 
[0m13:36:45.307270 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m13:36:45.308777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 53.520317, "process_user_time": 6.400128, "process_kernel_time": 0.331653, "process_mem_max_rss": "200196096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:36:45.309118 [debug] [MainThread]: Command `dbt run` succeeded at 13:36:45.309059 after 53.52 seconds
[0m13:36:45.309356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130cae3a0>]}
[0m13:36:45.309612 [debug] [MainThread]: Flushing usage events
[0m14:05:03.821787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108329370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108329190>]}


============================== 14:05:03.824559 | 2cea111b-0c58-4ff3-b9db-eef4b8079f7b ==============================
[0m14:05:03.824559 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:05:03.824887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select parents', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.601859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ae7c0>]}
[0m14:05:04.628078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dd70a30>]}
[0m14:05:04.628395 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:05:04.640437 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:05:04.729156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:04.729529 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/parents.sql
[0m14:05:04.891973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e2ca130>]}
[0m14:05:04.956965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1b9fa0>]}
[0m14:05:04.957264 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m14:05:04.957458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e29b0d0>]}
[0m14:05:04.958087 [info ] [MainThread]: 
[0m14:05:04.958362 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:04.958794 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:05:04.959011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:05.607350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m14:05:05.608099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:06.117505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106816880>]}
[0m14:05:06.119916 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:06.120456 [info ] [MainThread]: 
[0m14:05:06.124053 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m14:05:06.124694 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.parents .................................. [RUN]
[0m14:05:06.125262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.parents)
[0m14:05:06.125682 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m14:05:06.138040 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m14:05:06.139816 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m14:05:06.153284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:06.785835 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.parents"
[0m14:05:06.787938 [debug] [Thread-1  ]: On model.ruggable.parents: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.parents"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`parents`
      
    
    

    OPTIONS()
    as (
      with

parent as ( 
    select 
        distinct
        pid
        , product_type_id
        , name
        , origin
        , thickness
        , material
        , weave
        , weave_feature
        , color
        , brand
        , imageName as image_name
        , imageType as image_type
        , internalName as internal_name
        , category
        , min_price
        , max_price
        , availability
        , aggregate
        , clearance
        , long_description
        , shopbyroom
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`stg_parent` 
)

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    parent.*
    -- , 
from parent
-- left join pads using (pid)
-- left join variant using (pid)
    );
  
[0m14:05:07.379327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a34ecd79-c585-4366-bca0-5f111687eace&page=queryresults
[0m14:05:07.883769 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: imageName; Did you mean image_name? at [28:11]; reason: invalidQuery, location: query, message: Unrecognized name: imageName; Did you mean image_name? at [28:11]')
[0m14:05:09.325922 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dc4cb2ad-59ee-46cd-98c3-32b99f2cc460&page=queryresults
[0m14:05:09.463848 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dc4cb2ad-59ee-46cd-98c3-32b99f2cc460&page=queryresults
[0m14:05:09.509015 [debug] [Thread-1  ]: Database Error in model parents (models/3_final/parents.sql)
  Unrecognized name: imageName; Did you mean image_name? at [28:11]
  compiled Code at target/run/ruggable/models/3_final/parents.sql
[0m14:05:09.510308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4c4550>]}
[0m14:05:09.510785 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.parents ......................... [[31mERROR[0m in 3.38s]
[0m14:05:09.511252 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m14:05:09.512096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:09.512320 [debug] [MainThread]: Connection 'model.ruggable.parents' was properly closed.
[0m14:05:09.512523 [info ] [MainThread]: 
[0m14:05:09.512731 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m14:05:09.513142 [debug] [MainThread]: Command end result
[0m14:05:09.538974 [info ] [MainThread]: 
[0m14:05:09.539282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:05:09.539456 [info ] [MainThread]: 
[0m14:05:09.539672 [error] [MainThread]:   Database Error in model parents (models/3_final/parents.sql)
  Unrecognized name: imageName; Did you mean image_name? at [28:11]
  compiled Code at target/run/ruggable/models/3_final/parents.sql
[0m14:05:09.539845 [info ] [MainThread]: 
[0m14:05:09.540020 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:05:09.541588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7688627, "process_user_time": 2.215892, "process_kernel_time": 2.707959, "process_mem_max_rss": "196820992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:09.541906 [debug] [MainThread]: Command `dbt run` failed at 14:05:09.541853 after 5.77 seconds
[0m14:05:09.542138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1b9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1b9a90>]}
[0m14:05:09.542360 [debug] [MainThread]: Flushing usage events
[0m14:05:33.512323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c5160>]}


============================== 14:05:33.514419 | 18e52cf6-81b9-4123-b21b-2526d1bb757b ==============================
[0m14:05:33.514419 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:05:33.514745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select parents', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.985807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c640>]}
[0m14:05:34.011701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785ba60>]}
[0m14:05:34.011998 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:05:34.024428 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:05:34.112342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:34.112798 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/parents.sql
[0m14:05:34.276092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156b8a130>]}
[0m14:05:34.336805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15687b9d0>]}
[0m14:05:34.337085 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m14:05:34.337274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156b59100>]}
[0m14:05:34.337912 [info ] [MainThread]: 
[0m14:05:34.338175 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:34.338614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:05:34.338810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.823360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m14:05:34.823987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.298899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15687bc70>]}
[0m14:05:35.300067 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:35.300553 [info ] [MainThread]: 
[0m14:05:35.304309 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m14:05:35.305020 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.parents .................................. [RUN]
[0m14:05:35.305557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.parents)
[0m14:05:35.305967 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m14:05:35.318080 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m14:05:35.318855 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m14:05:35.333062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:35.883853 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.parents"
[0m14:05:35.884956 [debug] [Thread-1  ]: On model.ruggable.parents: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.parents"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`parents`
      
    
    

    OPTIONS()
    as (
      with

parent as ( 
    select 
        distinct
        pid
        , product_type_id
        , name
        , origin
        , thickness
        , material
        , weave
        , weave_feature
        , color
        , brand
        , image_name
        , image_type
        , internal_name
        , category
        , min_price
        , max_price
        , availability
        , aggregate
        , clearance
        , long_description
        , shopbyroom
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`stg_parent` 
)

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    parent.*
    -- , 
from parent
-- left join pads using (pid)
-- left join variant using (pid)
    );
  
[0m14:05:36.351640 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:44623bc8-875a-4658-ad21-15d69271a2b6&page=queryresults
[0m14:05:38.816047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fd41640>]}
[0m14:05:38.816554 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.parents ............................. [[32mCREATE TABLE (3.4k rows, 3.2 MiB processed)[0m in 3.51s]
[0m14:05:38.816973 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m14:05:38.817690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:38.817910 [debug] [MainThread]: Connection 'model.ruggable.parents' was properly closed.
[0m14:05:38.818112 [info ] [MainThread]: 
[0m14:05:38.818327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m14:05:38.818737 [debug] [MainThread]: Command end result
[0m14:05:38.845068 [info ] [MainThread]: 
[0m14:05:38.845411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:38.845589 [info ] [MainThread]: 
[0m14:05:38.845768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:38.847042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.381608, "process_user_time": 2.131388, "process_kernel_time": 2.682451, "process_mem_max_rss": "199180288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:38.847346 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:38.847296 after 5.38 seconds
[0m14:05:38.847559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156539520>]}
[0m14:05:38.847769 [debug] [MainThread]: Flushing usage events
[0m14:23:55.056629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b26e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b261c0>]}


============================== 14:23:55.059285 | 1235779c-542c-4d70-bbfe-052bc876c150 ==============================
[0m14:23:55.059285 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:23:55.059607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:55.798251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6fa8e0>]}
[0m14:23:55.824089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ed30>]}
[0m14:23:55.824371 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:23:55.836528 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:23:55.927127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:55.927514 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/variants.sql
[0m14:23:56.089216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282f3ee0>]}
[0m14:23:56.100575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128292100>]}
[0m14:23:56.100837 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m14:23:56.101021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282da310>]}
[0m14:23:56.102106 [info ] [MainThread]: 
[0m14:23:56.102387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:23:56.105237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_ruggable'
[0m14:23:56.105439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:56.658032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a25b0>]}
[0m14:23:56.660514 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:23:56.661086 [info ] [MainThread]: 
[0m14:23:56.664779 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.665372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m14:23:56.665822 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.677735 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m14:23:56.678802 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.679715 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.680175 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.680687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m14:23:56.681115 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.684078 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m14:23:56.684849 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.685515 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.685883 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m14:23:56.686229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m14:23:56.686530 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m14:23:56.689038 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m14:23:56.689690 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m14:23:56.690202 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m14:23:56.690534 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.690868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m14:23:56.691198 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.693564 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m14:23:56.694035 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.694540 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.694840 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m14:23:56.695154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m14:23:56.695427 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m14:23:56.697634 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m14:23:56.698210 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m14:23:56.698649 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m14:23:56.698915 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m14:23:56.699210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m14:23:56.699496 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m14:23:56.701746 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m14:23:56.702286 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m14:23:56.702692 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m14:23:56.702962 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_category_map
[0m14:23:56.703224 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now seed.ruggable.rugs_usa_category_map)
[0m14:23:56.703479 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_category_map
[0m14:23:56.704976 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_category_map
[0m14:23:56.705389 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_category_map
[0m14:23:56.705648 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_color_map
[0m14:23:56.705900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_category_map, now seed.ruggable.rugs_usa_color_map)
[0m14:23:56.706125 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_color_map
[0m14:23:56.708398 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_color_map
[0m14:23:56.708814 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_color_map
[0m14:23:56.709058 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_links
[0m14:23:56.709312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_color_map, now seed.ruggable.rugs_usa_links)
[0m14:23:56.709541 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_links
[0m14:23:56.710887 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_links
[0m14:23:56.711260 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_links
[0m14:23:56.711495 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.711727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_links, now seed.ruggable.rugs_usa_pads_upsell)
[0m14:23:56.711932 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.713290 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.713657 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.713881 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_parent
[0m14:23:56.714118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_pads_upsell, now seed.ruggable.rugs_usa_parent)
[0m14:23:56.714314 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_parent
[0m14:23:56.715635 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_parent
[0m14:23:56.716069 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_parent
[0m14:23:56.716311 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_variant
[0m14:23:56.716551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_parent, now seed.ruggable.rugs_usa_variant)
[0m14:23:56.716767 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_variant
[0m14:23:56.718086 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_variant
[0m14:23:56.718461 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_variant
[0m14:23:56.718687 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m14:23:56.718926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_variant, now model.ruggable.stg_category_map)
[0m14:23:56.719121 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m14:23:56.720874 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m14:23:56.721424 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m14:23:56.721819 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m14:23:56.722042 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m14:23:56.722278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m14:23:56.722481 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m14:23:56.724255 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m14:23:56.724595 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m14:23:56.724958 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m14:23:56.725182 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m14:23:56.725409 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m14:23:56.725597 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m14:23:56.727249 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m14:23:56.727792 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m14:23:56.728130 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m14:23:56.728336 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m14:23:56.728548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_links, now model.ruggable.stg_pads_upsell)
[0m14:23:56.728735 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m14:23:56.731135 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m14:23:56.731599 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m14:23:56.731938 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m14:23:56.732148 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m14:23:56.732363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m14:23:56.732541 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m14:23:56.734163 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m14:23:56.734474 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m14:23:56.734803 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m14:23:56.735006 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m14:23:56.735213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_parent, now model.ruggable.stg_variant)
[0m14:23:56.735389 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m14:23:56.737023 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m14:23:56.737788 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m14:23:56.738178 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m14:23:56.738559 [debug] [Thread-1  ]: Began running node model.ruggable.pads
[0m14:23:56.738778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_variant, now model.ruggable.pads)
[0m14:23:56.738975 [debug] [Thread-1  ]: Began compiling node model.ruggable.pads
[0m14:23:56.740872 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.pads"
[0m14:23:56.741396 [debug] [Thread-1  ]: Began executing node model.ruggable.pads
[0m14:23:56.741737 [debug] [Thread-1  ]: Finished running node model.ruggable.pads
[0m14:23:56.741939 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m14:23:56.742143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.pads, now model.ruggable.parents)
[0m14:23:56.742314 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m14:23:56.744260 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m14:23:56.744694 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m14:23:56.745022 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m14:23:56.745223 [debug] [Thread-1  ]: Began running node model.ruggable.variants
[0m14:23:56.745423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.parents, now model.ruggable.variants)
[0m14:23:56.745588 [debug] [Thread-1  ]: Began compiling node model.ruggable.variants
[0m14:23:56.747340 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.variants"
[0m14:23:56.747758 [debug] [Thread-1  ]: Began executing node model.ruggable.variants
[0m14:23:56.748072 [debug] [Thread-1  ]: Finished running node model.ruggable.variants
[0m14:23:56.748472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:56.748630 [debug] [MainThread]: Connection 'model.ruggable.variants' was properly closed.
[0m14:23:56.750165 [debug] [MainThread]: Command end result
[0m14:23:56.809888 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m14:23:56.810082 [info ] [MainThread]: Building catalog
[0m14:23:56.813988 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m14:23:56.825086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:56.883609 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`ruggable`.__TABLES__ tables
    left join `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_variant')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('pads')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('variants')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_variant')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_variant')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('parents')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_variant')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m14:23:58.153440 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:daa32d44-85de-448d-8463-a07745f90b18&page=queryresults
[0m14:24:00.799903 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/ruggable/target/catalog.json
[0m14:24:00.801440 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.792969, "process_user_time": 2.324906, "process_kernel_time": 2.538205, "process_mem_max_rss": "203685888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:24:00.801746 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:24:00.801702 after 5.79 seconds
[0m14:24:00.801904 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:24:00.802028 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m14:24:00.802175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284eae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ed30>]}
[0m14:24:00.802354 [debug] [MainThread]: Flushing usage events
[0m14:24:19.332574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ccd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ccee0>]}


============================== 14:24:19.334866 | 18550110-eebe-4b5f-a60d-6753de22111f ==============================
[0m14:24:19.334866 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:24:19.335211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m14:24:19.802453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18550110-eebe-4b5f-a60d-6753de22111f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9b9910>]}
[0m14:24:19.828193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18550110-eebe-4b5f-a60d-6753de22111f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9b9370>]}
[0m14:35:41.082061 [error] [MainThread]: Encountered an error:

[0m14:35:41.117480 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:35:41.119913 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 681.8372, "process_user_time": 1.525346, "process_kernel_time": 2.721325, "process_mem_max_rss": "185696256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:41.120450 [debug] [MainThread]: Command `dbt docs serve` failed at 14:35:41.120382 after 681.84 seconds
[0m14:35:41.120810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fc6dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fc6df40>]}
[0m14:35:41.121130 [debug] [MainThread]: Flushing usage events
[0m12:28:00.537061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107264ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f9e80>]}


============================== 12:28:00.540193 | 6df1b695-19b5-45f7-a7f0-646f981624c6 ==============================
[0m12:28:00.540193 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:00.540513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:03.931295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6df1b695-19b5-45f7-a7f0-646f981624c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15891a9a0>]}
[0m12:28:03.958722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6df1b695-19b5-45f7-a7f0-646f981624c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11189c340>]}
[0m12:28:03.959177 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:28:03.988457 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:28:04.053791 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:28:04.054107 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:28:04.054328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6df1b695-19b5-45f7-a7f0-646f981624c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105345e0>]}
[0m12:28:04.667485 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.stg_spy_2014_2024' (models/2_staging/stg_spy_2014_2024.sql) depends on a node named 'base_spy_2014_2024' which was not found
[0m12:28:04.690906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2049894, "process_user_time": 3.078124, "process_kernel_time": 2.188118, "process_mem_max_rss": "192200704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:04.693233 [debug] [MainThread]: Command `dbt run` failed at 12:28:04.692843 after 4.21 seconds
[0m12:28:04.693885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107264ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e81040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042e610>]}
[0m12:28:04.694159 [debug] [MainThread]: Flushing usage events
[0m12:29:06.693594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128351ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128351e80>]}


============================== 12:29:06.695683 | 5fec7f62-3bbb-4708-b102-a787dbe3bc83 ==============================
[0m12:29:06.695683 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:06.696022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:07.154787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2c640>]}
[0m12:29:07.186925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107778310>]}
[0m12:29:07.187589 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:29:07.215657 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:29:07.281977 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:29:07.282253 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:29:07.282434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c820>]}
[0m12:29:08.006945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f88a130>]}
[0m12:29:08.065346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f8cda30>]}
[0m12:29:08.065663 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:29:08.065850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f8a2910>]}
[0m12:29:08.066590 [info ] [MainThread]: 
[0m12:29:08.066882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:29:08.069138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:29:08.069345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:08.726520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now create_first-project-262802_stock_analysis)
[0m12:29:08.727643 [debug] [ThreadPool]: Creating schema "database: "first-project-262802"
schema: "stock_analysis"
"
[0m12:29:08.741890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:08.821381 [debug] [ThreadPool]: On create_first-project-262802_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "create_first-project-262802_stock_analysis"} */
create schema if not exists `first-project-262802`.`stock_analysis`
  
[0m12:29:09.568694 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:aa5cf41a-90cd-49f0-a7b9-bcc9b497f7a4&page=queryresults
[0m12:29:10.181869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_first-project-262802_stock_analysis, now list_first-project-262802_stock_analysis)
[0m12:29:10.182541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:10.735435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665acd0>]}
[0m12:29:10.736360 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:29:10.736811 [info ] [MainThread]: 
[0m12:29:10.741546 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:29:10.742069 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:29:10.742543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:29:10.742825 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:29:10.747675 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:29:10.748227 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:29:10.773179 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:29:10.774334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:10.842865 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:29:11.752585 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:38c36500-96c0-45a0-80e7-84a062b3ad06&page=queryresults
[0m12:29:11.880042 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: date at [18:7]; reason: invalidQuery, location: query, message: Unrecognized name: date at [18:7]')
[0m12:29:12.745945 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c9523eb7-abf3-4636-8257-8b6644d5f71a&page=queryresults
[0m12:29:12.874098 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c9523eb7-abf3-4636-8257-8b6644d5f71a&page=queryresults
[0m12:29:12.918632 [debug] [Thread-1  ]: Database Error in model base_calendar (models/1_base/base_calendar.sql)
  Unrecognized name: date at [18:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_calendar.sql
[0m12:29:12.919888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fb39f70>]}
[0m12:29:12.920376 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model stock_analysis.base_calendar ............. [[31mERROR[0m in 2.18s]
[0m12:29:12.920799 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:29:12.921089 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:29:12.921496 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:29:12.921831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:29:12.922081 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:29:12.924559 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:12.925032 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:29:12.927399 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:12.928030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:12.993427 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:29:14.124503 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:63fe26a1-da2d-496f-a15f-9bdf9b7f1b3e&page=queryresults
[0m12:29:16.502610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fb3dfd0>]}
[0m12:29:16.503351 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.58s]
[0m12:29:16.503895 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:29:16.504533 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:29:16.505027 [info ] [Thread-1  ]: 3 of 4 SKIP relation stock_analysis.stg_spy_2014_2024 .......................... [[33mSKIP[0m]
[0m12:29:16.505525 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:29:16.506060 [debug] [Thread-1  ]: Began running node model.stock_analysis.final_spy_2014_2024
[0m12:29:16.506410 [info ] [Thread-1  ]: 4 of 4 SKIP relation stock_analysis.final_spy_2014_2024 ........................ [[33mSKIP[0m]
[0m12:29:16.506749 [debug] [Thread-1  ]: Finished running node model.stock_analysis.final_spy_2014_2024
[0m12:29:16.507458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:16.507675 [debug] [MainThread]: Connection 'model.stock_analysis.base_spy_2014_2024' was properly closed.
[0m12:29:16.507947 [info ] [MainThread]: 
[0m12:29:16.508216 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m12:29:16.508859 [debug] [MainThread]: Command end result
[0m12:29:16.535277 [info ] [MainThread]: 
[0m12:29:16.535636 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:29:16.535816 [info ] [MainThread]: 
[0m12:29:16.536036 [error] [MainThread]:   Database Error in model base_calendar (models/1_base/base_calendar.sql)
  Unrecognized name: date at [18:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_calendar.sql
[0m12:29:16.536198 [info ] [MainThread]: 
[0m12:29:16.536366 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m12:29:16.537519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.893358, "process_user_time": 5.350007, "process_kernel_time": 0.22381, "process_mem_max_rss": "202604544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:29:16.537799 [debug] [MainThread]: Command `dbt run` failed at 12:29:16.537747 after 9.89 seconds
[0m12:29:16.538018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107778310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d62ee0>]}
[0m12:29:16.538211 [debug] [MainThread]: Flushing usage events
[0m12:29:50.699543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106114b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a99d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a99f40>]}


============================== 12:29:50.701623 | 93ff2aa6-7855-49be-b707-bfc7abdb786e ==============================
[0m12:29:50.701623 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:50.701941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:29:51.149390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe9e4f0>]}
[0m12:29:51.175217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24df0>]}
[0m12:29:51.175530 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:29:51.186205 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:29:51.253106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:51.253493 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m12:29:51.408463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff56cd0>]}
[0m12:29:51.458143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fef9c70>]}
[0m12:29:51.458423 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:29:51.458610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fec8ca0>]}
[0m12:29:51.459492 [info ] [MainThread]: 
[0m12:29:51.459787 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:29:51.462015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:29:51.462237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:51.988650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:29:51.989694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:52.534760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7aa90>]}
[0m12:29:52.536007 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:29:52.536545 [info ] [MainThread]: 
[0m12:29:52.539971 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:29:52.540977 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:29:52.541715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:29:52.542430 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:29:52.553576 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:29:52.554472 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:29:52.587448 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:29:52.588069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:52.652671 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:29:53.616550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:87515d93-72e5-44c9-b038-9433b9bc3323&page=queryresults
[0m12:29:56.680333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c4400>]}
[0m12:29:56.681168 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.14s]
[0m12:29:56.681738 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:29:56.682123 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:29:56.682598 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:29:56.683023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:29:56.683318 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:29:56.686172 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:56.686858 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:29:56.690671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:57.252626 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:57.255717 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:29:57.848822 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:48fccd61-3d87-4b80-a837-d92ea8bea2ec&page=queryresults
[0m12:29:59.902271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748a460>]}
[0m12:29:59.903220 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.22s]
[0m12:29:59.904037 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:29:59.904769 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:29:59.905190 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:29:59.905493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m12:29:59.905688 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:29:59.909307 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:29:59.910250 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:29:59.913553 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:29:59.914375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:59.986271 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using date
    );
  
[0m12:30:00.509528 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:07efac97-49cb-4236-b9ed-bcf52861a1c3&page=queryresults
[0m12:30:00.510087 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" but got keyword DATE at [16:73]; reason: invalidQuery, location: query, message: Syntax error: Expected "(" but got keyword DATE at [16:73]')
[0m12:30:01.169748 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ef66697f-e128-458a-ad16-3b33b3422c7e&page=queryresults
[0m12:30:01.171452 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ef66697f-e128-458a-ad16-3b33b3422c7e&page=queryresults
[0m12:30:01.211689 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Syntax error: Expected "(" but got keyword DATE at [16:73]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m12:30:01.212128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f46dbb0>]}
[0m12:30:01.212597 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.31s]
[0m12:30:01.213031 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:30:01.213543 [debug] [Thread-1  ]: Began running node model.stock_analysis.final_spy_2014_2024
[0m12:30:01.213926 [info ] [Thread-1  ]: 4 of 4 SKIP relation stock_analysis.final_spy_2014_2024 ........................ [[33mSKIP[0m]
[0m12:30:01.214192 [debug] [Thread-1  ]: Finished running node model.stock_analysis.final_spy_2014_2024
[0m12:30:01.214849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:01.215041 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m12:30:01.215293 [info ] [MainThread]: 
[0m12:30:01.215504 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m12:30:01.216125 [debug] [MainThread]: Command end result
[0m12:30:01.239448 [info ] [MainThread]: 
[0m12:30:01.239795 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:01.239988 [info ] [MainThread]: 
[0m12:30:01.240243 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Syntax error: Expected "(" but got keyword DATE at [16:73]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m12:30:01.240431 [info ] [MainThread]: 
[0m12:30:01.240611 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m12:30:01.241854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.589343, "process_user_time": 4.895982, "process_kernel_time": 0.19524, "process_mem_max_rss": "198901760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:01.242170 [debug] [MainThread]: Command `dbt run` failed at 12:30:01.242116 after 10.59 seconds
[0m12:30:01.242394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106114b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fddf8e0>]}
[0m12:30:01.242618 [debug] [MainThread]: Flushing usage events
[0m12:30:22.449218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a21ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a21e80>]}


============================== 12:30:22.451655 | 9fab9307-ff3b-44f3-be6e-7510fd608b5b ==============================
[0m12:30:22.451655 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:22.451951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:22.899504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d4640>]}
[0m12:30:22.925352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e20310>]}
[0m12:30:22.925662 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:30:22.936579 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:30:23.004705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:23.005096 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m12:30:23.158637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165393130>]}
[0m12:30:23.208051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f3fdc0>]}
[0m12:30:23.208317 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:30:23.208506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1651714c0>]}
[0m12:30:23.209355 [info ] [MainThread]: 
[0m12:30:23.209648 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:30:23.211823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:30:23.212038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:23.876657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:30:23.877393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:24.373133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165242a30>]}
[0m12:30:24.374537 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:30:24.375099 [info ] [MainThread]: 
[0m12:30:24.378959 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:30:24.380126 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:30:24.380864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:30:24.381287 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:30:24.392092 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:30:24.393067 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:30:24.408013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:24.940483 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:30:24.941390 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:30:25.292574 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8ddf8d55-8b7b-4b84-8228-2aa2a4533894&page=queryresults
[0m12:30:28.472622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439ac70>]}
[0m12:30:28.473179 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.09s]
[0m12:30:28.473632 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:30:28.473930 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:30:28.474345 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:30:28.474715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:30:28.474969 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:30:28.478705 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:30:28.479414 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:30:28.481435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:28.981018 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:30:28.983127 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:30:29.491303 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:af1a43e7-a497-454e-af4f-c8da30121438&page=queryresults
[0m12:30:31.403058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165278430>]}
[0m12:30:31.405340 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.93s]
[0m12:30:31.406357 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:30:31.407337 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:30:31.407796 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:30:31.408281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m12:30:31.408523 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:30:31.411291 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:30:31.412047 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:30:31.414125 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:30:31.414645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:31.477777 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using (date)
    );
  
[0m12:30:32.253113 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ee0b6e0c-9bbe-4ab7-9be8-68dd9ac8923b&page=queryresults
[0m12:30:35.126939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1652781f0>]}
[0m12:30:35.129460 [info ] [Thread-1  ]: 3 of 4 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 31.1 MiB processed)[0m in 3.72s]
[0m12:30:35.130703 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:30:35.132113 [debug] [Thread-1  ]: Began running node model.stock_analysis.final_spy_2014_2024
[0m12:30:35.132655 [info ] [Thread-1  ]: 4 of 4 START sql table model stock_analysis.final_spy_2014_2024 ................ [RUN]
[0m12:30:35.133173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.final_spy_2014_2024)
[0m12:30:35.133498 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.final_spy_2014_2024
[0m12:30:35.137139 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.final_spy_2014_2024"
[0m12:30:35.138318 [debug] [Thread-1  ]: Began executing node model.stock_analysis.final_spy_2014_2024
[0m12:30:35.141424 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.final_spy_2014_2024"
[0m12:30:35.142400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:35.214717 [debug] [Thread-1  ]: On model.stock_analysis.final_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.final_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`final_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      -- with

-- spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


-- select
--     spy_2014_2024.*
-- from spy_2014_2024
    );
  
[0m12:30:35.607664 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:be792793-1c2c-4870-8df1-3edd22ef70b2&page=queryresults
[0m12:30:35.608929 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [21:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [21:5]')
[0m12:30:36.043714 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2f1ac729-4fea-49c9-943c-dd2680a43ef0&page=queryresults
[0m12:30:36.044897 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2f1ac729-4fea-49c9-943c-dd2680a43ef0&page=queryresults
[0m12:30:36.081724 [debug] [Thread-1  ]: Database Error in model final_spy_2014_2024 (models/3_final/final_spy_2014_2024.sql)
  Syntax error: Unexpected ")" at [21:5]
  compiled Code at target/run/stock_analysis/models/3_final/final_spy_2014_2024.sql
[0m12:30:36.082277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165650ee0>]}
[0m12:30:36.082822 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model stock_analysis.final_spy_2014_2024 ....... [[31mERROR[0m in 0.95s]
[0m12:30:36.083266 [debug] [Thread-1  ]: Finished running node model.stock_analysis.final_spy_2014_2024
[0m12:30:36.084173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:36.084406 [debug] [MainThread]: Connection 'model.stock_analysis.final_spy_2014_2024' was properly closed.
[0m12:30:36.084667 [info ] [MainThread]: 
[0m12:30:36.084909 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.88 seconds (12.88s).
[0m12:30:36.085644 [debug] [MainThread]: Command end result
[0m12:30:36.108606 [info ] [MainThread]: 
[0m12:30:36.108969 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:36.109162 [info ] [MainThread]: 
[0m12:30:36.109409 [error] [MainThread]:   Database Error in model final_spy_2014_2024 (models/3_final/final_spy_2014_2024.sql)
  Syntax error: Unexpected ")" at [21:5]
  compiled Code at target/run/stock_analysis/models/3_final/final_spy_2014_2024.sql
[0m12:30:36.109632 [info ] [MainThread]: 
[0m12:30:36.109847 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:30:36.111255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.714163, "process_user_time": 3.926323, "process_kernel_time": 1.310405, "process_mem_max_rss": "198541312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:36.111595 [debug] [MainThread]: Command `dbt run` failed at 12:30:36.111540 after 13.71 seconds
[0m12:30:36.111836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1653b0cd0>]}
[0m12:30:36.112054 [debug] [MainThread]: Flushing usage events
[0m12:32:34.781529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d39c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d39e50>]}


============================== 12:32:34.784482 | e4620a42-307d-45d8-9e92-9a4daa145f91 ==============================
[0m12:32:34.784482 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:32:34.784843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:35.527832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16629e0d0>]}
[0m12:32:35.555486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cec9d0>]}
[0m12:32:35.555883 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:32:35.567808 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:32:35.640335 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:32:35.640695 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_final/spy_2014_2024.sql
[0m12:32:35.640850 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_final/final_spy_2014_2024.sql
[0m12:32:35.795856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162b33b20>]}
[0m12:32:35.849342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166448670>]}
[0m12:32:35.849605 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:32:35.849796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d2149a0>]}
[0m12:32:35.850646 [info ] [MainThread]: 
[0m12:32:35.850928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:35.853096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:32:35.853293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:36.468242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:32:36.469163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:36.967018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103400190>]}
[0m12:32:36.969027 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:32:36.969703 [info ] [MainThread]: 
[0m12:32:36.974630 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:32:36.976134 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:32:36.976966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:32:36.977513 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:32:36.988677 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:32:36.989508 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:32:37.003509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:37.556744 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:32:37.557645 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:32:38.023710 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0fd16580-8c84-43dc-8802-3c0e70cf03fe&page=queryresults
[0m12:32:41.490949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162bf5640>]}
[0m12:32:41.491727 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.51s]
[0m12:32:41.492316 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:32:41.492711 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:32:41.493228 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:32:41.493691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:32:41.494014 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:32:41.499118 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:32:41.500213 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:32:41.502516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:42.014720 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:32:42.017701 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:32:42.409459 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b6fe7a98-c25f-435e-a5f0-3c2c5f186194&page=queryresults
[0m12:32:44.333676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d36a730>]}
[0m12:32:44.335288 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.84s]
[0m12:32:44.336785 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:32:44.338038 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:32:44.338664 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:32:44.339265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m12:32:44.339697 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:32:44.344677 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:32:44.345880 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:32:44.348764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:44.866054 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:32:44.868910 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using (date)
    );
  
[0m12:32:45.255701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fcc21313-47ab-4aa3-a867-11cb5daacb07&page=queryresults
[0m12:32:47.810656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d36aa60>]}
[0m12:32:47.811594 [info ] [Thread-1  ]: 3 of 4 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 31.1 MiB processed)[0m in 3.47s]
[0m12:32:47.812332 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:32:47.813331 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m12:32:47.813926 [info ] [Thread-1  ]: 4 of 4 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m12:32:47.814436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m12:32:47.814820 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m12:32:47.818564 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m12:32:47.819569 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m12:32:47.822800 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m12:32:47.823411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:47.898691 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m12:32:48.652877 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e5810859-bb9d-4458-8cd6-5e13fdeeb8e1&page=queryresults
[0m12:32:50.580273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d3a1460>]}
[0m12:32:50.581417 [info ] [Thread-1  ]: 4 of 4 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 703.1 KiB processed)[0m in 2.77s]
[0m12:32:50.582111 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m12:32:50.583378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:50.583735 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m12:32:50.584139 [info ] [MainThread]: 
[0m12:32:50.584480 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.73 seconds (14.73s).
[0m12:32:50.585594 [debug] [MainThread]: Command end result
[0m12:32:50.613777 [info ] [MainThread]: 
[0m12:32:50.614134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:50.614356 [info ] [MainThread]: 
[0m12:32:50.614707 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:32:50.616126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.887622, "process_user_time": 2.869769, "process_kernel_time": 2.443085, "process_mem_max_rss": "198213632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:50.616495 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:50.616437 after 15.89 seconds
[0m12:32:50.616754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162b33670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461b7c0>]}
[0m12:32:50.617007 [debug] [MainThread]: Flushing usage events
[0m12:42:09.046642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577de80>]}


============================== 12:42:09.049375 | be8de2f8-f5d4-41a7-9412-0401fe44e8e6 ==============================
[0m12:42:09.049375 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:42:09.049705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:09.821928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d5a9a0>]}
[0m12:42:09.847642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105720340>]}
[0m12:42:09.847928 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:42:09.858446 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:42:09.933019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m12:42:09.933389 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_calendar.sql
[0m12:42:09.933613 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m12:42:09.933807 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_spy_2014_2024.sql
[0m12:42:10.089534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f6ee0>]}
[0m12:42:10.142223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126df11f0>]}
[0m12:42:10.142487 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m12:42:10.142672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105720be0>]}
[0m12:42:10.143374 [info ] [MainThread]: 
[0m12:42:10.143644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:10.145926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:42:10.146139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:10.752349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:42:10.753444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:11.312521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5fa90>]}
[0m12:42:11.314078 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:42:11.314868 [info ] [MainThread]: 
[0m12:42:11.319323 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:42:11.320098 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:42:11.320707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:42:11.321187 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:42:11.330512 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:42:11.331270 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:42:11.344482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:11.883530 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:42:11.884497 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:42:12.455686 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:849114e9-78e3-477c-94bd-7e406df9db61&page=queryresults
[0m12:42:15.539854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232a9610>]}
[0m12:42:15.540602 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.22s]
[0m12:42:15.541193 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:42:15.541575 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:42:15.542105 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:42:15.542644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:42:15.542979 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:42:15.547840 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:42:15.549785 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:42:15.552146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:16.037152 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:42:16.041399 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:42:16.446619 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d1ee8cbd-7a36-477a-ae4b-4f7aaa9ecb6c&page=queryresults
[0m12:42:18.373388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d794f0>]}
[0m12:42:18.375805 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.83s]
[0m12:42:18.377310 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:42:18.378015 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m12:42:18.378887 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m12:42:18.379713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m12:42:18.380183 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m12:42:18.385918 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m12:42:18.387208 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m12:42:18.391654 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m12:42:18.393037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:18.471705 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

select
    *
    , case when day_of_date = 1 then TRUE else FALSE end as month_start
    -- , case 
    --     when month_full in () and day_of_date = 30 then TRUE 
    --     when day_of_date = 31 then TRUE 
    --     when day_of_date = 28 or day_of_date = 29 then TRUE 
    --     else FALSE 
    --   end as month_end
from base_calendar
    );
  
[0m12:42:19.144121 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a2cb1e0d-ed59-43c8-be10-decb4dd344f3&page=queryresults
[0m12:42:22.166501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d797f0>]}
[0m12:42:22.167307 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 34.3 MiB processed)[0m in 3.79s]
[0m12:42:22.168012 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m12:42:22.168489 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:42:22.169121 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:42:22.169694 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m12:42:22.170057 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:42:22.173677 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:42:22.174454 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:42:22.177368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:22.658811 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:42:22.659549 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using (date)
    );
  
[0m12:42:23.009934 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:59bf2c54-e428-4ab5-a444-ae935d76dc7e&page=queryresults
[0m12:42:25.726539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e18dc0>]}
[0m12:42:25.728969 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 34.4 MiB processed)[0m in 3.56s]
[0m12:42:25.730076 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:42:25.731456 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m12:42:25.732119 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m12:42:25.732714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m12:42:25.733545 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m12:42:25.738964 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m12:42:25.741477 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m12:42:25.745380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:26.242399 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m12:42:26.245065 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m12:42:26.583543 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cf280754-1a3b-4b99-8238-d0e3dd50a76c&page=queryresults
[0m12:42:28.603472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127dfc3a0>]}
[0m12:42:28.605799 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 703.1 KiB processed)[0m in 2.87s]
[0m12:42:28.607105 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m12:42:28.608733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:28.609106 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m12:42:28.609376 [info ] [MainThread]: 
[0m12:42:28.609603 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 18.47 seconds (18.47s).
[0m12:42:28.610409 [debug] [MainThread]: Command end result
[0m12:42:28.632403 [info ] [MainThread]: 
[0m12:42:28.632748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:28.632924 [info ] [MainThread]: 
[0m12:42:28.633103 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:42:28.634263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.636581, "process_user_time": 5.129571, "process_kernel_time": 0.306117, "process_mem_max_rss": "195215360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:42:28.634559 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:28.634508 after 19.64 seconds
[0m12:42:28.634771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126df60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bd0fd0>]}
[0m12:42:28.634977 [debug] [MainThread]: Flushing usage events
[0m13:01:44.113118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2de50>]}


============================== 13:01:44.116443 | a6ae88b5-5d90-4cb1-b466-d5af613c9ecf ==============================
[0m13:01:44.116443 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:44.116786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:44.990038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c24c0d0>]}
[0m13:01:45.019073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de29d0>]}
[0m13:01:45.019514 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:01:45.032954 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:01:45.112117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:01:45.112536 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m13:01:45.112752 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:01:45.112968 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m13:01:45.279558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5ae9a0>]}
[0m13:01:45.335380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c6a67f0>]}
[0m13:01:45.335660 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:01:45.335849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c22e400>]}
[0m13:01:45.336589 [info ] [MainThread]: 
[0m13:01:45.336865 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:45.339136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:01:45.339341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:45.960859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:01:45.961962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:46.478926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430fa90>]}
[0m13:01:46.480226 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:01:46.480775 [info ] [MainThread]: 
[0m13:01:46.485028 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:01:46.485592 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m13:01:46.486103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:01:46.486467 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:01:46.494951 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:01:46.495927 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:01:46.509487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:47.055660 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m13:01:47.056545 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m13:01:47.499826 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b1552c8c-8c57-4721-a0fe-05bc36343ae9&page=queryresults
[0m13:01:50.663743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8e8640>]}
[0m13:01:50.664298 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.18s]
[0m13:01:50.664750 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:01:50.665051 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:01:50.665369 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m13:01:50.665677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:01:50.665920 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:01:50.668510 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:01:50.669757 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:01:50.671880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:51.134917 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m13:01:51.138533 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m13:01:51.598076 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:79268c76-4c17-41c0-8c9d-9c9255f76557&page=queryresults
[0m13:01:53.828444 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c8efe80>]}
[0m13:01:53.829920 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.16s]
[0m13:01:53.830782 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:01:53.831634 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:01:53.832909 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:01:53.833740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:01:53.834280 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:01:53.839372 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:01:53.841773 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:01:53.845185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:54.329555 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:01:54.331300 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

select
    *
    , case when day_of_date = 1 then TRUE else FALSE end as month_start
    , case 
        when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
        when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
        when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
        else FALSE 
    end as month_end
from base_calendar
    );
  
[0m13:01:54.710788 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fb29a62f-4fd8-40be-bae1-6287355bf505&page=queryresults
[0m13:01:58.530806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c870f70>]}
[0m13:01:58.532771 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 33.9 MiB processed)[0m in 4.70s]
[0m13:01:58.533561 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:01:58.534601 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:01:58.535393 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m13:01:58.535952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:01:58.536278 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:01:58.539692 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:01:58.540559 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:01:58.544859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:59.054343 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:01:59.057522 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m13:01:59.481178 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3761e9cb-37a3-4461-a0d3-69bb2a433076&page=queryresults
[0m13:02:02.409617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c931220>]}
[0m13:02:02.410568 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 34.3 MiB processed)[0m in 3.87s]
[0m13:02:02.411261 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:02:02.411995 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:02:02.412527 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m13:02:02.413086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:02:02.413475 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:02:02.416581 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:02:02.418491 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:02:02.421331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:02.948524 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m13:02:02.950267 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m13:02:03.372543 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f92873a7-5714-4be4-9e4a-80f1c77860ba&page=queryresults
[0m13:02:05.367815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c870850>]}
[0m13:02:05.369893 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 701.0 KiB processed)[0m in 2.95s]
[0m13:02:05.370615 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:02:05.371677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:05.371962 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:02:05.372249 [info ] [MainThread]: 
[0m13:02:05.372492 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 20.04 seconds (20.04s).
[0m13:02:05.373394 [debug] [MainThread]: Command end result
[0m13:02:05.397992 [info ] [MainThread]: 
[0m13:02:05.398343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:05.398544 [info ] [MainThread]: 
[0m13:02:05.398743 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:02:05.400046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.345028, "process_user_time": 4.848076, "process_kernel_time": 0.320356, "process_mem_max_rss": "197459968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:02:05.400373 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:05.400314 after 21.35 seconds
[0m13:02:05.400612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8e8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5463a0>]}
[0m13:02:05.400843 [debug] [MainThread]: Flushing usage events
[0m13:04:30.227267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108341c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108341df0>]}


============================== 13:04:30.230029 | c4abc335-026f-4102-acb0-4e839bf37f2a ==============================
[0m13:04:30.230029 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:04:30.230350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:04:30.981156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a701c0>]}
[0m13:04:31.009998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a4b640>]}
[0m13:04:31.010442 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:04:31.022248 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:04:31.097959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:31.098312 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m13:04:31.257069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1296a3130>]}
[0m13:04:31.310494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830b190>]}
[0m13:04:31.310761 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:04:31.310955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129118730>]}
[0m13:04:31.311664 [info ] [MainThread]: 
[0m13:04:31.311936 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:04:31.314156 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:04:31.314363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:31.881345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:04:31.882476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:32.389573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081be1f0>]}
[0m13:04:32.391092 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:04:32.391871 [info ] [MainThread]: 
[0m13:04:32.395981 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:04:32.396604 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m13:04:32.397127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:04:32.397866 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:04:32.407848 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:04:32.408763 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:04:32.422713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:32.950396 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m13:04:32.953425 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m13:04:33.490803 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:64646f90-bcdc-4602-8364-6adc311f7b52&page=queryresults
[0m13:04:36.868667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a335b0>]}
[0m13:04:36.869263 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.47s]
[0m13:04:36.869750 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:04:36.870078 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:04:36.870532 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m13:04:36.871019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:04:36.871361 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:04:36.873944 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:04:36.874618 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:04:36.876993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:37.364674 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m13:04:37.366263 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m13:04:37.793610 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9fd8a73d-769a-4334-96f9-69d72e1a4cbf&page=queryresults
[0m13:04:39.563085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12988fdf0>]}
[0m13:04:39.564645 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.69s]
[0m13:04:39.565607 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:04:39.566209 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:04:39.567232 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:04:39.568340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:04:39.569154 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:04:39.573792 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:04:39.574937 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:04:39.578619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:40.089808 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:04:40.091927 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

select
    *
    , case when day_of_date = 1 then TRUE else FALSE end as month_start
    , case 
        when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
        when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
        when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
        else FALSE 
    end as month_end
from base_calendar
    );
  
[0m13:04:40.543958 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:47b8bf83-8034-4e76-a1b8-c443a47af427&page=queryresults
[0m13:04:43.577838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1298a5fa0>]}
[0m13:04:43.578854 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 4.01s]
[0m13:04:43.579620 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:04:43.580618 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:04:43.581306 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m13:04:43.581775 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:04:43.582012 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:04:43.584241 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:04:43.584778 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:04:43.587820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:44.060931 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:04:44.062248 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m13:04:44.374941 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2ee1ae7d-fbbe-4405-b5c0-090ccdcd6633&page=queryresults
[0m13:04:46.857055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129974160>]}
[0m13:04:46.858306 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 35.4 MiB processed)[0m in 3.28s]
[0m13:04:46.859188 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:04:46.860257 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:04:46.861034 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m13:04:46.861491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:04:46.861773 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:04:46.864312 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:04:46.866281 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:04:46.868762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:47.374291 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m13:04:47.375541 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m13:04:47.747018 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2d3f25bb-c8da-45d2-91b3-dccb82bbb0bc&page=queryresults
[0m13:04:49.873466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1298a5fd0>]}
[0m13:04:49.874953 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 721.0 KiB processed)[0m in 3.01s]
[0m13:04:49.875823 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:04:49.877484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:49.877883 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:04:49.878232 [info ] [MainThread]: 
[0m13:04:49.878531 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 18.57 seconds (18.57s).
[0m13:04:49.879619 [debug] [MainThread]: Command end result
[0m13:04:49.912256 [info ] [MainThread]: 
[0m13:04:49.912673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:49.912932 [info ] [MainThread]: 
[0m13:04:49.913170 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:04:49.914715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.735352, "process_user_time": 4.632596, "process_kernel_time": 0.733379, "process_mem_max_rss": "196214784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:04:49.915119 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:49.915057 after 19.74 seconds
[0m13:04:49.915406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a4b640>]}
[0m13:04:49.915683 [debug] [MainThread]: Flushing usage events
[0m13:13:03.266521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112311c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112311e50>]}


============================== 13:13:03.270051 | e3183a3a-5d08-4edd-9814-40320719c9b4 ==============================
[0m13:13:03.270051 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:13:03.270483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:13:04.075320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ff0c0d0>]}
[0m13:13:04.101484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c39d0>]}
[0m13:13:04.101785 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:13:04.113242 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:13:04.186893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:04.187227 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:13:04.343135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160423130>]}
[0m13:13:04.396331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110358a00>]}
[0m13:13:04.396598 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:13:04.396787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160462d60>]}
[0m13:13:04.397518 [info ] [MainThread]: 
[0m13:13:04.397800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:13:04.400033 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:13:04.400241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:04.961164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:13:04.962347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:05.508899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16010d070>]}
[0m13:13:05.509546 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:13:05.509853 [info ] [MainThread]: 
[0m13:13:05.512972 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:13:05.513435 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m13:13:05.513797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:13:05.514052 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:13:05.521099 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:13:05.522027 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:13:05.533962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:06.076789 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m13:13:06.078770 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m13:13:06.516240 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9194523a-77ac-4fa3-95c9-31fb969882cb&page=queryresults
[0m13:13:09.876624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f842640>]}
[0m13:13:09.877342 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.36s]
[0m13:13:09.877831 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:13:09.878158 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:13:09.878615 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m13:13:09.879111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:13:09.879399 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:13:09.881949 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:13:09.883518 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:13:09.885700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:10.405905 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m13:13:10.407985 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m13:13:10.827073 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bc16a7c8-a72f-4b04-a51f-c53a57481b50&page=queryresults
[0m13:13:12.740036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16070ff10>]}
[0m13:13:12.741395 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.86s]
[0m13:13:12.742290 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:13:12.742913 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:13:12.744069 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:13:12.744889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:13:12.745569 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:13:12.750162 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:13:12.752567 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:13:12.755686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:13.344549 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:13:13.347508 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
        when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
        else False
        end as quarter_start
        , case 
        when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
        else False
        end as quarter_end    
    from month_start_and_end
)

select * from adding_quarter_start_and_end
    );
  
[0m13:13:13.548243 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:081eb53a-1982-4f9d-a34f-2fd7baa812d4&page=queryresults
[0m13:13:13.549911 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: month_start_and_end, message: Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).')
[0m13:13:14.425408 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:08a91ada-d275-4b97-a73a-180eab0a5c1c&page=queryresults
[0m13:13:14.427779 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:08a91ada-d275-4b97-a73a-180eab0a5c1c&page=queryresults
[0m13:13:14.469632 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:13:14.470065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1607fbf70>]}
[0m13:13:14.470488 [error] [Thread-1  ]: 3 of 5 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 1.73s]
[0m13:13:14.470878 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:13:14.471461 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:13:14.471864 [info ] [Thread-1  ]: 4 of 5 SKIP relation stock_analysis.stg_spy_2014_2024 .......................... [[33mSKIP[0m]
[0m13:13:14.472224 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:13:14.472624 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:13:14.472957 [info ] [Thread-1  ]: 5 of 5 SKIP relation stock_analysis.spy_2014_2024 .............................. [[33mSKIP[0m]
[0m13:13:14.473315 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:13:14.474051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:14.474257 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m13:13:14.474525 [info ] [MainThread]: 
[0m13:13:14.474742 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m13:13:14.475434 [debug] [MainThread]: Command end result
[0m13:13:14.498530 [info ] [MainThread]: 
[0m13:13:14.498871 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:13:14.499050 [info ] [MainThread]: 
[0m13:13:14.499273 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:13:14.499459 [info ] [MainThread]: 
[0m13:13:14.499640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m13:13:14.500869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.305, "process_user_time": 4.351643, "process_kernel_time": 0.837419, "process_mem_max_rss": "194494464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:13:14.501176 [debug] [MainThread]: Command `dbt run` failed at 13:13:14.501128 after 11.31 seconds
[0m13:13:14.501394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100cd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ff0c0d0>]}
[0m13:13:14.501604 [debug] [MainThread]: Flushing usage events
[0m13:19:01.726548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f74b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056042b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056040d0>]}


============================== 13:19:01.729415 | 263aa728-2cab-49d0-8445-88b27a121e41 ==============================
[0m13:19:01.729415 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:19:01.729746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_calendar', 'send_anonymous_usage_stats': 'True'}
[0m13:19:02.541401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a7d90a0>]}
[0m13:19:02.568568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a820610>]}
[0m13:19:02.568912 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:19:02.580308 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:19:02.660005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:02.660429 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:19:02.859299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c022130>]}
[0m13:19:02.919891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c022490>]}
[0m13:19:02.920238 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:19:02.920437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c040d00>]}
[0m13:19:02.921042 [info ] [MainThread]: 
[0m13:19:02.921375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:02.921907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:19:02.922162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:03.497366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:19:03.498100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:04.004266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a8a47f0>]}
[0m13:19:04.005238 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:19:04.005653 [info ] [MainThread]: 
[0m13:19:04.007762 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:19:04.008328 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:19:04.008786 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m13:19:04.009138 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:19:04.018132 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:19:04.019076 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:19:04.032785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:04.567379 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:19:04.569368 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
        when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
        else False
        end as quarter_start
        , case 
        when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
        else False
        end as quarter_end    
    from month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as week_start
        , case 
        when day_of_week = 7 then TRUE
        else False
        end as week_end
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as typical_trading_week_start
        , case 
        when day_of_week = 5 then TRUE
        else False
        end as typical_trading_week_end
    from adding_quarter_start_and_end
)

select * from adding_week_start_and_end
    );
  
[0m13:19:04.757332 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6cc40622-322d-4e9a-b008-4ac99c609e78&page=queryresults
[0m13:19:04.759301 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: month_start_and_end, message: Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).')
[0m13:19:05.295563 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f4071811-04cf-47bb-bc5d-0d90aa8b35c7&page=queryresults
[0m13:19:05.297329 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f4071811-04cf-47bb-bc5d-0d90aa8b35c7&page=queryresults
[0m13:19:05.342630 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:19:05.343930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c10fdf0>]}
[0m13:19:05.344434 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 1.33s]
[0m13:19:05.344867 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:19:05.345646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:05.345871 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m13:19:05.346080 [info ] [MainThread]: 
[0m13:19:05.346293 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m13:19:05.346713 [debug] [MainThread]: Command end result
[0m13:19:05.370515 [info ] [MainThread]: 
[0m13:19:05.370858 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:19:05.371031 [info ] [MainThread]: 
[0m13:19:05.371250 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:19:05.371422 [info ] [MainThread]: 
[0m13:19:05.371599 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:19:05.372800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6965003, "process_user_time": 4.651507, "process_kernel_time": 0.278438, "process_mem_max_rss": "196001792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:05.373099 [debug] [MainThread]: Command `dbt run` failed at 13:19:05.373050 after 3.70 seconds
[0m13:19:05.373319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f74b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a820610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eef910>]}
[0m13:19:05.373516 [debug] [MainThread]: Flushing usage events
[0m13:19:41.897912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d1c0>]}


============================== 13:19:41.900459 | ba83c4ad-33fc-403f-ad2a-6b3f9d275541 ==============================
[0m13:19:41.900459 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:19:41.900778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_calendar+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:42.402751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dc5b0>]}
[0m13:19:42.428571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed6070>]}
[0m13:19:42.428873 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:19:42.440299 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:19:42.513464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:42.513880 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:19:42.667952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff97520>]}
[0m13:19:42.721269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c41d00>]}
[0m13:19:42.721543 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:19:42.721730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138931220>]}
[0m13:19:42.722354 [info ] [MainThread]: 
[0m13:19:42.722626 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:42.724811 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:19:42.725014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:43.276685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:19:43.277950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:43.773167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a7c0>]}
[0m13:19:43.774813 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:19:43.775534 [info ] [MainThread]: 
[0m13:19:43.780027 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:19:43.781080 [info ] [Thread-1  ]: 1 of 3 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:19:43.781849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m13:19:43.782358 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:19:43.793478 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:19:43.794569 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:19:43.809408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:44.340971 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:19:44.341828 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
        when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
        else False
        end as quarter_start
        , case 
        when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
        else False
        end as quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as week_start
        , case 
        when day_of_week = 7 then TRUE
        else False
        end as week_end
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as typical_trading_week_start
        , case 
        when day_of_week = 5 then TRUE
        else False
        end as typical_trading_week_end
    from adding_quarter_start_and_end
)

select * from adding_week_start_and_end
    );
  
[0m13:19:44.726935 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6537933c-bfa0-45f1-aa52-41baf2542364&page=queryresults
[0m13:19:48.634008 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139812eb0>]}
[0m13:19:48.634865 [info ] [Thread-1  ]: 1 of 3 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 4.85s]
[0m13:19:48.635481 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:19:48.636298 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:19:48.636816 [info ] [Thread-1  ]: 2 of 3 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m13:19:48.637250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:19:48.637574 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:19:48.640857 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:19:48.641917 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:19:48.644332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:49.149637 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:19:49.152184 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m13:19:49.538578 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:954f5f40-2b21-4500-afd5-7e6acdb7cd86&page=queryresults
[0m13:19:52.278464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139812d00>]}
[0m13:19:52.280330 [info ] [Thread-1  ]: 2 of 3 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 36.3 MiB processed)[0m in 3.64s]
[0m13:19:52.281186 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:19:52.282192 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:19:52.282809 [info ] [Thread-1  ]: 3 of 3 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m13:19:52.283265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:19:52.283559 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:19:52.286220 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:19:52.286876 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:19:52.289131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:52.807385 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m13:19:52.809116 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m13:19:53.159516 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b80cd5d6-6819-461f-a403-6de98123819d&page=queryresults
[0m13:19:55.354341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139812dc0>]}
[0m13:19:55.355291 [info ] [Thread-1  ]: 3 of 3 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 735.7 KiB processed)[0m in 3.07s]
[0m13:19:55.356087 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:19:55.357466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:55.357891 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:19:55.358368 [info ] [MainThread]: 
[0m13:19:55.358763 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.64 seconds (12.64s).
[0m13:19:55.359959 [debug] [MainThread]: Command end result
[0m13:19:55.384249 [info ] [MainThread]: 
[0m13:19:55.384673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:55.384889 [info ] [MainThread]: 
[0m13:19:55.385075 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:19:55.386381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.535562, "process_user_time": 2.256592, "process_kernel_time": 2.63183, "process_mem_max_rss": "194691072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:55.386663 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:55.386618 after 13.54 seconds
[0m13:19:55.386860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138a94910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dc5b0>]}
[0m13:19:55.387040 [debug] [MainThread]: Flushing usage events
[0m13:20:23.358753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d34ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d2df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d2fd0>]}


============================== 13:20:23.361484 | 2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8 ==============================
[0m13:20:23.361484 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:20:23.361807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:20:24.072934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104290d90>]}
[0m13:20:24.098685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042951c0>]}
[0m13:20:24.098970 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:20:24.110788 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:20:24.186551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:24.186782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:24.206998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b6e7130>]}
[0m13:20:24.217396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b70bcd0>]}
[0m13:20:24.217652 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:20:24.217847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b70bca0>]}
[0m13:20:24.218677 [info ] [MainThread]: 
[0m13:20:24.218975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:24.221233 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_stock_analysis'
[0m13:20:24.221438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:24.698753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b626040>]}
[0m13:20:24.700132 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:20:24.700635 [info ] [MainThread]: 
[0m13:20:24.705548 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:20:24.706386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:20:24.706990 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:20:24.720536 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:20:24.721547 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:20:24.722253 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:20:24.722601 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.723269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:20:24.723799 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.728912 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:20:24.729597 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.730171 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.730487 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:20:24.730800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:20:24.731057 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:20:24.774301 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:20:24.775008 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:20:24.775452 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:20:24.775864 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.776222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:20:24.776521 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.778429 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:20:24.778816 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.779164 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.779499 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:20:24.779751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:20:24.779943 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:20:24.781600 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:20:24.781991 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:20:24.782344 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:20:24.782756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:24.782911 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:20:24.783491 [debug] [MainThread]: Command end result
[0m13:20:24.837704 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:20:24.837876 [info ] [MainThread]: Building catalog
[0m13:20:24.840648 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m13:20:24.852047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:24.910390 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock_analysis`.__TABLES__ tables
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('spy_2014_2024')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:20:25.507388 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cce45fc4-42db-403f-9e63-ce901f9cf701&page=queryresults
[0m13:20:27.383588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:27.454153 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock`.__TABLES__ tables
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('400_years_of_generated_dates_and_holidays')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:20:28.170630 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06705e22-506d-471d-8ba4-0b0c33bbd941&page=queryresults
[0m13:20:30.021517 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/stock_analysis/target/catalog.json
[0m13:20:30.022792 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.711782, "process_user_time": 2.816343, "process_kernel_time": 2.010984, "process_mem_max_rss": "196935680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:20:30.023131 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:20:30.023082 after 6.71 seconds
[0m13:20:30.023307 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:20:30.023445 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m13:20:30.023607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d34ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b964d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10425b940>]}
[0m13:20:30.023796 [debug] [MainThread]: Flushing usage events
[0m14:18:37.063643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053842b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053840d0>]}


============================== 14:18:37.066361 | b47513a1-49fa-4865-a775-db9cfffab142 ==============================
[0m14:18:37.066361 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:18:37.066676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_calendar', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:37.817239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e9990a0>]}
[0m14:18:37.843104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e9e0610>]}
[0m14:18:37.843387 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:18:37.855313 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:18:37.931737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:37.932077 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m14:18:38.088744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ede2130>]}
[0m14:18:38.143226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ede2490>]}
[0m14:18:38.143497 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:18:38.143689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f104d00>]}
[0m14:18:38.144207 [info ] [MainThread]: 
[0m14:18:38.144471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:18:38.144929 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:18:38.145130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:38.857627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:18:38.858353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:39.357596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea647f0>]}
[0m14:18:39.358054 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:18:39.358316 [info ] [MainThread]: 
[0m14:18:39.360290 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:18:39.360726 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:18:39.361092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m14:18:39.361372 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:18:39.368652 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:18:39.370157 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:18:39.381568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:18:39.888261 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:18:39.890354 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    *

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:18:40.337573 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9270ecb0-7b3f-4f79-aff6-8d03321ca26c&page=queryresults
[0m14:18:40.476046 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: month_start; Did you mean is_month_start? at [36:122]; reason: invalidQuery, location: query, message: Unrecognized name: month_start; Did you mean is_month_start? at [36:122]')
[0m14:18:41.409348 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2eb92f7e-5ce0-49aa-995d-5e7fff230329&page=queryresults
[0m14:18:41.614799 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2eb92f7e-5ce0-49aa-995d-5e7fff230329&page=queryresults
[0m14:18:41.658710 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Unrecognized name: month_start; Did you mean is_month_start? at [36:122]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:18:41.659823 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1d2fd0>]}
[0m14:18:41.660260 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 2.30s]
[0m14:18:41.662049 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:18:41.662785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:41.662978 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m14:18:41.663180 [info ] [MainThread]: 
[0m14:18:41.663376 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m14:18:41.663755 [debug] [MainThread]: Command end result
[0m14:18:41.684920 [info ] [MainThread]: 
[0m14:18:41.685289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:18:41.685500 [info ] [MainThread]: 
[0m14:18:41.685764 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Unrecognized name: month_start; Did you mean is_month_start? at [36:122]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:18:41.685944 [info ] [MainThread]: 
[0m14:18:41.686128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:18:41.687987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6759763, "process_user_time": 2.117748, "process_kernel_time": 2.783078, "process_mem_max_rss": "194691072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:18:41.688319 [debug] [MainThread]: Command `dbt run` failed at 14:18:41.688267 after 4.68 seconds
[0m14:18:41.688537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e9e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456f910>]}
[0m14:18:41.688749 [debug] [MainThread]: Flushing usage events
[0m14:19:45.839481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d31340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d31160>]}


============================== 14:19:45.842727 | b6a88783-a78a-4793-8275-3aebacfa912f ==============================
[0m14:19:45.842727 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:19:45.843042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_calendar', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:46.587093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d12580>]}
[0m14:19:46.613560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412ba2b0>]}
[0m14:19:46.613877 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:19:46.625782 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:19:46.701613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:46.701957 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m14:19:46.858408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429a3130>]}
[0m14:19:46.912046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429d6c10>]}
[0m14:19:46.912315 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:19:46.912500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429c1d30>]}
[0m14:19:46.913039 [info ] [MainThread]: 
[0m14:19:46.913313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:19:46.913780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:19:46.913982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:47.567652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:19:47.568405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:48.044192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429c1d30>]}
[0m14:19:48.045539 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:19:48.046038 [info ] [MainThread]: 
[0m14:19:48.050860 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:19:48.051681 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:19:48.052266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m14:19:48.053067 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:19:48.064483 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:19:48.066376 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:19:48.081067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:48.604922 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:19:48.606229 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    *

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:19:48.954931 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d1cd1a4b-513c-4013-8e1b-19719120dfcd&page=queryresults
[0m14:19:49.113246 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name is_workday at [13:7]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name is_workday at [13:7]')
[0m14:19:50.016981 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12fe32d7-0fe1-4e4e-983f-d3acbc01cfed&page=queryresults
[0m14:19:50.134771 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12fe32d7-0fe1-4e4e-983f-d3acbc01cfed&page=queryresults
[0m14:19:50.180804 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  CREATE TABLE has columns with duplicate name is_workday at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:19:50.182245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142b91e50>]}
[0m14:19:50.182760 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 2.13s]
[0m14:19:50.184593 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:19:50.185481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:50.185703 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m14:19:50.185912 [info ] [MainThread]: 
[0m14:19:50.186136 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m14:19:50.186553 [debug] [MainThread]: Command end result
[0m14:19:50.209188 [info ] [MainThread]: 
[0m14:19:50.209528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:19:50.209707 [info ] [MainThread]: 
[0m14:19:50.209931 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  CREATE TABLE has columns with duplicate name is_workday at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:19:50.210102 [info ] [MainThread]: 
[0m14:19:50.210278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:19:50.211568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4222584, "process_user_time": 2.230652, "process_kernel_time": 2.711803, "process_mem_max_rss": "197378048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:19:50.211874 [debug] [MainThread]: Command `dbt run` failed at 14:19:50.211821 after 4.42 seconds
[0m14:19:50.212079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428f9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142b73fa0>]}
[0m14:19:50.212278 [debug] [MainThread]: Flushing usage events
[0m14:20:31.879806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b85160>]}


============================== 14:20:31.882301 | 13742e0d-d21c-48b9-b916-ed27991ece13 ==============================
[0m14:20:31.882301 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:20:31.882610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_calendar', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:32.605745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b66580>]}
[0m14:20:32.633590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c7a2b0>]}
[0m14:20:32.633948 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:20:32.646530 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:20:32.718926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:32.719342 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m14:20:32.874720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146862130>]}
[0m14:20:32.927738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146896c10>]}
[0m14:20:32.928000 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:20:32.928193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146881d30>]}
[0m14:20:32.928723 [info ] [MainThread]: 
[0m14:20:32.928980 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:20:32.929443 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:20:32.929653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:33.492459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:20:33.493426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:34.004734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146881d30>]}
[0m14:20:34.006039 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:20:34.006974 [info ] [MainThread]: 
[0m14:20:34.011119 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:20:34.011968 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:20:34.012628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m14:20:34.013171 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:20:34.024887 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:20:34.025881 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:20:34.040000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:20:34.572589 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:20:34.573955 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:20:34.971310 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a7bf258b-52b5-484c-9143-07346e28a4f9&page=queryresults
[0m14:20:39.846402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379816a0>]}
[0m14:20:39.848292 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 5.83s]
[0m14:20:39.848892 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:20:39.850256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:39.850713 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m14:20:39.851012 [info ] [MainThread]: 
[0m14:20:39.851317 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m14:20:39.851928 [debug] [MainThread]: Command end result
[0m14:20:39.878309 [info ] [MainThread]: 
[0m14:20:39.878694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:39.878908 [info ] [MainThread]: 
[0m14:20:39.879125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:20:39.880537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.049746, "process_user_time": 2.198981, "process_kernel_time": 2.662558, "process_mem_max_rss": "194822144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:20:39.880891 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:39.880831 after 8.05 seconds
[0m14:20:39.881138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c7a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063707c0>]}
[0m14:20:39.881365 [debug] [MainThread]: Flushing usage events
[0m14:21:10.744028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10398dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10398dee0>]}


============================== 14:21:10.746898 | 5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702 ==============================
[0m14:21:10.746898 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:21:10.747255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:21:11.641570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10367aa00>]}
[0m14:21:11.670916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1534ecc70>]}
[0m14:21:11.671365 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:21:11.684176 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:21:11.769720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:11.770020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:11.792451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153966130>]}
[0m14:21:11.895952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1537ecc70>]}
[0m14:21:11.896320 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:21:11.896512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153941a00>]}
[0m14:21:11.897315 [info ] [MainThread]: 
[0m14:21:11.897641 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:21:11.900180 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:21:11.900411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:12.430857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:21:12.433120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:12.929218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1536a9be0>]}
[0m14:21:12.930186 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:21:12.930661 [info ] [MainThread]: 
[0m14:21:12.934649 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m14:21:12.935100 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m14:21:12.935635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m14:21:12.936381 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m14:21:12.948072 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m14:21:12.949443 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m14:21:12.962290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:13.487545 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m14:21:13.489712 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m14:21:13.881244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b23d110f-e452-4c94-a943-2cdcf102414c&page=queryresults
[0m14:21:17.230894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15371ad90>]}
[0m14:21:17.231380 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.29s]
[0m14:21:17.231781 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m14:21:17.232032 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m14:21:17.232400 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m14:21:17.232769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m14:21:17.232988 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m14:21:17.234927 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m14:21:17.235423 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m14:21:17.237349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:17.735833 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m14:21:17.738230 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m14:21:18.182145 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:00d67d8f-145a-43bd-a58e-76c2b8fd9fc0&page=queryresults
[0m14:21:20.099290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f8eb0>]}
[0m14:21:20.100724 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.87s]
[0m14:21:20.101614 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m14:21:20.102216 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:21:20.103027 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:21:20.103708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m14:21:20.104258 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:21:20.107454 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:21:20.109406 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:21:20.113154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:20.614428 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:21:20.617244 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:21:21.048298 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5aeffbad-9a97-48c5-89c1-7a3221869660&page=queryresults
[0m14:21:24.683616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036290a0>]}
[0m14:21:24.684807 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 4.58s]
[0m14:21:24.685711 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:21:24.686895 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m14:21:24.687616 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m14:21:24.688389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m14:21:24.689118 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m14:21:24.693749 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m14:21:24.694726 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m14:21:24.696882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:25.172789 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m14:21:25.174508 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m14:21:25.575675 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:71b6438d-1618-4593-aa9a-4a6f32c343f4&page=queryresults
[0m14:21:28.318045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a4c910>]}
[0m14:21:28.319465 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.1 MiB processed)[0m in 3.63s]
[0m14:21:28.320382 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m14:21:28.321409 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m14:21:28.322032 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m14:21:28.322581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m14:21:28.323067 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m14:21:28.326640 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m14:21:28.328085 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m14:21:28.330345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:28.931763 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m14:21:28.933387 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m14:21:29.294470 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d218cd17-c1a0-432a-83c6-124748968b62&page=queryresults
[0m14:21:31.145810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a4c100>]}
[0m14:21:31.147225 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 750.5 KiB processed)[0m in 2.82s]
[0m14:21:31.148468 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m14:21:31.150639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:31.151140 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m14:21:31.151720 [info ] [MainThread]: 
[0m14:21:31.152163 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.25 seconds (19.25s).
[0m14:21:31.154164 [debug] [MainThread]: Command end result
[0m14:21:31.188628 [info ] [MainThread]: 
[0m14:21:31.189043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:31.189280 [info ] [MainThread]: 
[0m14:21:31.189532 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:21:31.191202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.49632, "process_user_time": 2.750206, "process_kernel_time": 2.729367, "process_mem_max_rss": "191184896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:21:31.191598 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:31.191540 after 20.50 seconds
[0m14:21:31.191865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103370a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a553d0>]}
[0m14:21:31.192114 [debug] [MainThread]: Flushing usage events
[0m19:01:08.221462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025f5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104281370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104281190>]}


============================== 19:01:08.224257 | 19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c ==============================
[0m19:01:08.224257 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:01:08.224587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select base_calendar+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:01:08.941510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041067c0>]}
[0m19:01:08.967511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1528f0a30>]}
[0m19:01:08.967807 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:01:08.979641 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:01:09.055856 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m19:01:09.056202 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_final/stock_analysis.sql
[0m19:01:09.056357 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_final/spy_2014_2024.sql
[0m19:01:09.056557 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m19:01:09.056736 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:01:09.212363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d3ba30>]}
[0m19:01:09.266973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104106f40>]}
[0m19:01:09.267235 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:01:09.267415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d306d0>]}
[0m19:01:09.268028 [info ] [MainThread]: 
[0m19:01:09.268301 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:01:09.270477 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:01:09.270688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:09.843180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:01:09.844098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:10.199924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410a580>]}
[0m19:01:10.201885 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:01:10.202460 [info ] [MainThread]: 
[0m19:01:10.207466 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m19:01:10.208393 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m19:01:10.209034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m19:01:10.209457 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m19:01:10.220542 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m19:01:10.221462 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m19:01:10.235984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:10.620249 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m19:01:10.621291 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m19:01:11.074350 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ef954c48-772a-4c09-9e63-bfca0cdabcbb&page=queryresults
[0m19:01:14.550089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152201610>]}
[0m19:01:14.550837 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.34s]
[0m19:01:14.551404 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m19:01:14.552155 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m19:01:14.552626 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m19:01:14.553003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.stg_calendar)
[0m19:01:14.553295 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m19:01:14.556542 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m19:01:14.558690 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m19:01:14.560859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:14.949601 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m19:01:14.952453 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m19:01:15.340220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fea4ccab-96d4-4e86-bd9f-1087ce6774da&page=queryresults
[0m19:01:19.596630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153219460>]}
[0m19:01:19.597836 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 5.04s]
[0m19:01:19.598884 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m19:01:19.600888 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:01:19.601999 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:01:19.602807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m19:01:19.603261 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:01:19.608719 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:01:19.609833 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:01:19.613191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:20.014441 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:01:20.016181 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

-- , weekly_stats as 
-- (
--     select 
        
--         , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
--     from spy_2014_2024
--     left join calendar using (date)
-- )


select
    base.*
    , daily_stats.avg_daily_price

from base
left join daily_stats using (date)
    );
  
[0m19:01:20.453165 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8aeeee7c-6e64-478d-8ee8-9d1c039d6aaa&page=queryresults
[0m19:01:23.206702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531cff70>]}
[0m19:01:23.209061 [info ] [Thread-1  ]: 3 of 4 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 3.60s]
[0m19:01:23.209883 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:01:23.210910 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m19:01:23.211437 [info ] [Thread-1  ]: 4 of 4 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m19:01:23.211889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.stock_analysis)
[0m19:01:23.212419 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m19:01:23.216167 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m19:01:23.217607 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m19:01:23.223585 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m19:01:23.224298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:23.301162 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- with

-- spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )

-- select
-- *
-- from spy_2014_2024
    );
  
[0m19:01:23.598275 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:74763476-ad72-4eb0-abd4-1d7dfe6b39d7&page=queryresults
[0m19:01:23.600251 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [20:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [20:5]')
[0m19:01:24.369025 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a2c54d75-4eb9-4a6e-ac97-cc7e5def095c&page=queryresults
[0m19:01:24.371101 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a2c54d75-4eb9-4a6e-ac97-cc7e5def095c&page=queryresults
[0m19:01:24.419020 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/3_final/stock_analysis.sql)
  Syntax error: Unexpected ")" at [20:5]
  compiled Code at target/run/stock_analysis/models/3_final/stock_analysis.sql
[0m19:01:24.419474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531cff70>]}
[0m19:01:24.419970 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 1.21s]
[0m19:01:24.420385 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m19:01:24.421160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:24.421353 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m19:01:24.421588 [info ] [MainThread]: 
[0m19:01:24.421794 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.15 seconds (15.15s).
[0m19:01:24.422490 [debug] [MainThread]: Command end result
[0m19:01:24.448193 [info ] [MainThread]: 
[0m19:01:24.448549 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:24.448742 [info ] [MainThread]: 
[0m19:01:24.449034 [error] [MainThread]:   Database Error in model stock_analysis (models/3_final/stock_analysis.sql)
  Syntax error: Unexpected ")" at [20:5]
  compiled Code at target/run/stock_analysis/models/3_final/stock_analysis.sql
[0m19:01:24.449235 [info ] [MainThread]: 
[0m19:01:24.449426 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:01:24.451254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.279663, "process_user_time": 2.554413, "process_kernel_time": 2.681144, "process_mem_max_rss": "196182016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:01:24.451603 [debug] [MainThread]: Command `dbt run` failed at 19:01:24.451549 after 16.28 seconds
[0m19:01:24.451827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025f5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b68a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15321d700>]}
[0m19:01:24.452042 [debug] [MainThread]: Flushing usage events
[0m19:03:58.127403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fccac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059443a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059441c0>]}


============================== 19:03:58.129809 | 01956f78-409a-4bb6-a7f1-5bf68e755365 ==============================
[0m19:03:58.129809 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:03:58.130142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:03:58.621814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a25a430>]}
[0m19:03:58.647604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105780ac0>]}
[0m19:03:58.647897 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:03:58.660011 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:03:58.733305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:03:58.733670 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:03:58.886659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a6a0130>]}
[0m19:03:58.939981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a5b6b80>]}
[0m19:03:58.940256 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:03:58.940443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a6e2d60>]}
[0m19:03:58.940972 [info ] [MainThread]: 
[0m19:03:58.941254 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:58.941726 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:03:58.941927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:59.417052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:03:59.417870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:59.773049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a6e2d60>]}
[0m19:03:59.774234 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:03:59.774718 [info ] [MainThread]: 
[0m19:03:59.778642 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:03:59.779495 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:03:59.780186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:03:59.780702 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:03:59.791364 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:03:59.792146 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:03:59.805831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:00.271827 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:04:00.272811 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(((open + close_last + high + low)/4.00),2) as avg_weekly_price
    from base
    group by 1,2
    -- order by 1,2
)


select
    base.*
    , daily_stats.avg_daily_price
    , weekly_stats.avg_weekly_price
from base
left join daily_stats using (date)
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:04:00.752115 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:37730258-a91f-4a6d-85fd-60668e1c6c9a&page=queryresults
[0m19:04:00.882760 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column open which is neither grouped nor aggregated at [40:19]; reason: invalidQuery, location: query, message: SELECT list expression references column open which is neither grouped nor aggregated at [40:19]')
[0m19:04:01.978993 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4d6f8328-e454-4bf0-a52c-e27504d96db6&page=queryresults
[0m19:04:02.078096 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4d6f8328-e454-4bf0-a52c-e27504d96db6&page=queryresults
[0m19:04:02.109866 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  SELECT list expression references column open which is neither grouped nor aggregated at [40:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:04:02.111125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a98dd90>]}
[0m19:04:02.111651 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.33s]
[0m19:04:02.112096 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:04:02.114659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:02.114899 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:04:02.115084 [info ] [MainThread]: 
[0m19:04:02.115261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m19:04:02.115618 [debug] [MainThread]: Command end result
[0m19:04:02.134880 [info ] [MainThread]: 
[0m19:04:02.135178 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:04:02.135347 [info ] [MainThread]: 
[0m19:04:02.135559 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  SELECT list expression references column open which is neither grouped nor aggregated at [40:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:04:02.135721 [info ] [MainThread]: 
[0m19:04:02.135887 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:04:02.137144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.056911, "process_user_time": 1.956265, "process_kernel_time": 2.709404, "process_mem_max_rss": "194805760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:04:02.137446 [debug] [MainThread]: Command `dbt run` failed at 19:04:02.137399 after 4.06 seconds
[0m19:04:02.137661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fccac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105780ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2abaf0>]}
[0m19:04:02.137859 [debug] [MainThread]: Flushing usage events
[0m19:06:43.699249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104819a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190190>]}


============================== 19:06:43.702138 | 4b6ab590-e294-4051-b86b-993f68443d64 ==============================
[0m19:06:43.702138 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:06:43.702468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:06:44.412416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060167c0>]}
[0m19:06:44.438024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4f0a30>]}
[0m19:06:44.438305 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:06:44.449260 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:06:44.524685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:06:44.525064 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:06:44.678506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9e0f70>]}
[0m19:06:44.732644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5e4df0>]}
[0m19:06:44.732905 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:06:44.733090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c92c7f0>]}
[0m19:06:44.733611 [info ] [MainThread]: 
[0m19:06:44.733868 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:06:44.734329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:06:44.734535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:45.177709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:06:45.178378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:45.555489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5e4df0>]}
[0m19:06:45.556439 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:06:45.556931 [info ] [MainThread]: 
[0m19:06:45.560984 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:06:45.561661 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:06:45.562246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:06:45.562779 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:06:45.573357 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:06:45.574416 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:06:45.587983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:06:45.966365 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:06:45.967348 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
    -- order by 1,2
)


select
    base.*
    , daily_stats.avg_daily_price
    , weekly_stats.avg_weekly_price
from base
left join daily_stats using (date)
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:06:46.337577 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:451b0197-089e-44d0-9c00-809168eb8ccf&page=queryresults
[0m19:06:46.461105 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: avg_daily_price at [40:21]; reason: invalidQuery, location: query, message: Unrecognized name: avg_daily_price at [40:21]')
[0m19:06:47.257402 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1206b907-8e89-46c2-9813-516997272aaf&page=queryresults
[0m19:06:47.363791 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1206b907-8e89-46c2-9813-516997272aaf&page=queryresults
[0m19:06:47.410766 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price at [40:21]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:06:47.412153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cccdd00>]}
[0m19:06:47.412640 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.85s]
[0m19:06:47.413048 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:06:47.415288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:47.415492 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:06:47.415693 [info ] [MainThread]: 
[0m19:06:47.415900 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m19:06:47.416320 [debug] [MainThread]: Command end result
[0m19:06:47.438820 [info ] [MainThread]: 
[0m19:06:47.439238 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:06:47.439461 [info ] [MainThread]: 
[0m19:06:47.439700 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price at [40:21]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:06:47.439872 [info ] [MainThread]: 
[0m19:06:47.440051 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:06:47.441454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7912774, "process_user_time": 2.072333, "process_kernel_time": 2.719325, "process_mem_max_rss": "195657728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:06:47.441793 [debug] [MainThread]: Command `dbt run` failed at 19:06:47.441738 after 3.79 seconds
[0m19:06:47.442027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104819a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060167c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c954eb0>]}
[0m19:06:47.442239 [debug] [MainThread]: Flushing usage events
[0m19:07:31.205670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065810d0>]}


============================== 19:07:31.207750 | 80214012-848b-437c-8b16-c1e235ce0880 ==============================
[0m19:07:31.207750 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:07:31.208100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:07:31.749237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1445190a0>]}
[0m19:07:31.777940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144560610>]}
[0m19:07:31.778384 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:07:31.791227 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:07:31.869338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:07:31.869752 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:07:32.035801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b5f130>]}
[0m19:07:32.096236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b95730>]}
[0m19:07:32.096594 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:07:32.096790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ba2d00>]}
[0m19:07:32.097466 [info ] [MainThread]: 
[0m19:07:32.097875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:07:32.098553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:07:32.098797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:32.511832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:07:32.512895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:32.884769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ba2d00>]}
[0m19:07:32.886083 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:07:32.887005 [info ] [MainThread]: 
[0m19:07:32.891048 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:07:32.891733 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:07:32.892400 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:07:32.893019 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:07:32.903659 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:07:32.904704 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:07:32.918000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:07:33.278181 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:07:33.278985 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from daily_stats
    group by 1,2
    -- order by 1,2
)


select
    base.*
    , daily_stats.avg_daily_price
    , weekly_stats.avg_weekly_price
from base
left join daily_stats using (date)
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:07:33.666763 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5eccb5c2-b053-4bf4-8d79-802c892bee2b&page=queryresults
[0m19:07:33.780428 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: year_full at [38:9]; reason: invalidQuery, location: query, message: Unrecognized name: year_full at [38:9]')
[0m19:07:34.770704 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0abc815-ad1e-4c1c-ac00-58e9219a0cd0&page=queryresults
[0m19:07:34.868281 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0abc815-ad1e-4c1c-ac00-58e9219a0cd0&page=queryresults
[0m19:07:34.909785 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:07:34.911118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c50d00>]}
[0m19:07:34.911625 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.02s]
[0m19:07:34.912058 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:07:34.914354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:34.914552 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:07:34.914746 [info ] [MainThread]: 
[0m19:07:34.914952 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m19:07:34.915362 [debug] [MainThread]: Command end result
[0m19:07:34.937906 [info ] [MainThread]: 
[0m19:07:34.938246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:07:34.938427 [info ] [MainThread]: 
[0m19:07:34.938658 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:07:34.938834 [info ] [MainThread]: 
[0m19:07:34.939015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:07:34.940726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7810855, "process_user_time": 2.75337, "process_kernel_time": 1.667851, "process_mem_max_rss": "198311936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:07:34.941077 [debug] [MainThread]: Command `dbt run` failed at 19:07:34.941025 after 3.78 seconds
[0m19:07:34.941306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b95670>]}
[0m19:07:34.941519 [debug] [MainThread]: Flushing usage events
[0m19:14:58.722733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d10b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036892b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036890d0>]}


============================== 19:14:58.725650 | 3e9008e3-e082-4a27-b29d-b6e63f4314b6 ==============================
[0m19:14:58.725650 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:14:58.725975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:14:59.469858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1521d90a0>]}
[0m19:14:59.496021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152320610>]}
[0m19:14:59.496329 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:14:59.508079 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:14:59.585597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:14:59.585986 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:14:59.739967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15311f130>]}
[0m19:14:59.794071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153155730>]}
[0m19:14:59.794349 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:14:59.794538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153162d00>]}
[0m19:14:59.795061 [info ] [MainThread]: 
[0m19:14:59.795332 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:14:59.795785 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:14:59.795989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:00.222759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:15:00.223652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:00.591171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153162d00>]}
[0m19:15:00.592758 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:15:00.593432 [info ] [MainThread]: 
[0m19:15:00.597479 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:15:00.598124 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:15:00.598704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:15:00.599174 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:15:00.609243 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:15:00.609998 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:15:00.624167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:15:01.021900 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:15:01.024001 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from daily_stats
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:15:01.465550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ea849c19-24af-45ef-8dcf-77b362bc79d9&page=queryresults
[0m19:15:01.578344 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: year_full at [38:9]; reason: invalidQuery, location: query, message: Unrecognized name: year_full at [38:9]')
[0m19:15:02.482080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0fc713f-d642-475c-b655-fd40a1279e34&page=queryresults
[0m19:15:02.614132 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0fc713f-d642-475c-b655-fd40a1279e34&page=queryresults
[0m19:15:02.652351 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:15:02.653693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153510e80>]}
[0m19:15:02.654203 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.05s]
[0m19:15:02.654634 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:15:02.656929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:02.657180 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:15:02.657398 [info ] [MainThread]: 
[0m19:15:02.657637 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m19:15:02.658072 [debug] [MainThread]: Command end result
[0m19:15:02.678124 [info ] [MainThread]: 
[0m19:15:02.678409 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:15:02.678573 [info ] [MainThread]: 
[0m19:15:02.678776 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:15:02.678934 [info ] [MainThread]: 
[0m19:15:02.679111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:15:02.680630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.008225, "process_user_time": 2.079806, "process_kernel_time": 2.792737, "process_mem_max_rss": "194674688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:02.680909 [debug] [MainThread]: Command `dbt run` failed at 19:15:02.680862 after 4.01 seconds
[0m19:15:02.681119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d10b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103077910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531673d0>]}
[0m19:15:02.681310 [debug] [MainThread]: Flushing usage events
[0m19:17:50.948346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d19a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105691370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105691190>]}


============================== 19:17:50.951284 | 84724ac4-50d7-4e55-8ef7-ac6254666bab ==============================
[0m19:17:50.951284 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:17:50.951596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:17:51.671983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055167c0>]}
[0m19:17:51.699817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddb0a30>]}
[0m19:17:51.700489 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:17:51.712212 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:17:51.788722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:51.789130 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:17:51.956493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3a0f70>]}
[0m19:17:52.014374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfa4df0>]}
[0m19:17:52.014687 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:17:52.014879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2ec7f0>]}
[0m19:17:52.015426 [info ] [MainThread]: 
[0m19:17:52.015709 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:17:52.016189 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:17:52.016393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:52.452273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:17:52.452921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:52.810815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfa4df0>]}
[0m19:17:52.812160 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:17:52.812657 [info ] [MainThread]: 
[0m19:17:52.817766 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:17:52.818614 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:17:52.819225 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:17:52.820178 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:17:52.831207 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:17:52.832426 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:17:52.847007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:17:53.235030 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:17:53.235688 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from daily_stats
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:17:53.396501 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0266ef64-933f-4d7a-9a6b-d0d3d96b6dc8&page=queryresults
[0m19:17:53.397917 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: daily_stats, message: Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).')
[0m19:17:54.230587 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c5c7077c-3c69-4eca-97f5-81eb2d532833&page=queryresults
[0m19:17:54.232001 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c5c7077c-3c69-4eca-97f5-81eb2d532833&page=queryresults
[0m19:17:54.274512 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:17:54.275810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c690d30>]}
[0m19:17:54.276274 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.46s]
[0m19:17:54.276678 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:17:54.277448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:54.277667 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:17:54.277875 [info ] [MainThread]: 
[0m19:17:54.278085 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m19:17:54.278512 [debug] [MainThread]: Command end result
[0m19:17:54.302866 [info ] [MainThread]: 
[0m19:17:54.303209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:17:54.303387 [info ] [MainThread]: 
[0m19:17:54.303615 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:17:54.303783 [info ] [MainThread]: 
[0m19:17:54.303968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:17:54.305326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4115396, "process_user_time": 2.05433, "process_kernel_time": 2.765938, "process_mem_max_rss": "195543040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:17:54.305636 [debug] [MainThread]: Command `dbt run` failed at 19:17:54.305586 after 3.41 seconds
[0m19:17:54.305864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d19a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddb0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508ddc0>]}
[0m19:17:54.306069 [debug] [MainThread]: Flushing usage events
[0m19:18:14.708605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083993a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083991c0>]}


============================== 19:18:14.710762 | 0f9c6648-298d-45d3-b3ea-4b8f4510acea ==============================
[0m19:18:14.710762 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:18:14.711099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:18:15.185820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e41a430>]}
[0m19:18:15.213704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d65e0>]}
[0m19:18:15.214149 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:18:15.226124 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:18:15.303211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:15.303670 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:18:15.474187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea60130>]}
[0m19:18:15.530452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e976b80>]}
[0m19:18:15.530811 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:18:15.531008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaa0d60>]}
[0m19:18:15.531585 [info ] [MainThread]: 
[0m19:18:15.531886 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:18:15.532397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:18:15.532623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:15.944182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:18:15.944864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:16.299907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaa0d60>]}
[0m19:18:16.301235 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:18:16.301740 [info ] [MainThread]: 
[0m19:18:16.306261 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:18:16.307349 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:18:16.308162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:18:16.308648 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:18:16.319940 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:18:16.321180 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:18:16.336288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:16.714879 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:18:16.715585 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:18:17.076623 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ab5bd936-c352-4edc-92dc-64d3d097566b&page=queryresults
[0m19:18:20.425251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f581670>]}
[0m19:18:20.425957 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.12s]
[0m19:18:20.426520 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:18:20.427607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:20.427846 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:18:20.428066 [info ] [MainThread]: 
[0m19:18:20.428326 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m19:18:20.428827 [debug] [MainThread]: Command end result
[0m19:18:20.454310 [info ] [MainThread]: 
[0m19:18:20.454664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:20.454856 [info ] [MainThread]: 
[0m19:18:20.455054 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:18:20.456471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7953634, "process_user_time": 2.079592, "process_kernel_time": 2.599888, "process_mem_max_rss": "197984256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:18:20.456806 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:20.456750 after 5.80 seconds
[0m19:18:20.457057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaa0d60>]}
[0m19:18:20.457275 [debug] [MainThread]: Flushing usage events
[0m19:22:23.704206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104768af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e1130>]}


============================== 19:22:23.706961 | 098b567e-bc24-4348-ae40-f9606e237afe ==============================
[0m19:22:23.706961 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:22:23.707273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:22:24.415810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1ca60>]}
[0m19:22:24.441483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b8220>]}
[0m19:22:24.441768 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:22:24.452692 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:22:24.527897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:24.528349 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:22:24.682464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd20130>]}
[0m19:22:24.737679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb0fa00>]}
[0m19:22:24.737949 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:22:24.738141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e2d00>]}
[0m19:22:24.738674 [info ] [MainThread]: 
[0m19:22:24.738944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:22:24.739418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:22:24.739619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:25.157017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:22:25.157719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:25.508847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b935730>]}
[0m19:22:25.510036 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:22:25.510529 [info ] [MainThread]: 
[0m19:22:25.515570 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:22:25.516528 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:22:25.517244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:22:25.517839 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:22:25.529255 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:25.530511 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:22:25.544711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:22:25.948455 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:25.950561 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_stats as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
left join weekly_stats using (year_full,month_number)
    );
  
[0m19:22:26.302092 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1de9f8e2-f134-4866-bb1b-0393baf788b4&page=queryresults
[0m19:22:26.409996 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column month_number in USING clause not found on right side of join at [53:41]; reason: invalidQuery, location: query, message: Column month_number in USING clause not found on right side of join at [53:41]')
[0m19:22:35.864901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043052b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043050d0>]}


============================== 19:22:35.867479 | f84491b9-e4b8-41c6-97d3-27ea0c5a76c1 ==============================
[0m19:22:35.867479 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:22:35.867795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:22:36.376689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387d90a0>]}
[0m19:22:36.402485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138820610>]}
[0m19:22:36.402792 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:22:36.414891 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:22:36.487437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:36.487864 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:22:36.643394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d21130>]}
[0m19:22:36.695956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d55730>]}
[0m19:22:36.696236 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:22:36.696430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d62d00>]}
[0m19:22:36.696963 [info ] [MainThread]: 
[0m19:22:36.697236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:22:36.697692 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:22:36.697896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:37.102744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:22:37.103461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:37.569966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d62d00>]}
[0m19:22:37.571863 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:22:37.572773 [info ] [MainThread]: 
[0m19:22:37.576944 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:22:37.577937 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:22:37.578690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:22:37.579268 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:22:37.590569 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:37.591548 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:22:37.606161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:22:37.989139 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:37.990016 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_stats as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
left join monthly_stats using (year_full,month_number)
    );
  
[0m19:22:38.341870 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7539e525-99c6-496d-a641-d9d1f873c858&page=queryresults
[0m19:22:41.362016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380416d0>]}
[0m19:22:41.362775 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 3.78s]
[0m19:22:41.365439 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:22:41.366372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:41.366625 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:22:41.366873 [info ] [MainThread]: 
[0m19:22:41.367152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m19:22:41.367765 [debug] [MainThread]: Command end result
[0m19:22:41.393137 [info ] [MainThread]: 
[0m19:22:41.393484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:41.393696 [info ] [MainThread]: 
[0m19:22:41.393912 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:22:41.395348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.576778, "process_user_time": 1.977614, "process_kernel_time": 2.682998, "process_mem_max_rss": "195084288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:22:41.395677 [debug] [MainThread]: Command `dbt run` succeeded at 19:22:41.395623 after 5.58 seconds
[0m19:22:41.395908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cbcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041957f0>]}
[0m19:22:41.396127 [debug] [MainThread]: Flushing usage events
[0m19:43:33.162958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b31a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a9250>]}


============================== 19:43:33.165725 | 151c14a7-6d7b-4cc8-b2fa-fd1434749fc6 ==============================
[0m19:43:33.165725 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:43:33.166046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:33.726456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e2deb0>]}
[0m19:43:33.753467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e6ea60>]}
[0m19:43:33.753811 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:43:33.764770 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:43:33.839706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:43:33.840062 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:43:33.991450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125360130>]}
[0m19:43:34.045098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252bb160>]}
[0m19:43:34.045362 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:43:34.045549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12531bee0>]}
[0m19:43:34.046072 [info ] [MainThread]: 
[0m19:43:34.046334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:43:34.046784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:43:34.046983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:34.480041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:43:34.480897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:34.843241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253a26d0>]}
[0m19:43:34.844374 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:43:34.845299 [info ] [MainThread]: 
[0m19:43:34.849745 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:43:34.850453 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:43:34.851087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:43:34.851581 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:43:34.863097 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:43:34.864442 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:43:34.878898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:43:35.280283 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:43:35.281240 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


select
    *
    , daily_price_movement_by_week.avg_daily_price_movement_in_week
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_by_week using (year_full,month_number)
    );
  
[0m19:43:35.717826 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:339c1d85-8969-4598-9963-506c97eef7a7&page=queryresults
[0m19:43:36.052841 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: daily_price_movement at [75:18]; reason: invalidQuery, location: query, message: Unrecognized name: daily_price_movement at [75:18]')
[0m19:43:36.895213 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ff452f90-93b6-4284-a691-10ac525fc6df&page=queryresults
[0m19:43:36.996184 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ff452f90-93b6-4284-a691-10ac525fc6df&page=queryresults
[0m19:43:37.040275 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: daily_price_movement at [75:18]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:43:37.041670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128594df0>]}
[0m19:43:37.042188 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.19s]
[0m19:43:37.042678 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:43:37.045110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:37.045368 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:43:37.045576 [info ] [MainThread]: 
[0m19:43:37.045789 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m19:43:37.046234 [debug] [MainThread]: Command end result
[0m19:43:37.067732 [info ] [MainThread]: 
[0m19:43:37.068054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:43:37.068230 [info ] [MainThread]: 
[0m19:43:37.068450 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: daily_price_movement at [75:18]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:43:37.068620 [info ] [MainThread]: 
[0m19:43:37.068796 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:43:37.070277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9565184, "process_user_time": 2.002966, "process_kernel_time": 2.706955, "process_mem_max_rss": "195543040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:43:37.070584 [debug] [MainThread]: Command `dbt run` failed at 19:43:37.070533 after 3.96 seconds
[0m19:43:37.070807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b31a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e59ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253a0190>]}
[0m19:43:37.071010 [debug] [MainThread]: Flushing usage events
[0m19:46:37.066134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ef5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c80190>]}


============================== 19:46:37.068871 | 6a8eeac4-95b9-4ee4-b198-efe3bf921488 ==============================
[0m19:46:37.068871 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:46:37.069181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:46:37.576285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b067c0>]}
[0m19:46:37.602100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1362f0a30>]}
[0m19:46:37.602403 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:46:37.613466 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:46:37.695685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:46:37.696111 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:46:37.851168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450e0f70>]}
[0m19:46:37.904907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363e4df0>]}
[0m19:46:37.905173 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:46:37.905370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14502c7f0>]}
[0m19:46:37.905894 [info ] [MainThread]: 
[0m19:46:37.906154 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:37.906603 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:46:37.906808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:38.327916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:46:38.328595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:38.694501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363e4df0>]}
[0m19:46:38.697537 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:46:38.698126 [info ] [MainThread]: 
[0m19:46:38.701896 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:38.702934 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:46:38.704049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:46:38.704681 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:46:38.716840 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:38.717915 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:46:38.732986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:39.131739 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:39.132577 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from daily_price_movement_by_week
)


select
    *
    , daily_price_movement_in_week.avg_daily_price_movement_in_week
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,month_number)
    );
  
[0m19:46:39.485997 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5556a78c-a79d-4cea-bb27-ef6b097a5cc2&page=queryresults
[0m19:46:39.662459 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column month_number in USING clause not found on right side of join at [99:57]; reason: invalidQuery, location: query, message: Column month_number in USING clause not found on right side of join at [99:57]')
[0m19:46:40.790107 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26cd86e6-9505-4350-a343-462300e73755&page=queryresults
[0m19:46:40.883807 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26cd86e6-9505-4350-a343-462300e73755&page=queryresults
[0m19:46:40.932564 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Column month_number in USING clause not found on right side of join at [99:57]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:40.933970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453ccdf0>]}
[0m19:46:40.934460 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.23s]
[0m19:46:40.934895 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:40.937088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:40.937327 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:46:40.937528 [info ] [MainThread]: 
[0m19:46:40.937742 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m19:46:40.938154 [debug] [MainThread]: Command end result
[0m19:46:40.959258 [info ] [MainThread]: 
[0m19:46:40.959584 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:40.959766 [info ] [MainThread]: 
[0m19:46:40.959983 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Column month_number in USING clause not found on right side of join at [99:57]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:40.960152 [info ] [MainThread]: 
[0m19:46:40.960330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:46:40.961769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9466028, "process_user_time": 2.042285, "process_kernel_time": 2.65544, "process_mem_max_rss": "197246976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:40.962088 [debug] [MainThread]: Command `dbt run` failed at 19:46:40.962036 after 3.95 seconds
[0m19:46:40.962305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ef5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b067c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145054eb0>]}
[0m19:46:40.962501 [debug] [MainThread]: Flushing usage events
[0m19:46:55.088062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104175a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d05430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d05250>]}


============================== 19:46:55.090340 | a053834d-498e-4f73-8e0c-3b334d7a16f9 ==============================
[0m19:46:55.090340 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:46:55.090666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:46:55.541101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d8aeeb0>]}
[0m19:46:55.567127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d8efa60>]}
[0m19:46:55.567429 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:46:55.578200 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:46:55.644819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:46:55.645235 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:46:55.797243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dce0130>]}
[0m19:46:55.853278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc39160>]}
[0m19:46:55.853559 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:46:55.853752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc9bee0>]}
[0m19:46:55.854294 [info ] [MainThread]: 
[0m19:46:55.854565 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:55.855047 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:46:55.855254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:56.263113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:46:56.263845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:56.635777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dd226d0>]}
[0m19:46:56.636919 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:46:56.637436 [info ] [MainThread]: 
[0m19:46:56.641823 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:56.642830 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:46:56.643630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:46:56.644198 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:46:56.655868 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:56.656806 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:46:56.671037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:57.080101 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:57.081106 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from daily_price_movement_by_week
)


select
    *
    , daily_price_movement_in_week.avg_daily_price_movement_in_week
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
    );
  
[0m19:46:57.363872 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e01badb8-227e-4a7b-a5d9-cac60e960581&page=queryresults
[0m19:46:57.462959 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]')
[0m19:46:58.093878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cfd43049-9cd7-43b1-a894-81ad51891321&page=queryresults
[0m19:46:58.216290 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cfd43049-9cd7-43b1-a894-81ad51891321&page=queryresults
[0m19:46:58.263921 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:58.265334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ddd0c70>]}
[0m19:46:58.265957 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.62s]
[0m19:46:58.266367 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:58.267174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:58.267451 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:46:58.267667 [info ] [MainThread]: 
[0m19:46:58.267891 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m19:46:58.268320 [debug] [MainThread]: Command end result
[0m19:46:58.291967 [info ] [MainThread]: 
[0m19:46:58.292313 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:58.292503 [info ] [MainThread]: 
[0m19:46:58.292743 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:58.292922 [info ] [MainThread]: 
[0m19:46:58.293104 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:46:58.294365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2535346, "process_user_time": 2.100844, "process_kernel_time": 2.726821, "process_mem_max_rss": "198344704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:58.294671 [debug] [MainThread]: Command `dbt run` failed at 19:46:58.294621 after 3.25 seconds
[0m19:46:58.294896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104175a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d278040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc1a190>]}
[0m19:46:58.295100 [debug] [MainThread]: Flushing usage events
[0m19:47:21.376297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6d160>]}


============================== 19:47:21.378355 | 5bbdf47f-3bba-4aa2-b5d0-639f46e6346d ==============================
[0m19:47:21.378355 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:47:21.378687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:47:21.836100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4e580>]}
[0m19:47:21.861835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f67a2b0>]}
[0m19:47:21.862132 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:47:21.873718 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:47:21.946801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:47:21.947146 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:47:22.101225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8350a0>]}
[0m19:47:22.153988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fc2f490>]}
[0m19:47:22.154258 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:47:22.154451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbbd160>]}
[0m19:47:22.154973 [info ] [MainThread]: 
[0m19:47:22.155246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:22.155708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:47:22.155917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:49.909706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102500a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e79340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e79160>]}


============================== 19:47:49.912399 | b9f5b062-47ab-4fa7-b463-86dc8eaea02b ==============================
[0m19:47:49.912399 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:47:49.912730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:47:50.444315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102738640>]}
[0m19:47:50.471431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e10a60>]}
[0m19:47:50.471774 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:47:50.482621 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:47:50.557777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:50.558044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:50.578161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fe6130>]}
[0m19:47:50.668187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d78490>]}
[0m19:47:50.668497 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:47:50.668687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aeed90>]}
[0m19:47:50.669212 [info ] [MainThread]: 
[0m19:47:50.669498 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:50.669952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:47:50.670155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:51.069921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:47:51.070687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:51.423741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c17040>]}
[0m19:47:51.424909 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:47:51.425343 [info ] [MainThread]: 
[0m19:47:51.428884 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:47:51.429519 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:47:51.430086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:47:51.430669 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:47:51.444303 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:47:51.445512 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:47:51.460915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:51.869823 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:47:51.870818 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from daily_price_movement_by_week
)


select
    *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
    );
  
[0m19:47:52.264781 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4271dd36-3c81-4f5f-b736-4f60435e581f&page=queryresults
[0m19:47:55.298785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135fe2fd0>]}
[0m19:47:55.299453 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (12.2k rows, 37.6 MiB processed)[0m in 3.87s]
[0m19:47:55.299895 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:47:55.300654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:55.300850 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:47:55.301039 [info ] [MainThread]: 
[0m19:47:55.301233 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m19:47:55.301721 [debug] [MainThread]: Command end result
[0m19:47:55.326884 [info ] [MainThread]: 
[0m19:47:55.327274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:47:55.327456 [info ] [MainThread]: 
[0m19:47:55.327651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:47:55.329033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.46677, "process_user_time": 1.953955, "process_kernel_time": 2.600782, "process_mem_max_rss": "189054976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:47:55.329345 [debug] [MainThread]: Command `dbt run` succeeded at 19:47:55.329297 after 5.47 seconds
[0m19:47:55.329566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102500a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038687c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c15970>]}
[0m19:47:55.329767 [debug] [MainThread]: Flushing usage events
[0m21:26:19.999768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c51c0>]}


============================== 21:26:20.002605 | 02e58f60-0df9-4a33-ac04-e926ee386885 ==============================
[0m21:26:20.002605 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:26:20.002957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:20.548740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156cd9430>]}
[0m21:26:20.576791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086025e0>]}
[0m21:26:20.577194 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:26:20.588155 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:26:20.663314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:20.663699 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:26:20.817159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a3a0130>]}
[0m21:26:20.872779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a086b80>]}
[0m21:26:20.873050 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:26:20.873243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a3e3d60>]}
[0m21:26:20.873779 [info ] [MainThread]: 
[0m21:26:20.874049 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:26:20.874499 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:26:20.874705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:21.319693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:26:21.320503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:21.741172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a3e3d60>]}
[0m21:26:21.742183 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:26:21.742984 [info ] [MainThread]: 
[0m21:26:21.746707 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:26:21.747283 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:26:21.747791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:26:21.748150 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:26:21.757506 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:26:21.758265 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:26:21.770921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:26:22.184994 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:26:22.186026 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , avg_daily_price_week_end - avg_daily_price_week_start as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)






select
    *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
    );
  
[0m21:26:22.642765 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d453fe98-b346-4410-83ac-2181ea1abe85&page=queryresults
[0m21:26:26.323864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a490f70>]}
[0m21:26:26.324578 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (12.2k rows, 37.6 MiB processed)[0m in 4.58s]
[0m21:26:26.325104 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:26:26.325979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:26.326242 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:26:26.326480 [info ] [MainThread]: 
[0m21:26:26.326749 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m21:26:26.327286 [debug] [MainThread]: Command end result
[0m21:26:26.351271 [info ] [MainThread]: 
[0m21:26:26.351639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:26.351838 [info ] [MainThread]: 
[0m21:26:26.352053 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:26:26.353932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4069757, "process_user_time": 2.171312, "process_kernel_time": 2.508472, "process_mem_max_rss": "195215360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:26.354271 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:26.354212 after 6.41 seconds
[0m21:26:26.354493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086025e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107faf7c0>]}
[0m21:26:26.354707 [debug] [MainThread]: Flushing usage events
[0m21:27:53.668336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104319a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c91370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c91190>]}


============================== 21:27:53.670762 | b758b349-77d5-4229-9eb9-0003474f513b ==============================
[0m21:27:53.670762 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:27:53.671076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:54.179395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b167c0>]}
[0m21:27:54.205291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13676fa30>]}
[0m21:27:54.205578 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:27:54.216871 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:27:54.290817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:54.291212 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:27:54.446454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d5ff70>]}
[0m21:27:54.499394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137864df0>]}
[0m21:27:54.499662 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:27:54.499858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bac7f0>]}
[0m21:27:54.500402 [info ] [MainThread]: 
[0m21:27:54.500685 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:27:54.501154 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:27:54.501353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:54.916873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:27:54.917724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:55.312994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137864df0>]}
[0m21:27:55.315221 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:27:55.315853 [info ] [MainThread]: 
[0m21:27:55.319807 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:27:55.320685 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:27:55.321358 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:27:55.321800 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:27:55.333420 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:27:55.334857 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:27:55.349608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:27:55.757876 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:27:55.758839 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , avg_daily_price_week_end - avg_daily_price_week_start as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , avg_daily_price_month_end - avg_daily_price_month_start as avg_daily_price_movement_in_month
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:27:56.237468 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:036cd787-a161-4017-bdea-c87c6798509d&page=queryresults
[0m21:28:02.358383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e050d90>]}
[0m21:28:02.360143 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (256.7k rows, 37.6 MiB processed)[0m in 7.04s]
[0m21:28:02.360796 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:28:02.361900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:02.362248 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:28:02.362562 [info ] [MainThread]: 
[0m21:28:02.362886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m21:28:02.363538 [debug] [MainThread]: Command end result
[0m21:28:02.391810 [info ] [MainThread]: 
[0m21:28:02.392154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:02.392329 [info ] [MainThread]: 
[0m21:28:02.392522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:28:02.394238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.775276, "process_user_time": 2.001826, "process_kernel_time": 2.63291, "process_mem_max_rss": "195608576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:28:02.394569 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:02.394521 after 8.78 seconds
[0m21:28:02.394780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104319a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b167c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568ca60>]}
[0m21:28:02.394981 [debug] [MainThread]: Flushing usage events
[0m21:29:03.938805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d14b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568d0d0>]}


============================== 21:29:03.941714 | 9b2211fc-4a5c-4895-a81d-b72d9b3b2010 ==============================
[0m21:29:03.941714 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:29:03.942044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:04.512976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1452da0a0>]}
[0m21:29:04.539988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145320610>]}
[0m21:29:04.540356 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:29:04.555002 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:29:04.631586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:04.632063 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:29:04.789334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14581f130>]}
[0m21:29:04.845400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145857730>]}
[0m21:29:04.845702 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:29:04.845888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145860d00>]}
[0m21:29:04.846420 [info ] [MainThread]: 
[0m21:29:04.846700 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:29:04.847177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:29:04.847395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:05.249789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:29:05.250207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.628896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145860d00>]}
[0m21:29:05.629913 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:29:05.630334 [info ] [MainThread]: 
[0m21:29:05.634098 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:29:05.634754 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:29:05.635295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:29:05.635717 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:29:05.645921 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:29:05.647232 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:29:05.661390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:06.049803 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:29:06.050925 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , avg_daily_price_week_end - avg_daily_price_week_start as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , avg_daily_price_month_end - avg_daily_price_month_start as avg_daily_price_movement_in_month
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:29:06.390556 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:40acab2b-cade-4b7f-a12e-978075ceefb8&page=queryresults
[0m21:29:10.367320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b056d0>]}
[0m21:29:10.368099 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.73s]
[0m21:29:10.368670 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:29:10.369713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:10.370009 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:29:10.370274 [info ] [MainThread]: 
[0m21:29:10.370559 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m21:29:10.371125 [debug] [MainThread]: Command end result
[0m21:29:10.397619 [info ] [MainThread]: 
[0m21:29:10.397987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:10.398211 [info ] [MainThread]: 
[0m21:29:10.398440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:29:10.399918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5118504, "process_user_time": 2.10919, "process_kernel_time": 2.597521, "process_mem_max_rss": "198082560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:29:10.400255 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:10.400202 after 6.51 seconds
[0m21:29:10.400490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d14b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a68280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145320610>]}
[0m21:29:10.400717 [debug] [MainThread]: Flushing usage events
[0m21:31:16.453660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106078ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f11c0>]}


============================== 21:31:16.456500 | 0c1c369e-9d53-4047-b110-6b55314c6947 ==============================
[0m21:31:16.456500 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:31:16.456818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:31:16.967561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145359430>]}
[0m21:31:16.993667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782e5e0>]}
[0m21:31:16.993986 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:31:17.006327 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:31:17.079081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:31:17.079445 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:31:17.232288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479a0130>]}
[0m21:31:17.286105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1478b6b80>]}
[0m21:31:17.286383 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:31:17.286573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479e3d60>]}
[0m21:31:17.287099 [info ] [MainThread]: 
[0m21:31:17.287362 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:31:17.287838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:31:17.288041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:17.698949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:31:17.699677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:18.060779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479e3d60>]}
[0m21:31:18.061727 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:31:18.062168 [info ] [MainThread]: 
[0m21:31:18.065522 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:31:18.066088 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:31:18.066600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:31:18.067111 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:31:18.077141 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:31:18.078195 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:31:18.091319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:31:18.504961 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:31:18.506158 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:31:18.994615 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:11abd81e-1cb4-4b0b-84d0-da07f4a90606&page=queryresults
[0m21:31:22.357575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141480670>]}
[0m21:31:22.358287 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.29s]
[0m21:31:22.358842 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:31:22.359834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:22.360075 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:31:22.360316 [info ] [MainThread]: 
[0m21:31:22.360589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m21:31:22.361129 [debug] [MainThread]: Command end result
[0m21:31:22.386780 [info ] [MainThread]: 
[0m21:31:22.387154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:22.387354 [info ] [MainThread]: 
[0m21:31:22.387552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:31:22.389131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.982792, "process_user_time": 1.995651, "process_kernel_time": 2.67232, "process_mem_max_rss": "195985408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:22.389489 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:22.389425 after 5.98 seconds
[0m21:31:22.389711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106078ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479e0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145359430>]}
[0m21:31:22.389934 [debug] [MainThread]: Flushing usage events
[0m21:34:02.200344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d04280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d040a0>]}


============================== 21:34:02.202849 | 86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2 ==============================
[0m21:34:02.202849 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:34:02.203173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:34:02.738986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14604f3d0>]}
[0m21:34:02.765864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772df10>]}
[0m21:34:02.766170 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:34:02.777745 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:34:02.854464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:02.854831 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:34:03.006961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146660130>]}
[0m21:34:03.060513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466a6790>]}
[0m21:34:03.060786 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:34:03.060968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460996a0>]}
[0m21:34:03.061485 [info ] [MainThread]: 
[0m21:34:03.061738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:34:03.062200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:34:03.062405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:03.476346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:34:03.476747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:03.839096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460996a0>]}
[0m21:34:03.840285 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:34:03.840799 [info ] [MainThread]: 
[0m21:34:03.845784 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:34:03.846925 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:34:03.847779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:34:03.848212 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:34:03.859449 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:34:03.860350 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:34:03.875034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:34:04.296639 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:34:04.297758 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:34:04.785229 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:62858420-602f-4bb6-af5b-a953a563c848&page=queryresults
[0m21:34:08.193795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145880700>]}
[0m21:34:08.194608 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.35s]
[0m21:34:08.195176 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:34:08.196206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:08.196506 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:34:08.196775 [info ] [MainThread]: 
[0m21:34:08.197068 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m21:34:08.197645 [debug] [MainThread]: Command end result
[0m21:34:08.225143 [info ] [MainThread]: 
[0m21:34:08.225492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:08.225696 [info ] [MainThread]: 
[0m21:34:08.225904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:34:08.227395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0743585, "process_user_time": 2.064804, "process_kernel_time": 2.615027, "process_mem_max_rss": "196165632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:34:08.227764 [debug] [MainThread]: Command `dbt run` succeeded at 21:34:08.227706 after 6.07 seconds
[0m21:34:08.228010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14604f3d0>]}
[0m21:34:08.228251 [debug] [MainThread]: Flushing usage events
[0m00:13:19.954038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515160>]}


============================== 00:13:19.956842 | b9b886c0-9f82-4a94-86df-75dba239c0a4 ==============================
[0m00:13:19.956842 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:13:19.957150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:13:20.507913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f6580>]}
[0m00:13:20.533783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141639190>]}
[0m00:13:20.534066 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:13:20.545741 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:13:20.621235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:20.621571 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m00:13:20.775099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416f60a0>]}
[0m00:13:20.828915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141aef490>]}
[0m00:13:20.829188 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m00:13:20.829378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a711f0>]}
[0m00:13:20.829904 [info ] [MainThread]: 
[0m00:13:20.830168 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:20.830641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:13:20.830843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:21.252879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:13:21.253426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:21.654137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416bb580>]}
[0m00:13:21.655339 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:13:21.655870 [info ] [MainThread]: 
[0m00:13:21.659810 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m00:13:21.660587 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m00:13:21.661267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m00:13:21.661775 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m00:13:21.672960 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:13:21.673743 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m00:13:21.688799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:13:22.107292 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:13:22.108295 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_end)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_month using (year_full)
    left join last_avg_daily_price_per_month using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m00:13:22.611093 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2ab23ea9-8150-4fb6-9f7d-81e718eab3d2&page=queryresults
[0m00:13:22.720747 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]; reason: invalidQuery, location: query, message: Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]')
[0m00:13:23.472841 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c60cca95-3861-423e-a8e4-2d8888304ab6&page=queryresults
[0m00:13:23.573850 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c60cca95-3861-423e-a8e4-2d8888304ab6&page=queryresults
[0m00:13:23.617053 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:13:23.618331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142010f10>]}
[0m00:13:23.618979 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.96s]
[0m00:13:23.619407 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m00:13:23.621543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:23.621738 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m00:13:23.621922 [info ] [MainThread]: 
[0m00:13:23.622141 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m00:13:23.622556 [debug] [MainThread]: Command end result
[0m00:13:23.643290 [info ] [MainThread]: 
[0m00:13:23.643588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:23.643757 [info ] [MainThread]: 
[0m00:13:23.643976 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:13:23.644138 [info ] [MainThread]: 
[0m00:13:23.644324 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:13:23.646119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7418041, "process_user_time": 2.00632, "process_kernel_time": 2.686671, "process_mem_max_rss": "195330048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:13:23.646415 [debug] [MainThread]: Command `dbt run` failed at 00:13:23.646367 after 3.74 seconds
[0m00:13:23.646628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ecc5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f6580>]}
[0m00:13:23.646835 [debug] [MainThread]: Flushing usage events
[0m00:14:26.540403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10229caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c15310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c15130>]}


============================== 00:14:26.542605 | 60a785c9-2d15-4d16-b13e-eb2519647261 ==============================
[0m00:14:26.542605 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:14:26.542943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:27.023566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a51a60>]}
[0m00:14:27.049773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bec220>]}
[0m00:14:27.050079 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:14:27.064154 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:14:27.137371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:27.137727 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m00:14:27.293891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152c9f130>]}
[0m00:14:27.347377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b8b610>]}
[0m00:14:27.347648 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m00:14:27.347833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102216d00>]}
[0m00:14:27.348348 [info ] [MainThread]: 
[0m00:14:27.348609 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:27.349054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:14:27.349256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:27.774386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:14:27.774957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:28.175925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c6b20>]}
[0m00:14:28.177034 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:28.177426 [info ] [MainThread]: 
[0m00:14:28.180247 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m00:14:28.180831 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m00:14:28.181320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m00:14:28.181683 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m00:14:28.193032 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:14:28.193842 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m00:14:28.208613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:14:28.623033 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:14:28.624175 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_month using (year_full)
    left join last_avg_daily_price_per_month using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m00:14:29.071117 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4768415a-49da-43da-bb31-718ca2502fa5&page=queryresults
[0m00:14:29.188164 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]; reason: invalidQuery, location: query, message: Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]')
[0m00:14:30.401662 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:34d0505c-f6a7-4958-8141-1ec3df6f00b5&page=queryresults
[0m00:14:30.506365 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:34d0505c-f6a7-4958-8141-1ec3df6f00b5&page=queryresults
[0m00:14:30.550949 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:14:30.552396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a11be0>]}
[0m00:14:30.552931 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.37s]
[0m00:14:30.553384 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m00:14:30.555804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:30.556016 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m00:14:30.556216 [info ] [MainThread]: 
[0m00:14:30.556425 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m00:14:30.556837 [debug] [MainThread]: Command end result
[0m00:14:30.579127 [info ] [MainThread]: 
[0m00:14:30.579533 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:30.579716 [info ] [MainThread]: 
[0m00:14:30.579958 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:14:30.580205 [info ] [MainThread]: 
[0m00:14:30.580431 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:14:30.581910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.088018, "process_user_time": 2.054272, "process_kernel_time": 2.664519, "process_mem_max_rss": "195510272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:14:30.582278 [debug] [MainThread]: Command `dbt run` failed at 00:14:30.582222 after 4.09 seconds
[0m00:14:30.582560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10229caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152825700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a51a60>]}
[0m00:14:30.582794 [debug] [MainThread]: Flushing usage events
[0m00:20:00.187094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10278cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104105280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041050a0>]}


============================== 00:20:00.189697 | f220fa5f-9819-480c-81ee-ad9f981c4b94 ==============================
[0m00:20:00.189697 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:20:00.190036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:00.696907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13428f3d0>]}
[0m00:20:00.722810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2df10>]}
[0m00:20:00.723114 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:20:00.734997 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:20:00.804564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:20:00.804884 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m00:20:00.958858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13709f130>]}
[0m00:20:01.013484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1370e7790>]}
[0m00:20:01.013757 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m00:20:01.013953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342d8970>]}
[0m00:20:01.014503 [info ] [MainThread]: 
[0m00:20:01.014785 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:20:01.015267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:20:01.015471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:01.471661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:20:01.472137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:01.826719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342d8970>]}
[0m00:20:01.828108 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:20:01.828616 [info ] [MainThread]: 
[0m00:20:01.832112 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m00:20:01.832810 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m00:20:01.833385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m00:20:01.833762 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m00:20:01.845671 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:20:01.846727 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m00:20:01.861960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:20:02.270246 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:20:02.271922 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m00:20:02.693418 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f861bb7f-e5f2-4993-9e94-879bf1c4ee32&page=queryresults
[0m00:20:42.931143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ac0700>]}
[0m00:20:42.933145 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 41.10s]
[0m00:20:42.933988 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m00:20:42.935385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:42.935781 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m00:20:42.936077 [info ] [MainThread]: 
[0m00:20:42.936460 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.92 seconds (41.92s).
[0m00:20:42.937058 [debug] [MainThread]: Command end result
[0m00:20:42.966309 [info ] [MainThread]: 
[0m00:20:42.966872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:20:42.967356 [info ] [MainThread]: 
[0m00:20:42.967565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:20:42.969430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 42.83317, "process_user_time": 2.023225, "process_kernel_time": 2.648026, "process_mem_max_rss": "194822144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:20:42.969914 [debug] [MainThread]: Command `dbt run` succeeded at 00:20:42.969838 after 42.83 seconds
[0m00:20:42.970188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10278cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347f9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347f9400>]}
[0m00:20:42.970413 [debug] [MainThread]: Flushing usage events
[0m12:31:32.320421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cb1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103628370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103628190>]}


============================== 12:31:32.323444 | d900bae0-9bb2-4c79-adbe-e9e92e4207a4 ==============================
[0m12:31:32.323444 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:31:32.323776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_spy_1993_2024+', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:32.935777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034ae7c0>]}
[0m12:31:32.962128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1345f0a30>]}
[0m12:31:32.962420 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:31:32.973808 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:31:33.050547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m12:31:33.050900 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_spy_1993_2024.sql
[0m12:31:33.051082 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_spy_1993_2024.sql
[0m12:31:33.051472 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m12:31:33.051649 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m12:31:33.260247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134fae130>]}
[0m12:31:33.315528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f0bd90>]}
[0m12:31:33.315790 [info ] [MainThread]: Found 7 models, 3 sources, 469 macros
[0m12:31:33.315974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134fae130>]}
[0m12:31:33.316572 [info ] [MainThread]: 
[0m12:31:33.316827 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:31:33.318923 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:31:33.319129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:33.766322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:31:33.767235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:34.203953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134592fd0>]}
[0m12:31:34.205898 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:31:34.206458 [info ] [MainThread]: 
[0m12:31:34.211620 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m12:31:34.212592 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_spy_1993_2024 ................. [RUN]
[0m12:31:34.213303 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_spy_1993_2024)
[0m12:31:34.214069 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m12:31:34.226520 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m12:31:34.227647 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m12:31:34.260811 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_1993_2024"
[0m12:31:34.261454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:31:34.325853 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_1993_2024`
    );
  
[0m12:31:35.041576 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:80fba028-6459-49a6-b786-f9bead76de1e&page=queryresults
[0m12:31:37.009496 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1359d46a0>]}
[0m12:31:37.010347 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.base_spy_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.80s]
[0m12:31:37.010949 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m12:31:37.011735 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m12:31:37.012220 [info ] [Thread-1  ]: 2 of 2 START sql table model stock_analysis.stg_spy_1993_2024 .................. [RUN]
[0m12:31:37.012689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_1993_2024, now model.stock_analysis.stg_spy_1993_2024)
[0m12:31:37.013011 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m12:31:37.016819 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m12:31:37.017450 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m12:31:37.019961 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_1993_2024"
[0m12:31:37.020449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:31:37.091183 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:31:37.702921 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:abbf9a2b-6dff-438e-bba9-e4442527c610&page=queryresults
[0m12:33:50.488104 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd900bae0-9bb2-4c79-adbe-e9e92e4207a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1359d4280>]}
[0m12:33:50.490555 [info ] [Thread-1  ]: 2 of 2 OK created sql table model stock_analysis.stg_spy_1993_2024 ............. [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 133.48s]
[0m12:33:50.491948 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m12:33:50.493924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:50.494445 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_1993_2024' was properly closed.
[0m12:33:50.494978 [info ] [MainThread]: 
[0m12:33:50.495387 [info ] [MainThread]: Finished running 2 table models in 0 hours 2 minutes and 17.18 seconds (137.18s).
[0m12:33:50.496765 [debug] [MainThread]: Command end result
[0m12:33:50.531602 [info ] [MainThread]: 
[0m12:33:50.532016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:50.532252 [info ] [MainThread]: 
[0m12:33:50.532484 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:33:50.534478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 138.26613, "process_user_time": 2.590258, "process_kernel_time": 2.498099, "process_mem_max_rss": "197017600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:33:50.534886 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:50.534819 after 138.27 seconds
[0m12:33:50.535157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cb1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103024a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f170d0>]}
[0m12:33:50.535427 [debug] [MainThread]: Flushing usage events
[0m12:52:00.397419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108329340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108329160>]}


============================== 12:52:00.400516 | 072c6525-33dd-41c6-8da2-369fa776e1ff ==============================
[0m12:52:00.400516 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:00.400828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select base_spus_2019_2024+', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:00.941950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108308580>]}
[0m12:52:00.967559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14547a2b0>]}
[0m12:52:00.967859 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:52:00.979819 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:52:01.055982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m12:52:01.056295 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_spus_2019_2024.sql
[0m12:52:01.056469 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_spus_2019_2024.sql
[0m12:52:01.056878 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m12:52:01.266361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146333130>]}
[0m12:52:01.321721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146367460>]}
[0m12:52:01.321983 [info ] [MainThread]: Found 9 models, 4 sources, 469 macros
[0m12:52:01.322167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146073ca0>]}
[0m12:52:01.322793 [info ] [MainThread]: 
[0m12:52:01.323055 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:52:01.325130 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:52:01.325334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:01.766913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:52:01.768110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:02.143083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b1970>]}
[0m12:52:02.144403 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:52:02.145012 [info ] [MainThread]: 
[0m12:52:02.149778 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m12:52:02.150732 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_spus_2019_2024 ................ [RUN]
[0m12:52:02.151711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_spus_2019_2024)
[0m12:52:02.152288 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m12:52:02.164694 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m12:52:02.165953 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m12:52:02.199205 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spus_2019_2024"
[0m12:52:02.199878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:02.263903 [debug] [Thread-1  ]: On model.stock_analysis.base_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spus_2019_2024`
    );
  
[0m12:52:02.930748 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26779f41-4fc0-46ac-8691-92db9ae2d807&page=queryresults
[0m12:52:04.893880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146554fd0>]}
[0m12:52:04.894588 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.base_spus_2019_2024 ........... [[32mCREATE TABLE (1.2k rows, 55.5 KiB processed)[0m in 2.74s]
[0m12:52:04.895151 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m12:52:04.895786 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m12:52:04.896311 [info ] [Thread-1  ]: 2 of 2 START sql table model stock_analysis.stg_spus_2019_2024 ................. [RUN]
[0m12:52:04.896811 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spus_2019_2024, now model.stock_analysis.stg_spus_2019_2024)
[0m12:52:04.897124 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m12:52:04.900901 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:52:04.901599 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m12:52:04.904075 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:52:04.904578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:04.975410 [debug] [Thread-1  ]: On model.stock_analysis.stg_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:52:05.472664 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:996ca3bf-5982-40fd-9aad-b0ce77d6c276&page=queryresults
[0m12:52:26.223936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '072c6525-33dd-41c6-8da2-369fa776e1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146554d30>]}
[0m12:52:26.226235 [info ] [Thread-1  ]: 2 of 2 OK created sql table model stock_analysis.stg_spus_2019_2024 ............ [[32mCREATE TABLE (1.2k rows, 37.6 MiB processed)[0m in 21.33s]
[0m12:52:26.227101 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m12:52:26.228923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:26.229481 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spus_2019_2024' was properly closed.
[0m12:52:26.229924 [info ] [MainThread]: 
[0m12:52:26.230306 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 24.91 seconds (24.91s).
[0m12:52:26.231224 [debug] [MainThread]: Command end result
[0m12:52:26.265310 [info ] [MainThread]: 
[0m12:52:26.265665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:26.265882 [info ] [MainThread]: 
[0m12:52:26.266075 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:52:26.267708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.93506, "process_user_time": 2.196179, "process_kernel_time": 2.690289, "process_mem_max_rss": "196706304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:52:26.268034 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:26.267982 after 25.94 seconds
[0m12:52:26.268253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108308580>]}
[0m12:52:26.268464 [debug] [MainThread]: Flushing usage events
[0m12:31:33.029117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021c0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b383a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b381c0>]}


============================== 12:31:33.031904 | 4a989b70-2476-404c-8863-3084df3e8416 ==============================
[0m12:31:33.031904 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:31:33.032206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_stock_analysis', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:31:33.746781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a989b70-2476-404c-8863-3084df3e8416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138319430>]}
[0m12:31:33.772471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a989b70-2476-404c-8863-3084df3e8416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039765e0>]}
[0m12:31:33.772762 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:31:33.784429 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:31:33.862755 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 3 files changed.
[0m12:31:33.863108 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_symbols_meta.sql
[0m12:31:33.863301 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m12:31:33.863455 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_symbols_meta.sql
[0m12:31:33.863604 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/4_final/stock_analysis.sql
[0m12:31:33.864061 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m12:31:33.864217 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_final/stock_analysis.sql
[0m12:31:33.864387 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spus_2019_2024.sql
[0m12:31:33.864552 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_1993_2024.sql
[0m12:31:34.037328 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.stock_analysis' (models/4_final/stock_analysis.sql) depends on a node named 'stg_stock_analysis' which was not found
[0m12:31:34.040031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0607344, "process_user_time": 1.69143, "process_kernel_time": 2.718988, "process_mem_max_rss": "189890560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:31:34.040354 [debug] [MainThread]: Command `dbt run` failed at 12:31:34.040304 after 1.06 seconds
[0m12:31:34.040549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021c0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13878d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028a0d60>]}
[0m12:31:34.040724 [debug] [MainThread]: Flushing usage events
[0m12:32:21.783449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088843a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088841c0>]}


============================== 12:32:21.786096 | 3460ac79-3b7a-4651-aded-4bf6f1b115e0 ==============================
[0m12:32:21.786096 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:32:21.786421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select int_stock_analysis', 'send_anonymous_usage_stats': 'True'}
[0m12:32:22.289926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3460ac79-3b7a-4651-aded-4bf6f1b115e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fc19430>]}
[0m12:32:22.317181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3460ac79-3b7a-4651-aded-4bf6f1b115e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bcac0>]}
[0m12:32:22.317588 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:32:22.329138 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:32:22.403566 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 3 files changed.
[0m12:32:22.403880 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/4_final/stock_analysis.sql
[0m12:32:22.404063 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m12:32:22.404224 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_symbols_meta.sql
[0m12:32:22.404372 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_symbols_meta.sql
[0m12:32:22.404814 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m12:32:22.404956 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_final/stock_analysis.sql
[0m12:32:22.405114 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spus_2019_2024.sql
[0m12:32:22.405265 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_1993_2024.sql
[0m12:32:22.621948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3460ac79-3b7a-4651-aded-4bf6f1b115e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16018b130>]}
[0m12:32:22.678005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3460ac79-3b7a-4651-aded-4bf6f1b115e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16023c880>]}
[0m12:32:22.678266 [info ] [MainThread]: Found 12 models, 5 sources, 469 macros
[0m12:32:22.678451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3460ac79-3b7a-4651-aded-4bf6f1b115e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160240a30>]}
[0m12:32:22.679027 [info ] [MainThread]: 
[0m12:32:22.679295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:22.679730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:32:22.679938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:23.260778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:32:23.261577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:23.757018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3460ac79-3b7a-4651-aded-4bf6f1b115e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16027fe50>]}
[0m12:32:23.758571 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:32:23.759287 [info ] [MainThread]: 
[0m12:32:23.763984 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m12:32:23.764635 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m12:32:23.765357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m12:32:23.766219 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m12:32:23.776457 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m12:32:23.777324 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m12:32:23.810773 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m12:32:23.811495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:23.875572 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )

, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )

select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
    );
  
[0m12:32:24.652989 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9460fb9b-d779-40a3-a074-4485fc6d70ff&page=queryresults
[0m12:32:27.141932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3460ac79-3b7a-4651-aded-4bf6f1b115e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160268b20>]}
[0m12:32:27.142719 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.int_stock_analysis ............ [[32mCREATE TABLE (9.1k rows, 3.3 MiB processed)[0m in 3.38s]
[0m12:32:27.143290 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m12:32:27.144497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:27.144750 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m12:32:27.145005 [info ] [MainThread]: 
[0m12:32:27.145290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m12:32:27.145857 [debug] [MainThread]: Command end result
[0m12:32:27.175540 [info ] [MainThread]: 
[0m12:32:27.175897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:27.176098 [info ] [MainThread]: 
[0m12:32:27.176297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:32:27.177693 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.442095, "process_user_time": 2.060777, "process_kernel_time": 2.718219, "process_mem_max_rss": "197148672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:27.178028 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:27.177973 after 5.44 seconds
[0m12:32:27.178259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081762e0>]}
[0m12:32:27.178479 [debug] [MainThread]: Flushing usage events
[0m12:33:42.545159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103074a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d01340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d01160>]}


============================== 12:33:42.547168 | 5999db4c-259e-4cf6-9ee8-7a39a9c96314 ==============================
[0m12:33:42.547168 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:33:42.547477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stock_analysis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:42.997381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033a6640>]}
[0m12:33:43.023388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c98a60>]}
[0m12:33:43.023674 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:33:43.034110 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:33:43.106055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:43.106318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:43.126955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a7bf130>]}
[0m12:33:43.213302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a4c0d30>]}
[0m12:33:43.213589 [info ] [MainThread]: Found 12 models, 5 sources, 469 macros
[0m12:33:43.213791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a7e51c0>]}
[0m12:33:43.214477 [info ] [MainThread]: 
[0m12:33:43.214771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:33:43.217271 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:33:43.217484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:45.857492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:33:45.858633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:46.312204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025cbcd0>]}
[0m12:33:46.313076 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:33:46.313317 [info ] [MainThread]: 
[0m12:33:46.315157 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:33:46.315519 [info ] [Thread-1  ]: 1 of 12 START sql table model stock_analysis.base_calendar ..................... [RUN]
[0m12:33:46.315791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:33:46.315980 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:33:46.325529 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:33:46.327023 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:33:46.340810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:46.842413 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:33:46.843510 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:33:47.288595 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b9b9ae1b-9c67-40c5-9388-792ea9a379bd&page=queryresults
[0m12:33:50.991410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a232640>]}
[0m12:33:50.993542 [info ] [Thread-1  ]: 1 of 12 OK created sql table model stock_analysis.base_calendar ................ [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.67s]
[0m12:33:50.994159 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:33:50.994560 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m12:33:50.995119 [info ] [Thread-1  ]: 2 of 12 START sql table model stock_analysis.base_spus_2019_2024 ............... [RUN]
[0m12:33:50.995682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spus_2019_2024)
[0m12:33:50.995986 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m12:33:50.999181 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m12:33:51.001457 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m12:33:51.003827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:51.688896 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spus_2019_2024"
[0m12:33:51.690635 [debug] [Thread-1  ]: On model.stock_analysis.base_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spus_2019_2024`
    );
  
[0m12:33:52.305029 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:83ecc7a1-15f5-423f-b45d-c2a88e7db54f&page=queryresults
[0m12:33:54.326460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a29fdc0>]}
[0m12:33:54.327986 [info ] [Thread-1  ]: 2 of 12 OK created sql table model stock_analysis.base_spus_2019_2024 .......... [[32mCREATE TABLE (1.2k rows, 55.5 KiB processed)[0m in 3.33s]
[0m12:33:54.329117 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m12:33:54.329725 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m12:33:54.330518 [info ] [Thread-1  ]: 3 of 12 START sql table model stock_analysis.base_spy_1993_2024 ................ [RUN]
[0m12:33:54.331293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spus_2019_2024, now model.stock_analysis.base_spy_1993_2024)
[0m12:33:54.331722 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m12:33:54.338312 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m12:33:54.340666 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m12:33:54.343358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:54.818343 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_1993_2024"
[0m12:33:54.820972 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_1993_2024`
    );
  
[0m12:33:55.276996 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a866d089-fc60-4f76-8e04-e6531cac9e5e&page=queryresults
[0m12:33:57.215408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273fdc10>]}
[0m12:33:57.217814 [info ] [Thread-1  ]: 3 of 12 OK created sql table model stock_analysis.base_spy_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.88s]
[0m12:33:57.218714 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m12:33:57.219616 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:33:57.220250 [info ] [Thread-1  ]: 4 of 12 START sql table model stock_analysis.base_spy_2014_2024 ................ [RUN]
[0m12:33:57.220761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_1993_2024, now model.stock_analysis.base_spy_2014_2024)
[0m12:33:57.221065 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:33:57.224661 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:33:57.226839 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:33:57.229001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:57.671358 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:33:57.673254 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:33:58.143052 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5f520468-2eeb-4801-be3f-008de72ad598&page=queryresults
[0m12:34:00.472908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3d5910>]}
[0m12:34:00.474801 [info ] [Thread-1  ]: 4 of 12 OK created sql table model stock_analysis.base_spy_2014_2024 ........... [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.25s]
[0m12:34:00.475860 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:34:00.476497 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m12:34:00.477326 [info ] [Thread-1  ]: 5 of 12 START sql table model stock_analysis.base_symbols_meta ................. [RUN]
[0m12:34:00.478028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.base_symbols_meta)
[0m12:34:00.478489 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m12:34:00.483147 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m12:34:00.484473 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m12:34:00.488179 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m12:34:00.489089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:34:00.564989 [debug] [Thread-1  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:34:01.215472 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bf4012c7-5668-40e9-9389-0a6d4525961a&page=queryresults
[0m12:34:01.216872 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:34:01.217497 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US

Location: US
Job ID: bf4012c7-5668-40e9-9389-0a6d4525961a

[0m12:34:01.254826 [debug] [Thread-1  ]: Runtime Error in model base_symbols_meta (models/1_base/base_symbols_meta.sql)
  404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US
  
  Location: US
  Job ID: bf4012c7-5668-40e9-9389-0a6d4525961a
  
[0m12:34:01.255335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2565b0>]}
[0m12:34:01.255842 [error] [Thread-1  ]: 5 of 12 ERROR creating sql table model stock_analysis.base_symbols_meta ........ [[31mERROR[0m in 0.78s]
[0m12:34:01.256302 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m12:34:01.256603 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m12:34:01.257048 [info ] [Thread-1  ]: 6 of 12 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m12:34:01.257557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_symbols_meta, now model.stock_analysis.stg_calendar)
[0m12:34:01.257820 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m12:34:01.262419 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m12:34:01.264391 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m12:34:01.266214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:34:01.701253 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m12:34:01.703265 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m12:34:02.178567 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7a2935b8-34be-4a21-885a-a7f2a50771a6&page=queryresults
[0m12:34:07.246431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5999db4c-259e-4cf6-9ee8-7a39a9c96314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12731dd00>]}
[0m12:34:07.248269 [info ] [Thread-1  ]: 6 of 12 OK created sql table model stock_analysis.stg_calendar ................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 5.99s]
[0m12:34:07.249216 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m12:34:07.249771 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_symbols_meta
[0m12:34:07.250374 [info ] [Thread-1  ]: 7 of 12 SKIP relation stock_analysis.stg_symbols_meta .......................... [[33mSKIP[0m]
[0m12:34:07.251174 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m12:34:07.251686 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m12:34:07.252300 [info ] [Thread-1  ]: 8 of 12 START sql table model stock_analysis.stg_spus_2019_2024 ................ [RUN]
[0m12:34:07.252893 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spus_2019_2024)
[0m12:34:07.253339 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m12:34:07.259252 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:34:07.260621 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m12:34:07.263855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:34:07.754555 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:34:07.757250 [debug] [Thread-1  ]: On model.stock_analysis.stg_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- --   DEPRACATED   -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 


with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:34:08.222801 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e310e625-ad2d-462d-b2d0-cdcd1e8bd349&page=queryresults
[0m12:34:34.559574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029ccac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043453a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043451c0>]}


============================== 12:34:34.562031 | bac85410-9ff5-4ba2-b443-913077a8d96b ==============================
[0m12:34:34.562031 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:34:34.562368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select base_symbols_metra', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:37.619704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104715a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608d190>]}


============================== 12:34:37.622299 | 9042d446-af68-4c0e-b4e0-687ad3a4e414 ==============================
[0m12:34:37.622299 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:34:37.622662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select base_symbols_meta', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:38.073052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9042d446-af68-4c0e-b4e0-687ad3a4e414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f127c0>]}
[0m12:34:38.099304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9042d446-af68-4c0e-b4e0-687ad3a4e414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eafa30>]}
[0m12:34:38.099590 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:34:38.117760 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:34:38.194415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:38.194689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:38.216898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9042d446-af68-4c0e-b4e0-687ad3a4e414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1562ff130>]}
[0m12:34:38.316800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9042d446-af68-4c0e-b4e0-687ad3a4e414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1561073a0>]}
[0m12:34:38.317128 [info ] [MainThread]: Found 12 models, 5 sources, 469 macros
[0m12:34:38.317328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9042d446-af68-4c0e-b4e0-687ad3a4e414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156325400>]}
[0m12:34:38.317950 [info ] [MainThread]: 
[0m12:34:38.318251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:34:38.318711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:34:38.318940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:39.006955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:34:39.007740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:39.448704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9042d446-af68-4c0e-b4e0-687ad3a4e414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054db7c0>]}
[0m12:34:39.449164 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:34:39.449409 [info ] [MainThread]: 
[0m12:34:39.451122 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m12:34:39.451497 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_symbols_meta .................. [RUN]
[0m12:34:39.451810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_symbols_meta)
[0m12:34:39.452043 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m12:34:39.470325 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m12:34:39.472204 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m12:34:39.500883 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m12:34:39.501498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:34:39.559957 [debug] [Thread-1  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:34:40.127825 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:678b93ed-20c8-4f9e-82a7-e76651a80ace&page=queryresults
[0m12:34:40.129385 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:34:40.130036 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US

Location: US
Job ID: 678b93ed-20c8-4f9e-82a7-e76651a80ace

[0m12:34:40.171352 [debug] [Thread-1  ]: Runtime Error in model base_symbols_meta (models/1_base/base_symbols_meta.sql)
  404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US
  
  Location: US
  Job ID: 678b93ed-20c8-4f9e-82a7-e76651a80ace
  
[0m12:34:40.172688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9042d446-af68-4c0e-b4e0-687ad3a4e414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f0bc40>]}
[0m12:34:40.173192 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.base_symbols_meta ......... [[31mERROR[0m in 0.72s]
[0m12:34:40.173770 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m12:34:40.174837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:40.175159 [debug] [MainThread]: Connection 'model.stock_analysis.base_symbols_meta' was properly closed.
[0m12:34:40.175390 [info ] [MainThread]: 
[0m12:34:40.175632 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m12:34:40.176072 [debug] [MainThread]: Command end result
[0m12:34:40.200927 [info ] [MainThread]: 
[0m12:34:40.201215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:34:40.201412 [info ] [MainThread]: 
[0m12:34:40.201661 [error] [MainThread]:   Runtime Error in model base_symbols_meta (models/1_base/base_symbols_meta.sql)
  404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US
  
  Location: US
  Job ID: 678b93ed-20c8-4f9e-82a7-e76651a80ace
  
[0m12:34:40.201836 [info ] [MainThread]: 
[0m12:34:40.202015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:34:40.203329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6346421, "process_user_time": 2.090894, "process_kernel_time": 2.580136, "process_mem_max_rss": "194412544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:40.203642 [debug] [MainThread]: Command `dbt run` failed at 12:34:40.203583 after 2.63 seconds
[0m12:34:40.203870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104715a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e8e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f127c0>]}
[0m12:34:40.204067 [debug] [MainThread]: Flushing usage events
[0m12:35:46.731380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105234ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c11c0>]}


============================== 12:35:46.734639 | d22c9305-470f-4a32-b7ee-654e38b59137 ==============================
[0m12:35:46.734639 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:35:46.734981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select base_symbols_meta', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:47.282850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd22c9305-470f-4a32-b7ee-654e38b59137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1543d9430>]}
[0m12:35:47.310958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd22c9305-470f-4a32-b7ee-654e38b59137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fe5e0>]}
[0m12:35:47.311343 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:35:47.323164 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:35:47.402727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:47.403004 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:47.423835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd22c9305-470f-4a32-b7ee-654e38b59137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15487f130>]}
[0m12:35:47.518179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd22c9305-470f-4a32-b7ee-654e38b59137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1546897c0>]}
[0m12:35:47.518482 [info ] [MainThread]: Found 12 models, 5 sources, 469 macros
[0m12:35:47.518674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd22c9305-470f-4a32-b7ee-654e38b59137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1548a54f0>]}
[0m12:35:47.519259 [info ] [MainThread]: 
[0m12:35:47.519547 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:35:47.520001 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:35:47.520214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:48.090964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:35:48.091608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:48.715412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd22c9305-470f-4a32-b7ee-654e38b59137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509aa90>]}
[0m12:35:48.715937 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:35:48.716231 [info ] [MainThread]: 
[0m12:35:48.718441 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m12:35:48.718910 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_symbols_meta .................. [RUN]
[0m12:35:48.719306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_symbols_meta)
[0m12:35:48.719602 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m12:35:48.728998 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m12:35:48.729716 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m12:35:48.760173 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m12:35:48.760780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:48.822124 [debug] [Thread-1  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:35:49.423124 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:13883060-75e0-47af-9101-b15fcdc7347f&page=queryresults
[0m12:35:49.424845 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:35:49.425866 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US

Location: US
Job ID: 13883060-75e0-47af-9101-b15fcdc7347f

[0m12:35:49.465788 [debug] [Thread-1  ]: Runtime Error in model base_symbols_meta (models/1_base/base_symbols_meta.sql)
  404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US
  
  Location: US
  Job ID: 13883060-75e0-47af-9101-b15fcdc7347f
  
[0m12:35:49.467162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd22c9305-470f-4a32-b7ee-654e38b59137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154a7d9d0>]}
[0m12:35:49.467680 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.base_symbols_meta ......... [[31mERROR[0m in 0.75s]
[0m12:35:49.468116 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m12:35:49.468945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:49.469178 [debug] [MainThread]: Connection 'model.stock_analysis.base_symbols_meta' was properly closed.
[0m12:35:49.469393 [info ] [MainThread]: 
[0m12:35:49.469611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m12:35:49.470044 [debug] [MainThread]: Command end result
[0m12:35:49.494957 [info ] [MainThread]: 
[0m12:35:49.495293 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:35:49.495472 [info ] [MainThread]: 
[0m12:35:49.495700 [error] [MainThread]:   Runtime Error in model base_symbols_meta (models/1_base/base_symbols_meta.sql)
  404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US
  
  Location: US
  Job ID: 13883060-75e0-47af-9101-b15fcdc7347f
  
[0m12:35:49.495878 [info ] [MainThread]: 
[0m12:35:49.496058 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:35:49.497549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.822467, "process_user_time": 1.894644, "process_kernel_time": 2.668079, "process_mem_max_rss": "192151552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:49.497847 [debug] [MainThread]: Command `dbt run` failed at 12:35:49.497796 after 2.82 seconds
[0m12:35:49.498068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105234ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a18550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154444b50>]}
[0m12:35:49.498268 [debug] [MainThread]: Flushing usage events
[0m12:35:59.192952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061553a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061551c0>]}


============================== 12:35:59.195064 | 3b04e749-8991-454b-970c-39d8c051e5f8 ==============================
[0m12:35:59.195064 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:35:59.195382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select base_symbols_meta', 'send_anonymous_usage_stats': 'True'}
[0m12:35:59.642122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b04e749-8991-454b-970c-39d8c051e5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142199430>]}
[0m12:35:59.667999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b04e749-8991-454b-970c-39d8c051e5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7e5e0>]}
[0m12:35:59.668286 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:35:59.679270 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:35:59.746552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:59.746806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:59.767365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b04e749-8991-454b-970c-39d8c051e5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14263f130>]}
[0m12:35:59.856263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b04e749-8991-454b-970c-39d8c051e5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14246f7c0>]}
[0m12:35:59.856618 [info ] [MainThread]: Found 12 models, 5 sources, 469 macros
[0m12:35:59.856823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b04e749-8991-454b-970c-39d8c051e5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1426654f0>]}
[0m12:35:59.857434 [info ] [MainThread]: 
[0m12:35:59.857720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:35:59.858169 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:35:59.858373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:00.522047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:36:00.522953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:01.040169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b04e749-8991-454b-970c-39d8c051e5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104463a90>]}
[0m12:36:01.040738 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:36:01.041066 [info ] [MainThread]: 
[0m12:36:01.042944 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m12:36:01.043460 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_symbols_meta .................. [RUN]
[0m12:36:01.043896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_symbols_meta)
[0m12:36:01.044242 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m12:36:01.055811 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m12:36:01.056452 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m12:36:01.086986 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m12:36:01.087536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:01.150407 [debug] [Thread-1  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:36:01.742513 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3cf5844f-f7bc-4c9b-8347-fd18e2e399d8&page=queryresults
[0m12:36:01.744318 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_meta_valid`
    );
  
[0m12:36:01.745018 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US

Location: US
Job ID: 3cf5844f-f7bc-4c9b-8347-fd18e2e399d8

[0m12:36:01.786772 [debug] [Thread-1  ]: Runtime Error in model base_symbols_meta (models/1_base/base_symbols_meta.sql)
  404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US
  
  Location: US
  Job ID: 3cf5844f-f7bc-4c9b-8347-fd18e2e399d8
  
[0m12:36:01.788009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b04e749-8991-454b-970c-39d8c051e5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428300d0>]}
[0m12:36:01.788495 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.base_symbols_meta ......... [[31mERROR[0m in 0.74s]
[0m12:36:01.788947 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m12:36:01.789714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:01.789908 [debug] [MainThread]: Connection 'model.stock_analysis.base_symbols_meta' was properly closed.
[0m12:36:01.790111 [info ] [MainThread]: 
[0m12:36:01.790315 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m12:36:01.790712 [debug] [MainThread]: Command end result
[0m12:36:01.815500 [info ] [MainThread]: 
[0m12:36:01.815865 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:36:01.816057 [info ] [MainThread]: 
[0m12:36:01.816279 [error] [MainThread]:   Runtime Error in model base_symbols_meta (models/1_base/base_symbols_meta.sql)
  404 Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.symbols_meta_valid was not found in location US
  
  Location: US
  Job ID: 3cf5844f-f7bc-4c9b-8347-fd18e2e399d8
  
[0m12:36:01.816452 [info ] [MainThread]: 
[0m12:36:01.816631 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:36:01.817980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6712608, "process_user_time": 1.922921, "process_kernel_time": 2.792179, "process_mem_max_rss": "196968448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:01.818299 [debug] [MainThread]: Command `dbt run` failed at 12:36:01.818250 after 2.67 seconds
[0m12:36:01.818529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2f7c0>]}
[0m12:36:01.818734 [debug] [MainThread]: Flushing usage events
[0m12:36:36.550066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fa4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046411c0>]}


============================== 12:36:36.552509 | b2cb765a-1e63-4a4b-8865-84110272bbac ==============================
[0m12:36:36.552509 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:36:36.552819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select base_symbols_meta', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:36:37.019673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2cb765a-1e63-4a4b-8865-84110272bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142c1a430>]}
[0m12:36:37.045780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2cb765a-1e63-4a4b-8865-84110272bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447cac0>]}
[0m12:36:37.046068 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:36:37.056615 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:36:37.124716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:36:37.125484 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m12:36:37.125695 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_symbols_meta.sql
[0m12:36:37.338333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2cb765a-1e63-4a4b-8865-84110272bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143282130>]}
[0m12:36:37.391709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2cb765a-1e63-4a4b-8865-84110272bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434346d0>]}
[0m12:36:37.391980 [info ] [MainThread]: Found 12 models, 5 sources, 469 macros
[0m12:36:37.392170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2cb765a-1e63-4a4b-8865-84110272bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434409a0>]}
[0m12:36:37.392748 [info ] [MainThread]: 
[0m12:36:37.393021 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:36:37.393441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:36:37.393646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:37.913268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:36:37.913993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:38.426121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2cb765a-1e63-4a4b-8865-84110272bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ca760>]}
[0m12:36:38.427822 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:36:38.428636 [info ] [MainThread]: 
[0m12:36:38.434071 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m12:36:38.434750 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_symbols_meta .................. [RUN]
[0m12:36:38.435281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_symbols_meta)
[0m12:36:38.435690 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m12:36:38.446102 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m12:36:38.446964 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m12:36:38.479980 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m12:36:38.480607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:38.545043 [debug] [Thread-1  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_valid_meta`
    );
  
[0m12:36:39.325431 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f4256cf6-3c7b-458d-8d23-c90220798460&page=queryresults
[0m12:36:41.507936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2cb765a-1e63-4a4b-8865-84110272bbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143478df0>]}
[0m12:36:41.508971 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.base_symbols_meta ............. [[32mCREATE TABLE (8.0k rows, 0 processed)[0m in 3.07s]
[0m12:36:41.509434 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m12:36:41.510243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:41.510426 [debug] [MainThread]: Connection 'model.stock_analysis.base_symbols_meta' was properly closed.
[0m12:36:41.510615 [info ] [MainThread]: 
[0m12:36:41.510825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.12 seconds (4.12s).
[0m12:36:41.511247 [debug] [MainThread]: Command end result
[0m12:36:41.535583 [info ] [MainThread]: 
[0m12:36:41.535910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:41.536091 [info ] [MainThread]: 
[0m12:36:41.536270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:41.537758 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0361795, "process_user_time": 2.098622, "process_kernel_time": 2.689759, "process_mem_max_rss": "199868416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:41.538072 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:41.538023 after 5.04 seconds
[0m12:36:41.538295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fa4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037362e0>]}
[0m12:36:41.538496 [debug] [MainThread]: Flushing usage events
[0m12:36:51.801572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f88a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103900340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103900160>]}


============================== 12:36:51.803585 | 239e2137-447e-4bb7-9ad2-12df46cbd0a9 ==============================
[0m12:36:51.803585 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:36:51.803936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stock_analysis', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:36:52.259480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021c0640>]}
[0m12:36:52.285363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103897a60>]}
[0m12:36:52.285647 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:36:52.296171 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:36:52.365512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:52.365776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:36:52.386705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1639c0130>]}
[0m12:36:52.472877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162fc8d30>]}
[0m12:36:52.473191 [info ] [MainThread]: Found 12 models, 5 sources, 469 macros
[0m12:36:52.473387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1639e6280>]}
[0m12:36:52.474096 [info ] [MainThread]: 
[0m12:36:52.474385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:36:52.476891 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:36:52.477114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:53.010840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:36:53.011960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:53.571027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101deecd0>]}
[0m12:36:53.571707 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:36:53.572061 [info ] [MainThread]: 
[0m12:36:53.574003 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:36:53.574474 [info ] [Thread-1  ]: 1 of 12 START sql table model stock_analysis.base_calendar ..................... [RUN]
[0m12:36:53.574856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:36:53.575151 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:36:53.586291 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:36:53.586925 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:36:53.600043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:54.115568 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:36:54.116665 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:36:54.448997 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8d891cc6-4a45-436d-b01b-189296a24136&page=queryresults
[0m12:36:57.496225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103410100>]}
[0m12:36:57.497782 [info ] [Thread-1  ]: 1 of 12 OK created sql table model stock_analysis.base_calendar ................ [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 3.92s]
[0m12:36:57.498256 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:36:57.498549 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m12:36:57.498949 [info ] [Thread-1  ]: 2 of 12 START sql table model stock_analysis.base_spus_2019_2024 ............... [RUN]
[0m12:36:57.499363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spus_2019_2024)
[0m12:36:57.499613 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m12:36:57.502041 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m12:36:57.502757 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m12:36:57.504524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:58.028506 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spus_2019_2024"
[0m12:36:58.031343 [debug] [Thread-1  ]: On model.stock_analysis.base_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spus_2019_2024`
    );
  
[0m12:36:58.674039 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4f204195-9cf6-4322-9b37-4c58619fa7dd&page=queryresults
[0m12:37:00.662191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162df46a0>]}
[0m12:37:00.663574 [info ] [Thread-1  ]: 2 of 12 OK created sql table model stock_analysis.base_spus_2019_2024 .......... [[32mCREATE TABLE (1.2k rows, 55.5 KiB processed)[0m in 3.16s]
[0m12:37:00.664804 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m12:37:00.665734 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m12:37:00.666658 [info ] [Thread-1  ]: 3 of 12 START sql table model stock_analysis.base_spy_1993_2024 ................ [RUN]
[0m12:37:00.667465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spus_2019_2024, now model.stock_analysis.base_spy_1993_2024)
[0m12:37:00.668002 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m12:37:00.675086 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m12:37:00.677665 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m12:37:00.680683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:01.215538 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_1993_2024"
[0m12:37:01.219547 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_1993_2024`
    );
  
[0m12:37:01.665005 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:103ae779-9de6-4c32-ae6d-07c3d75adbe8&page=queryresults
[0m12:37:03.908949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103410100>]}
[0m12:37:03.910634 [info ] [Thread-1  ]: 3 of 12 OK created sql table model stock_analysis.base_spy_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.24s]
[0m12:37:03.911647 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m12:37:03.912003 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:37:03.912650 [info ] [Thread-1  ]: 4 of 12 START sql table model stock_analysis.base_spy_2014_2024 ................ [RUN]
[0m12:37:03.913306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_1993_2024, now model.stock_analysis.base_spy_2014_2024)
[0m12:37:03.913586 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:37:03.917390 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:37:03.918007 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:37:03.919831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:04.452743 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:37:04.454752 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:37:04.923504 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1ca32ff5-5929-4e23-9afe-d2c70508378a&page=queryresults
[0m12:37:06.865832 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134cfd160>]}
[0m12:37:06.867244 [info ] [Thread-1  ]: 4 of 12 OK created sql table model stock_analysis.base_spy_2014_2024 ........... [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.95s]
[0m12:37:06.868058 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:37:06.868576 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m12:37:06.869412 [info ] [Thread-1  ]: 5 of 12 START sql table model stock_analysis.base_symbols_meta ................. [RUN]
[0m12:37:06.870216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.base_symbols_meta)
[0m12:37:06.870637 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m12:37:06.874572 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m12:37:06.875601 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m12:37:06.878215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:07.387959 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m12:37:07.389959 [debug] [Thread-1  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_valid_meta`
    );
  
[0m12:37:07.995813 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7c48f938-96a1-407d-93fd-188449ecefcd&page=queryresults
[0m12:37:09.996170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134d38ee0>]}
[0m12:37:09.998588 [info ] [Thread-1  ]: 5 of 12 OK created sql table model stock_analysis.base_symbols_meta ............ [[32mCREATE TABLE (8.0k rows, 0 processed)[0m in 3.13s]
[0m12:37:09.999792 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m12:37:10.000594 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m12:37:10.001644 [info ] [Thread-1  ]: 6 of 12 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m12:37:10.002466 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_symbols_meta, now model.stock_analysis.stg_calendar)
[0m12:37:10.003082 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m12:37:10.009955 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m12:37:10.011100 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m12:37:10.013435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:10.576061 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m12:37:10.579612 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m12:37:10.966581 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d505d5fe-94de-476d-a420-f94fdc263bed&page=queryresults
[0m12:37:16.046617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d20a60>]}
[0m12:37:16.049071 [info ] [Thread-1  ]: 6 of 12 OK created sql table model stock_analysis.stg_calendar ................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 6.04s]
[0m12:37:16.049962 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m12:37:16.051041 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_symbols_meta
[0m12:37:16.051943 [info ] [Thread-1  ]: 7 of 12 START sql table model stock_analysis.stg_symbols_meta .................. [RUN]
[0m12:37:16.053030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_symbols_meta)
[0m12:37:16.053639 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m12:37:16.058155 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m12:37:16.059294 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m12:37:16.063135 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_symbols_meta"
[0m12:37:16.064076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:16.133267 [debug] [Thread-1  ]: On model.stock_analysis.stg_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_symbols_meta`
      
    
    

    OPTIONS()
    as (
      with 

symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`base_symbols_meta` )

select 
    symbol
    , security_name
    , listing_exchange
    , market_category
    , is_ETF
from symbols_meta
    );
  
[0m12:37:16.904690 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:406f6fe4-f6f4-405a-a88b-a65c97b01203&page=queryresults
[0m12:37:18.808126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d20a60>]}
[0m12:37:18.808646 [info ] [Thread-1  ]: 7 of 12 OK created sql table model stock_analysis.stg_symbols_meta ............. [[32mCREATE TABLE (8.0k rows, 495.2 KiB processed)[0m in 2.76s]
[0m12:37:18.809089 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m12:37:18.809386 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m12:37:18.809801 [info ] [Thread-1  ]: 8 of 12 START sql table model stock_analysis.stg_spus_2019_2024 ................ [RUN]
[0m12:37:18.810181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_symbols_meta, now model.stock_analysis.stg_spus_2019_2024)
[0m12:37:18.810447 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m12:37:18.813835 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:37:18.815574 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m12:37:18.817408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:19.300162 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:37:19.303254 [debug] [Thread-1  ]: On model.stock_analysis.stg_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- --   DEPRACATED   -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 


with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:37:19.672581 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06e03b68-8d30-471d-b193-be067d13693b&page=queryresults
[0m12:37:44.209681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134cfd1f0>]}
[0m12:37:44.213163 [info ] [Thread-1  ]: 8 of 12 OK created sql table model stock_analysis.stg_spus_2019_2024 ........... [[32mCREATE TABLE (1.2k rows, 37.6 MiB processed)[0m in 25.40s]
[0m12:37:44.214473 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m12:37:44.215073 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m12:37:44.215792 [info ] [Thread-1  ]: 9 of 12 START sql table model stock_analysis.stg_spy_1993_2024 ................. [RUN]
[0m12:37:44.216936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spus_2019_2024, now model.stock_analysis.stg_spy_1993_2024)
[0m12:37:44.217660 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m12:37:44.223628 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m12:37:44.226223 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m12:37:44.229532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:44.752720 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_1993_2024"
[0m12:37:44.755103 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:37:45.269878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ddf48685-070c-4965-b82d-fcd2ee7c5c34&page=queryresults
[0m12:39:36.916622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d20a60>]}
[0m12:39:36.920004 [info ] [Thread-1  ]: 9 of 12 OK created sql table model stock_analysis.stg_spy_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 112.70s]
[0m12:39:36.920928 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m12:39:36.921383 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:39:36.921991 [info ] [Thread-1  ]: 10 of 12 START sql table model stock_analysis.stg_spy_2014_2024 ................ [RUN]
[0m12:39:36.922618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_1993_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m12:39:36.922949 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:39:36.927065 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:39:36.928898 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:39:36.931480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:37.506106 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:39:37.510333 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:39:38.012312 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c5f57b1f-7228-4377-b74c-db4a276bd6dc&page=queryresults
[0m12:40:21.832494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d21d30>]}
[0m12:40:21.833693 [info ] [Thread-1  ]: 10 of 12 OK created sql table model stock_analysis.stg_spy_2014_2024 ........... [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 44.91s]
[0m12:40:21.834445 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:40:21.834938 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m12:40:21.835599 [info ] [Thread-1  ]: 11 of 12 START sql table model stock_analysis.int_stock_analysis ............... [RUN]
[0m12:40:21.836221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.int_stock_analysis)
[0m12:40:21.836665 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m12:40:21.843888 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m12:40:21.846094 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m12:40:21.848577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:40:22.449525 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m12:40:22.452040 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )

, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )

select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
    );
  
[0m12:40:22.861217 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:de1f6082-1062-46a1-9d6e-903196acae18&page=queryresults
[0m12:40:25.608776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163b6df70>]}
[0m12:40:25.611205 [info ] [Thread-1  ]: 11 of 12 OK created sql table model stock_analysis.int_stock_analysis .......... [[32mCREATE TABLE (9.1k rows, 3.4 MiB processed)[0m in 3.77s]
[0m12:40:25.612736 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m12:40:25.614246 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m12:40:25.615030 [info ] [Thread-1  ]: 12 of 12 START sql table model stock_analysis.stock_analysis ................... [RUN]
[0m12:40:25.615700 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.int_stock_analysis, now model.stock_analysis.stock_analysis)
[0m12:40:25.616152 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m12:40:25.622359 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m12:40:25.623864 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m12:40:25.628022 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m12:40:25.628965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:40:25.708062 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m12:40:26.549205 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f8c9c8a3-c3e8-4b8f-acc1-84e55293f77a&page=queryresults
[0m12:40:28.816364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '239e2137-447e-4bb7-9ad2-12df46cbd0a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397a280>]}
[0m12:40:28.817595 [info ] [Thread-1  ]: 12 of 12 OK created sql table model stock_analysis.stock_analysis .............. [[32mCREATE TABLE (9.1k rows, 3.9 MiB processed)[0m in 3.20s]
[0m12:40:28.818373 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m12:40:28.819811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:28.820220 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m12:40:28.820701 [info ] [MainThread]: 
[0m12:40:28.821095 [info ] [MainThread]: Finished running 12 table models in 0 hours 3 minutes and 36.35 seconds (216.35s).
[0m12:40:28.823834 [debug] [MainThread]: Command end result
[0m12:40:28.859032 [info ] [MainThread]: 
[0m12:40:28.859477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:28.859749 [info ] [MainThread]: 
[0m12:40:28.859993 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m12:40:28.861837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 217.10452, "process_user_time": 3.616631, "process_kernel_time": 2.909978, "process_mem_max_rss": "191971328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:40:28.862231 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:28.862168 after 217.10 seconds
[0m12:40:28.862482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f88a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102576d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032ef7c0>]}
[0m12:40:28.862737 [debug] [MainThread]: Flushing usage events
[0m13:44:20.380748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102054a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039d9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039d9e80>]}


============================== 13:44:20.383668 | a1cf3e89-9d36-4d26-b068-fc9b02ae02f7 ==============================
[0m13:44:20.383668 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:44:20.383992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:21.137524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1cf3e89-9d36-4d26-b068-fc9b02ae02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10228c640>]}
[0m13:44:21.163133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1cf3e89-9d36-4d26-b068-fc9b02ae02f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd8310>]}
[0m13:44:21.163401 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:44:21.175745 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:44:21.266989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 64 files added, 1 files changed.
[0m13:44:21.267352 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_msft_1993_2024.sql
[0m13:44:21.267525 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_jnj_1993_2024.sql
[0m13:44:21.267682 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_aapl_1993_2024.sql
[0m13:44:21.267842 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_brk-b_1996_2024.sql
[0m13:44:21.267993 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_ma_2006_2024.sql
[0m13:44:21.268140 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_cvx_1993_2024.sql
[0m13:44:21.268286 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_pep_1993_2024.sql
[0m13:44:21.268428 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_abbv_2013_2024.sql
[0m13:44:21.268569 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_amzn_1997_2024.sql
[0m13:44:21.268713 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_amd_1993_2024.sql
[0m13:44:21.268853 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_goog_2004_2024.sql
[0m13:44:21.268991 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_avgo_2009_2024.sql
[0m13:44:21.269134 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_ko_1993_2024.sql
[0m13:44:21.269274 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_goog_2004_2024.sql
[0m13:44:21.269413 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_mrk_1993_2024.sql
[0m13:44:21.269558 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_xom_1993_2024.sql
[0m13:44:21.269702 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_tmo_1993_2024.sql
[0m13:44:21.269848 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_jnj_1993_2024.sql
[0m13:44:21.269994 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_nvda_1999_2024.sql
[0m13:44:21.270137 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_amd_1993_2024.sql
[0m13:44:21.270273 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_lly_1993_2024.sql
[0m13:44:21.270414 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_ma_2006_2024.sql
[0m13:44:21.270554 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_amzn_1997_2024.sql
[0m13:44:21.270692 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_pep_1993_2024.sql
[0m13:44:21.270829 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_adbe_1993_2024.sql
[0m13:44:21.270987 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_crm_2004_2024.sql
[0m13:44:21.271131 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_aapl_1993_2024.sql
[0m13:44:21.271270 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_xom_1993_2024.sql
[0m13:44:21.271407 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_abbv_2013_2024.sql
[0m13:44:21.271546 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_cvx_1993_2024.sql
[0m13:44:21.271689 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_brk-b_1996_2024.sql
[0m13:44:21.271834 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_tmo_1993_2024.sql
[0m13:44:21.271984 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_bac_1993_2024.sql
[0m13:44:21.272130 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_bac_1993_2024.sql
[0m13:44:21.272275 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_unh_1993_2024.sql
[0m13:44:21.272418 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_meta_2012_2024.sql
[0m13:44:21.272555 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_unh_1993_2024.sql
[0m13:44:21.272693 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_tsla_2010_2024.sql
[0m13:44:21.272833 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_ko_1993_2024.sql
[0m13:44:21.272973 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_googl_2004_2024.sql
[0m13:44:21.273117 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_lly_1993_2024.sql
[0m13:44:21.273256 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_wmt_1993_2024.sql
[0m13:44:21.273404 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_meta_2012_2024.sql
[0m13:44:21.273550 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_crm_2004_2024.sql
[0m13:44:21.273695 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_tsla_2010_2024.sql
[0m13:44:21.273839 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_adbe_1993_2024.sql
[0m13:44:21.273984 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_avgo_2009_2024.sql
[0m13:44:21.274125 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nvda_1999_2024.sql
[0m13:44:21.274265 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_jpm_1993_2024.sql
[0m13:44:21.274404 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_wmt_1993_2024.sql
[0m13:44:21.274548 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_pg_1993_2024.sql
[0m13:44:21.274687 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_v_1993_2024.sql
[0m13:44:21.274826 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_cost_1993_2024.sql
[0m13:44:21.274966 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_nflx_1993_2024.sql
[0m13:44:21.275109 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_cost_1993_2024.sql
[0m13:44:21.275247 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_mrk_1993_2024.sql
[0m13:44:21.275384 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_pg_1993_2024.sql
[0m13:44:21.275521 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_hd_1993_2024.sql
[0m13:44:21.275673 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_jpm_1993_2024.sql
[0m13:44:21.275826 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_msft_1993_2024.sql
[0m13:44:21.275979 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_googl_2004_2024.sql
[0m13:44:21.276128 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nflx_1993_2024.sql
[0m13:44:21.276279 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_v_1993_2024.sql
[0m13:44:21.276423 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_hd_1993_2024.sql
[0m13:44:21.277052 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m13:44:21.540895 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.base_abbv_2013_2024' (models/1_base/base_abbv_2013_2024.sql) depends on a source named 'stock.aabv' which was not found
[0m13:44:21.543417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2131659, "process_user_time": 1.830728, "process_kernel_time": 2.741606, "process_mem_max_rss": "190496768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:21.543729 [debug] [MainThread]: Command `dbt run` failed at 13:44:21.543679 after 1.21 seconds
[0m13:44:21.543946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102054a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12959ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128df8760>]}
[0m13:44:21.544129 [debug] [MainThread]: Flushing usage events
[0m13:44:58.692828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106804b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108189d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108189f40>]}


============================== 13:44:58.695246 | 9bf73e11-9f4c-4ee2-a85a-8d8e78d5314b ==============================
[0m13:44:58.695246 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:44:58.695550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:59.194182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf73e11-9f4c-4ee2-a85a-8d8e78d5314b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cade4f0>]}
[0m13:44:59.219978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf73e11-9f4c-4ee2-a85a-8d8e78d5314b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108114df0>]}
[0m13:44:59.220275 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:44:59.231811 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:44:59.314174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 64 files added, 1 files changed.
[0m13:44:59.314530 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_tmo_1993_2024.sql
[0m13:44:59.314722 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_ko_1993_2024.sql
[0m13:44:59.314882 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_unh_1993_2024.sql
[0m13:44:59.315047 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_nflx_1993_2024.sql
[0m13:44:59.315193 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_cvx_1993_2024.sql
[0m13:44:59.315339 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_amzn_1997_2024.sql
[0m13:44:59.315485 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_amd_1993_2024.sql
[0m13:44:59.315629 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_xom_1993_2024.sql
[0m13:44:59.315785 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_brk-b_1996_2024.sql
[0m13:44:59.315931 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_aapl_1993_2024.sql
[0m13:44:59.316076 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_msft_1993_2024.sql
[0m13:44:59.316229 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_nvda_1999_2024.sql
[0m13:44:59.316372 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_abbv_2013_2024.sql
[0m13:44:59.316514 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_hd_1993_2024.sql
[0m13:44:59.316657 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_jnj_1993_2024.sql
[0m13:44:59.316802 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_pep_1993_2024.sql
[0m13:44:59.316944 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_crm_2004_2024.sql
[0m13:44:59.317085 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_jnj_1993_2024.sql
[0m13:44:59.317235 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_brk-b_1996_2024.sql
[0m13:44:59.317377 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_googl_2004_2024.sql
[0m13:44:59.317529 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_jpm_1993_2024.sql
[0m13:44:59.317676 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_xom_1993_2024.sql
[0m13:44:59.317830 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_cost_1993_2024.sql
[0m13:44:59.317977 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_lly_1993_2024.sql
[0m13:44:59.318124 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nvda_1999_2024.sql
[0m13:44:59.318285 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_meta_2012_2024.sql
[0m13:44:59.318430 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_bac_1993_2024.sql
[0m13:44:59.318571 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_tsla_2010_2024.sql
[0m13:44:59.318718 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_mrk_1993_2024.sql
[0m13:44:59.318858 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_aapl_1993_2024.sql
[0m13:44:59.319000 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_mrk_1993_2024.sql
[0m13:44:59.319150 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_v_1993_2024.sql
[0m13:44:59.319296 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_ma_2006_2024.sql
[0m13:44:59.319437 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_msft_1993_2024.sql
[0m13:44:59.319577 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_adbe_1993_2024.sql
[0m13:44:59.319718 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_jpm_1993_2024.sql
[0m13:44:59.319872 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_unh_1993_2024.sql
[0m13:44:59.320013 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_avgo_2009_2024.sql
[0m13:44:59.320155 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_cvx_1993_2024.sql
[0m13:44:59.320306 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_cost_1993_2024.sql
[0m13:44:59.320451 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_pep_1993_2024.sql
[0m13:44:59.320596 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_amd_1993_2024.sql
[0m13:44:59.320740 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_meta_2012_2024.sql
[0m13:44:59.320881 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_ma_2006_2024.sql
[0m13:44:59.321025 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_ko_1993_2024.sql
[0m13:44:59.321182 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_crm_2004_2024.sql
[0m13:44:59.321331 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_goog_2004_2024.sql
[0m13:44:59.321481 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_adbe_1993_2024.sql
[0m13:44:59.321631 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_goog_2004_2024.sql
[0m13:44:59.321787 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_tmo_1993_2024.sql
[0m13:44:59.321932 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_v_1993_2024.sql
[0m13:44:59.322082 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nflx_1993_2024.sql
[0m13:44:59.322233 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_googl_2004_2024.sql
[0m13:44:59.322375 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_amzn_1997_2024.sql
[0m13:44:59.322515 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_pg_1993_2024.sql
[0m13:44:59.322656 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_bac_1993_2024.sql
[0m13:44:59.322796 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_avgo_2009_2024.sql
[0m13:44:59.322935 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_lly_1993_2024.sql
[0m13:44:59.323075 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_hd_1993_2024.sql
[0m13:44:59.323214 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_wmt_1993_2024.sql
[0m13:44:59.323355 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_tsla_2010_2024.sql
[0m13:44:59.323495 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_wmt_1993_2024.sql
[0m13:44:59.323636 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_abbv_2013_2024.sql
[0m13:44:59.323780 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_pg_1993_2024.sql
[0m13:44:59.324356 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m13:44:59.585631 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.stg_adbe_1993_2024' (models/2_staging/stg_adbe_1993_2024.sql) depends on a node named 'base_adbe_1994_2024' which was not found
[0m13:44:59.587035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.94019336, "process_user_time": 1.728454, "process_kernel_time": 2.575553, "process_mem_max_rss": "191807488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:59.587344 [debug] [MainThread]: Command `dbt run` failed at 13:44:59.587286 after 0.94 seconds
[0m13:44:59.587567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106804b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e92abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e92a2e0>]}
[0m13:44:59.587767 [debug] [MainThread]: Flushing usage events
[0m13:45:31.861890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102534ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cde50>]}


============================== 13:45:31.864458 | f4248ac8-198b-4d46-9c77-9177bf69b4f2 ==============================
[0m13:45:31.864458 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:45:31.864784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:45:32.375985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520cc0d0>]}
[0m13:45:32.401933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417f9d0>]}
[0m13:45:32.402295 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:45:32.415250 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:45:32.500808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 64 files added, 1 files changed.
[0m13:45:32.501130 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_goog_2004_2024.sql
[0m13:45:32.501308 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_jnj_1993_2024.sql
[0m13:45:32.501475 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_adbe_1993_2024.sql
[0m13:45:32.501630 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_ma_2006_2024.sql
[0m13:45:32.501779 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_hd_1993_2024.sql
[0m13:45:32.501932 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_unh_1993_2024.sql
[0m13:45:32.502078 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_v_1993_2024.sql
[0m13:45:32.502228 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_abbv_2013_2024.sql
[0m13:45:32.502375 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_cvx_1993_2024.sql
[0m13:45:32.502517 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_pg_1993_2024.sql
[0m13:45:32.502661 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_tsla_2010_2024.sql
[0m13:45:32.502801 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_jpm_1993_2024.sql
[0m13:45:32.502943 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nflx_1993_2024.sql
[0m13:45:32.503085 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_wmt_1993_2024.sql
[0m13:45:32.503239 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_jpm_1993_2024.sql
[0m13:45:32.503386 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_nflx_1993_2024.sql
[0m13:45:32.503526 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_xom_1993_2024.sql
[0m13:45:32.503666 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_nvda_1999_2024.sql
[0m13:45:32.503807 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_mrk_1993_2024.sql
[0m13:45:32.503954 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_lly_1993_2024.sql
[0m13:45:32.504099 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_meta_2012_2024.sql
[0m13:45:32.504247 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_adbe_1993_2024.sql
[0m13:45:32.504408 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_cost_1993_2024.sql
[0m13:45:32.504560 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_aapl_1993_2024.sql
[0m13:45:32.504704 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_brk-b_1996_2024.sql
[0m13:45:32.504881 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_mrk_1993_2024.sql
[0m13:45:32.505033 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_pep_1993_2024.sql
[0m13:45:32.505182 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_ko_1993_2024.sql
[0m13:45:32.505326 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_googl_2004_2024.sql
[0m13:45:32.505469 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_amd_1993_2024.sql
[0m13:45:32.505613 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_bac_1993_2024.sql
[0m13:45:32.505764 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_amd_1993_2024.sql
[0m13:45:32.505911 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_pep_1993_2024.sql
[0m13:45:32.506054 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_wmt_1993_2024.sql
[0m13:45:32.506192 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_msft_1993_2024.sql
[0m13:45:32.506332 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_pg_1993_2024.sql
[0m13:45:32.506474 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_tmo_1993_2024.sql
[0m13:45:32.506613 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_amzn_1997_2024.sql
[0m13:45:32.506754 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_crm_2004_2024.sql
[0m13:45:32.506894 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_msft_1993_2024.sql
[0m13:45:32.507033 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_meta_2012_2024.sql
[0m13:45:32.507174 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_jnj_1993_2024.sql
[0m13:45:32.507314 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_amzn_1997_2024.sql
[0m13:45:32.507452 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_aapl_1993_2024.sql
[0m13:45:32.507590 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_goog_2004_2024.sql
[0m13:45:32.507735 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_unh_1993_2024.sql
[0m13:45:32.507876 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_v_1993_2024.sql
[0m13:45:32.508017 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_xom_1993_2024.sql
[0m13:45:32.508159 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_crm_2004_2024.sql
[0m13:45:32.508306 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_avgo_2009_2024.sql
[0m13:45:32.508443 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_ko_1993_2024.sql
[0m13:45:32.508586 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_googl_2004_2024.sql
[0m13:45:32.508726 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_tsla_2010_2024.sql
[0m13:45:32.508868 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nvda_1999_2024.sql
[0m13:45:32.509011 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_ma_2006_2024.sql
[0m13:45:32.509150 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_lly_1993_2024.sql
[0m13:45:32.509290 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_hd_1993_2024.sql
[0m13:45:32.509430 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_avgo_2009_2024.sql
[0m13:45:32.509570 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_brk-b_1996_2024.sql
[0m13:45:32.509709 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_bac_1993_2024.sql
[0m13:45:32.509849 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_tmo_1993_2024.sql
[0m13:45:32.509992 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_cost_1993_2024.sql
[0m13:45:32.510133 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_abbv_2013_2024.sql
[0m13:45:32.510271 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_cvx_1993_2024.sql
[0m13:45:32.510869 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m13:45:32.663370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153836160>]}
[0m13:45:32.825386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a13130>]}
[0m13:45:32.891830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102932c40>]}
[0m13:45:32.892120 [info ] [MainThread]: Found 76 models, 37 sources, 469 macros
[0m13:45:32.892319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102932e20>]}
[0m13:45:32.894512 [info ] [MainThread]: 
[0m13:45:32.894804 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:32.899791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:45:32.900051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:33.479203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:45:33.479956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:34.003668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15225ffd0>]}
[0m13:45:34.004800 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:45:34.005223 [info ] [MainThread]: 
[0m13:45:34.009964 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_aapl_1993_2024
[0m13:45:34.010517 [info ] [Thread-1  ]: 1 of 76 START sql table model stock_analysis.base_aapl_1993_2024 ............... [RUN]
[0m13:45:34.010988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_aapl_1993_2024)
[0m13:45:34.011435 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_aapl_1993_2024
[0m13:45:34.020985 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_aapl_1993_2024"
[0m13:45:34.021829 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_aapl_1993_2024
[0m13:45:34.053214 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_aapl_1993_2024"
[0m13:45:34.053791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:34.117597 [debug] [Thread-1  ]: On model.stock_analysis.base_aapl_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_aapl_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_aapl_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`aapl`
    );
  
[0m13:45:35.168859 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0eab682e-0417-4873-8b4a-d0e1c6ab95d2&page=queryresults
[0m13:45:37.354295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a6a7c0>]}
[0m13:45:37.355150 [info ] [Thread-1  ]: 1 of 76 OK created sql table model stock_analysis.base_aapl_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.34s]
[0m13:45:37.355748 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_aapl_1993_2024
[0m13:45:37.356135 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_abbv_2013_2024
[0m13:45:37.356636 [info ] [Thread-1  ]: 2 of 76 START sql table model stock_analysis.base_abbv_2013_2024 ............... [RUN]
[0m13:45:37.357101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_aapl_1993_2024, now model.stock_analysis.base_abbv_2013_2024)
[0m13:45:37.357429 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_abbv_2013_2024
[0m13:45:37.360454 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_abbv_2013_2024"
[0m13:45:37.361358 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_abbv_2013_2024
[0m13:45:37.366265 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_abbv_2013_2024"
[0m13:45:37.367020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:37.437974 [debug] [Thread-1  ]: On model.stock_analysis.base_abbv_2013_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_abbv_2013_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_abbv_2013_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`abbv`
    );
  
[0m13:45:38.165209 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1ba38c4f-e997-4e03-9653-aed0e6bce728&page=queryresults
[0m13:45:40.242013 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bb9100>]}
[0m13:45:40.244464 [info ] [Thread-1  ]: 2 of 76 OK created sql table model stock_analysis.base_abbv_2013_2024 .......... [[32mCREATE TABLE (2.9k rows, 137.6 KiB processed)[0m in 2.88s]
[0m13:45:40.245616 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_abbv_2013_2024
[0m13:45:40.246309 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_adbe_1993_2024
[0m13:45:40.247142 [info ] [Thread-1  ]: 3 of 76 START sql table model stock_analysis.base_adbe_1993_2024 ............... [RUN]
[0m13:45:40.247809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_abbv_2013_2024, now model.stock_analysis.base_adbe_1993_2024)
[0m13:45:40.248313 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_adbe_1993_2024
[0m13:45:40.254725 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_adbe_1993_2024"
[0m13:45:40.256064 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_adbe_1993_2024
[0m13:45:40.260145 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_adbe_1993_2024"
[0m13:45:40.261017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:40.339692 [debug] [Thread-1  ]: On model.stock_analysis.base_adbe_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_adbe_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_adbe_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`adbe`
    );
  
[0m13:45:41.226202 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:356fe24c-455a-4990-a790-b822ffcf17e7&page=queryresults
[0m13:45:43.136621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15250ca60>]}
[0m13:45:43.138537 [info ] [Thread-1  ]: 3 of 76 OK created sql table model stock_analysis.base_adbe_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.89s]
[0m13:45:43.139765 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_adbe_1993_2024
[0m13:45:43.140454 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_amd_1993_2024
[0m13:45:43.141304 [info ] [Thread-1  ]: 4 of 76 START sql table model stock_analysis.base_amd_1993_2024 ................ [RUN]
[0m13:45:43.142077 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_adbe_1993_2024, now model.stock_analysis.base_amd_1993_2024)
[0m13:45:43.142469 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_amd_1993_2024
[0m13:45:43.147127 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_amd_1993_2024"
[0m13:45:43.148196 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_amd_1993_2024
[0m13:45:43.151296 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_amd_1993_2024"
[0m13:45:43.151950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:43.225625 [debug] [Thread-1  ]: On model.stock_analysis.base_amd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_amd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_amd_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`amd`
    );
  
[0m13:45:43.869547 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cfdb59e3-5c07-4d0c-add3-aeb15a196f7f&page=queryresults
[0m13:45:45.789722 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b57f40>]}
[0m13:45:45.791136 [info ] [Thread-1  ]: 4 of 76 OK created sql table model stock_analysis.base_amd_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.65s]
[0m13:45:45.792593 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_amd_1993_2024
[0m13:45:45.793286 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_amzn_1997_2024
[0m13:45:45.794177 [info ] [Thread-1  ]: 5 of 76 START sql table model stock_analysis.base_amzn_1997_2024 ............... [RUN]
[0m13:45:45.794982 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amd_1993_2024, now model.stock_analysis.base_amzn_1997_2024)
[0m13:45:45.795462 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_amzn_1997_2024
[0m13:45:45.800509 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_amzn_1997_2024"
[0m13:45:45.801688 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_amzn_1997_2024
[0m13:45:45.807234 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_amzn_1997_2024"
[0m13:45:45.808340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:45.884327 [debug] [Thread-1  ]: On model.stock_analysis.base_amzn_1997_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_amzn_1997_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_amzn_1997_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`amzn`
    );
  
[0m13:45:46.624059 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2e86469d-3324-4cd0-9a3f-d366e6c227f9&page=queryresults
[0m13:45:48.824874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c4d940>]}
[0m13:45:48.825938 [info ] [Thread-1  ]: 5 of 76 OK created sql table model stock_analysis.base_amzn_1997_2024 .......... [[32mCREATE TABLE (6.9k rows, 322.0 KiB processed)[0m in 3.03s]
[0m13:45:48.826680 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_amzn_1997_2024
[0m13:45:48.827178 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_avgo_2009_2024
[0m13:45:48.827867 [info ] [Thread-1  ]: 6 of 76 START sql table model stock_analysis.base_avgo_2009_2024 ............... [RUN]
[0m13:45:48.828484 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amzn_1997_2024, now model.stock_analysis.base_avgo_2009_2024)
[0m13:45:48.828918 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_avgo_2009_2024
[0m13:45:48.833423 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_avgo_2009_2024"
[0m13:45:48.834519 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_avgo_2009_2024
[0m13:45:48.838225 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_avgo_2009_2024"
[0m13:45:48.839220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:48.905194 [debug] [Thread-1  ]: On model.stock_analysis.base_avgo_2009_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_avgo_2009_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_avgo_2009_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`avgo`
    );
  
[0m13:45:49.538991 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8f931424-90a2-4b62-af9e-83d928f3afc3&page=queryresults
[0m13:45:51.517588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102980190>]}
[0m13:45:51.520045 [info ] [Thread-1  ]: 6 of 76 OK created sql table model stock_analysis.base_avgo_2009_2024 .......... [[32mCREATE TABLE (3.8k rows, 177.8 KiB processed)[0m in 2.69s]
[0m13:45:51.521430 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_avgo_2009_2024
[0m13:45:51.522278 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_bac_1993_2024
[0m13:45:51.523066 [info ] [Thread-1  ]: 7 of 76 START sql table model stock_analysis.base_bac_1993_2024 ................ [RUN]
[0m13:45:51.523550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_avgo_2009_2024, now model.stock_analysis.base_bac_1993_2024)
[0m13:45:51.523840 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_bac_1993_2024
[0m13:45:51.527232 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_bac_1993_2024"
[0m13:45:51.528050 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_bac_1993_2024
[0m13:45:51.530347 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_bac_1993_2024"
[0m13:45:51.530771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:51.593431 [debug] [Thread-1  ]: On model.stock_analysis.base_bac_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_bac_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_bac_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`bac`
    );
  
[0m13:45:52.389716 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:892ceccd-302b-4a4d-b0be-a56ef66b1ece&page=queryresults
[0m13:45:54.345920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c01040>]}
[0m13:45:54.348388 [info ] [Thread-1  ]: 7 of 76 OK created sql table model stock_analysis.base_bac_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.82s]
[0m13:45:54.349763 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_bac_1993_2024
[0m13:45:54.350608 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_brk-b_1996_2024
[0m13:45:54.351482 [info ] [Thread-1  ]: 8 of 76 START sql table model stock_analysis.base_brk-b_1996_2024 .............. [RUN]
[0m13:45:54.352015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_bac_1993_2024, now model.stock_analysis.base_brk-b_1996_2024)
[0m13:45:54.352357 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_brk-b_1996_2024
[0m13:45:54.356192 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_brk-b_1996_2024"
[0m13:45:54.357052 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_brk-b_1996_2024
[0m13:45:54.360761 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_brk-b_1996_2024"
[0m13:45:54.361575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:54.428183 [debug] [Thread-1  ]: On model.stock_analysis.base_brk-b_1996_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_brk-b_1996_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_brk-b_1996_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`brk-b`
    );
  
[0m13:45:55.384376 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:55205fd5-98e5-42be-b60d-a7b25399ae05&page=queryresults
[0m13:45:57.626202 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c4d940>]}
[0m13:45:57.627488 [info ] [Thread-1  ]: 8 of 76 OK created sql table model stock_analysis.base_brk-b_1996_2024 ......... [[32mCREATE TABLE (7.1k rows, 334.0 KiB processed)[0m in 3.27s]
[0m13:45:57.628313 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_brk-b_1996_2024
[0m13:45:57.628907 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:45:57.629662 [info ] [Thread-1  ]: 9 of 76 START sql table model stock_analysis.base_calendar ..................... [RUN]
[0m13:45:57.630417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_brk-b_1996_2024, now model.stock_analysis.base_calendar)
[0m13:45:57.631124 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:45:57.636088 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:45:57.638042 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:45:57.641361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:58.167465 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m13:45:58.169892 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m13:45:58.614799 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6e0b7032-4bbf-41b5-b280-61936330feac&page=queryresults
[0m13:46:02.330544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b40640>]}
[0m13:46:02.331170 [info ] [Thread-1  ]: 9 of 76 OK created sql table model stock_analysis.base_calendar ................ [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.70s]
[0m13:46:02.331580 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:46:02.331860 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_cost_1993_2024
[0m13:46:02.332256 [info ] [Thread-1  ]: 10 of 76 START sql table model stock_analysis.base_cost_1993_2024 .............. [RUN]
[0m13:46:02.332792 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_cost_1993_2024)
[0m13:46:02.333067 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_cost_1993_2024
[0m13:46:02.335154 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_cost_1993_2024"
[0m13:46:02.335703 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_cost_1993_2024
[0m13:46:02.337679 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_cost_1993_2024"
[0m13:46:02.338174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:02.408092 [debug] [Thread-1  ]: On model.stock_analysis.base_cost_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_cost_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_cost_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`cost`
    );
  
[0m13:46:03.141528 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9af30e12-a423-4384-ad20-c0547b0975f3&page=queryresults
[0m13:46:05.373104 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153acb370>]}
[0m13:46:05.374550 [info ] [Thread-1  ]: 10 of 76 OK created sql table model stock_analysis.base_cost_1993_2024 ......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.04s]
[0m13:46:05.375402 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_cost_1993_2024
[0m13:46:05.375997 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_crm_2004_2024
[0m13:46:05.377331 [info ] [Thread-1  ]: 11 of 76 START sql table model stock_analysis.base_crm_2004_2024 ............... [RUN]
[0m13:46:05.378167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cost_1993_2024, now model.stock_analysis.base_crm_2004_2024)
[0m13:46:05.378688 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_crm_2004_2024
[0m13:46:05.383792 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_crm_2004_2024"
[0m13:46:05.384978 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_crm_2004_2024
[0m13:46:05.390839 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_crm_2004_2024"
[0m13:46:05.391544 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:05.467924 [debug] [Thread-1  ]: On model.stock_analysis.base_crm_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_crm_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_crm_2004_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`crm`
    );
  
[0m13:46:06.520469 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7c5915ec-f771-4f98-b12e-ca6d5b514553&page=queryresults
[0m13:46:08.548692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c4d940>]}
[0m13:46:08.550130 [info ] [Thread-1  ]: 11 of 76 OK created sql table model stock_analysis.base_crm_2004_2024 .......... [[32mCREATE TABLE (5.1k rows, 238.3 KiB processed)[0m in 3.17s]
[0m13:46:08.551006 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_crm_2004_2024
[0m13:46:08.551876 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_cvx_1993_2024
[0m13:46:08.553003 [info ] [Thread-1  ]: 12 of 76 START sql table model stock_analysis.base_cvx_1993_2024 ............... [RUN]
[0m13:46:08.553781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_crm_2004_2024, now model.stock_analysis.base_cvx_1993_2024)
[0m13:46:08.554332 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_cvx_1993_2024
[0m13:46:08.559605 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_cvx_1993_2024"
[0m13:46:08.560834 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_cvx_1993_2024
[0m13:46:08.564903 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_cvx_1993_2024"
[0m13:46:08.565907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:08.643638 [debug] [Thread-1  ]: On model.stock_analysis.base_cvx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_cvx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_cvx_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`cvx`
    );
  
[0m13:46:09.312969 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c6a0e3c6-a230-4ecf-8053-002576d2ee00&page=queryresults
[0m13:46:11.575768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c4d940>]}
[0m13:46:11.577114 [info ] [Thread-1  ]: 12 of 76 OK created sql table model stock_analysis.base_cvx_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.02s]
[0m13:46:11.577955 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_cvx_1993_2024
[0m13:46:11.578531 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_goog_2004_2024
[0m13:46:11.579297 [info ] [Thread-1  ]: 13 of 76 START sql table model stock_analysis.base_goog_2004_2024 .............. [RUN]
[0m13:46:11.580110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cvx_1993_2024, now model.stock_analysis.base_goog_2004_2024)
[0m13:46:11.580761 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_goog_2004_2024
[0m13:46:11.585474 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_goog_2004_2024"
[0m13:46:11.586582 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_goog_2004_2024
[0m13:46:11.591017 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_goog_2004_2024"
[0m13:46:11.591844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:11.670481 [debug] [Thread-1  ]: On model.stock_analysis.base_goog_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_goog_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_goog_2004_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`goog`
    );
  
[0m13:46:12.329558 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:31377e1e-c1d8-4043-a134-199429494a99&page=queryresults
[0m13:46:14.608342 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b5ec40>]}
[0m13:46:14.609689 [info ] [Thread-1  ]: 13 of 76 OK created sql table model stock_analysis.base_goog_2004_2024 ......... [[32mCREATE TABLE (5.0k rows, 236.4 KiB processed)[0m in 3.03s]
[0m13:46:14.610523 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_goog_2004_2024
[0m13:46:14.611093 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_googl_2004_2024
[0m13:46:14.612082 [info ] [Thread-1  ]: 14 of 76 START sql table model stock_analysis.base_googl_2004_2024 ............. [RUN]
[0m13:46:14.613031 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_goog_2004_2024, now model.stock_analysis.base_googl_2004_2024)
[0m13:46:14.613614 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_googl_2004_2024
[0m13:46:14.618092 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_googl_2004_2024"
[0m13:46:14.619302 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_googl_2004_2024
[0m13:46:14.625630 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_googl_2004_2024"
[0m13:46:14.626588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:14.702321 [debug] [Thread-1  ]: On model.stock_analysis.base_googl_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_googl_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_googl_2004_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`googl`
    );
  
[0m13:46:15.429140 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:97ebd25e-2c81-41fd-8852-377c0515d142&page=queryresults
[0m13:46:17.654856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bfb6a0>]}
[0m13:46:17.657240 [info ] [Thread-1  ]: 14 of 76 OK created sql table model stock_analysis.base_googl_2004_2024 ........ [[32mCREATE TABLE (5.0k rows, 236.4 KiB processed)[0m in 3.04s]
[0m13:46:17.659192 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_googl_2004_2024
[0m13:46:17.660327 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_hd_1993_2024
[0m13:46:17.661154 [info ] [Thread-1  ]: 15 of 76 START sql table model stock_analysis.base_hd_1993_2024 ................ [RUN]
[0m13:46:17.661864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_googl_2004_2024, now model.stock_analysis.base_hd_1993_2024)
[0m13:46:17.662383 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_hd_1993_2024
[0m13:46:17.668817 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_hd_1993_2024"
[0m13:46:17.670233 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_hd_1993_2024
[0m13:46:17.674447 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_hd_1993_2024"
[0m13:46:17.675286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:17.753660 [debug] [Thread-1  ]: On model.stock_analysis.base_hd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_hd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_hd_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`hd`
    );
  
[0m13:46:18.494313 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b26d276d-cd8d-4e62-aad1-1fce6ee07e4c&page=queryresults
[0m13:46:20.307935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b5cee0>]}
[0m13:46:20.309457 [info ] [Thread-1  ]: 15 of 76 OK created sql table model stock_analysis.base_hd_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.65s]
[0m13:46:20.310392 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_hd_1993_2024
[0m13:46:20.310989 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_jnj_1993_2024
[0m13:46:20.311708 [info ] [Thread-1  ]: 16 of 76 START sql table model stock_analysis.base_jnj_1993_2024 ............... [RUN]
[0m13:46:20.312700 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_hd_1993_2024, now model.stock_analysis.base_jnj_1993_2024)
[0m13:46:20.313478 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_jnj_1993_2024
[0m13:46:20.318246 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_jnj_1993_2024"
[0m13:46:20.319464 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_jnj_1993_2024
[0m13:46:20.323894 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_jnj_1993_2024"
[0m13:46:20.324843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:20.402787 [debug] [Thread-1  ]: On model.stock_analysis.base_jnj_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_jnj_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_jnj_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`jnj`
    );
  
[0m13:46:21.162181 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:60b06de2-89f4-49ae-8e3d-fad993e81224&page=queryresults
[0m13:46:22.992355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152501c10>]}
[0m13:46:22.993795 [info ] [Thread-1  ]: 16 of 76 OK created sql table model stock_analysis.base_jnj_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.68s]
[0m13:46:22.994955 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_jnj_1993_2024
[0m13:46:22.995902 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_jpm_1993_2024
[0m13:46:22.996818 [info ] [Thread-1  ]: 17 of 76 START sql table model stock_analysis.base_jpm_1993_2024 ............... [RUN]
[0m13:46:22.997635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jnj_1993_2024, now model.stock_analysis.base_jpm_1993_2024)
[0m13:46:22.998178 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_jpm_1993_2024
[0m13:46:23.002667 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_jpm_1993_2024"
[0m13:46:23.003948 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_jpm_1993_2024
[0m13:46:23.010925 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_jpm_1993_2024"
[0m13:46:23.012170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:23.088028 [debug] [Thread-1  ]: On model.stock_analysis.base_jpm_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_jpm_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_jpm_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`jpm`
    );
  
[0m13:46:23.829842 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1b1ab764-7a61-41b4-aa6c-68f799c46528&page=queryresults
[0m13:46:25.681512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15213c460>]}
[0m13:46:25.683554 [info ] [Thread-1  ]: 17 of 76 OK created sql table model stock_analysis.base_jpm_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.68s]
[0m13:46:25.684512 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_jpm_1993_2024
[0m13:46:25.685138 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_ko_1993_2024
[0m13:46:25.686098 [info ] [Thread-1  ]: 18 of 76 START sql table model stock_analysis.base_ko_1993_2024 ................ [RUN]
[0m13:46:25.687168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jpm_1993_2024, now model.stock_analysis.base_ko_1993_2024)
[0m13:46:25.687721 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_ko_1993_2024
[0m13:46:25.691478 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_ko_1993_2024"
[0m13:46:25.692693 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_ko_1993_2024
[0m13:46:25.696986 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_ko_1993_2024"
[0m13:46:25.697732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:25.766304 [debug] [Thread-1  ]: On model.stock_analysis.base_ko_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_ko_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_ko_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`ko`
    );
  
[0m13:46:26.401600 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:df824c19-6ae9-4a7f-ba5d-62e6233073f0&page=queryresults
[0m13:46:28.638280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c75fa0>]}
[0m13:46:28.639587 [info ] [Thread-1  ]: 18 of 76 OK created sql table model stock_analysis.base_ko_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.95s]
[0m13:46:28.640367 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_ko_1993_2024
[0m13:46:28.640893 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_lly_1993_2024
[0m13:46:28.641791 [info ] [Thread-1  ]: 19 of 76 START sql table model stock_analysis.base_lly_1993_2024 ............... [RUN]
[0m13:46:28.642660 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ko_1993_2024, now model.stock_analysis.base_lly_1993_2024)
[0m13:46:28.643127 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_lly_1993_2024
[0m13:46:28.647152 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_lly_1993_2024"
[0m13:46:28.648202 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_lly_1993_2024
[0m13:46:28.651903 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_lly_1993_2024"
[0m13:46:28.652778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:28.727112 [debug] [Thread-1  ]: On model.stock_analysis.base_lly_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_lly_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_lly_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`lly`
    );
  
[0m13:46:29.361228 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f8e61372-e023-457b-a37b-cd2b33f41699&page=queryresults
[0m13:46:31.415339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c75fa0>]}
[0m13:46:31.416865 [info ] [Thread-1  ]: 19 of 76 OK created sql table model stock_analysis.base_lly_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.77s]
[0m13:46:31.417956 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_lly_1993_2024
[0m13:46:31.418609 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_ma_2006_2024
[0m13:46:31.419423 [info ] [Thread-1  ]: 20 of 76 START sql table model stock_analysis.base_ma_2006_2024 ................ [RUN]
[0m13:46:31.420118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_lly_1993_2024, now model.stock_analysis.base_ma_2006_2024)
[0m13:46:31.420555 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_ma_2006_2024
[0m13:46:31.424929 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_ma_2006_2024"
[0m13:46:31.426027 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_ma_2006_2024
[0m13:46:31.433231 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_ma_2006_2024"
[0m13:46:31.434048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:31.509818 [debug] [Thread-1  ]: On model.stock_analysis.base_ma_2006_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_ma_2006_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_ma_2006_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`ma`
    );
  
[0m13:46:32.225218 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:809ac12e-a622-4c3c-af7a-5c1d3ffcfdd4&page=queryresults
[0m13:46:34.251233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153acc0a0>]}
[0m13:46:34.252688 [info ] [Thread-1  ]: 20 of 76 OK created sql table model stock_analysis.base_ma_2006_2024 ........... [[32mCREATE TABLE (4.6k rows, 215.5 KiB processed)[0m in 2.83s]
[0m13:46:34.253602 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_ma_2006_2024
[0m13:46:34.254174 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_meta_2012_2024
[0m13:46:34.254939 [info ] [Thread-1  ]: 21 of 76 START sql table model stock_analysis.base_meta_2012_2024 .............. [RUN]
[0m13:46:34.256100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ma_2006_2024, now model.stock_analysis.base_meta_2012_2024)
[0m13:46:34.256713 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_meta_2012_2024
[0m13:46:34.261557 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_meta_2012_2024"
[0m13:46:34.262776 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_meta_2012_2024
[0m13:46:34.267378 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_meta_2012_2024"
[0m13:46:34.268039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:34.344284 [debug] [Thread-1  ]: On model.stock_analysis.base_meta_2012_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_meta_2012_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_meta_2012_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`meta`
    );
  
[0m13:46:35.094704 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:43e2a27b-7b50-41bd-89a2-1f641051cca2&page=queryresults
[0m13:46:37.029644 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bec4c0>]}
[0m13:46:37.031076 [info ] [Thread-1  ]: 21 of 76 OK created sql table model stock_analysis.base_meta_2012_2024 ......... [[32mCREATE TABLE (3.1k rows, 144.9 KiB processed)[0m in 2.77s]
[0m13:46:37.032516 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_meta_2012_2024
[0m13:46:37.033236 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_mrk_1993_2024
[0m13:46:37.034153 [info ] [Thread-1  ]: 22 of 76 START sql table model stock_analysis.base_mrk_1993_2024 ............... [RUN]
[0m13:46:37.034971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_meta_2012_2024, now model.stock_analysis.base_mrk_1993_2024)
[0m13:46:37.035487 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_mrk_1993_2024
[0m13:46:37.039881 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_mrk_1993_2024"
[0m13:46:37.041118 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_mrk_1993_2024
[0m13:46:37.045377 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_mrk_1993_2024"
[0m13:46:37.046187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:37.123067 [debug] [Thread-1  ]: On model.stock_analysis.base_mrk_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_mrk_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_mrk_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`mrk`
    );
  
[0m13:46:37.957642 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3dbb6d69-8dd2-4a2a-a5cf-554ada43e1db&page=queryresults
[0m13:46:40.313229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bf8160>]}
[0m13:46:40.574460 [info ] [Thread-1  ]: 22 of 76 OK created sql table model stock_analysis.base_mrk_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.28s]
[0m13:46:40.575982 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_mrk_1993_2024
[0m13:46:40.576777 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_msft_1993_2024
[0m13:46:40.577640 [info ] [Thread-1  ]: 23 of 76 START sql table model stock_analysis.base_msft_1993_2024 .............. [RUN]
[0m13:46:40.578555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_mrk_1993_2024, now model.stock_analysis.base_msft_1993_2024)
[0m13:46:40.579089 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_msft_1993_2024
[0m13:46:40.584808 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_msft_1993_2024"
[0m13:46:40.586183 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_msft_1993_2024
[0m13:46:40.593733 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_msft_1993_2024"
[0m13:46:40.594855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:40.672826 [debug] [Thread-1  ]: On model.stock_analysis.base_msft_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_msft_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_msft_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`msft`
    );
  
[0m13:46:41.418755 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d553e843-d672-45fa-823d-78f6d7c33085&page=queryresults
[0m13:46:43.388767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c946d0>]}
[0m13:46:43.391200 [info ] [Thread-1  ]: 23 of 76 OK created sql table model stock_analysis.base_msft_1993_2024 ......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.81s]
[0m13:46:43.392510 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_msft_1993_2024
[0m13:46:43.393406 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_nflx_1993_2024
[0m13:46:43.394426 [info ] [Thread-1  ]: 24 of 76 START sql table model stock_analysis.base_nflx_1993_2024 .............. [RUN]
[0m13:46:43.395107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_msft_1993_2024, now model.stock_analysis.base_nflx_1993_2024)
[0m13:46:43.395560 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_nflx_1993_2024
[0m13:46:43.399256 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_nflx_1993_2024"
[0m13:46:43.400240 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_nflx_1993_2024
[0m13:46:43.403559 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_nflx_1993_2024"
[0m13:46:43.404391 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:43.477894 [debug] [Thread-1  ]: On model.stock_analysis.base_nflx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_nflx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_nflx_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`nflx`
    );
  
[0m13:46:44.677875 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f935a76b-332d-4076-b9ad-d3886581d59b&page=queryresults
[0m13:46:46.501735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a3eb20>]}
[0m13:46:46.503226 [info ] [Thread-1  ]: 24 of 76 OK created sql table model stock_analysis.base_nflx_1993_2024 ......... [[32mCREATE TABLE (5.6k rows, 262.8 KiB processed)[0m in 3.11s]
[0m13:46:46.504317 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_nflx_1993_2024
[0m13:46:46.504976 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_nvda_1999_2024
[0m13:46:46.505802 [info ] [Thread-1  ]: 25 of 76 START sql table model stock_analysis.base_nvda_1999_2024 .............. [RUN]
[0m13:46:46.506580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nflx_1993_2024, now model.stock_analysis.base_nvda_1999_2024)
[0m13:46:46.507044 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_nvda_1999_2024
[0m13:46:46.511600 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_nvda_1999_2024"
[0m13:46:46.512695 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_nvda_1999_2024
[0m13:46:46.516120 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_nvda_1999_2024"
[0m13:46:46.516941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:46.591381 [debug] [Thread-1  ]: On model.stock_analysis.base_nvda_1999_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_nvda_1999_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_nvda_1999_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`nvda`
    );
  
[0m13:46:47.271911 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9e00a745-7a5e-4dbe-a7d9-8e7e048add36&page=queryresults
[0m13:46:49.118569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c946d0>]}
[0m13:46:49.120088 [info ] [Thread-1  ]: 25 of 76 OK created sql table model stock_analysis.base_nvda_1999_2024 ......... [[32mCREATE TABLE (6.4k rows, 302.1 KiB processed)[0m in 2.61s]
[0m13:46:49.121039 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_nvda_1999_2024
[0m13:46:49.121659 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_pep_1993_2024
[0m13:46:49.122412 [info ] [Thread-1  ]: 26 of 76 START sql table model stock_analysis.base_pep_1993_2024 ............... [RUN]
[0m13:46:49.123615 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nvda_1999_2024, now model.stock_analysis.base_pep_1993_2024)
[0m13:46:49.124263 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_pep_1993_2024
[0m13:46:49.129145 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_pep_1993_2024"
[0m13:46:49.130325 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_pep_1993_2024
[0m13:46:49.137157 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_pep_1993_2024"
[0m13:46:49.138019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:49.214782 [debug] [Thread-1  ]: On model.stock_analysis.base_pep_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_pep_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_pep_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`pep`
    );
  
[0m13:46:49.985204 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12d6b112-a370-46a4-ab1b-d0ca3bd8b329&page=queryresults
[0m13:46:52.175811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153acc0a0>]}
[0m13:46:52.177171 [info ] [Thread-1  ]: 26 of 76 OK created sql table model stock_analysis.base_pep_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.05s]
[0m13:46:52.177968 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_pep_1993_2024
[0m13:46:52.178492 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_pg_1993_2024
[0m13:46:52.179368 [info ] [Thread-1  ]: 27 of 76 START sql table model stock_analysis.base_pg_1993_2024 ................ [RUN]
[0m13:46:52.180228 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pep_1993_2024, now model.stock_analysis.base_pg_1993_2024)
[0m13:46:52.180682 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_pg_1993_2024
[0m13:46:52.185173 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_pg_1993_2024"
[0m13:46:52.186348 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_pg_1993_2024
[0m13:46:52.190005 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_pg_1993_2024"
[0m13:46:52.190686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:52.261071 [debug] [Thread-1  ]: On model.stock_analysis.base_pg_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_pg_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_pg_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`pg`
    );
  
[0m13:46:53.011181 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ce9b5bb1-1c8b-4d2c-805c-71be6da852da&page=queryresults
[0m13:46:54.979215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bff190>]}
[0m13:46:54.980687 [info ] [Thread-1  ]: 27 of 76 OK created sql table model stock_analysis.base_pg_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.80s]
[0m13:46:54.981591 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_pg_1993_2024
[0m13:46:54.982138 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m13:46:54.983054 [info ] [Thread-1  ]: 28 of 76 START sql table model stock_analysis.base_spus_2019_2024 .............. [RUN]
[0m13:46:54.983918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pg_1993_2024, now model.stock_analysis.base_spus_2019_2024)
[0m13:46:54.984399 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m13:46:54.988835 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m13:46:54.991482 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m13:46:54.994813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:55.566170 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spus_2019_2024"
[0m13:46:55.567938 [debug] [Thread-1  ]: On model.stock_analysis.base_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spus_2019_2024`
    );
  
[0m13:46:55.986484 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a2960393-4448-4d02-90d6-69cf114d4a7c&page=queryresults
[0m13:46:57.652146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bfc6d0>]}
[0m13:46:57.654609 [info ] [Thread-1  ]: 28 of 76 OK created sql table model stock_analysis.base_spus_2019_2024 ......... [[32mCREATE TABLE (1.2k rows, 55.5 KiB processed)[0m in 2.67s]
[0m13:46:57.655487 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m13:46:57.656428 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m13:46:57.657787 [info ] [Thread-1  ]: 29 of 76 START sql table model stock_analysis.base_spy_1993_2024 ............... [RUN]
[0m13:46:57.658778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spus_2019_2024, now model.stock_analysis.base_spy_1993_2024)
[0m13:46:57.659236 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m13:46:57.663776 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m13:46:57.666200 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m13:46:57.672482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:58.152720 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_1993_2024"
[0m13:46:58.155384 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_1993_2024`
    );
  
[0m13:46:58.603356 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2b41863d-cf84-4593-b844-e08f66c0c0f4&page=queryresults
[0m13:47:00.453653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bfc6d0>]}
[0m13:47:00.455136 [info ] [Thread-1  ]: 29 of 76 OK created sql table model stock_analysis.base_spy_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.79s]
[0m13:47:00.456038 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m13:47:00.456624 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:47:00.457336 [info ] [Thread-1  ]: 30 of 76 START sql table model stock_analysis.base_spy_2014_2024 ............... [RUN]
[0m13:47:00.458025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_1993_2024, now model.stock_analysis.base_spy_2014_2024)
[0m13:47:00.458967 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:47:00.464242 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:47:00.465541 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:47:00.469392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:00.993500 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m13:47:00.995617 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m13:47:01.339816 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e4ba942f-e70b-4504-867b-cbbaf46583fc&page=queryresults
[0m13:47:03.566624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c7fee0>]}
[0m13:47:03.568257 [info ] [Thread-1  ]: 30 of 76 OK created sql table model stock_analysis.base_spy_2014_2024 .......... [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.11s]
[0m13:47:03.569133 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:47:03.569729 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m13:47:03.570797 [info ] [Thread-1  ]: 31 of 76 START sql table model stock_analysis.base_symbols_meta ................ [RUN]
[0m13:47:03.571819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.base_symbols_meta)
[0m13:47:03.572361 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m13:47:03.577414 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m13:47:03.578652 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m13:47:03.582509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:04.072807 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m13:47:04.075872 [debug] [Thread-1  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_valid_meta`
    );
  
[0m13:47:04.447297 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f3dc081a-3fb5-4bf7-8b2d-c5f00dc81199&page=queryresults
[0m13:47:06.602530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153ca7eb0>]}
[0m13:47:06.604157 [info ] [Thread-1  ]: 31 of 76 OK created sql table model stock_analysis.base_symbols_meta ........... [[32mCREATE TABLE (8.0k rows, 0 processed)[0m in 3.03s]
[0m13:47:06.605124 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m13:47:06.605665 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_tmo_1993_2024
[0m13:47:06.606287 [info ] [Thread-1  ]: 32 of 76 START sql table model stock_analysis.base_tmo_1993_2024 ............... [RUN]
[0m13:47:06.606963 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_symbols_meta, now model.stock_analysis.base_tmo_1993_2024)
[0m13:47:06.607323 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_tmo_1993_2024
[0m13:47:06.613826 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_tmo_1993_2024"
[0m13:47:06.614865 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_tmo_1993_2024
[0m13:47:06.665752 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_tmo_1993_2024"
[0m13:47:06.666530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:06.727877 [debug] [Thread-1  ]: On model.stock_analysis.base_tmo_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_tmo_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_tmo_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`tmo`
    );
  
[0m13:47:07.719747 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8815ca19-d1c9-414b-b7f2-4f19db30a981&page=queryresults
[0m13:47:09.879201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153d018b0>]}
[0m13:47:09.880417 [info ] [Thread-1  ]: 32 of 76 OK created sql table model stock_analysis.base_tmo_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.27s]
[0m13:47:09.881168 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_tmo_1993_2024
[0m13:47:09.881688 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_tsla_2010_2024
[0m13:47:09.882575 [info ] [Thread-1  ]: 33 of 76 START sql table model stock_analysis.base_tsla_2010_2024 .............. [RUN]
[0m13:47:09.883417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tmo_1993_2024, now model.stock_analysis.base_tsla_2010_2024)
[0m13:47:09.883821 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_tsla_2010_2024
[0m13:47:09.888298 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_tsla_2010_2024"
[0m13:47:09.889415 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_tsla_2010_2024
[0m13:47:09.892826 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_tsla_2010_2024"
[0m13:47:09.893520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:09.967639 [debug] [Thread-1  ]: On model.stock_analysis.base_tsla_2010_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_tsla_2010_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_tsla_2010_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`tsla`
    );
  
[0m13:47:10.611929 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9ccb4a42-0ebc-4b1d-b1f4-fa1f9534a1a1&page=queryresults
[0m13:47:12.504651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153ce3610>]}
[0m13:47:12.506187 [info ] [Thread-1  ]: 33 of 76 OK created sql table model stock_analysis.base_tsla_2010_2024 ......... [[32mCREATE TABLE (3.6k rows, 167.2 KiB processed)[0m in 2.62s]
[0m13:47:12.507674 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_tsla_2010_2024
[0m13:47:12.508387 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_unh_1993_2024
[0m13:47:12.509315 [info ] [Thread-1  ]: 34 of 76 START sql table model stock_analysis.base_unh_1993_2024 ............... [RUN]
[0m13:47:12.510393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tsla_2010_2024, now model.stock_analysis.base_unh_1993_2024)
[0m13:47:12.510928 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_unh_1993_2024
[0m13:47:12.515392 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_unh_1993_2024"
[0m13:47:12.516592 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_unh_1993_2024
[0m13:47:12.520359 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_unh_1993_2024"
[0m13:47:12.521414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:12.589515 [debug] [Thread-1  ]: On model.stock_analysis.base_unh_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_unh_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_unh_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`unh`
    );
  
[0m13:47:13.151705 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a88c24ba-dd0d-4907-8b23-d0528d110647&page=queryresults
[0m13:47:15.096788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c964f0>]}
[0m13:47:15.098248 [info ] [Thread-1  ]: 34 of 76 OK created sql table model stock_analysis.base_unh_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.59s]
[0m13:47:15.099148 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_unh_1993_2024
[0m13:47:15.099696 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_v_1993_2024
[0m13:47:15.100345 [info ] [Thread-1  ]: 35 of 76 START sql table model stock_analysis.base_v_1993_2024 ................. [RUN]
[0m13:47:15.101424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_unh_1993_2024, now model.stock_analysis.base_v_1993_2024)
[0m13:47:15.102070 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_v_1993_2024
[0m13:47:15.106501 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_v_1993_2024"
[0m13:47:15.107469 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_v_1993_2024
[0m13:47:15.114060 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_v_1993_2024"
[0m13:47:15.115053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:15.192520 [debug] [Thread-1  ]: On model.stock_analysis.base_v_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_v_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_v_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`v`
    );
  
[0m13:47:15.845278 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dcb317aa-c277-45bb-a925-9fd0fe70dd04&page=queryresults
[0m13:47:17.679566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c408e0>]}
[0m13:47:17.681826 [info ] [Thread-1  ]: 35 of 76 OK created sql table model stock_analysis.base_v_1993_2024 ............ [[32mCREATE TABLE (4.1k rows, 194.2 KiB processed)[0m in 2.58s]
[0m13:47:17.682782 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_v_1993_2024
[0m13:47:17.683759 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_wmt_1993_2024
[0m13:47:17.684300 [info ] [Thread-1  ]: 36 of 76 START sql table model stock_analysis.base_wmt_1993_2024 ............... [RUN]
[0m13:47:17.684941 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_v_1993_2024, now model.stock_analysis.base_wmt_1993_2024)
[0m13:47:17.685307 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_wmt_1993_2024
[0m13:47:17.688575 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_wmt_1993_2024"
[0m13:47:17.689581 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_wmt_1993_2024
[0m13:47:17.692980 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_wmt_1993_2024"
[0m13:47:17.693658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:17.765156 [debug] [Thread-1  ]: On model.stock_analysis.base_wmt_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_wmt_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_wmt_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`wmt`
    );
  
[0m13:47:18.378103 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9250c980-aae8-46d6-9981-bf5d117c69a4&page=queryresults
[0m13:47:20.580486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c2a970>]}
[0m13:47:20.581416 [info ] [Thread-1  ]: 36 of 76 OK created sql table model stock_analysis.base_wmt_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 2.90s]
[0m13:47:20.581949 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_wmt_1993_2024
[0m13:47:20.582306 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_xom_1993_2024
[0m13:47:20.582783 [info ] [Thread-1  ]: 37 of 76 START sql table model stock_analysis.base_xom_1993_2024 ............... [RUN]
[0m13:47:20.583237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_wmt_1993_2024, now model.stock_analysis.base_xom_1993_2024)
[0m13:47:20.583531 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_xom_1993_2024
[0m13:47:20.586527 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_xom_1993_2024"
[0m13:47:20.587365 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_xom_1993_2024
[0m13:47:20.590340 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_xom_1993_2024"
[0m13:47:20.590937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:20.663566 [debug] [Thread-1  ]: On model.stock_analysis.base_xom_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_xom_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_xom_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`xom`
    );
  
[0m13:47:21.299922 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bb5779ed-da73-487e-bc99-e2d850d5b258&page=queryresults
[0m13:47:24.007526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c2a8b0>]}
[0m13:47:24.009166 [info ] [Thread-1  ]: 37 of 76 OK created sql table model stock_analysis.base_xom_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 372.8 KiB processed)[0m in 3.42s]
[0m13:47:24.010362 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_xom_1993_2024
[0m13:47:24.011359 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:47:24.012256 [info ] [Thread-1  ]: 38 of 76 START sql table model stock_analysis.stg_calendar ..................... [RUN]
[0m13:47:24.013053 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_xom_1993_2024, now model.stock_analysis.stg_calendar)
[0m13:47:24.013590 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:47:24.018983 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:47:24.020921 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:47:24.027158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:24.632407 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:47:24.635067 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m13:47:25.061590 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d2648ea5-f355-46c3-90c2-7d4f10ad893e&page=queryresults
[0m13:47:29.360997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bb7220>]}
[0m13:47:29.362097 [info ] [Thread-1  ]: 38 of 76 OK created sql table model stock_analysis.stg_calendar ................ [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 5.35s]
[0m13:47:29.362759 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:47:29.363191 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_symbols_meta
[0m13:47:29.363855 [info ] [Thread-1  ]: 39 of 76 START sql table model stock_analysis.stg_symbols_meta ................. [RUN]
[0m13:47:29.365108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_symbols_meta)
[0m13:47:29.365449 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m13:47:29.368605 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m13:47:29.369529 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m13:47:29.372058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:29.871087 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_symbols_meta"
[0m13:47:29.873209 [debug] [Thread-1  ]: On model.stock_analysis.stg_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_symbols_meta`
      
    
    

    OPTIONS()
    as (
      with 

symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`base_symbols_meta` )

select 
    symbol
    , security_name
    , listing_exchange
    , market_category
    , is_ETF
from symbols_meta
    );
  
[0m13:47:30.183315 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d9612eb4-032d-4a0a-9084-c19f53331198&page=queryresults
[0m13:47:32.643149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c9ba90>]}
[0m13:47:32.644716 [info ] [Thread-1  ]: 39 of 76 OK created sql table model stock_analysis.stg_symbols_meta ............ [[32mCREATE TABLE (8.0k rows, 495.2 KiB processed)[0m in 3.28s]
[0m13:47:32.646205 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m13:47:32.646925 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m13:47:32.647828 [info ] [Thread-1  ]: 40 of 76 START sql table model stock_analysis.stg_aapl_1993_2024 ............... [RUN]
[0m13:47:32.648640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_symbols_meta, now model.stock_analysis.stg_aapl_1993_2024)
[0m13:47:32.649179 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_aapl_1993_2024
[0m13:47:32.655233 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_aapl_1993_2024"
[0m13:47:32.656695 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_aapl_1993_2024
[0m13:47:32.661052 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_aapl_1993_2024"
[0m13:47:32.661863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:32.734639 [debug] [Thread-1  ]: On model.stock_analysis.stg_aapl_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_aapl_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_aapl_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:47:33.359584 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:27b65619-b53e-47a4-b11d-c4e034d0c9e5&page=queryresults
[0m13:49:54.951373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153ce3f70>]}
[0m13:49:54.954309 [info ] [Thread-1  ]: 40 of 76 OK created sql table model stock_analysis.stg_aapl_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 142.30s]
[0m13:49:54.955309 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m13:49:54.955944 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m13:49:54.956935 [info ] [Thread-1  ]: 41 of 76 START sql table model stock_analysis.stg_abbv_2013_2024 ............... [RUN]
[0m13:49:54.958060 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_aapl_1993_2024, now model.stock_analysis.stg_abbv_2013_2024)
[0m13:49:54.958635 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_abbv_2013_2024
[0m13:49:54.964436 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_abbv_2013_2024"
[0m13:49:54.965806 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_abbv_2013_2024
[0m13:49:54.969900 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_abbv_2013_2024"
[0m13:49:54.970908 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:55.038498 [debug] [Thread-1  ]: On model.stock_analysis.stg_abbv_2013_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_abbv_2013_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_abbv_2013_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:49:55.693439 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b9a552ed-4f9e-4446-8c4b-b599e740fc94&page=queryresults
[0m13:50:47.305779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153817e80>]}
[0m13:50:47.308241 [info ] [Thread-1  ]: 41 of 76 OK created sql table model stock_analysis.stg_abbv_2013_2024 .......... [[32mCREATE TABLE (2.9k rows, 37.7 MiB processed)[0m in 52.35s]
[0m13:50:47.308933 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m13:50:47.309374 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m13:50:47.309913 [info ] [Thread-1  ]: 42 of 76 START sql table model stock_analysis.stg_adbe_1993_2024 ............... [RUN]
[0m13:50:47.310458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_abbv_2013_2024, now model.stock_analysis.stg_adbe_1993_2024)
[0m13:50:47.310781 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_adbe_1993_2024
[0m13:50:47.315093 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_adbe_1993_2024"
[0m13:50:47.316111 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_adbe_1993_2024
[0m13:50:47.318876 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_adbe_1993_2024"
[0m13:50:47.319507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:47.388594 [debug] [Thread-1  ]: On model.stock_analysis.stg_adbe_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_adbe_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_adbe_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:50:48.020627 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c7fb8e99-5d80-45c2-9ddb-b9d19863b29e&page=queryresults
[0m13:52:29.783655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525567f0>]}
[0m13:52:29.786982 [info ] [Thread-1  ]: 42 of 76 OK created sql table model stock_analysis.stg_adbe_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 102.47s]
[0m13:52:29.788234 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m13:52:29.788719 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m13:52:29.789356 [info ] [Thread-1  ]: 43 of 76 START sql table model stock_analysis.stg_amd_1993_2024 ................ [RUN]
[0m13:52:29.789933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_adbe_1993_2024, now model.stock_analysis.stg_amd_1993_2024)
[0m13:52:29.790301 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amd_1993_2024
[0m13:52:29.794808 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amd_1993_2024"
[0m13:52:29.796205 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amd_1993_2024
[0m13:52:29.799884 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_amd_1993_2024"
[0m13:52:29.801308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:29.868719 [debug] [Thread-1  ]: On model.stock_analysis.stg_amd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:52:30.659754 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ea678b42-b9ec-4f8b-8cda-701c54bf9c51&page=queryresults
[0m13:54:47.076391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153ce3970>]}
[0m13:54:47.079169 [info ] [Thread-1  ]: 43 of 76 OK created sql table model stock_analysis.stg_amd_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 137.29s]
[0m13:54:47.080327 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m13:54:47.080967 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m13:54:47.081685 [info ] [Thread-1  ]: 44 of 76 START sql table model stock_analysis.stg_amzn_1997_2024 ............... [RUN]
[0m13:54:47.082366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amd_1993_2024, now model.stock_analysis.stg_amzn_1997_2024)
[0m13:54:47.082802 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amzn_1997_2024
[0m13:54:47.088269 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amzn_1997_2024"
[0m13:54:47.089541 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amzn_1997_2024
[0m13:54:47.093050 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_amzn_1997_2024"
[0m13:54:47.093876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:47.169744 [debug] [Thread-1  ]: On model.stock_analysis.stg_amzn_1997_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amzn_1997_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amzn_1997_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:54:47.875347 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:be688443-3f54-4e4c-9646-15accb487dec&page=queryresults
[0m13:56:57.599264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15218a640>]}
[0m13:56:57.603140 [info ] [Thread-1  ]: 44 of 76 OK created sql table model stock_analysis.stg_amzn_1997_2024 .......... [[32mCREATE TABLE (6.9k rows, 37.8 MiB processed)[0m in 130.52s]
[0m13:56:57.604136 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m13:56:57.604767 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m13:56:57.605585 [info ] [Thread-1  ]: 45 of 76 START sql table model stock_analysis.stg_avgo_2009_2024 ............... [RUN]
[0m13:56:57.606192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amzn_1997_2024, now model.stock_analysis.stg_avgo_2009_2024)
[0m13:56:57.606612 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_avgo_2009_2024
[0m13:56:57.613325 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_avgo_2009_2024"
[0m13:56:57.615028 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_avgo_2009_2024
[0m13:56:57.618854 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_avgo_2009_2024"
[0m13:56:57.619714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:57.688992 [debug] [Thread-1  ]: On model.stock_analysis.stg_avgo_2009_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_avgo_2009_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_avgo_2009_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:56:58.397345 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cad9a8d3-1e5d-433d-93b5-6f62c6308024&page=queryresults
[0m13:58:13.271932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bfcee0>]}
[0m13:58:13.274388 [info ] [Thread-1  ]: 45 of 76 OK created sql table model stock_analysis.stg_avgo_2009_2024 .......... [[32mCREATE TABLE (3.8k rows, 37.7 MiB processed)[0m in 75.67s]
[0m13:58:13.275235 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m13:58:13.275685 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m13:58:13.276458 [info ] [Thread-1  ]: 46 of 76 START sql table model stock_analysis.stg_bac_1993_2024 ................ [RUN]
[0m13:58:13.277244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_avgo_2009_2024, now model.stock_analysis.stg_bac_1993_2024)
[0m13:58:13.277652 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_bac_1993_2024
[0m13:58:13.282162 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_bac_1993_2024"
[0m13:58:13.283221 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_bac_1993_2024
[0m13:58:13.286292 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_bac_1993_2024"
[0m13:58:13.287144 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:58:13.357136 [debug] [Thread-1  ]: On model.stock_analysis.stg_bac_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_bac_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_bac_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:58:14.109887 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8d530201-0034-4f90-bd70-7966840b1090&page=queryresults
[0m14:00:17.874494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b90070>]}
[0m14:00:17.877924 [info ] [Thread-1  ]: 46 of 76 OK created sql table model stock_analysis.stg_bac_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 124.60s]
[0m14:00:17.879060 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m14:00:17.879719 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m14:00:17.880468 [info ] [Thread-1  ]: 47 of 76 START sql table model stock_analysis.stg_brk-b_1996_2024 .............. [RUN]
[0m14:00:17.881098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_bac_1993_2024, now model.stock_analysis.stg_brk-b_1996_2024)
[0m14:00:17.881534 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_brk-b_1996_2024
[0m14:00:17.888310 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m14:00:17.890085 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_brk-b_1996_2024
[0m14:00:17.894466 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m14:00:17.896072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:00:17.966485 [debug] [Thread-1  ]: On model.stock_analysis.stg_brk-b_1996_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_brk-b_1996_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_brk-b_1996_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:00:18.625390 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:27c949be-d44d-4e54-a317-feba1353fae6&page=queryresults
[0m14:02:29.804597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c77220>]}
[0m14:02:29.807402 [info ] [Thread-1  ]: 47 of 76 OK created sql table model stock_analysis.stg_brk-b_1996_2024 ......... [[32mCREATE TABLE (7.1k rows, 37.9 MiB processed)[0m in 131.92s]
[0m14:02:29.808561 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m14:02:29.809249 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m14:02:29.810065 [info ] [Thread-1  ]: 48 of 76 START sql table model stock_analysis.stg_cost_1993_2024 ............... [RUN]
[0m14:02:29.810802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_brk-b_1996_2024, now model.stock_analysis.stg_cost_1993_2024)
[0m14:02:29.811238 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cost_1993_2024
[0m14:02:29.816910 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cost_1993_2024"
[0m14:02:29.818202 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cost_1993_2024
[0m14:02:29.821998 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_cost_1993_2024"
[0m14:02:29.822837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:02:29.889799 [debug] [Thread-1  ]: On model.stock_analysis.stg_cost_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cost_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cost_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:02:30.583651 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1fe3bbca-ce74-4ffb-8535-98e9b78963e4&page=queryresults
[0m14:05:14.941525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153cde940>]}
[0m14:05:14.943243 [info ] [Thread-1  ]: 48 of 76 OK created sql table model stock_analysis.stg_cost_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 165.13s]
[0m14:05:14.944564 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m14:05:14.945232 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m14:05:14.945990 [info ] [Thread-1  ]: 49 of 76 START sql table model stock_analysis.stg_crm_2004_2024 ................ [RUN]
[0m14:05:14.946639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cost_1993_2024, now model.stock_analysis.stg_crm_2004_2024)
[0m14:05:14.947009 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_crm_2004_2024
[0m14:05:14.951627 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_crm_2004_2024"
[0m14:05:14.952874 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_crm_2004_2024
[0m14:05:14.956332 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_crm_2004_2024"
[0m14:05:14.957113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:15.023487 [debug] [Thread-1  ]: On model.stock_analysis.stg_crm_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_crm_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_crm_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:05:15.843430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e924894f-771a-47fe-a5a7-e0f4e57b181d&page=queryresults
[0m14:06:43.619214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bd4dc0>]}
[0m14:06:43.620969 [info ] [Thread-1  ]: 49 of 76 OK created sql table model stock_analysis.stg_crm_2004_2024 ........... [[32mCREATE TABLE (5.1k rows, 37.8 MiB processed)[0m in 88.67s]
[0m14:06:43.621767 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m14:06:43.622311 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m14:06:43.622953 [info ] [Thread-1  ]: 50 of 76 START sql table model stock_analysis.stg_cvx_1993_2024 ................ [RUN]
[0m14:06:43.623555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_crm_2004_2024, now model.stock_analysis.stg_cvx_1993_2024)
[0m14:06:43.623978 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cvx_1993_2024
[0m14:06:43.626847 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cvx_1993_2024"
[0m14:06:43.627813 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cvx_1993_2024
[0m14:06:43.630128 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_cvx_1993_2024"
[0m14:06:43.630901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:06:43.705657 [debug] [Thread-1  ]: On model.stock_analysis.stg_cvx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cvx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cvx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:06:44.720173 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:618c82cf-62a1-422e-87d5-f006fb2116aa&page=queryresults
[0m14:09:01.206817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15218a640>]}
[0m14:09:01.210355 [info ] [Thread-1  ]: 50 of 76 OK created sql table model stock_analysis.stg_cvx_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 137.58s]
[0m14:09:01.211579 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m14:09:01.212365 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m14:09:01.213147 [info ] [Thread-1  ]: 51 of 76 START sql table model stock_analysis.stg_goog_2004_2024 ............... [RUN]
[0m14:09:01.213823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cvx_1993_2024, now model.stock_analysis.stg_goog_2004_2024)
[0m14:09:01.214283 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_goog_2004_2024
[0m14:09:01.225146 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_goog_2004_2024"
[0m14:09:01.226524 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_goog_2004_2024
[0m14:09:01.230651 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_goog_2004_2024"
[0m14:09:01.231738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:01.300111 [debug] [Thread-1  ]: On model.stock_analysis.stg_goog_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_goog_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_goog_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:09:02.012066 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:69b138de-deec-4913-99e5-2d57dd706dc8&page=queryresults
[0m14:10:11.475850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1521cda00>]}
[0m14:10:11.477672 [info ] [Thread-1  ]: 51 of 76 OK created sql table model stock_analysis.stg_goog_2004_2024 .......... [[32mCREATE TABLE (5.0k rows, 37.8 MiB processed)[0m in 70.26s]
[0m14:10:11.478301 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m14:10:11.478688 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m14:10:11.479216 [info ] [Thread-1  ]: 52 of 76 START sql table model stock_analysis.stg_googl_2004_2024 .............. [RUN]
[0m14:10:11.479710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_goog_2004_2024, now model.stock_analysis.stg_googl_2004_2024)
[0m14:10:11.480001 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_googl_2004_2024
[0m14:10:11.484523 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_googl_2004_2024"
[0m14:10:11.485510 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_googl_2004_2024
[0m14:10:11.488147 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_googl_2004_2024"
[0m14:10:11.488866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:10:11.560241 [debug] [Thread-1  ]: On model.stock_analysis.stg_googl_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_googl_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_googl_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:10:12.292360 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e9ddbb4c-94a1-44c6-bbed-4e109a037cdb&page=queryresults
[0m14:11:24.768538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525567f0>]}
[0m14:11:25.026780 [info ] [Thread-1  ]: 52 of 76 OK created sql table model stock_analysis.stg_googl_2004_2024 ......... [[32mCREATE TABLE (5.0k rows, 37.8 MiB processed)[0m in 73.29s]
[0m14:11:25.028503 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m14:11:25.029337 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m14:11:25.030166 [info ] [Thread-1  ]: 53 of 76 START sql table model stock_analysis.stg_hd_1993_2024 ................. [RUN]
[0m14:11:25.030963 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_googl_2004_2024, now model.stock_analysis.stg_hd_1993_2024)
[0m14:11:25.031436 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hd_1993_2024
[0m14:11:25.038349 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hd_1993_2024"
[0m14:11:25.041346 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hd_1993_2024
[0m14:11:25.048642 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_hd_1993_2024"
[0m14:11:25.050057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:25.126774 [debug] [Thread-1  ]: On model.stock_analysis.stg_hd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:11:25.825224 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4b98c41d-3f8e-40fa-b491-2ec5e098673f&page=queryresults
[0m14:13:29.200415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525567f0>]}
[0m14:13:29.202940 [info ] [Thread-1  ]: 53 of 76 OK created sql table model stock_analysis.stg_hd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 124.17s]
[0m14:13:29.203963 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m14:13:29.204548 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m14:13:29.205104 [info ] [Thread-1  ]: 54 of 76 START sql table model stock_analysis.stg_jnj_1993_2024 ................ [RUN]
[0m14:13:29.205622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hd_1993_2024, now model.stock_analysis.stg_jnj_1993_2024)
[0m14:13:29.206143 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jnj_1993_2024
[0m14:13:29.211521 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jnj_1993_2024"
[0m14:13:29.212689 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jnj_1993_2024
[0m14:13:29.216527 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_jnj_1993_2024"
[0m14:13:29.217179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:13:29.295231 [debug] [Thread-1  ]: On model.stock_analysis.stg_jnj_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jnj_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jnj_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:13:30.041653 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1e500b34-da99-413e-afc8-a0d2df0b4524&page=queryresults
[0m14:16:06.503672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153dd4670>]}
[0m14:16:06.506541 [info ] [Thread-1  ]: 54 of 76 OK created sql table model stock_analysis.stg_jnj_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 157.30s]
[0m14:16:06.507765 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m14:16:06.508488 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m14:16:06.509351 [info ] [Thread-1  ]: 55 of 76 START sql table model stock_analysis.stg_jpm_1993_2024 ................ [RUN]
[0m14:16:06.510161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jnj_1993_2024, now model.stock_analysis.stg_jpm_1993_2024)
[0m14:16:06.510692 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jpm_1993_2024
[0m14:16:06.516514 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jpm_1993_2024"
[0m14:16:06.517723 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jpm_1993_2024
[0m14:16:06.524720 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_jpm_1993_2024"
[0m14:16:06.525465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:16:06.599933 [debug] [Thread-1  ]: On model.stock_analysis.stg_jpm_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jpm_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jpm_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:16:07.220888 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bff5bc6a-031d-4060-9fef-e6749b1d4acf&page=queryresults
[0m14:18:44.630299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153cca4f0>]}
[0m14:18:44.633261 [info ] [Thread-1  ]: 55 of 76 OK created sql table model stock_analysis.stg_jpm_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 158.12s]
[0m14:18:44.634164 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m14:18:44.634743 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m14:18:44.635440 [info ] [Thread-1  ]: 56 of 76 START sql table model stock_analysis.stg_ko_1993_2024 ................. [RUN]
[0m14:18:44.635965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jpm_1993_2024, now model.stock_analysis.stg_ko_1993_2024)
[0m14:18:44.636281 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ko_1993_2024
[0m14:18:44.642945 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ko_1993_2024"
[0m14:18:44.644222 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ko_1993_2024
[0m14:18:44.648043 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_ko_1993_2024"
[0m14:18:44.649284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:18:44.724996 [debug] [Thread-1  ]: On model.stock_analysis.stg_ko_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ko_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ko_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:18:45.428486 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:eb3159db-9059-4d27-be1c-e993e71b874b&page=queryresults
[0m14:21:17.493408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153ac0b80>]}
[0m14:21:17.495962 [info ] [Thread-1  ]: 56 of 76 OK created sql table model stock_analysis.stg_ko_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 152.86s]
[0m14:21:17.496957 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m14:21:17.497552 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m14:21:17.498281 [info ] [Thread-1  ]: 57 of 76 START sql table model stock_analysis.stg_lly_1993_2024 ................ [RUN]
[0m14:21:17.498942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ko_1993_2024, now model.stock_analysis.stg_lly_1993_2024)
[0m14:21:17.499388 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_lly_1993_2024
[0m14:21:17.504666 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_lly_1993_2024"
[0m14:21:17.505840 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_lly_1993_2024
[0m14:21:17.509507 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_lly_1993_2024"
[0m14:21:17.510308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:17.578276 [debug] [Thread-1  ]: On model.stock_analysis.stg_lly_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_lly_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_lly_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:21:18.273904 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a764ead7-9bdb-4ed0-97c2-3723c1b42d2f&page=queryresults
[0m14:24:01.818853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b90070>]}
[0m14:24:01.822977 [info ] [Thread-1  ]: 57 of 76 OK created sql table model stock_analysis.stg_lly_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 164.32s]
[0m14:24:01.824159 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m14:24:01.824874 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m14:24:01.825786 [info ] [Thread-1  ]: 58 of 76 START sql table model stock_analysis.stg_ma_2006_2024 ................. [RUN]
[0m14:24:01.826554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_lly_1993_2024, now model.stock_analysis.stg_ma_2006_2024)
[0m14:24:01.827032 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ma_2006_2024
[0m14:24:01.834551 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ma_2006_2024"
[0m14:24:01.836380 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ma_2006_2024
[0m14:24:01.840059 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_ma_2006_2024"
[0m14:24:01.840949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:01.915253 [debug] [Thread-1  ]: On model.stock_analysis.stg_ma_2006_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ma_2006_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ma_2006_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:24:02.559282 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e93d386f-04b9-4bb5-8a6c-09bb44db0365&page=queryresults
[0m14:25:17.428188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c60070>]}
[0m14:25:17.431255 [info ] [Thread-1  ]: 58 of 76 OK created sql table model stock_analysis.stg_ma_2006_2024 ............ [[32mCREATE TABLE (4.6k rows, 37.7 MiB processed)[0m in 75.60s]
[0m14:25:17.432285 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m14:25:17.432864 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m14:25:17.433591 [info ] [Thread-1  ]: 59 of 76 START sql table model stock_analysis.stg_meta_2012_2024 ............... [RUN]
[0m14:25:17.434298 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ma_2006_2024, now model.stock_analysis.stg_meta_2012_2024)
[0m14:25:17.434747 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_meta_2012_2024
[0m14:25:17.440035 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_meta_2012_2024"
[0m14:25:17.441773 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_meta_2012_2024
[0m14:25:17.445386 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_meta_2012_2024"
[0m14:25:17.446315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:17.521499 [debug] [Thread-1  ]: On model.stock_analysis.stg_meta_2012_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_meta_2012_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_meta_2012_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:25:18.230516 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:82f6de96-6aae-491e-9258-cc3e6c14086c&page=queryresults
[0m14:26:14.161167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153e2ce80>]}
[0m14:26:14.163271 [info ] [Thread-1  ]: 59 of 76 OK created sql table model stock_analysis.stg_meta_2012_2024 .......... [[32mCREATE TABLE (3.1k rows, 37.7 MiB processed)[0m in 56.73s]
[0m14:26:14.164118 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m14:26:14.164648 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m14:26:14.165271 [info ] [Thread-1  ]: 60 of 76 START sql table model stock_analysis.stg_mrk_1993_2024 ................ [RUN]
[0m14:26:14.166220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_meta_2012_2024, now model.stock_analysis.stg_mrk_1993_2024)
[0m14:26:14.166752 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_mrk_1993_2024
[0m14:26:14.171865 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_mrk_1993_2024"
[0m14:26:14.175439 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_mrk_1993_2024
[0m14:26:14.179076 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_mrk_1993_2024"
[0m14:26:14.179889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:26:14.259446 [debug] [Thread-1  ]: On model.stock_analysis.stg_mrk_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_mrk_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_mrk_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:26:14.974297 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:917a0e44-126b-4123-9d75-6995b43560cf&page=queryresults
[0m14:28:35.482011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153ac0220>]}
[0m14:28:35.483545 [info ] [Thread-1  ]: 60 of 76 OK created sql table model stock_analysis.stg_mrk_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 141.32s]
[0m14:28:35.484453 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_mrk_1993_2024
[0m14:28:35.485052 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_msft_1993_2024
[0m14:28:35.485770 [info ] [Thread-1  ]: 61 of 76 START sql table model stock_analysis.stg_msft_1993_2024 ............... [RUN]
[0m14:28:35.487011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_mrk_1993_2024, now model.stock_analysis.stg_msft_1993_2024)
[0m14:28:35.487636 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_msft_1993_2024
[0m14:28:35.493394 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_msft_1993_2024"
[0m14:28:35.494781 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_msft_1993_2024
[0m14:28:35.498619 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_msft_1993_2024"
[0m14:28:35.499485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:35.576269 [debug] [Thread-1  ]: On model.stock_analysis.stg_msft_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_msft_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_msft_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:28:36.246056 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:22eced9f-4de3-4827-9794-7c3233a9d3fc&page=queryresults
[0m14:30:35.120850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525567f0>]}
[0m14:30:35.123412 [info ] [Thread-1  ]: 61 of 76 OK created sql table model stock_analysis.stg_msft_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 119.63s]
[0m14:30:35.124264 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_msft_1993_2024
[0m14:30:35.124970 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nflx_1993_2024
[0m14:30:35.125805 [info ] [Thread-1  ]: 62 of 76 START sql table model stock_analysis.stg_nflx_1993_2024 ............... [RUN]
[0m14:30:35.126277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_msft_1993_2024, now model.stock_analysis.stg_nflx_1993_2024)
[0m14:30:35.126504 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nflx_1993_2024
[0m14:30:35.129128 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nflx_1993_2024"
[0m14:30:35.130005 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nflx_1993_2024
[0m14:30:35.132349 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nflx_1993_2024"
[0m14:30:35.133376 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:30:35.195535 [debug] [Thread-1  ]: On model.stock_analysis.stg_nflx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nflx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nflx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:30:36.017228 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3614ecad-bbcc-4c5d-81d3-b492696944f6&page=queryresults
[0m14:32:32.275279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153e99c10>]}
[0m14:32:32.278777 [info ] [Thread-1  ]: 62 of 76 OK created sql table model stock_analysis.stg_nflx_1993_2024 .......... [[32mCREATE TABLE (5.6k rows, 37.8 MiB processed)[0m in 117.15s]
[0m14:32:32.280152 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nflx_1993_2024
[0m14:32:32.281009 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nvda_1999_2024
[0m14:32:32.281935 [info ] [Thread-1  ]: 63 of 76 START sql table model stock_analysis.stg_nvda_1999_2024 ............... [RUN]
[0m14:32:32.282637 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nflx_1993_2024, now model.stock_analysis.stg_nvda_1999_2024)
[0m14:32:32.283105 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nvda_1999_2024
[0m14:32:32.290470 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nvda_1999_2024"
[0m14:32:32.291657 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nvda_1999_2024
[0m14:32:32.295690 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nvda_1999_2024"
[0m14:32:32.296379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:32:32.369863 [debug] [Thread-1  ]: On model.stock_analysis.stg_nvda_1999_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nvda_1999_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nvda_1999_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:32:33.160649 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1d9307fc-df84-4931-9476-3a62793b0034&page=queryresults
[0m14:34:37.610125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b90070>]}
[0m14:34:37.613458 [info ] [Thread-1  ]: 63 of 76 OK created sql table model stock_analysis.stg_nvda_1999_2024 .......... [[32mCREATE TABLE (6.4k rows, 37.8 MiB processed)[0m in 125.33s]
[0m14:34:37.614757 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nvda_1999_2024
[0m14:34:37.615464 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pep_1993_2024
[0m14:34:37.616407 [info ] [Thread-1  ]: 64 of 76 START sql table model stock_analysis.stg_pep_1993_2024 ................ [RUN]
[0m14:34:37.617178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nvda_1999_2024, now model.stock_analysis.stg_pep_1993_2024)
[0m14:34:37.617641 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_pep_1993_2024
[0m14:34:37.623252 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_pep_1993_2024"
[0m14:34:37.625017 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_pep_1993_2024
[0m14:34:37.628799 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_pep_1993_2024"
[0m14:34:37.629634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:37.705704 [debug] [Thread-1  ]: On model.stock_analysis.stg_pep_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pep_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pep_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:34:38.476952 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e4f896f6-81db-4acd-8838-ef0c4a186369&page=queryresults
[0m14:36:50.072794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153cd2970>]}
[0m14:36:50.076745 [info ] [Thread-1  ]: 64 of 76 OK created sql table model stock_analysis.stg_pep_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 132.46s]
[0m14:36:50.077674 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pep_1993_2024
[0m14:36:50.078333 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pg_1993_2024
[0m14:36:50.079059 [info ] [Thread-1  ]: 65 of 76 START sql table model stock_analysis.stg_pg_1993_2024 ................. [RUN]
[0m14:36:50.079747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_pep_1993_2024, now model.stock_analysis.stg_pg_1993_2024)
[0m14:36:50.080180 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_pg_1993_2024
[0m14:36:50.086306 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_pg_1993_2024"
[0m14:36:50.088250 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_pg_1993_2024
[0m14:36:50.092363 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_pg_1993_2024"
[0m14:36:50.093317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:36:50.168278 [debug] [Thread-1  ]: On model.stock_analysis.stg_pg_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pg_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pg_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:36:50.797392 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b6435e33-9ba8-44b5-bade-64b04982a8cc&page=queryresults
[0m14:39:12.052690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525567f0>]}
[0m14:39:12.056563 [info ] [Thread-1  ]: 65 of 76 OK created sql table model stock_analysis.stg_pg_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 141.97s]
[0m14:39:12.057883 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pg_1993_2024
[0m14:39:12.058484 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m14:39:12.059284 [info ] [Thread-1  ]: 66 of 76 START sql table model stock_analysis.stg_spus_2019_2024 ............... [RUN]
[0m14:39:12.059946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_pg_1993_2024, now model.stock_analysis.stg_spus_2019_2024)
[0m14:39:12.060398 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m14:39:12.065975 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m14:39:12.068417 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m14:39:12.071684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:12.607454 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spus_2019_2024"
[0m14:39:12.610310 [debug] [Thread-1  ]: On model.stock_analysis.stg_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- --   DEPRACATED   -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 


with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:39:13.049798 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3f8c35ae-adaf-4558-8dcb-aef71d710b03&page=queryresults
[0m14:39:36.667011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f6e910>]}
[0m14:39:36.669040 [info ] [Thread-1  ]: 66 of 76 OK created sql table model stock_analysis.stg_spus_2019_2024 .......... [[32mCREATE TABLE (1.2k rows, 37.6 MiB processed)[0m in 24.61s]
[0m14:39:36.670359 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m14:39:36.671072 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m14:39:36.672078 [info ] [Thread-1  ]: 67 of 76 START sql table model stock_analysis.stg_spy_1993_2024 ................ [RUN]
[0m14:39:36.673064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spus_2019_2024, now model.stock_analysis.stg_spy_1993_2024)
[0m14:39:36.673606 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m14:39:36.678955 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m14:39:36.681626 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m14:39:36.685310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:37.241164 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_1993_2024"
[0m14:39:37.244671 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:39:37.589930 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fb6a1f62-1e62-44cb-9c93-25a4ec8b9b47&page=queryresults
[0m14:42:11.819912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153efcdf0>]}
[0m14:42:11.824040 [info ] [Thread-1  ]: 67 of 76 OK created sql table model stock_analysis.stg_spy_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 155.15s]
[0m14:42:11.825001 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m14:42:11.825634 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m14:42:11.826524 [info ] [Thread-1  ]: 68 of 76 START sql table model stock_analysis.stg_spy_2014_2024 ................ [RUN]
[0m14:42:11.827467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_1993_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m14:42:11.827920 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m14:42:11.834102 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m14:42:11.835364 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m14:42:11.838500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:42:14.368358 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m14:42:14.371202 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:42:14.800177 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:78533ab3-2696-4050-8952-526418d33ae3&page=queryresults
[0m14:43:05.568287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153fc5eb0>]}
[0m14:43:05.570988 [info ] [Thread-1  ]: 68 of 76 OK created sql table model stock_analysis.stg_spy_2014_2024 ........... [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 53.74s]
[0m14:43:05.571865 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m14:43:05.572536 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tmo_1993_2024
[0m14:43:05.572951 [info ] [Thread-1  ]: 69 of 76 START sql table model stock_analysis.stg_tmo_1993_2024 ................ [RUN]
[0m14:43:05.573297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.stg_tmo_1993_2024)
[0m14:43:05.573484 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_tmo_1993_2024
[0m14:43:05.576079 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_tmo_1993_2024"
[0m14:43:05.577058 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_tmo_1993_2024
[0m14:43:05.578930 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_tmo_1993_2024"
[0m14:43:05.579369 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:05.637885 [debug] [Thread-1  ]: On model.stock_analysis.stg_tmo_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tmo_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tmo_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:43:06.309594 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:51a196f5-b5ad-415d-9056-c7b11388ee35&page=queryresults
[0m14:45:36.045915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f04d30>]}
[0m14:45:36.048715 [info ] [Thread-1  ]: 69 of 76 OK created sql table model stock_analysis.stg_tmo_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 150.47s]
[0m14:45:36.050183 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tmo_1993_2024
[0m14:45:36.050958 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tsla_2010_2024
[0m14:45:36.051896 [info ] [Thread-1  ]: 70 of 76 START sql table model stock_analysis.stg_tsla_2010_2024 ............... [RUN]
[0m14:45:36.052700 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_tmo_1993_2024, now model.stock_analysis.stg_tsla_2010_2024)
[0m14:45:36.053146 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_tsla_2010_2024
[0m14:45:36.058782 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_tsla_2010_2024"
[0m14:45:36.060152 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_tsla_2010_2024
[0m14:45:36.063978 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_tsla_2010_2024"
[0m14:45:36.065095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:45:36.138168 [debug] [Thread-1  ]: On model.stock_analysis.stg_tsla_2010_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tsla_2010_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tsla_2010_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:45:36.933161 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3475e38d-aec2-440c-a3e8-950ddf5d571c&page=queryresults
[0m14:46:53.536466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f04d30>]}
[0m14:46:53.540166 [info ] [Thread-1  ]: 70 of 76 OK created sql table model stock_analysis.stg_tsla_2010_2024 .......... [[32mCREATE TABLE (3.6k rows, 37.7 MiB processed)[0m in 77.48s]
[0m14:46:53.541046 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tsla_2010_2024
[0m14:46:53.541575 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_unh_1993_2024
[0m14:46:53.542350 [info ] [Thread-1  ]: 71 of 76 START sql table model stock_analysis.stg_unh_1993_2024 ................ [RUN]
[0m14:46:53.543094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_tsla_2010_2024, now model.stock_analysis.stg_unh_1993_2024)
[0m14:46:53.543483 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_unh_1993_2024
[0m14:46:53.548761 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_unh_1993_2024"
[0m14:46:53.550387 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_unh_1993_2024
[0m14:46:53.553913 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_unh_1993_2024"
[0m14:46:53.554892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:46:53.625198 [debug] [Thread-1  ]: On model.stock_analysis.stg_unh_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_unh_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_unh_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:46:54.281000 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e58a559d-b501-4469-812e-4e66550fbfcf&page=queryresults
[0m14:48:52.824137 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f6df70>]}
[0m14:48:52.826569 [info ] [Thread-1  ]: 71 of 76 OK created sql table model stock_analysis.stg_unh_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 119.28s]
[0m14:48:52.827509 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_unh_1993_2024
[0m14:48:52.828390 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_v_1993_2024
[0m14:48:52.828994 [info ] [Thread-1  ]: 72 of 76 START sql table model stock_analysis.stg_v_1993_2024 .................. [RUN]
[0m14:48:52.829467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_unh_1993_2024, now model.stock_analysis.stg_v_1993_2024)
[0m14:48:52.829746 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_v_1993_2024
[0m14:48:52.835885 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_v_1993_2024"
[0m14:48:52.836978 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_v_1993_2024
[0m14:48:52.839845 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_v_1993_2024"
[0m14:48:52.840707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:48:52.905491 [debug] [Thread-1  ]: On model.stock_analysis.stg_v_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_v_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_v_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_v_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:48:53.790412 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9a314393-28ee-45a5-a157-e5101ad67554&page=queryresults
[0m14:50:16.501074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b48880>]}
[0m14:50:16.502975 [info ] [Thread-1  ]: 72 of 76 OK created sql table model stock_analysis.stg_v_1993_2024 ............. [[32mCREATE TABLE (4.1k rows, 37.7 MiB processed)[0m in 83.67s]
[0m14:50:16.504033 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_v_1993_2024
[0m14:50:16.504686 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_wmt_1993_2024
[0m14:50:16.505351 [info ] [Thread-1  ]: 73 of 76 START sql table model stock_analysis.stg_wmt_1993_2024 ................ [RUN]
[0m14:50:16.505882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_v_1993_2024, now model.stock_analysis.stg_wmt_1993_2024)
[0m14:50:16.506202 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_wmt_1993_2024
[0m14:50:16.510284 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_wmt_1993_2024"
[0m14:50:16.511170 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_wmt_1993_2024
[0m14:50:16.514046 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_wmt_1993_2024"
[0m14:50:16.514974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:50:16.580516 [debug] [Thread-1  ]: On model.stock_analysis.stg_wmt_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_wmt_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_wmt_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:50:17.306760 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e254cbfe-3759-42d4-805b-9ecc64b544c3&page=queryresults
[0m14:52:38.456732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1548c0610>]}
[0m14:52:38.458269 [info ] [Thread-1  ]: 73 of 76 OK created sql table model stock_analysis.stg_wmt_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 141.95s]
[0m14:52:38.459238 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_wmt_1993_2024
[0m14:52:38.459892 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_xom_1993_2024
[0m14:52:38.460881 [info ] [Thread-1  ]: 74 of 76 START sql table model stock_analysis.stg_xom_1993_2024 ................ [RUN]
[0m14:52:38.461766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_wmt_1993_2024, now model.stock_analysis.stg_xom_1993_2024)
[0m14:52:38.462188 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_xom_1993_2024
[0m14:52:38.467613 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_xom_1993_2024"
[0m14:52:38.469188 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_xom_1993_2024
[0m14:52:38.476829 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_xom_1993_2024"
[0m14:52:38.477558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:38.551910 [debug] [Thread-1  ]: On model.stock_analysis.stg_xom_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_xom_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_xom_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m14:52:39.226298 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4991d7b4-756e-4560-9284-6eab44ab73e7&page=queryresults
[0m14:54:50.878829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1548c0610>]}
[0m14:54:50.881144 [info ] [Thread-1  ]: 74 of 76 OK created sql table model stock_analysis.stg_xom_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 37.9 MiB processed)[0m in 132.42s]
[0m14:54:50.882223 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_xom_1993_2024
[0m14:54:50.882896 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m14:54:50.883657 [info ] [Thread-1  ]: 75 of 76 START sql table model stock_analysis.int_stock_analysis ............... [RUN]
[0m14:54:50.884318 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_xom_1993_2024, now model.stock_analysis.int_stock_analysis)
[0m14:54:50.884689 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m14:54:50.892254 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m14:54:50.894364 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m14:54:50.898901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:54:51.412354 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m14:54:51.413681 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )

, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )

select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
    );
  
[0m14:54:51.749518 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:acee5d8e-355d-4dae-9c46-9dab46a913d2&page=queryresults
[0m14:54:54.178407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c60ac0>]}
[0m14:54:54.179544 [info ] [Thread-1  ]: 75 of 76 OK created sql table model stock_analysis.int_stock_analysis .......... [[32mCREATE TABLE (9.1k rows, 3.4 MiB processed)[0m in 3.29s]
[0m14:54:54.180531 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m14:54:54.182550 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m14:54:54.183534 [info ] [Thread-1  ]: 76 of 76 START sql table model stock_analysis.stock_analysis ................... [RUN]
[0m14:54:54.184639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.int_stock_analysis, now model.stock_analysis.stock_analysis)
[0m14:54:54.185246 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m14:54:54.189994 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m14:54:54.192149 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m14:54:54.196446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:54:54.723153 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m14:54:54.725953 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m14:54:55.112075 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bc37ea63-d9c8-428a-80bf-31225f8742a3&page=queryresults
[0m14:54:57.222904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4248ac8-198b-4d46-9c77-9177bf69b4f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1548ffbb0>]}
[0m14:54:57.224055 [info ] [Thread-1  ]: 76 of 76 OK created sql table model stock_analysis.stock_analysis .............. [[32mCREATE TABLE (9.1k rows, 3.9 MiB processed)[0m in 3.04s]
[0m14:54:57.224840 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m14:54:57.227838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:57.228528 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m14:54:57.229530 [info ] [MainThread]: 
[0m14:54:57.229948 [info ] [MainThread]: Finished running 76 table models in 1 hours 9 minutes and 24.33 seconds (4164.33s).
[0m14:54:57.242550 [debug] [MainThread]: Command end result
[0m14:54:57.297254 [info ] [MainThread]: 
[0m14:54:57.297779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:57.298056 [info ] [MainThread]: 
[0m14:54:57.298287 [info ] [MainThread]: Done. PASS=76 WARN=0 ERROR=0 SKIP=0 TOTAL=76
[0m14:54:57.301517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4165.4683, "process_user_time": 16.704315, "process_kernel_time": 4.52461, "process_mem_max_rss": "203194368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:54:57.302173 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:57.302105 after 4165.47 seconds
[0m14:54:57.302552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102534ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10296a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10417f9d0>]}
[0m14:54:57.302814 [debug] [MainThread]: Flushing usage events
[0m16:42:03.558379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a4340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a4160>]}


============================== 16:42:03.561264 | cd537457-6207-441a-aa1a-dcf7349d3c99 ==============================
[0m16:42:03.561264 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:42:03.561576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select int_stock_analysis', 'send_anonymous_usage_stats': 'True'}
[0m16:42:04.282151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd537457-6207-441a-aa1a-dcf7349d3c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107686580>]}
[0m16:42:04.308273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd537457-6207-441a-aa1a-dcf7349d3c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bdb9190>]}
[0m16:42:04.308593 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:42:04.320589 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:42:04.414629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:42:04.415145 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m16:42:04.572493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd537457-6207-441a-aa1a-dcf7349d3c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168317130>]}
[0m16:42:04.641170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd537457-6207-441a-aa1a-dcf7349d3c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16833cca0>]}
[0m16:42:04.641446 [info ] [MainThread]: Found 76 models, 37 sources, 469 macros
[0m16:42:04.641634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd537457-6207-441a-aa1a-dcf7349d3c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168185700>]}
[0m16:42:04.642709 [info ] [MainThread]: 
[0m16:42:04.642976 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:42:04.643390 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:42:04.643591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:05.426618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:42:05.427313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:05.839026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd537457-6207-441a-aa1a-dcf7349d3c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681ba520>]}
[0m16:42:05.839575 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m16:42:05.839872 [info ] [MainThread]: 
[0m16:42:05.841854 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m16:42:05.842273 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m16:42:05.842614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m16:42:05.842877 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m16:42:05.856522 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m16:42:05.858134 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m16:42:05.870052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:06.254446 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m16:42:06.257676 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )

, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, brk-b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from brk-b
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m16:42:06.608890 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:829e3bed-0135-47cb-9351-eb9079ac609b&page=queryresults
[0m16:42:06.611397 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword AS but got "-" at [26:6]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword AS but got "-" at [26:6]')
[0m16:42:06.908291 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e6bf2967-7828-427b-8d5c-094c87d0d172&page=queryresults
[0m16:42:06.910059 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e6bf2967-7828-427b-8d5c-094c87d0d172&page=queryresults
[0m16:42:06.952209 [debug] [Thread-1  ]: Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected keyword AS but got "-" at [26:6]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m16:42:06.953470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd537457-6207-441a-aa1a-dcf7349d3c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa7d30>]}
[0m16:42:06.953960 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.int_stock_analysis ........ [[31mERROR[0m in 1.11s]
[0m16:42:06.954390 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m16:42:06.955175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:06.955375 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m16:42:06.955573 [info ] [MainThread]: 
[0m16:42:06.955785 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m16:42:06.956206 [debug] [MainThread]: Command end result
[0m16:42:06.992766 [info ] [MainThread]: 
[0m16:42:06.993062 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:42:06.993226 [info ] [MainThread]: 
[0m16:42:06.993434 [error] [MainThread]:   Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected keyword AS but got "-" at [26:6]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m16:42:06.993597 [info ] [MainThread]: 
[0m16:42:06.993769 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:42:06.995478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4876978, "process_user_time": 2.134904, "process_kernel_time": 2.78504, "process_mem_max_rss": "200359936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:42:06.995828 [debug] [MainThread]: Command `dbt run` failed at 16:42:06.995774 after 3.49 seconds
[0m16:42:06.996073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13be24a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16849bee0>]}
[0m16:42:06.996280 [debug] [MainThread]: Flushing usage events
[0m16:43:08.434702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3c160>]}


============================== 16:43:08.437389 | 30853b06-3718-48a2-a820-3bd963a53018 ==============================
[0m16:43:08.437389 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:43:08.437716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_stock_analysis', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:43:08.937580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30853b06-3718-48a2-a820-3bd963a53018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044fc640>]}
[0m16:43:08.963416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30853b06-3718-48a2-a820-3bd963a53018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd3a60>]}
[0m16:43:08.963713 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:43:08.975355 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:43:09.062931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:09.063426 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m16:43:09.219397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30853b06-3718-48a2-a820-3bd963a53018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154816130>]}
[0m16:43:09.287597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30853b06-3718-48a2-a820-3bd963a53018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15480bf70>]}
[0m16:43:09.287872 [info ] [MainThread]: Found 76 models, 37 sources, 469 macros
[0m16:43:09.288061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30853b06-3718-48a2-a820-3bd963a53018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137be9a90>]}
[0m16:43:09.289136 [info ] [MainThread]: 
[0m16:43:09.289416 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:43:09.289850 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:43:09.290059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:09.779879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:43:09.780497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:10.295020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30853b06-3718-48a2-a820-3bd963a53018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379abd30>]}
[0m16:43:10.295749 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m16:43:10.296007 [info ] [MainThread]: 
[0m16:43:10.298562 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m16:43:10.298952 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m16:43:10.299265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m16:43:10.299501 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m16:43:10.312953 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m16:43:10.313799 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m16:43:10.325789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:10.706235 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m16:43:10.707007 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )

, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, 'brk-b' as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from 'brk-b'
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m16:43:10.912482 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8c47b8db-ca54-4e10-be42-8ecceef10dd6&page=queryresults
[0m16:43:10.912943 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Expected keyword SELECT but got string literal 'brk-b' at [26:3]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword SELECT but got string literal 'brk-b' at [26:3]")
[0m16:43:12.112946 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2d172593-0aae-4d73-b903-f1fd9d4928b2&page=queryresults
[0m16:43:12.114576 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2d172593-0aae-4d73-b903-f1fd9d4928b2&page=queryresults
[0m16:43:12.161367 [debug] [Thread-1  ]: Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected keyword SELECT but got string literal 'brk-b' at [26:3]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m16:43:12.162674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30853b06-3718-48a2-a820-3bd963a53018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1548cf1c0>]}
[0m16:43:12.163162 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.int_stock_analysis ........ [[31mERROR[0m in 1.86s]
[0m16:43:12.163572 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m16:43:12.164395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:12.164623 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m16:43:12.164834 [info ] [MainThread]: 
[0m16:43:12.165053 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m16:43:12.165470 [debug] [MainThread]: Command end result
[0m16:43:12.202966 [info ] [MainThread]: 
[0m16:43:12.203373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:12.203557 [info ] [MainThread]: 
[0m16:43:12.203802 [error] [MainThread]:   Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected keyword SELECT but got string literal 'brk-b' at [26:3]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m16:43:12.203978 [info ] [MainThread]: 
[0m16:43:12.204168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:43:12.205788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.824265, "process_user_time": 2.161357, "process_kernel_time": 2.55169, "process_mem_max_rss": "200245248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:12.206132 [debug] [MainThread]: Command `dbt run` failed at 16:43:12.206082 after 3.82 seconds
[0m16:43:12.206373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136415bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15481a0d0>]}
[0m16:43:12.206582 [debug] [MainThread]: Flushing usage events
[0m16:43:37.799163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106458340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106458160>]}


============================== 16:43:37.802436 | dac43d44-8792-41bb-ab77-6884cfb782ca ==============================
[0m16:43:37.802436 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:43:37.802791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select int_stock_analysis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:43:38.343126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac43d44-8792-41bb-ab77-6884cfb782ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643a580>]}
[0m16:43:38.369084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac43d44-8792-41bb-ab77-6884cfb782ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f97a2b0>]}
[0m16:43:38.369363 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:43:38.385376 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:43:38.477048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:38.477569 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m16:43:38.635380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac43d44-8792-41bb-ab77-6884cfb782ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b0d6130>]}
[0m16:43:38.703617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac43d44-8792-41bb-ab77-6884cfb782ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b0ff340>]}
[0m16:43:38.703889 [info ] [MainThread]: Found 76 models, 37 sources, 469 macros
[0m16:43:38.704082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac43d44-8792-41bb-ab77-6884cfb782ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff48ac0>]}
[0m16:43:38.705136 [info ] [MainThread]: 
[0m16:43:38.705406 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:43:38.705844 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:43:38.706054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:39.142819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:43:39.143538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:39.511940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac43d44-8792-41bb-ab77-6884cfb782ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa562e0>]}
[0m16:43:39.512786 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m16:43:39.513135 [info ] [MainThread]: 
[0m16:43:39.516617 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m16:43:39.517216 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m16:43:39.517715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m16:43:39.518194 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m16:43:39.533821 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m16:43:39.535283 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m16:43:39.547496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:39.948692 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m16:43:39.949704 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )

, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from brk_b
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m16:43:40.443035 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26d7504f-b7c6-4e2a-9e52-aac7f7816475&page=queryresults
[0m16:43:46.513976 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac43d44-8792-41bb-ab77-6884cfb782ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1646a0>]}
[0m16:43:46.514783 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.int_stock_analysis ............ [[32mCREATE TABLE (223.6k rows, 83.0 MiB processed)[0m in 7.00s]
[0m16:43:46.515358 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m16:43:46.516354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:46.516576 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m16:43:46.516801 [info ] [MainThread]: 
[0m16:43:46.517047 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m16:43:46.517546 [debug] [MainThread]: Command end result
[0m16:43:46.556592 [info ] [MainThread]: 
[0m16:43:46.556939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:46.557130 [info ] [MainThread]: 
[0m16:43:46.557313 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:43:46.558579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.813005, "process_user_time": 2.053363, "process_kernel_time": 2.655412, "process_mem_max_rss": "199737344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:46.558881 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:46.558832 after 8.81 seconds
[0m16:43:46.559093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064098e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f97a2b0>]}
[0m16:43:46.559301 [debug] [MainThread]: Flushing usage events
[0m16:44:10.312559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085813a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085811c0>]}


============================== 16:44:10.315151 | 4372a586-769a-45e6-a367-aa813e34a048 ==============================
[0m16:44:10.315151 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:44:10.315466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stock_analysis', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:20.533381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102934a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d81340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d81160>]}


============================== 16:44:20.536323 | 8ea05525-098e-49a7-ae59-9cac70ad4541 ==============================
[0m16:44:20.536323 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:44:20.536641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stock_analysis.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:44:21.123157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ea05525-098e-49a7-ae59-9cac70ad4541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b69640>]}
[0m16:44:21.150057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ea05525-098e-49a7-ae59-9cac70ad4541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d17a60>]}
[0m16:44:21.150382 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:44:21.161747 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:44:21.252686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:21.252972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:21.313021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ea05525-098e-49a7-ae59-9cac70ad4541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1543650d0>]}
[0m16:44:21.384819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ea05525-098e-49a7-ae59-9cac70ad4541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1544be100>]}
[0m16:44:21.385157 [info ] [MainThread]: Found 76 models, 37 sources, 469 macros
[0m16:44:21.385361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ea05525-098e-49a7-ae59-9cac70ad4541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1544ea040>]}
[0m16:44:21.386975 [info ] [MainThread]: 
[0m16:44:21.387287 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:44:21.387748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:44:21.387958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:21.785517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:44:21.786206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:22.210812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ea05525-098e-49a7-ae59-9cac70ad4541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1543651c0>]}
[0m16:44:22.211742 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m16:44:22.212126 [info ] [MainThread]: 
[0m16:44:22.214561 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m16:44:22.215093 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m16:44:22.215547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m16:44:22.215893 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m16:44:22.226574 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m16:44:22.227907 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m16:44:22.241869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:44:22.692601 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m16:44:22.694743 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m16:44:23.490272 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:03812898-dac9-4af4-8ce9-65b05b7cc222&page=queryresults
[0m16:44:28.790382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ea05525-098e-49a7-ae59-9cac70ad4541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11efc0640>]}
[0m16:44:28.791303 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (223.6k rows, 84.6 MiB processed)[0m in 6.57s]
[0m16:44:28.791845 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m16:44:28.792802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:28.793093 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m16:44:28.793358 [info ] [MainThread]: 
[0m16:44:28.793637 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m16:44:28.794188 [debug] [MainThread]: Command end result
[0m16:44:28.833678 [info ] [MainThread]: 
[0m16:44:28.834100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:28.834407 [info ] [MainThread]: 
[0m16:44:28.834642 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:28.836165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.352763, "process_user_time": 1.989728, "process_kernel_time": 2.603274, "process_mem_max_rss": "195084288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:28.836482 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:28.836431 after 8.35 seconds
[0m16:44:28.836728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102934a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1541155b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c095b0>]}
[0m16:44:28.836938 [debug] [MainThread]: Flushing usage events
[0m09:31:33.225747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106346e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106346280>]}


============================== 09:31:33.228553 | 8d9c39ef-8540-4945-b487-52f1f8d4cfb1 ==============================
[0m09:31:33.228553 [info ] [MainThread]: Running with dbt=1.8.2
[0m09:31:33.228883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:31:33.944380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d9c39ef-8540-4945-b487-52f1f8d4cfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fcce670>]}
[0m09:31:33.970209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d9c39ef-8540-4945-b487-52f1f8d4cfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fcdf3d0>]}
[0m09:31:33.970491 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m09:31:33.982561 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m09:31:34.074876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:34.075089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:34.131792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d9c39ef-8540-4945-b487-52f1f8d4cfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c950910>]}
[0m09:31:34.147858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d9c39ef-8540-4945-b487-52f1f8d4cfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdfcee0>]}
[0m09:31:34.148103 [info ] [MainThread]: Found 76 models, 37 sources, 469 macros
[0m09:31:34.148293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9c39ef-8540-4945-b487-52f1f8d4cfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c9318b0>]}
[0m09:31:34.150586 [info ] [MainThread]: 
[0m09:31:34.150874 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:31:34.155828 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_stock_analysis'
[0m09:31:34.156087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:34.775973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9c39ef-8540-4945-b487-52f1f8d4cfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c93a5e0>]}
[0m09:31:34.776652 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m09:31:34.776953 [info ] [MainThread]: 
[0m09:31:34.780723 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_aapl_1993_2024
[0m09:31:34.781057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_aapl_1993_2024)
[0m09:31:34.781339 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_aapl_1993_2024
[0m09:31:34.790140 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_aapl_1993_2024"
[0m09:31:34.791999 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_aapl_1993_2024
[0m09:31:34.792645 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_aapl_1993_2024
[0m09:31:34.792971 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_abbv_2013_2024
[0m09:31:34.793312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_aapl_1993_2024, now model.stock_analysis.base_abbv_2013_2024)
[0m09:31:34.793571 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_abbv_2013_2024
[0m09:31:34.797175 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_abbv_2013_2024"
[0m09:31:34.798059 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_abbv_2013_2024
[0m09:31:34.798562 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_abbv_2013_2024
[0m09:31:34.798829 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_adbe_1993_2024
[0m09:31:34.799124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_abbv_2013_2024, now model.stock_analysis.base_adbe_1993_2024)
[0m09:31:34.799347 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_adbe_1993_2024
[0m09:31:34.801498 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_adbe_1993_2024"
[0m09:31:34.801907 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_adbe_1993_2024
[0m09:31:34.802321 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_adbe_1993_2024
[0m09:31:34.802585 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_amd_1993_2024
[0m09:31:34.802844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_adbe_1993_2024, now model.stock_analysis.base_amd_1993_2024)
[0m09:31:34.803058 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_amd_1993_2024
[0m09:31:34.804957 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_amd_1993_2024"
[0m09:31:34.805727 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_amd_1993_2024
[0m09:31:34.806111 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_amd_1993_2024
[0m09:31:34.806342 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_amzn_1997_2024
[0m09:31:34.806583 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amd_1993_2024, now model.stock_analysis.base_amzn_1997_2024)
[0m09:31:34.806786 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_amzn_1997_2024
[0m09:31:34.808595 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_amzn_1997_2024"
[0m09:31:34.808946 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_amzn_1997_2024
[0m09:31:34.809321 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_amzn_1997_2024
[0m09:31:34.809556 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_avgo_2009_2024
[0m09:31:34.809794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amzn_1997_2024, now model.stock_analysis.base_avgo_2009_2024)
[0m09:31:34.809999 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_avgo_2009_2024
[0m09:31:34.811814 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_avgo_2009_2024"
[0m09:31:34.812467 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_avgo_2009_2024
[0m09:31:34.812839 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_avgo_2009_2024
[0m09:31:34.813062 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_bac_1993_2024
[0m09:31:34.813297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_avgo_2009_2024, now model.stock_analysis.base_bac_1993_2024)
[0m09:31:34.813488 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_bac_1993_2024
[0m09:31:34.815277 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_bac_1993_2024"
[0m09:31:34.815768 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_bac_1993_2024
[0m09:31:34.816182 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_bac_1993_2024
[0m09:31:34.816409 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_brk-b_1996_2024
[0m09:31:34.816655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_bac_1993_2024, now model.stock_analysis.base_brk-b_1996_2024)
[0m09:31:34.816864 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_brk-b_1996_2024
[0m09:31:34.818616 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_brk-b_1996_2024"
[0m09:31:34.820229 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_brk-b_1996_2024
[0m09:31:34.820593 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_brk-b_1996_2024
[0m09:31:34.820812 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m09:31:34.821038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_brk-b_1996_2024, now model.stock_analysis.base_calendar)
[0m09:31:34.821226 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m09:31:34.823675 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m09:31:34.824425 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m09:31:34.824783 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m09:31:34.824999 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_cost_1993_2024
[0m09:31:34.825260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_cost_1993_2024)
[0m09:31:34.825462 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_cost_1993_2024
[0m09:31:34.827110 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_cost_1993_2024"
[0m09:31:34.827652 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_cost_1993_2024
[0m09:31:34.827991 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_cost_1993_2024
[0m09:31:34.828202 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_crm_2004_2024
[0m09:31:34.828473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cost_1993_2024, now model.stock_analysis.base_crm_2004_2024)
[0m09:31:34.828658 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_crm_2004_2024
[0m09:31:34.830203 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_crm_2004_2024"
[0m09:31:34.830766 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_crm_2004_2024
[0m09:31:34.831109 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_crm_2004_2024
[0m09:31:34.831313 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_cvx_1993_2024
[0m09:31:34.831528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_crm_2004_2024, now model.stock_analysis.base_cvx_1993_2024)
[0m09:31:34.831706 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_cvx_1993_2024
[0m09:31:34.833330 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_cvx_1993_2024"
[0m09:31:34.833895 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_cvx_1993_2024
[0m09:31:34.834235 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_cvx_1993_2024
[0m09:31:34.834445 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_goog_2004_2024
[0m09:31:34.834663 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cvx_1993_2024, now model.stock_analysis.base_goog_2004_2024)
[0m09:31:34.834838 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_goog_2004_2024
[0m09:31:34.836403 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_goog_2004_2024"
[0m09:31:34.836953 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_goog_2004_2024
[0m09:31:34.837287 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_goog_2004_2024
[0m09:31:34.837496 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_googl_2004_2024
[0m09:31:34.837706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_goog_2004_2024, now model.stock_analysis.base_googl_2004_2024)
[0m09:31:34.837884 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_googl_2004_2024
[0m09:31:34.839442 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_googl_2004_2024"
[0m09:31:34.839920 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_googl_2004_2024
[0m09:31:34.840232 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_googl_2004_2024
[0m09:31:34.840425 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_hd_1993_2024
[0m09:31:34.840625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_googl_2004_2024, now model.stock_analysis.base_hd_1993_2024)
[0m09:31:34.840796 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_hd_1993_2024
[0m09:31:34.842322 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_hd_1993_2024"
[0m09:31:34.842792 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_hd_1993_2024
[0m09:31:34.843109 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_hd_1993_2024
[0m09:31:34.843300 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_jnj_1993_2024
[0m09:31:34.843497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_hd_1993_2024, now model.stock_analysis.base_jnj_1993_2024)
[0m09:31:34.843668 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_jnj_1993_2024
[0m09:31:34.845184 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_jnj_1993_2024"
[0m09:31:34.845484 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_jnj_1993_2024
[0m09:31:34.845802 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_jnj_1993_2024
[0m09:31:34.845997 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_jpm_1993_2024
[0m09:31:34.846197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jnj_1993_2024, now model.stock_analysis.base_jpm_1993_2024)
[0m09:31:34.846368 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_jpm_1993_2024
[0m09:31:34.848583 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_jpm_1993_2024"
[0m09:31:34.849569 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_jpm_1993_2024
[0m09:31:34.849884 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_jpm_1993_2024
[0m09:31:34.850071 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_ko_1993_2024
[0m09:31:34.850270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jpm_1993_2024, now model.stock_analysis.base_ko_1993_2024)
[0m09:31:34.850439 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_ko_1993_2024
[0m09:31:34.851948 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_ko_1993_2024"
[0m09:31:34.852556 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_ko_1993_2024
[0m09:31:34.852863 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_ko_1993_2024
[0m09:31:34.853053 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_lly_1993_2024
[0m09:31:34.853245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ko_1993_2024, now model.stock_analysis.base_lly_1993_2024)
[0m09:31:34.853408 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_lly_1993_2024
[0m09:31:34.854841 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_lly_1993_2024"
[0m09:31:34.855102 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_lly_1993_2024
[0m09:31:34.855402 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_lly_1993_2024
[0m09:31:34.855587 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_ma_2006_2024
[0m09:31:34.855776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_lly_1993_2024, now model.stock_analysis.base_ma_2006_2024)
[0m09:31:34.855939 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_ma_2006_2024
[0m09:31:34.857420 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_ma_2006_2024"
[0m09:31:34.857860 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_ma_2006_2024
[0m09:31:34.858167 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_ma_2006_2024
[0m09:31:34.858356 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_meta_2012_2024
[0m09:31:34.858549 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ma_2006_2024, now model.stock_analysis.base_meta_2012_2024)
[0m09:31:34.858714 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_meta_2012_2024
[0m09:31:34.860207 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_meta_2012_2024"
[0m09:31:34.860514 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_meta_2012_2024
[0m09:31:34.860824 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_meta_2012_2024
[0m09:31:34.861016 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_mrk_1993_2024
[0m09:31:34.861208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_meta_2012_2024, now model.stock_analysis.base_mrk_1993_2024)
[0m09:31:34.861373 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_mrk_1993_2024
[0m09:31:34.862794 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_mrk_1993_2024"
[0m09:31:34.863049 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_mrk_1993_2024
[0m09:31:34.863369 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_mrk_1993_2024
[0m09:31:34.863561 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_msft_1993_2024
[0m09:31:34.863754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_mrk_1993_2024, now model.stock_analysis.base_msft_1993_2024)
[0m09:31:34.863920 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_msft_1993_2024
[0m09:31:34.865404 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_msft_1993_2024"
[0m09:31:34.865809 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_msft_1993_2024
[0m09:31:34.866119 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_msft_1993_2024
[0m09:31:34.866304 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_nflx_1993_2024
[0m09:31:34.866495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_msft_1993_2024, now model.stock_analysis.base_nflx_1993_2024)
[0m09:31:34.866663 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_nflx_1993_2024
[0m09:31:34.868739 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_nflx_1993_2024"
[0m09:31:34.869017 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_nflx_1993_2024
[0m09:31:34.869323 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_nflx_1993_2024
[0m09:31:34.869521 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_nvda_1999_2024
[0m09:31:34.869744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nflx_1993_2024, now model.stock_analysis.base_nvda_1999_2024)
[0m09:31:34.869938 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_nvda_1999_2024
[0m09:31:34.871429 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_nvda_1999_2024"
[0m09:31:34.871739 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_nvda_1999_2024
[0m09:31:34.872048 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_nvda_1999_2024
[0m09:31:34.872236 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_pep_1993_2024
[0m09:31:34.872436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nvda_1999_2024, now model.stock_analysis.base_pep_1993_2024)
[0m09:31:34.872608 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_pep_1993_2024
[0m09:31:34.874105 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_pep_1993_2024"
[0m09:31:34.874527 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_pep_1993_2024
[0m09:31:34.874841 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_pep_1993_2024
[0m09:31:34.875029 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_pg_1993_2024
[0m09:31:34.875231 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pep_1993_2024, now model.stock_analysis.base_pg_1993_2024)
[0m09:31:34.875399 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_pg_1993_2024
[0m09:31:34.876863 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_pg_1993_2024"
[0m09:31:34.877137 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_pg_1993_2024
[0m09:31:34.877443 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_pg_1993_2024
[0m09:31:34.877631 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m09:31:34.877827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pg_1993_2024, now model.stock_analysis.base_spus_2019_2024)
[0m09:31:34.877993 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m09:31:34.879440 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m09:31:34.879833 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m09:31:34.880144 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m09:31:34.880328 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m09:31:34.880525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spus_2019_2024, now model.stock_analysis.base_spy_1993_2024)
[0m09:31:34.880704 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m09:31:34.882244 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m09:31:34.882658 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m09:31:34.882971 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m09:31:34.883156 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m09:31:34.883356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_1993_2024, now model.stock_analysis.base_spy_2014_2024)
[0m09:31:34.883521 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m09:31:34.884912 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m09:31:34.885175 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m09:31:34.885476 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m09:31:34.885662 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m09:31:34.885858 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.base_symbols_meta)
[0m09:31:34.886023 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m09:31:34.888143 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m09:31:34.888716 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m09:31:34.889021 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m09:31:34.889205 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_tmo_1993_2024
[0m09:31:34.889429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_symbols_meta, now model.stock_analysis.base_tmo_1993_2024)
[0m09:31:34.889606 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_tmo_1993_2024
[0m09:31:34.891029 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_tmo_1993_2024"
[0m09:31:34.891433 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_tmo_1993_2024
[0m09:31:34.891742 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_tmo_1993_2024
[0m09:31:34.891929 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_tsla_2010_2024
[0m09:31:34.892176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tmo_1993_2024, now model.stock_analysis.base_tsla_2010_2024)
[0m09:31:34.892344 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_tsla_2010_2024
[0m09:31:34.893743 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_tsla_2010_2024"
[0m09:31:34.894026 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_tsla_2010_2024
[0m09:31:34.894333 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_tsla_2010_2024
[0m09:31:34.894524 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_unh_1993_2024
[0m09:31:34.894723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tsla_2010_2024, now model.stock_analysis.base_unh_1993_2024)
[0m09:31:34.894889 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_unh_1993_2024
[0m09:31:34.896348 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_unh_1993_2024"
[0m09:31:34.896622 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_unh_1993_2024
[0m09:31:34.896933 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_unh_1993_2024
[0m09:31:34.897124 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_v_1993_2024
[0m09:31:34.897327 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_unh_1993_2024, now model.stock_analysis.base_v_1993_2024)
[0m09:31:34.897494 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_v_1993_2024
[0m09:31:34.898888 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_v_1993_2024"
[0m09:31:34.899284 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_v_1993_2024
[0m09:31:34.899601 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_v_1993_2024
[0m09:31:34.899786 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_wmt_1993_2024
[0m09:31:34.899978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_v_1993_2024, now model.stock_analysis.base_wmt_1993_2024)
[0m09:31:34.900142 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_wmt_1993_2024
[0m09:31:34.901599 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_wmt_1993_2024"
[0m09:31:34.901869 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_wmt_1993_2024
[0m09:31:34.902180 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_wmt_1993_2024
[0m09:31:34.902370 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_xom_1993_2024
[0m09:31:34.902561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_wmt_1993_2024, now model.stock_analysis.base_xom_1993_2024)
[0m09:31:34.902726 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_xom_1993_2024
[0m09:31:34.904183 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_xom_1993_2024"
[0m09:31:34.904438 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_xom_1993_2024
[0m09:31:34.904744 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_xom_1993_2024
[0m09:31:34.904941 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m09:31:34.905145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_xom_1993_2024, now model.stock_analysis.stg_calendar)
[0m09:31:34.905322 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m09:31:34.907204 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m09:31:34.907871 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m09:31:34.908183 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m09:31:34.908367 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_symbols_meta
[0m09:31:34.908631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_symbols_meta)
[0m09:31:34.909861 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m09:31:34.911336 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m09:31:34.911889 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m09:31:34.912197 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m09:31:34.912391 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m09:31:34.912590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_symbols_meta, now model.stock_analysis.stg_aapl_1993_2024)
[0m09:31:34.912752 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_aapl_1993_2024
[0m09:31:34.914765 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_aapl_1993_2024"
[0m09:31:34.915286 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_aapl_1993_2024
[0m09:31:34.915613 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m09:31:34.915803 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m09:31:34.916003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_aapl_1993_2024, now model.stock_analysis.stg_abbv_2013_2024)
[0m09:31:34.916171 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_abbv_2013_2024
[0m09:31:34.917988 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_abbv_2013_2024"
[0m09:31:34.918552 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_abbv_2013_2024
[0m09:31:34.918859 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m09:31:34.919042 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m09:31:34.919237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_abbv_2013_2024, now model.stock_analysis.stg_adbe_1993_2024)
[0m09:31:34.919399 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_adbe_1993_2024
[0m09:31:34.921309 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_adbe_1993_2024"
[0m09:31:34.921769 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_adbe_1993_2024
[0m09:31:34.922089 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m09:31:34.922280 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m09:31:34.922486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_adbe_1993_2024, now model.stock_analysis.stg_amd_1993_2024)
[0m09:31:34.922656 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amd_1993_2024
[0m09:31:34.924482 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amd_1993_2024"
[0m09:31:34.925155 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amd_1993_2024
[0m09:31:34.925466 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m09:31:34.925657 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m09:31:34.925851 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amd_1993_2024, now model.stock_analysis.stg_amzn_1997_2024)
[0m09:31:34.926016 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amzn_1997_2024
[0m09:31:34.927832 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amzn_1997_2024"
[0m09:31:34.928369 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amzn_1997_2024
[0m09:31:34.928675 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m09:31:34.928862 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m09:31:34.929056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amzn_1997_2024, now model.stock_analysis.stg_avgo_2009_2024)
[0m09:31:34.929227 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_avgo_2009_2024
[0m09:31:34.931861 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_avgo_2009_2024"
[0m09:31:34.932487 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_avgo_2009_2024
[0m09:31:34.932800 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m09:31:34.932989 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m09:31:34.933183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_avgo_2009_2024, now model.stock_analysis.stg_bac_1993_2024)
[0m09:31:34.933351 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_bac_1993_2024
[0m09:31:34.935178 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_bac_1993_2024"
[0m09:31:34.935957 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_bac_1993_2024
[0m09:31:34.936266 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m09:31:34.936451 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m09:31:34.936645 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_bac_1993_2024, now model.stock_analysis.stg_brk-b_1996_2024)
[0m09:31:34.936813 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_brk-b_1996_2024
[0m09:31:34.938703 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m09:31:34.939219 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_brk-b_1996_2024
[0m09:31:34.939538 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m09:31:34.939728 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m09:31:34.939927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_brk-b_1996_2024, now model.stock_analysis.stg_cost_1993_2024)
[0m09:31:34.940093 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cost_1993_2024
[0m09:31:34.941908 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cost_1993_2024"
[0m09:31:34.942345 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cost_1993_2024
[0m09:31:34.942655 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m09:31:34.942839 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m09:31:34.943036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cost_1993_2024, now model.stock_analysis.stg_crm_2004_2024)
[0m09:31:34.943202 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_crm_2004_2024
[0m09:31:34.945019 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_crm_2004_2024"
[0m09:31:34.945552 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_crm_2004_2024
[0m09:31:34.945879 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m09:31:34.946073 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m09:31:34.946273 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_crm_2004_2024, now model.stock_analysis.stg_cvx_1993_2024)
[0m09:31:34.946444 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cvx_1993_2024
[0m09:31:34.948326 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cvx_1993_2024"
[0m09:31:34.948764 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cvx_1993_2024
[0m09:31:34.949072 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m09:31:34.949259 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m09:31:34.949452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cvx_1993_2024, now model.stock_analysis.stg_goog_2004_2024)
[0m09:31:34.949615 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_goog_2004_2024
[0m09:31:34.951397 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_goog_2004_2024"
[0m09:31:34.951907 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_goog_2004_2024
[0m09:31:34.952223 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m09:31:34.952409 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m09:31:34.952610 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_goog_2004_2024, now model.stock_analysis.stg_googl_2004_2024)
[0m09:31:34.952775 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_googl_2004_2024
[0m09:31:34.954603 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_googl_2004_2024"
[0m09:31:34.955256 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_googl_2004_2024
[0m09:31:34.955569 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m09:31:34.955755 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m09:31:34.955949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_googl_2004_2024, now model.stock_analysis.stg_hd_1993_2024)
[0m09:31:34.956117 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hd_1993_2024
[0m09:31:34.958663 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hd_1993_2024"
[0m09:31:34.959148 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hd_1993_2024
[0m09:31:34.959458 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m09:31:34.959643 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m09:31:34.959839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hd_1993_2024, now model.stock_analysis.stg_jnj_1993_2024)
[0m09:31:34.960006 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jnj_1993_2024
[0m09:31:34.961810 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jnj_1993_2024"
[0m09:31:34.962524 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jnj_1993_2024
[0m09:31:34.962831 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m09:31:34.963016 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m09:31:34.963235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jnj_1993_2024, now model.stock_analysis.stg_jpm_1993_2024)
[0m09:31:34.963419 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jpm_1993_2024
[0m09:31:34.965214 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jpm_1993_2024"
[0m09:31:34.965847 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jpm_1993_2024
[0m09:31:34.966152 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m09:31:34.966338 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m09:31:34.966534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jpm_1993_2024, now model.stock_analysis.stg_ko_1993_2024)
[0m09:31:34.966699 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ko_1993_2024
[0m09:31:34.968538 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ko_1993_2024"
[0m09:31:34.969149 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ko_1993_2024
[0m09:31:34.969459 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m09:31:34.969659 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m09:31:34.969869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ko_1993_2024, now model.stock_analysis.stg_lly_1993_2024)
[0m09:31:34.970041 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_lly_1993_2024
[0m09:31:34.971886 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_lly_1993_2024"
[0m09:31:34.972561 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_lly_1993_2024
[0m09:31:34.972872 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m09:31:34.973058 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m09:31:34.973252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_lly_1993_2024, now model.stock_analysis.stg_ma_2006_2024)
[0m09:31:34.973419 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ma_2006_2024
[0m09:31:34.975268 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ma_2006_2024"
[0m09:31:34.975572 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ma_2006_2024
[0m09:31:34.975887 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m09:31:34.976079 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m09:31:34.976274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ma_2006_2024, now model.stock_analysis.stg_meta_2012_2024)
[0m09:31:34.976439 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_meta_2012_2024
[0m09:31:34.978275 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_meta_2012_2024"
[0m09:31:34.978837 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_meta_2012_2024
[0m09:31:34.979150 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m09:31:34.979336 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m09:31:34.979528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_meta_2012_2024, now model.stock_analysis.stg_mrk_1993_2024)
[0m09:31:34.979693 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_mrk_1993_2024
[0m09:31:34.982163 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_mrk_1993_2024"
[0m09:31:34.982671 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_mrk_1993_2024
[0m09:31:34.982979 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_mrk_1993_2024
[0m09:31:34.983165 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_msft_1993_2024
[0m09:31:34.983359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_mrk_1993_2024, now model.stock_analysis.stg_msft_1993_2024)
[0m09:31:34.983537 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_msft_1993_2024
[0m09:31:34.985367 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_msft_1993_2024"
[0m09:31:34.985830 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_msft_1993_2024
[0m09:31:34.986135 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_msft_1993_2024
[0m09:31:34.986320 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nflx_1993_2024
[0m09:31:34.986515 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_msft_1993_2024, now model.stock_analysis.stg_nflx_1993_2024)
[0m09:31:34.986682 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nflx_1993_2024
[0m09:31:34.988470 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nflx_1993_2024"
[0m09:31:34.989017 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nflx_1993_2024
[0m09:31:34.989322 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nflx_1993_2024
[0m09:31:34.989507 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nvda_1999_2024
[0m09:31:34.989698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nflx_1993_2024, now model.stock_analysis.stg_nvda_1999_2024)
[0m09:31:34.989865 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nvda_1999_2024
[0m09:31:34.991654 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nvda_1999_2024"
[0m09:31:34.992229 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nvda_1999_2024
[0m09:31:34.992535 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nvda_1999_2024
[0m09:31:34.992720 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pep_1993_2024
[0m09:31:34.992911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nvda_1999_2024, now model.stock_analysis.stg_pep_1993_2024)
[0m09:31:34.993073 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_pep_1993_2024
[0m09:31:34.994873 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_pep_1993_2024"
[0m09:31:34.995555 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_pep_1993_2024
[0m09:31:34.995862 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pep_1993_2024
[0m09:31:34.996051 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pg_1993_2024
[0m09:31:34.996251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_pep_1993_2024, now model.stock_analysis.stg_pg_1993_2024)
[0m09:31:34.996420 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_pg_1993_2024
[0m09:31:34.998261 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_pg_1993_2024"
[0m09:31:34.998885 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_pg_1993_2024
[0m09:31:34.999196 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pg_1993_2024
[0m09:31:34.999382 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m09:31:34.999582 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_pg_1993_2024, now model.stock_analysis.stg_spus_2019_2024)
[0m09:31:34.999748 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m09:31:35.001589 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m09:31:35.002003 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m09:31:35.002312 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m09:31:35.002497 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m09:31:35.002690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spus_2019_2024, now model.stock_analysis.stg_spy_1993_2024)
[0m09:31:35.002854 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m09:31:35.005367 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m09:31:35.006476 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m09:31:35.006806 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m09:31:35.006998 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m09:31:35.007217 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_1993_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m09:31:35.007383 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m09:31:35.009252 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m09:31:35.009824 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m09:31:35.010155 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m09:31:35.010352 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tmo_1993_2024
[0m09:31:35.010560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.stg_tmo_1993_2024)
[0m09:31:35.010729 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_tmo_1993_2024
[0m09:31:35.012608 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_tmo_1993_2024"
[0m09:31:35.013178 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_tmo_1993_2024
[0m09:31:35.013494 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tmo_1993_2024
[0m09:31:35.013682 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tsla_2010_2024
[0m09:31:35.013874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_tmo_1993_2024, now model.stock_analysis.stg_tsla_2010_2024)
[0m09:31:35.014040 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_tsla_2010_2024
[0m09:31:35.015804 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_tsla_2010_2024"
[0m09:31:35.016456 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_tsla_2010_2024
[0m09:31:35.016762 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tsla_2010_2024
[0m09:31:35.016952 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_unh_1993_2024
[0m09:31:35.017145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_tsla_2010_2024, now model.stock_analysis.stg_unh_1993_2024)
[0m09:31:35.017310 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_unh_1993_2024
[0m09:31:35.019162 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_unh_1993_2024"
[0m09:31:35.019632 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_unh_1993_2024
[0m09:31:35.019953 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_unh_1993_2024
[0m09:31:35.020146 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_v_1993_2024
[0m09:31:35.020388 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_unh_1993_2024, now model.stock_analysis.stg_v_1993_2024)
[0m09:31:35.020599 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_v_1993_2024
[0m09:31:35.022641 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_v_1993_2024"
[0m09:31:35.023173 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_v_1993_2024
[0m09:31:35.023508 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_v_1993_2024
[0m09:31:35.023698 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_wmt_1993_2024
[0m09:31:35.023906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_v_1993_2024, now model.stock_analysis.stg_wmt_1993_2024)
[0m09:31:35.024075 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_wmt_1993_2024
[0m09:31:35.025879 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_wmt_1993_2024"
[0m09:31:35.026329 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_wmt_1993_2024
[0m09:31:35.026653 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_wmt_1993_2024
[0m09:31:35.026848 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_xom_1993_2024
[0m09:31:35.027057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_wmt_1993_2024, now model.stock_analysis.stg_xom_1993_2024)
[0m09:31:35.027230 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_xom_1993_2024
[0m09:31:35.029155 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_xom_1993_2024"
[0m09:31:35.029692 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_xom_1993_2024
[0m09:31:35.030017 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_xom_1993_2024
[0m09:31:35.030386 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m09:31:35.030608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_xom_1993_2024, now model.stock_analysis.int_stock_analysis)
[0m09:31:35.030779 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m09:31:35.037022 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m09:31:35.037709 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m09:31:35.038025 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m09:31:35.038322 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m09:31:35.038555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.int_stock_analysis, now model.stock_analysis.stock_analysis)
[0m09:31:35.038751 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m09:31:35.040388 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m09:31:35.041429 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m09:31:35.041891 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m09:31:35.042382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:35.042560 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m09:31:35.047155 [debug] [MainThread]: Command end result
[0m09:31:35.114057 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m09:31:35.114262 [info ] [MainThread]: Building catalog
[0m09:31:35.125183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:36.173196 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m09:31:36.194704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:36.267495 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards as (
                    
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock_analysis`.__TABLES__ tables
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'

                    where (upper(tables.dataset_id) = upper('stock_analysis'))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m09:31:37.098393 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d26753e7-3b67-45f2-9de9-728885460c8d&page=queryresults
[0m09:31:40.872326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:40.930173 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards as (
                    
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock`.__TABLES__ tables
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'

                    where (upper(tables.dataset_id) = upper('stock'))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m09:31:41.943034 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9edd7728-c1af-418e-9ad3-92c9528ea73b&page=queryresults
[0m09:31:44.506712 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/stock_analysis/target/catalog.json
[0m09:31:44.511175 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.335528, "process_user_time": 3.506383, "process_kernel_time": 2.707747, "process_mem_max_rss": "243892224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:31:44.511664 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:31:44.511605 after 11.34 seconds
[0m09:31:44.511867 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:31:44.512008 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m09:31:44.512185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f4fceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c93a3a0>]}
[0m09:31:44.512389 [debug] [MainThread]: Flushing usage events
[0m09:32:08.962140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eccac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850eb0>]}


============================== 09:32:08.964610 | 94b0ed6b-8f4a-47e5-b897-886988e06ce0 ==============================
[0m09:32:08.964610 [info ] [MainThread]: Running with dbt=1.8.2
[0m09:32:08.964944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:32:09.486188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94b0ed6b-8f4a-47e5-b897-886988e06ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041040a0>]}
[0m09:32:09.514447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94b0ed6b-8f4a-47e5-b897-886988e06ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cbdacd0>]}
[0m02:04:22.308335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10257cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef5100>]}


============================== 02:04:22.311280 | 161c0bba-2e17-43fe-9e6e-d024105fd1c7 ==============================
[0m02:04:22.311280 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:04:22.311599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_hlal_2019_2024.sql stg_hlal_2019_2024.sql int_stock_analysis.sql stock_analysis.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:04:23.055797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '161c0bba-2e17-43fe-9e6e-d024105fd1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7da30>]}
[0m02:04:23.081855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '161c0bba-2e17-43fe-9e6e-d024105fd1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea4dc0>]}
[0m02:04:23.082175 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m02:04:23.094133 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:04:23.187211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m02:04:23.187631 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_hlal_2019_2024.sql
[0m02:04:23.187847 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_hlal_2019_2024.sql
[0m02:04:23.190197 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m02:04:23.190373 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m02:04:23.499074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '161c0bba-2e17-43fe-9e6e-d024105fd1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139294f10>]}
[0m02:04:23.566819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '161c0bba-2e17-43fe-9e6e-d024105fd1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1392888b0>]}
[0m02:04:23.567084 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m02:04:23.567270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '161c0bba-2e17-43fe-9e6e-d024105fd1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1392ee100>]}
[0m02:04:23.570935 [info ] [MainThread]: 
[0m02:04:23.571209 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:23.573596 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m02:04:23.573823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:24.017670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m02:04:24.018183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:24.428152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '161c0bba-2e17-43fe-9e6e-d024105fd1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e2a90>]}
[0m02:04:24.429021 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:04:24.429367 [info ] [MainThread]: 
[0m02:04:24.432985 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_hlal_2019_2024
[0m02:04:24.433594 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_hlal_2019_2024 ................ [RUN]
[0m02:04:24.434085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_hlal_2019_2024)
[0m02:04:24.434445 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_hlal_2019_2024
[0m02:04:24.443579 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_hlal_2019_2024"
[0m02:04:24.444393 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_hlal_2019_2024
[0m02:04:24.475518 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_hlal_2019_2024"
[0m02:04:24.476015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:04:24.538447 [debug] [Thread-1  ]: On model.stock_analysis.base_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`hlal`
    );
  
[0m02:04:25.252220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:35d4ef0b-265f-4e73-87ca-21be953f9907&page=queryresults
[0m02:04:25.406401 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: close_last at [15:5]; reason: invalidQuery, location: query, message: Unrecognized name: close_last at [15:5]')
[0m02:04:26.270318 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:23a12d88-846d-4bea-b2c3-08fb208f372d&page=queryresults
[0m02:04:26.366193 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:23a12d88-846d-4bea-b2c3-08fb208f372d&page=queryresults
[0m02:04:26.407870 [debug] [Thread-1  ]: Database Error in model base_hlal_2019_2024 (models/1_base/base_hlal_2019_2024.sql)
  Unrecognized name: close_last at [15:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_hlal_2019_2024.sql
[0m02:04:26.409167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '161c0bba-2e17-43fe-9e6e-d024105fd1c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1393eca90>]}
[0m02:04:26.409672 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model stock_analysis.base_hlal_2019_2024 ....... [[31mERROR[0m in 1.97s]
[0m02:04:26.410121 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_hlal_2019_2024
[0m02:04:26.410632 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m02:04:26.410969 [info ] [Thread-1  ]: 2 of 4 SKIP relation stock_analysis.stg_hlal_2019_2024 ......................... [[33mSKIP[0m]
[0m02:04:26.411284 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m02:04:26.411680 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m02:04:26.412006 [info ] [Thread-1  ]: 3 of 4 SKIP relation stock_analysis.int_stock_analysis ......................... [[33mSKIP[0m]
[0m02:04:26.412307 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m02:04:26.412667 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m02:04:26.412948 [info ] [Thread-1  ]: 4 of 4 SKIP relation stock_analysis.stock_analysis ............................. [[33mSKIP[0m]
[0m02:04:26.413221 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m02:04:26.413840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:26.414029 [debug] [MainThread]: Connection 'model.stock_analysis.base_hlal_2019_2024' was properly closed.
[0m02:04:26.414261 [info ] [MainThread]: 
[0m02:04:26.414467 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m02:04:26.414942 [debug] [MainThread]: Command end result
[0m02:04:26.450727 [info ] [MainThread]: 
[0m02:04:26.451017 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:04:26.451180 [info ] [MainThread]: 
[0m02:04:26.451384 [error] [MainThread]:   Database Error in model base_hlal_2019_2024 (models/1_base/base_hlal_2019_2024.sql)
  Unrecognized name: close_last at [15:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_hlal_2019_2024.sql
[0m02:04:26.451539 [info ] [MainThread]: 
[0m02:04:26.451704 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m02:04:26.453354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1964197, "process_user_time": 4.742593, "process_kernel_time": 0.296862, "process_mem_max_rss": "203915264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:04:26.453679 [debug] [MainThread]: Command `dbt run` failed at 02:04:26.453627 after 4.20 seconds
[0m02:04:26.453886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10257cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038e37c0>]}
[0m02:04:26.454100 [debug] [MainThread]: Flushing usage events
[0m02:05:36.127407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f44b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038bc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038bc0d0>]}


============================== 02:05:36.129448 | d4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2 ==============================
[0m02:05:36.129448 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:05:36.129832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_hlal_2019_2024.sql stg_hlal_2019_2024.sql int_stock_analysis.sql stock_analysis.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:05:36.573827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dd90a0>]}
[0m02:05:36.599572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f20610>]}
[0m02:05:36.599890 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m02:05:36.609876 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:05:36.686957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:05:36.687228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:05:36.744032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13745c250>]}
[0m02:05:36.809490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13724bb20>]}
[0m02:05:36.809746 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m02:05:36.809943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137555a00>]}
[0m02:05:36.813604 [info ] [MainThread]: 
[0m02:05:36.813885 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:05:36.816149 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m02:05:36.816395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:37.217596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m02:05:37.218156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:05:37.590487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101daaa90>]}
[0m02:05:37.591200 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m02:05:37.591493 [info ] [MainThread]: 
[0m02:05:37.593266 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_hlal_2019_2024
[0m02:05:37.593734 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_hlal_2019_2024 ................ [RUN]
[0m02:05:37.594114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_hlal_2019_2024)
[0m02:05:37.594390 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_hlal_2019_2024
[0m02:05:37.603101 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_hlal_2019_2024"
[0m02:05:37.603891 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_hlal_2019_2024
[0m02:05:37.632226 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_hlal_2019_2024"
[0m02:05:37.632710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:05:37.693494 [debug] [Thread-1  ]: On model.stock_analysis.base_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`hlal`
    );
  
[0m02:05:38.341433 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a9f16a11-3ad1-4fbb-b83a-7f24067d89ad&page=queryresults
[0m02:05:40.296007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375777c0>]}
[0m02:05:40.296609 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_hlal_2019_2024 ........... [[32mCREATE TABLE (1.3k rows, 60.7 KiB processed)[0m in 2.70s]
[0m02:05:40.297112 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_hlal_2019_2024
[0m02:05:40.297656 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m02:05:40.298086 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.stg_hlal_2019_2024 ................. [RUN]
[0m02:05:40.298490 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_hlal_2019_2024, now model.stock_analysis.stg_hlal_2019_2024)
[0m02:05:40.298816 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m02:05:40.302893 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m02:05:40.303474 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m02:05:40.306062 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_hlal_2019_2024"
[0m02:05:40.306643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:05:40.373405 [debug] [Thread-1  ]: On model.stock_analysis.stg_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:05:40.998739 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:856bfb7d-2e3e-4fe6-b929-fed535ba1194&page=queryresults
[0m02:06:00.927937 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137577cd0>]}
[0m02:06:00.929006 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.stg_hlal_2019_2024 ............ [[32mCREATE TABLE (1.3k rows, 37.6 MiB processed)[0m in 20.63s]
[0m02:06:00.929817 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m02:06:00.930859 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m02:06:00.931585 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m02:06:00.932302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hlal_2019_2024, now model.stock_analysis.int_stock_analysis)
[0m02:06:00.932793 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m02:06:00.940719 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m02:06:00.942700 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m02:06:00.944721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:06:01.310921 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m02:06:01.314091 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from brk_b
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m02:06:01.698207 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1bb6c452-000b-467a-a100-ee046430fe66&page=queryresults
[0m02:06:08.066408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376fd640>]}
[0m02:06:08.067348 [info ] [Thread-1  ]: 3 of 4 OK created sql table model stock_analysis.int_stock_analysis ............ [[32mCREATE TABLE (224.9k rows, 83.5 MiB processed)[0m in 7.13s]
[0m02:06:08.068236 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m02:06:08.069274 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m02:06:08.069719 [info ] [Thread-1  ]: 4 of 4 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m02:06:08.070043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.int_stock_analysis, now model.stock_analysis.stock_analysis)
[0m02:06:08.070269 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m02:06:08.072478 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m02:06:08.074169 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m02:06:08.077330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:06:08.424251 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m02:06:08.426705 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m02:06:08.857017 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:766e5d4e-da5a-43ce-b1b1-dd43c97ffe9f&page=queryresults
[0m02:06:14.597073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4f52aaf-82dc-4ae9-b404-dfd2ec8c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137577dc0>]}
[0m02:06:14.598594 [info ] [Thread-1  ]: 4 of 4 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (224.9k rows, 85.1 MiB processed)[0m in 6.53s]
[0m02:06:14.599479 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m02:06:14.601607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:14.602263 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m02:06:14.602815 [info ] [MainThread]: 
[0m02:06:14.603298 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 37.79 seconds (37.79s).
[0m02:06:14.604931 [debug] [MainThread]: Command end result
[0m02:06:14.653853 [info ] [MainThread]: 
[0m02:06:14.654236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:06:14.654443 [info ] [MainThread]: 
[0m02:06:14.654647 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:06:14.655978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 38.573742, "process_user_time": 3.21379, "process_kernel_time": 1.90395, "process_mem_max_rss": "196591616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:06:14.656315 [debug] [MainThread]: Command `dbt run` succeeded at 02:06:14.656261 after 38.57 seconds
[0m02:06:14.656567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f44b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1376fd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f2bdf0>]}
[0m02:06:14.656790 [debug] [MainThread]: Flushing usage events
[0m18:02:18.698674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104718a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060903a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060901c0>]}


============================== 18:02:18.701515 | ab7aa886-57f6-4fe9-b003-b8bffbd00ede ==============================
[0m18:02:18.701515 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:02:18.701842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_calendar+', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:02:19.481142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab7aa886-57f6-4fe9-b003-b8bffbd00ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106054580>]}
[0m18:02:19.506667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab7aa886-57f6-4fe9-b003-b8bffbd00ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137dfa250>]}
[0m18:02:19.506954 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m18:02:19.521211 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:02:19.615019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:19.615481 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m18:02:19.772943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab7aa886-57f6-4fe9-b003-b8bffbd00ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156550eb0>]}
[0m18:02:19.841503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab7aa886-57f6-4fe9-b003-b8bffbd00ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156540a60>]}
[0m18:02:19.841767 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m18:02:19.841957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab7aa886-57f6-4fe9-b003-b8bffbd00ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565130a0>]}
[0m18:02:19.843840 [info ] [MainThread]: 
[0m18:02:19.844117 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:02:19.847542 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m18:02:19.847749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:20.335817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m18:02:20.336255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:20.750328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab7aa886-57f6-4fe9-b003-b8bffbd00ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546c190>]}
[0m18:02:20.750948 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:02:20.751279 [info ] [MainThread]: 
[0m18:02:20.753313 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m18:02:20.753762 [info ] [Thread-1  ]: 1 of 39 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m18:02:20.754129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m18:02:20.754401 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m18:02:20.762447 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m18:02:20.764037 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m18:02:20.777653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:02:21.166317 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m18:02:21.169159 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , concat(year_full,'-',week_number) as year_week
    , concat(year_full,'-',month_abbrev,'-',week_number) as year_month_week

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m18:02:21.724456 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d236bd9d-97ab-4e13-ae61-7be9aaf671cc&page=queryresults
[0m18:02:22.167917 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name year_full is ambiguous at [135:14]; reason: invalidQuery, location: query, message: Column name year_full is ambiguous at [135:14]')
[0m18:02:23.293988 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:786b9485-e027-400a-98a1-aa4326107858&page=queryresults
[0m18:02:23.415594 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:786b9485-e027-400a-98a1-aa4326107858&page=queryresults
[0m18:02:23.464769 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Column name year_full is ambiguous at [135:14]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m18:02:23.466238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab7aa886-57f6-4fe9-b003-b8bffbd00ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1566cbe20>]}
[0m18:02:23.466732 [error] [Thread-1  ]: 1 of 39 ERROR creating sql table model stock_analysis.stg_calendar ............. [[31mERROR[0m in 2.71s]
[0m18:02:23.467148 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m18:02:23.468384 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m18:02:23.468729 [info ] [Thread-1  ]: 2 of 39 SKIP relation stock_analysis.stg_aapl_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.469021 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m18:02:23.469275 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m18:02:23.469532 [info ] [Thread-1  ]: 3 of 39 SKIP relation stock_analysis.stg_abbv_2013_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.469789 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m18:02:23.470028 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m18:02:23.470275 [info ] [Thread-1  ]: 4 of 39 SKIP relation stock_analysis.stg_adbe_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.470525 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m18:02:23.470759 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m18:02:23.471006 [info ] [Thread-1  ]: 5 of 39 SKIP relation stock_analysis.stg_amd_1993_2024 ......................... [[33mSKIP[0m]
[0m18:02:23.471279 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m18:02:23.471548 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m18:02:23.471814 [info ] [Thread-1  ]: 6 of 39 SKIP relation stock_analysis.stg_amzn_1997_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.472075 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m18:02:23.472320 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m18:02:23.472603 [info ] [Thread-1  ]: 7 of 39 SKIP relation stock_analysis.stg_avgo_2009_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.472875 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m18:02:23.473122 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m18:02:23.473466 [info ] [Thread-1  ]: 8 of 39 SKIP relation stock_analysis.stg_bac_1993_2024 ......................... [[33mSKIP[0m]
[0m18:02:23.473782 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m18:02:23.474058 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m18:02:23.474335 [info ] [Thread-1  ]: 9 of 39 SKIP relation stock_analysis.stg_brk-b_1996_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.474597 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m18:02:23.475034 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m18:02:23.475337 [info ] [Thread-1  ]: 10 of 39 SKIP relation stock_analysis.stg_cost_1993_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.475667 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m18:02:23.475924 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m18:02:23.476167 [info ] [Thread-1  ]: 11 of 39 SKIP relation stock_analysis.stg_crm_2004_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.476401 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m18:02:23.476627 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m18:02:23.476849 [info ] [Thread-1  ]: 12 of 39 SKIP relation stock_analysis.stg_cvx_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.477079 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m18:02:23.477305 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m18:02:23.477532 [info ] [Thread-1  ]: 13 of 39 SKIP relation stock_analysis.stg_goog_2004_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.477760 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m18:02:23.477992 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m18:02:23.478223 [info ] [Thread-1  ]: 14 of 39 SKIP relation stock_analysis.stg_googl_2004_2024 ...................... [[33mSKIP[0m]
[0m18:02:23.478458 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m18:02:23.478692 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m18:02:23.478947 [info ] [Thread-1  ]: 15 of 39 SKIP relation stock_analysis.stg_hd_1993_2024 ......................... [[33mSKIP[0m]
[0m18:02:23.479177 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m18:02:23.479438 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m18:02:23.479795 [info ] [Thread-1  ]: 16 of 39 SKIP relation stock_analysis.stg_hlal_2019_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.480130 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m18:02:23.480376 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m18:02:23.480646 [info ] [Thread-1  ]: 17 of 39 SKIP relation stock_analysis.stg_jnj_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.480954 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m18:02:23.481275 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m18:02:23.481518 [info ] [Thread-1  ]: 18 of 39 SKIP relation stock_analysis.stg_jpm_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.481919 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m18:02:23.482224 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m18:02:23.482515 [info ] [Thread-1  ]: 19 of 39 SKIP relation stock_analysis.stg_ko_1993_2024 ......................... [[33mSKIP[0m]
[0m18:02:23.482825 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m18:02:23.483114 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m18:02:23.483424 [info ] [Thread-1  ]: 20 of 39 SKIP relation stock_analysis.stg_lly_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.483720 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m18:02:23.483962 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m18:02:23.484272 [info ] [Thread-1  ]: 21 of 39 SKIP relation stock_analysis.stg_ma_2006_2024 ......................... [[33mSKIP[0m]
[0m18:02:23.484626 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m18:02:23.484877 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m18:02:23.485153 [info ] [Thread-1  ]: 22 of 39 SKIP relation stock_analysis.stg_meta_2012_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.485431 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m18:02:23.485677 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m18:02:23.486024 [info ] [Thread-1  ]: 23 of 39 SKIP relation stock_analysis.stg_mrk_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.486340 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_mrk_1993_2024
[0m18:02:23.486576 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_msft_1993_2024
[0m18:02:23.486820 [info ] [Thread-1  ]: 24 of 39 SKIP relation stock_analysis.stg_msft_1993_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.487086 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_msft_1993_2024
[0m18:02:23.487331 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nflx_1993_2024
[0m18:02:23.487563 [info ] [Thread-1  ]: 25 of 39 SKIP relation stock_analysis.stg_nflx_1993_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.487824 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nflx_1993_2024
[0m18:02:23.488073 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nvda_1999_2024
[0m18:02:23.488302 [info ] [Thread-1  ]: 26 of 39 SKIP relation stock_analysis.stg_nvda_1999_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.488633 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nvda_1999_2024
[0m18:02:23.488910 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pep_1993_2024
[0m18:02:23.489161 [info ] [Thread-1  ]: 27 of 39 SKIP relation stock_analysis.stg_pep_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.489401 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pep_1993_2024
[0m18:02:23.489613 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pg_1993_2024
[0m18:02:23.489891 [info ] [Thread-1  ]: 28 of 39 SKIP relation stock_analysis.stg_pg_1993_2024 ......................... [[33mSKIP[0m]
[0m18:02:23.490221 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pg_1993_2024
[0m18:02:23.490467 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m18:02:23.490711 [info ] [Thread-1  ]: 29 of 39 SKIP relation stock_analysis.stg_spus_2019_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.490966 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m18:02:23.491178 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m18:02:23.491412 [info ] [Thread-1  ]: 30 of 39 SKIP relation stock_analysis.stg_spy_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.491635 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m18:02:23.491853 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m18:02:23.492100 [info ] [Thread-1  ]: 31 of 39 SKIP relation stock_analysis.stg_spy_2014_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.492389 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m18:02:23.492650 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tmo_1993_2024
[0m18:02:23.492881 [info ] [Thread-1  ]: 32 of 39 SKIP relation stock_analysis.stg_tmo_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.493101 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tmo_1993_2024
[0m18:02:23.493305 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tsla_2010_2024
[0m18:02:23.493543 [info ] [Thread-1  ]: 33 of 39 SKIP relation stock_analysis.stg_tsla_2010_2024 ....................... [[33mSKIP[0m]
[0m18:02:23.493783 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tsla_2010_2024
[0m18:02:23.494017 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_unh_1993_2024
[0m18:02:23.494224 [info ] [Thread-1  ]: 34 of 39 SKIP relation stock_analysis.stg_unh_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.494468 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_unh_1993_2024
[0m18:02:23.494702 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_v_1993_2024
[0m18:02:23.494960 [info ] [Thread-1  ]: 35 of 39 SKIP relation stock_analysis.stg_v_1993_2024 .......................... [[33mSKIP[0m]
[0m18:02:23.495203 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_v_1993_2024
[0m18:02:23.495420 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_wmt_1993_2024
[0m18:02:23.495666 [info ] [Thread-1  ]: 36 of 39 SKIP relation stock_analysis.stg_wmt_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.495957 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_wmt_1993_2024
[0m18:02:23.496195 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_xom_1993_2024
[0m18:02:23.496402 [info ] [Thread-1  ]: 37 of 39 SKIP relation stock_analysis.stg_xom_1993_2024 ........................ [[33mSKIP[0m]
[0m18:02:23.496680 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_xom_1993_2024
[0m18:02:23.497117 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m18:02:23.497446 [info ] [Thread-1  ]: 38 of 39 SKIP relation stock_analysis.int_stock_analysis ....................... [[33mSKIP[0m]
[0m18:02:23.497690 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m18:02:23.498130 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m18:02:23.498426 [info ] [Thread-1  ]: 39 of 39 SKIP relation stock_analysis.stock_analysis ........................... [[33mSKIP[0m]
[0m18:02:23.498697 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m18:02:23.499472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:23.499657 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m18:02:23.499939 [info ] [MainThread]: 
[0m18:02:23.500124 [info ] [MainThread]: Finished running 39 table models in 0 hours 0 minutes and 3.66 seconds (3.66s).
[0m18:02:23.502911 [debug] [MainThread]: Command end result
[0m18:02:23.544125 [info ] [MainThread]: 
[0m18:02:23.544425 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:23.544594 [info ] [MainThread]: 
[0m18:02:23.544796 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Column name year_full is ambiguous at [135:14]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m18:02:23.544967 [info ] [MainThread]: 
[0m18:02:23.545131 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=38 TOTAL=39
[0m18:02:23.546840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.898939, "process_user_time": 3.49192, "process_kernel_time": 1.480044, "process_mem_max_rss": "202686464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:02:23.547148 [debug] [MainThread]: Command `dbt run` failed at 18:02:23.547098 after 4.90 seconds
[0m18:02:23.547360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104718a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137dfa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15604f460>]}
[0m18:02:23.547556 [debug] [MainThread]: Flushing usage events
[0m18:03:24.570552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d813a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d811c0>]}


============================== 18:03:24.572633 | 0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b ==============================
[0m18:03:24.572633 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:03:24.572965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_calendar+', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:03:25.014596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154b19430>]}
[0m18:03:25.040214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbcac0>]}
[0m18:03:25.040502 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m18:03:25.050958 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:03:25.127844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:25.128281 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m18:03:25.282404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155bdb130>]}
[0m18:03:25.350646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155a873d0>]}
[0m18:03:25.350916 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m18:03:25.351107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155d1e6a0>]}
[0m18:03:25.352925 [info ] [MainThread]: 
[0m18:03:25.353218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:25.356653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m18:03:25.356867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:25.765370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m18:03:25.766026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:26.169042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464aa90>]}
[0m18:03:26.169984 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m18:03:26.170340 [info ] [MainThread]: 
[0m18:03:26.173091 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m18:03:26.173564 [info ] [Thread-1  ]: 1 of 39 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m18:03:26.173961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m18:03:26.174249 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m18:03:26.182067 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m18:03:26.182875 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m18:03:26.196495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:03:26.588456 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m18:03:26.589915 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , concat(base.year_full,'-',base.week_number) as year_week
    , concat(base.year_full,'-',base.month_abbrev,'-',base.week_number) as year_month_week
    , concat(base.year_full,'-',base.month_abbrev) as year_month

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m18:03:27.191261 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d6677e2c-2ac5-4e58-b809-c449367083dd&page=queryresults
[0m18:03:33.009533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154381670>]}
[0m18:03:33.010045 [info ] [Thread-1  ]: 1 of 39 OK created sql table model stock_analysis.stg_calendar ................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 6.84s]
[0m18:03:33.010466 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m18:03:33.011497 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m18:03:33.011861 [info ] [Thread-1  ]: 2 of 39 START sql table model stock_analysis.stg_aapl_1993_2024 ................ [RUN]
[0m18:03:33.012156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_aapl_1993_2024)
[0m18:03:33.012377 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_aapl_1993_2024
[0m18:03:33.014967 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_aapl_1993_2024"
[0m18:03:33.016806 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_aapl_1993_2024
[0m18:03:33.018783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:03:33.387244 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_aapl_1993_2024"
[0m18:03:33.391468 [debug] [Thread-1  ]: On model.stock_analysis.stg_aapl_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_aapl_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_aapl_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:03:33.780699 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:48e0b400-0c0e-45e3-8329-1cefac5a090b&page=queryresults
[0m18:05:31.768596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155dffe50>]}
[0m18:05:31.772598 [info ] [Thread-1  ]: 2 of 39 OK created sql table model stock_analysis.stg_aapl_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 118.76s]
[0m18:05:31.773825 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m18:05:31.774442 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m18:05:31.775297 [info ] [Thread-1  ]: 3 of 39 START sql table model stock_analysis.stg_abbv_2013_2024 ................ [RUN]
[0m18:05:31.776051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_aapl_1993_2024, now model.stock_analysis.stg_abbv_2013_2024)
[0m18:05:31.776571 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_abbv_2013_2024
[0m18:05:31.785758 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_abbv_2013_2024"
[0m18:05:31.787970 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_abbv_2013_2024
[0m18:05:31.790891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:05:32.191819 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_abbv_2013_2024"
[0m18:05:32.196025 [debug] [Thread-1  ]: On model.stock_analysis.stg_abbv_2013_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_abbv_2013_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_abbv_2013_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:05:32.875610 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6a9ff226-b117-4089-b844-09ffa0f18cf5&page=queryresults
[0m18:06:14.718080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eb71c0>]}
[0m18:06:14.719566 [info ] [Thread-1  ]: 3 of 39 OK created sql table model stock_analysis.stg_abbv_2013_2024 ........... [[32mCREATE TABLE (2.9k rows, 42.1 MiB processed)[0m in 42.94s]
[0m18:06:14.720602 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m18:06:14.721446 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m18:06:14.722623 [info ] [Thread-1  ]: 4 of 39 START sql table model stock_analysis.stg_adbe_1993_2024 ................ [RUN]
[0m18:06:14.723531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_abbv_2013_2024, now model.stock_analysis.stg_adbe_1993_2024)
[0m18:06:14.724136 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_adbe_1993_2024
[0m18:06:14.730141 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_adbe_1993_2024"
[0m18:06:14.731510 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_adbe_1993_2024
[0m18:06:14.734981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:15.191049 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_adbe_1993_2024"
[0m18:06:15.193734 [debug] [Thread-1  ]: On model.stock_analysis.stg_adbe_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_adbe_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_adbe_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:06:15.622409 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1f880545-f5d3-4f87-9080-5529f1c1b286&page=queryresults
[0m18:09:14.113242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ebfb20>]}
[0m18:09:14.115992 [info ] [Thread-1  ]: 4 of 39 OK created sql table model stock_analysis.stg_adbe_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 179.39s]
[0m18:09:14.117464 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m18:09:14.118343 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m18:09:14.119283 [info ] [Thread-1  ]: 5 of 39 START sql table model stock_analysis.stg_amd_1993_2024 ................. [RUN]
[0m18:09:14.120155 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_adbe_1993_2024, now model.stock_analysis.stg_amd_1993_2024)
[0m18:09:14.120712 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amd_1993_2024
[0m18:09:14.128890 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amd_1993_2024"
[0m18:09:14.130144 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amd_1993_2024
[0m18:09:14.133314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:09:14.501695 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_amd_1993_2024"
[0m18:09:14.503325 [debug] [Thread-1  ]: On model.stock_analysis.stg_amd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:09:14.867341 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fa9ab759-e99a-403e-9518-7f61ef5e5f0e&page=queryresults
[0m18:11:48.166408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e75d60>]}
[0m18:11:48.168466 [info ] [Thread-1  ]: 5 of 39 OK created sql table model stock_analysis.stg_amd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 154.05s]
[0m18:11:48.169467 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m18:11:48.170409 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m18:11:48.171660 [info ] [Thread-1  ]: 6 of 39 START sql table model stock_analysis.stg_amzn_1997_2024 ................ [RUN]
[0m18:11:48.172697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amd_1993_2024, now model.stock_analysis.stg_amzn_1997_2024)
[0m18:11:48.173239 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amzn_1997_2024
[0m18:11:48.178595 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amzn_1997_2024"
[0m18:11:48.179777 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amzn_1997_2024
[0m18:11:48.183800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:48.589288 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_amzn_1997_2024"
[0m18:11:48.591413 [debug] [Thread-1  ]: On model.stock_analysis.stg_amzn_1997_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amzn_1997_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amzn_1997_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:11:49.277302 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4b2cda90-b6b9-4350-afa9-68211aba1d9d&page=queryresults
[0m18:14:02.194112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e75d60>]}
[0m18:14:02.195808 [info ] [Thread-1  ]: 6 of 39 OK created sql table model stock_analysis.stg_amzn_1997_2024 ........... [[32mCREATE TABLE (6.9k rows, 42.3 MiB processed)[0m in 134.02s]
[0m18:14:02.196850 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m18:14:02.197400 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m18:14:02.198098 [info ] [Thread-1  ]: 7 of 39 START sql table model stock_analysis.stg_avgo_2009_2024 ................ [RUN]
[0m18:14:02.198777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amzn_1997_2024, now model.stock_analysis.stg_avgo_2009_2024)
[0m18:14:02.199231 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_avgo_2009_2024
[0m18:14:02.207065 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_avgo_2009_2024"
[0m18:14:02.209776 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_avgo_2009_2024
[0m18:14:02.213078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:14:02.605528 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_avgo_2009_2024"
[0m18:14:02.608405 [debug] [Thread-1  ]: On model.stock_analysis.stg_avgo_2009_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_avgo_2009_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_avgo_2009_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:14:03.006345 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f66bdea6-6d3f-4330-af1b-f2b43d7c6b07&page=queryresults
[0m18:14:57.946014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e75d60>]}
[0m18:14:57.947196 [info ] [Thread-1  ]: 7 of 39 OK created sql table model stock_analysis.stg_avgo_2009_2024 ........... [[32mCREATE TABLE (3.8k rows, 42.2 MiB processed)[0m in 55.75s]
[0m18:14:57.948115 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m18:14:57.948679 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m18:14:57.949403 [info ] [Thread-1  ]: 8 of 39 START sql table model stock_analysis.stg_bac_1993_2024 ................. [RUN]
[0m18:14:57.950184 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_avgo_2009_2024, now model.stock_analysis.stg_bac_1993_2024)
[0m18:14:57.950780 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_bac_1993_2024
[0m18:14:57.956754 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_bac_1993_2024"
[0m18:14:57.957751 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_bac_1993_2024
[0m18:14:57.960082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:14:58.342304 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_bac_1993_2024"
[0m18:14:58.344875 [debug] [Thread-1  ]: On model.stock_analysis.stg_bac_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_bac_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_bac_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:14:58.798240 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:509e6515-0245-4040-9a78-b3da1b2e86db&page=queryresults
[0m18:17:48.241275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ea8a60>]}
[0m18:17:48.243146 [info ] [Thread-1  ]: 8 of 39 OK created sql table model stock_analysis.stg_bac_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 170.29s]
[0m18:17:48.244135 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m18:17:48.244800 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m18:17:48.245837 [info ] [Thread-1  ]: 9 of 39 START sql table model stock_analysis.stg_brk-b_1996_2024 ............... [RUN]
[0m18:17:48.246766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_bac_1993_2024, now model.stock_analysis.stg_brk-b_1996_2024)
[0m18:17:48.247302 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_brk-b_1996_2024
[0m18:17:48.255428 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m18:17:48.257077 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_brk-b_1996_2024
[0m18:17:48.260090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:17:48.673138 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m18:17:48.675496 [debug] [Thread-1  ]: On model.stock_analysis.stg_brk-b_1996_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_brk-b_1996_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_brk-b_1996_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:17:49.080177 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cbcd6fcc-5e4a-4674-83e8-f59bcfe12610&page=queryresults
[0m18:19:43.359063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ea8a60>]}
[0m18:19:43.360675 [info ] [Thread-1  ]: 9 of 39 OK created sql table model stock_analysis.stg_brk-b_1996_2024 .......... [[32mCREATE TABLE (7.1k rows, 42.3 MiB processed)[0m in 115.11s]
[0m18:19:43.361118 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m18:19:43.361410 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m18:19:43.361789 [info ] [Thread-1  ]: 10 of 39 START sql table model stock_analysis.stg_cost_1993_2024 ............... [RUN]
[0m18:19:43.362169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_brk-b_1996_2024, now model.stock_analysis.stg_cost_1993_2024)
[0m18:19:43.362612 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cost_1993_2024
[0m18:19:43.366982 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cost_1993_2024"
[0m18:19:43.368057 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cost_1993_2024
[0m18:19:43.370411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:43.770417 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_cost_1993_2024"
[0m18:19:43.773334 [debug] [Thread-1  ]: On model.stock_analysis.stg_cost_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cost_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cost_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:19:44.150697 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:54481934-6ffe-453d-abdd-c771866bd00c&page=queryresults
[0m18:21:52.124626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ed41c0>]}
[0m18:21:52.127464 [info ] [Thread-1  ]: 10 of 39 OK created sql table model stock_analysis.stg_cost_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 128.76s]
[0m18:21:52.128765 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m18:21:52.129503 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m18:21:52.130308 [info ] [Thread-1  ]: 11 of 39 START sql table model stock_analysis.stg_crm_2004_2024 ................ [RUN]
[0m18:21:52.131064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cost_1993_2024, now model.stock_analysis.stg_crm_2004_2024)
[0m18:21:52.131516 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_crm_2004_2024
[0m18:21:52.140329 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_crm_2004_2024"
[0m18:21:52.141554 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_crm_2004_2024
[0m18:21:52.144552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:21:52.516188 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_crm_2004_2024"
[0m18:21:52.519009 [debug] [Thread-1  ]: On model.stock_analysis.stg_crm_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_crm_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_crm_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:21:52.935030 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:269d52c7-4ebc-4bed-aa6f-2e368dcff0f4&page=queryresults
[0m18:23:23.304030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eeeca0>]}
[0m18:23:23.306738 [info ] [Thread-1  ]: 11 of 39 OK created sql table model stock_analysis.stg_crm_2004_2024 ........... [[32mCREATE TABLE (5.1k rows, 42.2 MiB processed)[0m in 91.17s]
[0m18:23:23.307807 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m18:23:23.308755 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m18:23:23.309630 [info ] [Thread-1  ]: 12 of 39 START sql table model stock_analysis.stg_cvx_1993_2024 ................ [RUN]
[0m18:23:23.310432 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_crm_2004_2024, now model.stock_analysis.stg_cvx_1993_2024)
[0m18:23:23.310976 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cvx_1993_2024
[0m18:23:23.316800 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cvx_1993_2024"
[0m18:23:23.318042 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cvx_1993_2024
[0m18:23:23.321440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:23.714007 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_cvx_1993_2024"
[0m18:23:23.716767 [debug] [Thread-1  ]: On model.stock_analysis.stg_cvx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cvx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cvx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:23:24.050173 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0e8e71d7-a1bd-4814-aba0-d25774edbe2d&page=queryresults
[0m18:26:02.421685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e75d60>]}
[0m18:26:02.424597 [info ] [Thread-1  ]: 12 of 39 OK created sql table model stock_analysis.stg_cvx_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 159.11s]
[0m18:26:02.425884 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m18:26:02.426597 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m18:26:02.427440 [info ] [Thread-1  ]: 13 of 39 START sql table model stock_analysis.stg_goog_2004_2024 ............... [RUN]
[0m18:26:02.428239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cvx_1993_2024, now model.stock_analysis.stg_goog_2004_2024)
[0m18:26:02.428713 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_goog_2004_2024
[0m18:26:02.437075 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_goog_2004_2024"
[0m18:26:02.438205 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_goog_2004_2024
[0m18:26:02.441424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:26:02.832874 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_goog_2004_2024"
[0m18:26:02.835465 [debug] [Thread-1  ]: On model.stock_analysis.stg_goog_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_goog_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_goog_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:26:03.194937 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dc9ed941-c617-43fe-ad8b-901e4e317b89&page=queryresults
[0m18:27:41.832941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e9c730>]}
[0m18:27:41.834425 [info ] [Thread-1  ]: 13 of 39 OK created sql table model stock_analysis.stg_goog_2004_2024 .......... [[32mCREATE TABLE (5.0k rows, 42.2 MiB processed)[0m in 99.40s]
[0m18:27:41.835325 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m18:27:41.835942 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m18:27:41.837414 [info ] [Thread-1  ]: 14 of 39 START sql table model stock_analysis.stg_googl_2004_2024 .............. [RUN]
[0m18:27:41.838309 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_goog_2004_2024, now model.stock_analysis.stg_googl_2004_2024)
[0m18:27:41.838903 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_googl_2004_2024
[0m18:27:41.844980 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_googl_2004_2024"
[0m18:27:41.846328 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_googl_2004_2024
[0m18:27:41.850374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:42.232142 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_googl_2004_2024"
[0m18:27:42.235073 [debug] [Thread-1  ]: On model.stock_analysis.stg_googl_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_googl_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_googl_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:27:42.661733 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2fdecf01-d26c-4de1-ab6f-17e7b257446b&page=queryresults
[0m18:29:04.993310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eeeca0>]}
[0m18:29:04.996459 [info ] [Thread-1  ]: 14 of 39 OK created sql table model stock_analysis.stg_googl_2004_2024 ......... [[32mCREATE TABLE (5.0k rows, 42.2 MiB processed)[0m in 83.15s]
[0m18:29:04.997665 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m18:29:04.998346 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m18:29:04.999204 [info ] [Thread-1  ]: 15 of 39 START sql table model stock_analysis.stg_hd_1993_2024 ................. [RUN]
[0m18:29:04.999904 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_googl_2004_2024, now model.stock_analysis.stg_hd_1993_2024)
[0m18:29:05.000359 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hd_1993_2024
[0m18:29:05.005897 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hd_1993_2024"
[0m18:29:05.007324 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hd_1993_2024
[0m18:29:05.013088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:05.381849 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_hd_1993_2024"
[0m18:29:05.386078 [debug] [Thread-1  ]: On model.stock_analysis.stg_hd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:29:05.770595 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e9488f17-cbe5-4018-875d-66450b0fe0f7&page=queryresults
[0m18:31:38.899576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eeeca0>]}
[0m18:31:38.901288 [info ] [Thread-1  ]: 15 of 39 OK created sql table model stock_analysis.stg_hd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 153.90s]
[0m18:31:38.902452 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m18:31:38.903152 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m18:31:38.903946 [info ] [Thread-1  ]: 16 of 39 START sql table model stock_analysis.stg_hlal_2019_2024 ............... [RUN]
[0m18:31:38.904748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hd_1993_2024, now model.stock_analysis.stg_hlal_2019_2024)
[0m18:31:38.905251 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m18:31:38.910596 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m18:31:38.913449 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m18:31:38.916634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:39.323034 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_hlal_2019_2024"
[0m18:31:39.325698 [debug] [Thread-1  ]: On model.stock_analysis.stg_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:31:39.731799 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:72af79f9-017c-4c15-bb31-db27b67d6449&page=queryresults
[0m18:32:04.697836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e65790>]}
[0m18:32:04.699335 [info ] [Thread-1  ]: 16 of 39 OK created sql table model stock_analysis.stg_hlal_2019_2024 .......... [[32mCREATE TABLE (1.3k rows, 42.1 MiB processed)[0m in 25.79s]
[0m18:32:04.700396 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m18:32:04.701082 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m18:32:04.701908 [info ] [Thread-1  ]: 17 of 39 START sql table model stock_analysis.stg_jnj_1993_2024 ................ [RUN]
[0m18:32:04.702612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hlal_2019_2024, now model.stock_analysis.stg_jnj_1993_2024)
[0m18:32:04.703078 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jnj_1993_2024
[0m18:32:04.708626 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jnj_1993_2024"
[0m18:32:04.710417 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jnj_1993_2024
[0m18:32:04.716223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:05.090132 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_jnj_1993_2024"
[0m18:32:05.094591 [debug] [Thread-1  ]: On model.stock_analysis.stg_jnj_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jnj_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jnj_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:32:05.524043 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e9875b81-c9e2-4a33-a282-9951f3224e62&page=queryresults
[0m18:34:09.232295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e64ac0>]}
[0m18:34:09.235150 [info ] [Thread-1  ]: 17 of 39 OK created sql table model stock_analysis.stg_jnj_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 124.53s]
[0m18:34:09.236422 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m18:34:09.237108 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m18:34:09.237991 [info ] [Thread-1  ]: 18 of 39 START sql table model stock_analysis.stg_jpm_1993_2024 ................ [RUN]
[0m18:34:09.238809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jnj_1993_2024, now model.stock_analysis.stg_jpm_1993_2024)
[0m18:34:09.239261 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jpm_1993_2024
[0m18:34:09.245179 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jpm_1993_2024"
[0m18:34:09.247005 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jpm_1993_2024
[0m18:34:09.250828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:34:09.664763 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_jpm_1993_2024"
[0m18:34:09.667654 [debug] [Thread-1  ]: On model.stock_analysis.stg_jpm_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jpm_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jpm_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:34:10.046213 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:848645d3-87b7-493b-8ea3-8911a97bd537&page=queryresults
[0m18:36:35.757519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f56c40>]}
[0m18:36:35.759337 [info ] [Thread-1  ]: 18 of 39 OK created sql table model stock_analysis.stg_jpm_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 146.52s]
[0m18:36:35.760359 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m18:36:35.761233 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m18:36:35.762324 [info ] [Thread-1  ]: 19 of 39 START sql table model stock_analysis.stg_ko_1993_2024 ................. [RUN]
[0m18:36:35.763173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jpm_1993_2024, now model.stock_analysis.stg_ko_1993_2024)
[0m18:36:35.763751 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ko_1993_2024
[0m18:36:35.769558 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ko_1993_2024"
[0m18:36:35.770750 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ko_1993_2024
[0m18:36:35.776858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:36.197709 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_ko_1993_2024"
[0m18:36:36.201819 [debug] [Thread-1  ]: On model.stock_analysis.stg_ko_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ko_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ko_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:36:36.691908 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b0673a57-816c-452e-9cc1-3ea4a7eedccc&page=queryresults
[0m18:39:03.910522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f56c40>]}
[0m18:39:03.912193 [info ] [Thread-1  ]: 19 of 39 OK created sql table model stock_analysis.stg_ko_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 148.15s]
[0m18:39:03.913314 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m18:39:03.914336 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m18:39:03.915395 [info ] [Thread-1  ]: 20 of 39 START sql table model stock_analysis.stg_lly_1993_2024 ................ [RUN]
[0m18:39:03.916252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ko_1993_2024, now model.stock_analysis.stg_lly_1993_2024)
[0m18:39:03.916797 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_lly_1993_2024
[0m18:39:03.922536 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_lly_1993_2024"
[0m18:39:03.923775 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_lly_1993_2024
[0m18:39:03.927337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:39:04.286114 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_lly_1993_2024"
[0m18:39:04.288408 [debug] [Thread-1  ]: On model.stock_analysis.stg_lly_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_lly_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_lly_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:39:04.660061 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f7137fdf-32ea-4021-83c4-0081bb01e955&page=queryresults
[0m18:41:38.322191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f56c40>]}
[0m18:41:38.325167 [info ] [Thread-1  ]: 20 of 39 OK created sql table model stock_analysis.stg_lly_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 154.41s]
[0m18:41:38.326368 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m18:41:38.327080 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m18:41:38.327930 [info ] [Thread-1  ]: 21 of 39 START sql table model stock_analysis.stg_ma_2006_2024 ................. [RUN]
[0m18:41:38.328656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_lly_1993_2024, now model.stock_analysis.stg_ma_2006_2024)
[0m18:41:38.329130 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ma_2006_2024
[0m18:41:38.337628 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ma_2006_2024"
[0m18:41:38.338876 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ma_2006_2024
[0m18:41:38.342022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:41:38.727768 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_ma_2006_2024"
[0m18:41:38.731363 [debug] [Thread-1  ]: On model.stock_analysis.stg_ma_2006_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ma_2006_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ma_2006_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:41:39.155030 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d4f35f73-360d-4892-a3c4-0a7cef15f1c1&page=queryresults
[0m18:42:46.027819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ffee20>]}
[0m18:42:46.029418 [info ] [Thread-1  ]: 21 of 39 OK created sql table model stock_analysis.stg_ma_2006_2024 ............ [[32mCREATE TABLE (4.6k rows, 42.2 MiB processed)[0m in 67.70s]
[0m18:42:46.030674 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m18:42:46.031668 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m18:42:46.032606 [info ] [Thread-1  ]: 22 of 39 START sql table model stock_analysis.stg_meta_2012_2024 ............... [RUN]
[0m18:42:46.033492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ma_2006_2024, now model.stock_analysis.stg_meta_2012_2024)
[0m18:42:46.034022 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_meta_2012_2024
[0m18:42:46.039749 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_meta_2012_2024"
[0m18:42:46.041993 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_meta_2012_2024
[0m18:42:46.045165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:42:46.432476 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_meta_2012_2024"
[0m18:42:46.435064 [debug] [Thread-1  ]: On model.stock_analysis.stg_meta_2012_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_meta_2012_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_meta_2012_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:42:46.842926 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bf982435-ac69-4aad-9694-dd6383899744&page=queryresults
[0m18:43:56.356325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a59aee0-ee5f-4bad-a5d3-3b609daa2a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f7df10>]}
[0m18:43:56.357744 [info ] [Thread-1  ]: 22 of 39 OK created sql table model stock_analysis.stg_meta_2012_2024 .......... [[32mCREATE TABLE (3.1k rows, 42.1 MiB processed)[0m in 70.32s]
[0m18:43:56.359010 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m18:43:56.359863 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m18:43:56.360748 [info ] [Thread-1  ]: 23 of 39 START sql table model stock_analysis.stg_mrk_1993_2024 ................ [RUN]
[0m18:43:56.361564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_meta_2012_2024, now model.stock_analysis.stg_mrk_1993_2024)
[0m18:43:56.362108 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_mrk_1993_2024
[0m18:43:56.367464 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_mrk_1993_2024"
[0m18:43:56.369682 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_mrk_1993_2024
[0m18:43:56.375260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:56.765722 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_mrk_1993_2024"
[0m18:43:56.768231 [debug] [Thread-1  ]: On model.stock_analysis.stg_mrk_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_mrk_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_mrk_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m18:43:57.227388 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:424f67d3-c2cf-47bc-96af-a02c6b8512ae&page=queryresults
[0m01:17:13.694023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815d0a0>]}


============================== 01:17:13.696784 | fcc6ff5b-bc83-47de-afd5-f8b315e426d6 ==============================
[0m01:17:13.696784 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:17:13.697123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_calendar+', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:17:14.241182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba0d3d0>]}
[0m01:17:14.267825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b84f10>]}
[0m01:17:14.268154 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:17:14.285244 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:17:14.384548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:14.384825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:14.442842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf43040>]}
[0m01:17:14.513789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd91b50>]}
[0m01:17:14.514083 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m01:17:14.514272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf54a00>]}
[0m01:17:14.516303 [info ] [MainThread]: 
[0m01:17:14.516588 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:17:14.520056 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:17:14.520269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:14.971101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:17:14.971621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:15.394108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664aa90>]}
[0m01:17:15.394868 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m01:17:15.395237 [info ] [MainThread]: 
[0m01:17:15.398076 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m01:17:15.398674 [info ] [Thread-1  ]: 1 of 39 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m01:17:15.399150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m01:17:15.399505 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m01:17:15.410141 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m01:17:15.411410 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m01:17:15.424226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:15.824668 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m01:17:15.826519 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , concat(base.year_full,'-',base.week_number) as year_week
    , concat(base.year_full,'-',base.month_abbrev,'-',base.week_number) as year_month_week
    , concat(base.year_full,'-',base.month_abbrev) as year_month

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m01:17:16.412927 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26f166c7-1a11-4c69-a17a-1adf50338c16&page=queryresults
[0m01:17:21.824192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b340700>]}
[0m01:17:21.825005 [info ] [Thread-1  ]: 1 of 39 OK created sql table model stock_analysis.stg_calendar ................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 6.42s]
[0m01:17:21.825597 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m01:17:21.826924 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m01:17:21.827406 [info ] [Thread-1  ]: 2 of 39 START sql table model stock_analysis.stg_aapl_1993_2024 ................ [RUN]
[0m01:17:21.827910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_aapl_1993_2024)
[0m01:17:21.828239 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_aapl_1993_2024
[0m01:17:21.832210 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_aapl_1993_2024"
[0m01:17:21.833681 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_aapl_1993_2024
[0m01:17:21.836346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:17:22.200195 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_aapl_1993_2024"
[0m01:17:22.202965 [debug] [Thread-1  ]: On model.stock_analysis.stg_aapl_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_aapl_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_aapl_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:17:22.604866 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:77dbb1ec-5064-4c94-8084-efe461cae00b&page=queryresults
[0m01:20:07.658843 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d8c3ac0>]}
[0m01:20:07.662553 [info ] [Thread-1  ]: 2 of 39 OK created sql table model stock_analysis.stg_aapl_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 165.83s]
[0m01:20:07.663965 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m01:20:07.664573 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m01:20:07.665640 [info ] [Thread-1  ]: 3 of 39 START sql table model stock_analysis.stg_abbv_2013_2024 ................ [RUN]
[0m01:20:07.666684 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_aapl_1993_2024, now model.stock_analysis.stg_abbv_2013_2024)
[0m01:20:07.667187 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_abbv_2013_2024
[0m01:20:07.673267 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_abbv_2013_2024"
[0m01:20:07.674152 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_abbv_2013_2024
[0m01:20:07.679095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:08.053130 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_abbv_2013_2024"
[0m01:20:08.055160 [debug] [Thread-1  ]: On model.stock_analysis.stg_abbv_2013_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_abbv_2013_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_abbv_2013_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:20:08.509731 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:86b56002-fd0b-4dd2-86b9-e04e42ba0587&page=queryresults
[0m01:21:04.171386 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b340700>]}
[0m01:21:04.172195 [info ] [Thread-1  ]: 3 of 39 OK created sql table model stock_analysis.stg_abbv_2013_2024 ........... [[32mCREATE TABLE (2.9k rows, 42.1 MiB processed)[0m in 56.50s]
[0m01:21:04.172662 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m01:21:04.172968 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m01:21:04.173329 [info ] [Thread-1  ]: 4 of 39 START sql table model stock_analysis.stg_adbe_1993_2024 ................ [RUN]
[0m01:21:04.173614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_abbv_2013_2024, now model.stock_analysis.stg_adbe_1993_2024)
[0m01:21:04.173842 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_adbe_1993_2024
[0m01:21:04.176851 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_adbe_1993_2024"
[0m01:21:04.177460 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_adbe_1993_2024
[0m01:21:04.179627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:04.595148 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_adbe_1993_2024"
[0m01:21:04.595858 [debug] [Thread-1  ]: On model.stock_analysis.stg_adbe_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_adbe_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_adbe_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:21:05.323112 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:67f3d28a-4b0f-4ba1-978a-55a58d6492e7&page=queryresults
[0m01:23:50.573038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf75460>]}
[0m01:23:50.576144 [info ] [Thread-1  ]: 4 of 39 OK created sql table model stock_analysis.stg_adbe_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 166.40s]
[0m01:23:50.577533 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m01:23:50.578213 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m01:23:50.579012 [info ] [Thread-1  ]: 5 of 39 START sql table model stock_analysis.stg_amd_1993_2024 ................. [RUN]
[0m01:23:50.579744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_adbe_1993_2024, now model.stock_analysis.stg_amd_1993_2024)
[0m01:23:50.580203 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amd_1993_2024
[0m01:23:50.586163 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amd_1993_2024"
[0m01:23:50.587977 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amd_1993_2024
[0m01:23:50.594339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:23:51.005087 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_amd_1993_2024"
[0m01:23:51.007840 [debug] [Thread-1  ]: On model.stock_analysis.stg_amd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:23:51.513429 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d55bfb94-b4ae-43c0-a22c-e7fea22844aa&page=queryresults
[0m01:26:04.201096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf75460>]}
[0m01:26:04.203143 [info ] [Thread-1  ]: 5 of 39 OK created sql table model stock_analysis.stg_amd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 133.62s]
[0m01:26:04.204193 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m01:26:04.204883 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m01:26:04.205869 [info ] [Thread-1  ]: 6 of 39 START sql table model stock_analysis.stg_amzn_1997_2024 ................ [RUN]
[0m01:26:04.206622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amd_1993_2024, now model.stock_analysis.stg_amzn_1997_2024)
[0m01:26:04.207026 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_amzn_1997_2024
[0m01:26:04.213708 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_amzn_1997_2024"
[0m01:26:04.214951 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_amzn_1997_2024
[0m01:26:04.218505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:26:04.587610 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_amzn_1997_2024"
[0m01:26:04.589922 [debug] [Thread-1  ]: On model.stock_analysis.stg_amzn_1997_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amzn_1997_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amzn_1997_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:26:04.951150 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2dd46b01-4767-4d5c-9276-1f78f9ed5832&page=queryresults
[0m01:28:20.575469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d971ca0>]}
[0m01:28:20.578177 [info ] [Thread-1  ]: 6 of 39 OK created sql table model stock_analysis.stg_amzn_1997_2024 ........... [[32mCREATE TABLE (6.9k rows, 42.3 MiB processed)[0m in 136.37s]
[0m01:28:20.579004 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m01:28:20.579465 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m01:28:20.580087 [info ] [Thread-1  ]: 7 of 39 START sql table model stock_analysis.stg_avgo_2009_2024 ................ [RUN]
[0m01:28:20.580652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amzn_1997_2024, now model.stock_analysis.stg_avgo_2009_2024)
[0m01:28:20.580944 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_avgo_2009_2024
[0m01:28:20.584536 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_avgo_2009_2024"
[0m01:28:20.586083 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_avgo_2009_2024
[0m01:28:20.590622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:28:20.975246 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_avgo_2009_2024"
[0m01:28:20.977603 [debug] [Thread-1  ]: On model.stock_analysis.stg_avgo_2009_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_avgo_2009_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_avgo_2009_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:28:21.469506 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:24251732-1c07-4334-8f51-12b2c775513f&page=queryresults
[0m01:29:30.356489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d951940>]}
[0m01:29:30.357936 [info ] [Thread-1  ]: 7 of 39 OK created sql table model stock_analysis.stg_avgo_2009_2024 ........... [[32mCREATE TABLE (3.8k rows, 42.2 MiB processed)[0m in 69.78s]
[0m01:29:30.358805 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m01:29:30.359384 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m01:29:30.360670 [info ] [Thread-1  ]: 8 of 39 START sql table model stock_analysis.stg_bac_1993_2024 ................. [RUN]
[0m01:29:30.361545 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_avgo_2009_2024, now model.stock_analysis.stg_bac_1993_2024)
[0m01:29:30.362164 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_bac_1993_2024
[0m01:29:30.367893 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_bac_1993_2024"
[0m01:29:30.369243 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_bac_1993_2024
[0m01:29:30.372677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:29:30.734986 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_bac_1993_2024"
[0m01:29:30.736909 [debug] [Thread-1  ]: On model.stock_analysis.stg_bac_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_bac_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_bac_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:29:31.204807 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:be777502-695f-4272-a6a8-68ab81b007a0&page=queryresults
[0m01:31:42.777860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d964ca0>]}
[0m01:31:42.780419 [info ] [Thread-1  ]: 8 of 39 OK created sql table model stock_analysis.stg_bac_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 132.42s]
[0m01:31:42.781489 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m01:31:42.782163 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m01:31:42.782938 [info ] [Thread-1  ]: 9 of 39 START sql table model stock_analysis.stg_brk-b_1996_2024 ............... [RUN]
[0m01:31:42.783564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_bac_1993_2024, now model.stock_analysis.stg_brk-b_1996_2024)
[0m01:31:42.784001 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_brk-b_1996_2024
[0m01:31:42.789223 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m01:31:42.790213 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_brk-b_1996_2024
[0m01:31:42.795777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:43.191923 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m01:31:43.195091 [debug] [Thread-1  ]: On model.stock_analysis.stg_brk-b_1996_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_brk-b_1996_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_brk-b_1996_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:31:43.611080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ed525136-39b7-4a22-aea1-1da0801e37ff&page=queryresults
[0m01:33:43.090763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b340700>]}
[0m01:33:43.093537 [info ] [Thread-1  ]: 9 of 39 OK created sql table model stock_analysis.stg_brk-b_1996_2024 .......... [[32mCREATE TABLE (7.1k rows, 42.3 MiB processed)[0m in 120.31s]
[0m01:33:43.094562 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m01:33:43.095175 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m01:33:43.095849 [info ] [Thread-1  ]: 10 of 39 START sql table model stock_analysis.stg_cost_1993_2024 ............... [RUN]
[0m01:33:43.096470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_brk-b_1996_2024, now model.stock_analysis.stg_cost_1993_2024)
[0m01:33:43.096893 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cost_1993_2024
[0m01:33:43.102093 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cost_1993_2024"
[0m01:33:43.103080 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cost_1993_2024
[0m01:33:43.106096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:33:43.502918 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_cost_1993_2024"
[0m01:33:43.505647 [debug] [Thread-1  ]: On model.stock_analysis.stg_cost_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cost_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cost_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:33:43.917290 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:562cb06d-aad8-4602-99d1-59f7f99d2b9e&page=queryresults
[0m01:36:03.659791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9508b0>]}
[0m01:36:03.662473 [info ] [Thread-1  ]: 10 of 39 OK created sql table model stock_analysis.stg_cost_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 140.56s]
[0m01:36:03.663614 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m01:36:03.664310 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m01:36:03.664916 [info ] [Thread-1  ]: 11 of 39 START sql table model stock_analysis.stg_crm_2004_2024 ................ [RUN]
[0m01:36:03.665601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cost_1993_2024, now model.stock_analysis.stg_crm_2004_2024)
[0m01:36:03.666019 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_crm_2004_2024
[0m01:36:03.671060 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_crm_2004_2024"
[0m01:36:03.672388 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_crm_2004_2024
[0m01:36:03.679730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:36:04.085290 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_crm_2004_2024"
[0m01:36:04.087941 [debug] [Thread-1  ]: On model.stock_analysis.stg_crm_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_crm_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_crm_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:36:04.487088 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c96577a1-58ba-4987-bf0b-d6d5867b2bd5&page=queryresults
[0m01:37:57.255035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf75460>]}
[0m01:37:57.258388 [info ] [Thread-1  ]: 11 of 39 OK created sql table model stock_analysis.stg_crm_2004_2024 ........... [[32mCREATE TABLE (5.1k rows, 42.2 MiB processed)[0m in 113.59s]
[0m01:37:57.259425 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m01:37:57.259830 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m01:37:57.260322 [info ] [Thread-1  ]: 12 of 39 START sql table model stock_analysis.stg_cvx_1993_2024 ................ [RUN]
[0m01:37:57.260789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_crm_2004_2024, now model.stock_analysis.stg_cvx_1993_2024)
[0m01:37:57.261071 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_cvx_1993_2024
[0m01:37:57.264643 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_cvx_1993_2024"
[0m01:37:57.265645 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_cvx_1993_2024
[0m01:37:57.267668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:37:57.645725 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_cvx_1993_2024"
[0m01:37:57.648999 [debug] [Thread-1  ]: On model.stock_analysis.stg_cvx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cvx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cvx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:37:58.118038 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9f5e6467-440c-4357-982e-fbd9b7b028cd&page=queryresults
[0m01:40:48.653491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9a8460>]}
[0m01:40:48.656474 [info ] [Thread-1  ]: 12 of 39 OK created sql table model stock_analysis.stg_cvx_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 171.39s]
[0m01:40:48.657780 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m01:40:48.658804 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m01:40:48.659702 [info ] [Thread-1  ]: 13 of 39 START sql table model stock_analysis.stg_goog_2004_2024 ............... [RUN]
[0m01:40:48.660483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cvx_1993_2024, now model.stock_analysis.stg_goog_2004_2024)
[0m01:40:48.661018 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_goog_2004_2024
[0m01:40:48.666327 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_goog_2004_2024"
[0m01:40:48.668129 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_goog_2004_2024
[0m01:40:48.673500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:40:49.019455 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_goog_2004_2024"
[0m01:40:49.020924 [debug] [Thread-1  ]: On model.stock_analysis.stg_goog_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_goog_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_goog_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:40:49.688682 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6fce7881-a7fd-4f15-bab3-db457991f5ca&page=queryresults
[0m01:42:07.978904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075589a0>]}
[0m01:42:07.980587 [info ] [Thread-1  ]: 13 of 39 OK created sql table model stock_analysis.stg_goog_2004_2024 .......... [[32mCREATE TABLE (5.0k rows, 42.2 MiB processed)[0m in 79.32s]
[0m01:42:07.981737 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m01:42:07.982369 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m01:42:07.983188 [info ] [Thread-1  ]: 14 of 39 START sql table model stock_analysis.stg_googl_2004_2024 .............. [RUN]
[0m01:42:07.983991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_goog_2004_2024, now model.stock_analysis.stg_googl_2004_2024)
[0m01:42:07.984526 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_googl_2004_2024
[0m01:42:07.990107 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_googl_2004_2024"
[0m01:42:07.991251 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_googl_2004_2024
[0m01:42:07.994364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:42:08.399903 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_googl_2004_2024"
[0m01:42:08.403588 [debug] [Thread-1  ]: On model.stock_analysis.stg_googl_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_googl_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_googl_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:42:08.803521 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e7e071f5-a2e7-4879-b5e3-54ac3235a4cc&page=queryresults
[0m01:43:52.214042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075589a0>]}
[0m01:43:52.215549 [info ] [Thread-1  ]: 14 of 39 OK created sql table model stock_analysis.stg_googl_2004_2024 ......... [[32mCREATE TABLE (5.0k rows, 42.2 MiB processed)[0m in 104.23s]
[0m01:43:52.216411 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m01:43:52.217169 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m01:43:52.218165 [info ] [Thread-1  ]: 15 of 39 START sql table model stock_analysis.stg_hd_1993_2024 ................. [RUN]
[0m01:43:52.218927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_googl_2004_2024, now model.stock_analysis.stg_hd_1993_2024)
[0m01:43:52.219462 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hd_1993_2024
[0m01:43:52.224979 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hd_1993_2024"
[0m01:43:52.227057 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hd_1993_2024
[0m01:43:52.232454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:43:52.622485 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_hd_1993_2024"
[0m01:43:52.624654 [debug] [Thread-1  ]: On model.stock_analysis.stg_hd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:43:53.048981 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2eb43202-7920-419c-a21c-35aba4d0a714&page=queryresults
[0m01:46:40.153009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075589a0>]}
[0m01:46:40.154083 [info ] [Thread-1  ]: 15 of 39 OK created sql table model stock_analysis.stg_hd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 167.93s]
[0m01:46:40.154790 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m01:46:40.155336 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m01:46:40.156213 [info ] [Thread-1  ]: 16 of 39 START sql table model stock_analysis.stg_hlal_2019_2024 ............... [RUN]
[0m01:46:40.157061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hd_1993_2024, now model.stock_analysis.stg_hlal_2019_2024)
[0m01:46:40.157515 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m01:46:40.162431 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m01:46:40.164868 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m01:46:40.167661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:46:40.550609 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_hlal_2019_2024"
[0m01:46:40.552780 [debug] [Thread-1  ]: On model.stock_analysis.stg_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:46:41.186788 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bed83122-903b-47f9-8be1-10923fd00c70&page=queryresults
[0m01:47:01.802597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9111f0>]}
[0m01:47:01.804334 [info ] [Thread-1  ]: 16 of 39 OK created sql table model stock_analysis.stg_hlal_2019_2024 .......... [[32mCREATE TABLE (1.3k rows, 42.1 MiB processed)[0m in 21.65s]
[0m01:47:01.805387 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m01:47:01.806259 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m01:47:01.807375 [info ] [Thread-1  ]: 17 of 39 START sql table model stock_analysis.stg_jnj_1993_2024 ................ [RUN]
[0m01:47:01.808223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hlal_2019_2024, now model.stock_analysis.stg_jnj_1993_2024)
[0m01:47:01.808786 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jnj_1993_2024
[0m01:47:01.814236 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jnj_1993_2024"
[0m01:47:01.815491 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jnj_1993_2024
[0m01:47:01.820822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:47:02.195939 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_jnj_1993_2024"
[0m01:47:02.198362 [debug] [Thread-1  ]: On model.stock_analysis.stg_jnj_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jnj_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jnj_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:47:02.534719 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a15fc838-c25b-428d-a178-f5d9af7917b2&page=queryresults
[0m01:49:45.930525 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da4ef40>]}
[0m01:49:45.932010 [info ] [Thread-1  ]: 17 of 39 OK created sql table model stock_analysis.stg_jnj_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 164.12s]
[0m01:49:45.932763 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m01:49:45.933325 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m01:49:45.934221 [info ] [Thread-1  ]: 18 of 39 START sql table model stock_analysis.stg_jpm_1993_2024 ................ [RUN]
[0m01:49:45.935131 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jnj_1993_2024, now model.stock_analysis.stg_jpm_1993_2024)
[0m01:49:45.935587 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_jpm_1993_2024
[0m01:49:45.940339 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_jpm_1993_2024"
[0m01:49:45.941377 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_jpm_1993_2024
[0m01:49:45.944305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:49:46.355091 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_jpm_1993_2024"
[0m01:49:46.358098 [debug] [Thread-1  ]: On model.stock_analysis.stg_jpm_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jpm_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jpm_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:49:46.797814 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f5a821cd-9a40-4cda-9e50-23ba90474764&page=queryresults
[0m01:52:14.652106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da58d00>]}
[0m01:52:14.655670 [info ] [Thread-1  ]: 18 of 39 OK created sql table model stock_analysis.stg_jpm_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 148.72s]
[0m01:52:14.656649 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m01:52:14.657147 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m01:52:14.657945 [info ] [Thread-1  ]: 19 of 39 START sql table model stock_analysis.stg_ko_1993_2024 ................. [RUN]
[0m01:52:14.658485 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_jpm_1993_2024, now model.stock_analysis.stg_ko_1993_2024)
[0m01:52:14.658771 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ko_1993_2024
[0m01:52:14.663371 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ko_1993_2024"
[0m01:52:14.664181 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ko_1993_2024
[0m01:52:14.668931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:52:15.051303 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_ko_1993_2024"
[0m01:52:15.055045 [debug] [Thread-1  ]: On model.stock_analysis.stg_ko_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ko_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ko_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:52:15.477634 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:420afc43-cdeb-4e12-b896-c99ad2da1a4a&page=queryresults
[0m01:54:18.334766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da435e0>]}
[0m01:54:18.337841 [info ] [Thread-1  ]: 19 of 39 OK created sql table model stock_analysis.stg_ko_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 123.68s]
[0m01:54:18.339160 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m01:54:18.339745 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m01:54:18.340674 [info ] [Thread-1  ]: 20 of 39 START sql table model stock_analysis.stg_lly_1993_2024 ................ [RUN]
[0m01:54:18.341467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ko_1993_2024, now model.stock_analysis.stg_lly_1993_2024)
[0m01:54:18.341873 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_lly_1993_2024
[0m01:54:18.346595 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_lly_1993_2024"
[0m01:54:18.348342 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_lly_1993_2024
[0m01:54:18.351039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:54:18.738519 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_lly_1993_2024"
[0m01:54:18.742731 [debug] [Thread-1  ]: On model.stock_analysis.stg_lly_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_lly_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_lly_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:54:19.175944 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a211dece-c1c9-4934-8b4f-cd8212bce9cc&page=queryresults
[0m01:56:33.706333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da435e0>]}
[0m01:56:33.707582 [info ] [Thread-1  ]: 20 of 39 OK created sql table model stock_analysis.stg_lly_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 135.36s]
[0m01:56:33.708333 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m01:56:33.708856 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m01:56:33.709643 [info ] [Thread-1  ]: 21 of 39 START sql table model stock_analysis.stg_ma_2006_2024 ................. [RUN]
[0m01:56:33.710301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_lly_1993_2024, now model.stock_analysis.stg_ma_2006_2024)
[0m01:56:33.710743 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_ma_2006_2024
[0m01:56:33.718035 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_ma_2006_2024"
[0m01:56:33.720437 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_ma_2006_2024
[0m01:56:33.723267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:56:34.100330 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_ma_2006_2024"
[0m01:56:34.102833 [debug] [Thread-1  ]: On model.stock_analysis.stg_ma_2006_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ma_2006_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ma_2006_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:56:34.510998 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dc431d01-21c0-4402-9624-18220d00f966&page=queryresults
[0m01:57:42.953760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9b1280>]}
[0m01:57:42.956284 [info ] [Thread-1  ]: 21 of 39 OK created sql table model stock_analysis.stg_ma_2006_2024 ............ [[32mCREATE TABLE (4.6k rows, 42.2 MiB processed)[0m in 69.24s]
[0m01:57:42.957349 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m01:57:42.958150 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m01:57:42.959010 [info ] [Thread-1  ]: 22 of 39 START sql table model stock_analysis.stg_meta_2012_2024 ............... [RUN]
[0m01:57:42.959507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_ma_2006_2024, now model.stock_analysis.stg_meta_2012_2024)
[0m01:57:42.959816 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_meta_2012_2024
[0m01:57:42.963491 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_meta_2012_2024"
[0m01:57:42.965451 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_meta_2012_2024
[0m01:57:42.968180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:57:43.336730 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_meta_2012_2024"
[0m01:57:43.339822 [debug] [Thread-1  ]: On model.stock_analysis.stg_meta_2012_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_meta_2012_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_meta_2012_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:57:43.709104 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dfbe51a5-f3fe-4e6d-bad1-8e141c291093&page=queryresults
[0m01:58:36.084740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9b1280>]}
[0m01:58:36.087204 [info ] [Thread-1  ]: 22 of 39 OK created sql table model stock_analysis.stg_meta_2012_2024 .......... [[32mCREATE TABLE (3.1k rows, 42.1 MiB processed)[0m in 53.12s]
[0m01:58:36.088475 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m01:58:36.089292 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m01:58:36.090128 [info ] [Thread-1  ]: 23 of 39 START sql table model stock_analysis.stg_mrk_1993_2024 ................ [RUN]
[0m01:58:36.090641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_meta_2012_2024, now model.stock_analysis.stg_mrk_1993_2024)
[0m01:58:36.090948 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_mrk_1993_2024
[0m01:58:36.094846 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_mrk_1993_2024"
[0m01:58:36.095757 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_mrk_1993_2024
[0m01:58:36.099561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:58:36.462840 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_mrk_1993_2024"
[0m01:58:36.465366 [debug] [Thread-1  ]: On model.stock_analysis.stg_mrk_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_mrk_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_mrk_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m01:58:36.875399 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0a03eb8b-5215-424b-99bb-72b07ced1ef7&page=queryresults
[0m02:01:18.271397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9b1280>]}
[0m02:01:18.479105 [info ] [Thread-1  ]: 23 of 39 OK created sql table model stock_analysis.stg_mrk_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 162.18s]
[0m02:01:18.480742 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_mrk_1993_2024
[0m02:01:18.481551 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_msft_1993_2024
[0m02:01:18.482384 [info ] [Thread-1  ]: 24 of 39 START sql table model stock_analysis.stg_msft_1993_2024 ............... [RUN]
[0m02:01:18.483258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_mrk_1993_2024, now model.stock_analysis.stg_msft_1993_2024)
[0m02:01:18.483729 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_msft_1993_2024
[0m02:01:18.488828 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_msft_1993_2024"
[0m02:01:18.491529 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_msft_1993_2024
[0m02:01:18.494718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:01:18.886511 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_msft_1993_2024"
[0m02:01:18.889051 [debug] [Thread-1  ]: On model.stock_analysis.stg_msft_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_msft_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_msft_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:01:19.290803 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:46f72029-0294-4392-a1ab-ff81e21c4617&page=queryresults
[0m02:03:41.520386 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9cff40>]}
[0m02:03:41.521981 [info ] [Thread-1  ]: 24 of 39 OK created sql table model stock_analysis.stg_msft_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 143.04s]
[0m02:03:41.523229 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_msft_1993_2024
[0m02:03:41.524185 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nflx_1993_2024
[0m02:03:41.525167 [info ] [Thread-1  ]: 25 of 39 START sql table model stock_analysis.stg_nflx_1993_2024 ............... [RUN]
[0m02:03:41.526017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_msft_1993_2024, now model.stock_analysis.stg_nflx_1993_2024)
[0m02:03:41.526584 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nflx_1993_2024
[0m02:03:41.532219 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nflx_1993_2024"
[0m02:03:41.534523 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nflx_1993_2024
[0m02:03:41.540193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:03:41.973298 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nflx_1993_2024"
[0m02:03:41.977647 [debug] [Thread-1  ]: On model.stock_analysis.stg_nflx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nflx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nflx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:03:42.348387 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ffb38efd-c917-4b5f-975f-66be73931713&page=queryresults
[0m02:05:28.218045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9a0d90>]}
[0m02:05:28.220742 [info ] [Thread-1  ]: 25 of 39 OK created sql table model stock_analysis.stg_nflx_1993_2024 .......... [[32mCREATE TABLE (5.6k rows, 42.2 MiB processed)[0m in 106.69s]
[0m02:05:28.222264 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nflx_1993_2024
[0m02:05:28.223013 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nvda_1999_2024
[0m02:05:28.223911 [info ] [Thread-1  ]: 26 of 39 START sql table model stock_analysis.stg_nvda_1999_2024 ............... [RUN]
[0m02:05:28.224734 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nflx_1993_2024, now model.stock_analysis.stg_nvda_1999_2024)
[0m02:05:28.225222 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nvda_1999_2024
[0m02:05:28.230723 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nvda_1999_2024"
[0m02:05:28.232083 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nvda_1999_2024
[0m02:05:28.235258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:05:28.620871 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nvda_1999_2024"
[0m02:05:28.625314 [debug] [Thread-1  ]: On model.stock_analysis.stg_nvda_1999_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nvda_1999_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nvda_1999_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:05:29.106508 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:37106e76-1f3b-4452-b2f0-2865bea2f11b&page=queryresults
[0m02:07:14.073724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bbca6a0>]}
[0m02:07:14.077053 [info ] [Thread-1  ]: 26 of 39 OK created sql table model stock_analysis.stg_nvda_1999_2024 .......... [[32mCREATE TABLE (6.4k rows, 42.3 MiB processed)[0m in 105.85s]
[0m02:07:14.078183 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nvda_1999_2024
[0m02:07:14.078759 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pep_1993_2024
[0m02:07:14.079425 [info ] [Thread-1  ]: 27 of 39 START sql table model stock_analysis.stg_pep_1993_2024 ................ [RUN]
[0m02:07:14.080096 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nvda_1999_2024, now model.stock_analysis.stg_pep_1993_2024)
[0m02:07:14.080466 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_pep_1993_2024
[0m02:07:14.084878 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_pep_1993_2024"
[0m02:07:14.086871 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_pep_1993_2024
[0m02:07:14.092782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:07:14.463747 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_pep_1993_2024"
[0m02:07:14.467373 [debug] [Thread-1  ]: On model.stock_analysis.stg_pep_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pep_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pep_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:07:14.762792 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d4642e94-3c61-4649-aef6-7535f28db073&page=queryresults
[0m02:09:41.714779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d89b1f0>]}
[0m02:09:41.717628 [info ] [Thread-1  ]: 27 of 39 OK created sql table model stock_analysis.stg_pep_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 147.63s]
[0m02:09:41.718664 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pep_1993_2024
[0m02:09:41.719294 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_pg_1993_2024
[0m02:09:41.720275 [info ] [Thread-1  ]: 28 of 39 START sql table model stock_analysis.stg_pg_1993_2024 ................. [RUN]
[0m02:09:41.720991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_pep_1993_2024, now model.stock_analysis.stg_pg_1993_2024)
[0m02:09:41.721459 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_pg_1993_2024
[0m02:09:41.727931 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_pg_1993_2024"
[0m02:09:41.729666 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_pg_1993_2024
[0m02:09:41.732695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:09:42.132434 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_pg_1993_2024"
[0m02:09:42.136216 [debug] [Thread-1  ]: On model.stock_analysis.stg_pg_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pg_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pg_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:09:42.581030 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:624dba5e-85aa-4524-9f35-777b1d11046d&page=queryresults
[0m02:12:49.323832 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d89b1f0>]}
[0m02:12:49.326578 [info ] [Thread-1  ]: 28 of 39 OK created sql table model stock_analysis.stg_pg_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 187.60s]
[0m02:12:49.327847 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_pg_1993_2024
[0m02:12:49.328513 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m02:12:49.329292 [info ] [Thread-1  ]: 29 of 39 START sql table model stock_analysis.stg_spus_2019_2024 ............... [RUN]
[0m02:12:49.329896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_pg_1993_2024, now model.stock_analysis.stg_spus_2019_2024)
[0m02:12:49.330306 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m02:12:49.338862 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m02:12:49.340805 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m02:12:49.343992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:12:49.717375 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spus_2019_2024"
[0m02:12:49.720170 [debug] [Thread-1  ]: On model.stock_analysis.stg_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- --   DEPRACATED   -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 


with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:12:50.379984 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e4b89c34-21e4-4c0a-b09c-c9c7bc722e34&page=queryresults
[0m02:13:16.797719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9b1280>]}
[0m02:13:16.800750 [info ] [Thread-1  ]: 29 of 39 OK created sql table model stock_analysis.stg_spus_2019_2024 .......... [[32mCREATE TABLE (1.2k rows, 42.0 MiB processed)[0m in 27.47s]
[0m02:13:16.802160 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m02:13:16.803064 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m02:13:16.803995 [info ] [Thread-1  ]: 30 of 39 START sql table model stock_analysis.stg_spy_1993_2024 ................ [RUN]
[0m02:13:16.804793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spus_2019_2024, now model.stock_analysis.stg_spy_1993_2024)
[0m02:13:16.805323 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m02:13:16.810917 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m02:13:16.812408 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m02:13:16.815796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:13:17.217350 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_1993_2024"
[0m02:13:17.221437 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:13:17.624192 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:edc85981-4a42-40f4-a159-5a34220ad30c&page=queryresults
[0m02:15:24.158521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da3f310>]}
[0m02:15:24.161647 [info ] [Thread-1  ]: 30 of 39 OK created sql table model stock_analysis.stg_spy_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 127.35s]
[0m02:15:24.163116 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m02:15:24.163850 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m02:15:24.164823 [info ] [Thread-1  ]: 31 of 39 START sql table model stock_analysis.stg_spy_2014_2024 ................ [RUN]
[0m02:15:24.165676 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_1993_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m02:15:24.166179 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m02:15:24.174625 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m02:15:24.176401 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m02:15:24.179502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:15:24.571653 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m02:15:24.574385 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:15:25.424800 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8a754823-550f-4077-beef-ad1c70164368&page=queryresults
[0m02:16:01.872570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d995ca0>]}
[0m02:16:01.874175 [info ] [Thread-1  ]: 31 of 39 OK created sql table model stock_analysis.stg_spy_2014_2024 ........... [[32mCREATE TABLE (2.5k rows, 42.1 MiB processed)[0m in 37.71s]
[0m02:16:01.875485 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m02:16:01.876212 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tmo_1993_2024
[0m02:16:01.877122 [info ] [Thread-1  ]: 32 of 39 START sql table model stock_analysis.stg_tmo_1993_2024 ................ [RUN]
[0m02:16:01.877971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.stg_tmo_1993_2024)
[0m02:16:01.878486 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_tmo_1993_2024
[0m02:16:01.883977 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_tmo_1993_2024"
[0m02:16:01.885185 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_tmo_1993_2024
[0m02:16:01.888452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:16:02.392816 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_tmo_1993_2024"
[0m02:16:02.395567 [debug] [Thread-1  ]: On model.stock_analysis.stg_tmo_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tmo_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tmo_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:16:02.824429 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:57efcf69-bfe5-4b66-ac16-615736d47960&page=queryresults
[0m02:18:05.536334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da9c700>]}
[0m02:18:05.539048 [info ] [Thread-1  ]: 32 of 39 OK created sql table model stock_analysis.stg_tmo_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 123.66s]
[0m02:18:05.540276 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tmo_1993_2024
[0m02:18:05.540948 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tsla_2010_2024
[0m02:18:05.541807 [info ] [Thread-1  ]: 33 of 39 START sql table model stock_analysis.stg_tsla_2010_2024 ............... [RUN]
[0m02:18:05.542547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_tmo_1993_2024, now model.stock_analysis.stg_tsla_2010_2024)
[0m02:18:05.542998 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_tsla_2010_2024
[0m02:18:05.548451 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_tsla_2010_2024"
[0m02:18:05.549531 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_tsla_2010_2024
[0m02:18:05.555687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:18:05.927190 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_tsla_2010_2024"
[0m02:18:05.930584 [debug] [Thread-1  ]: On model.stock_analysis.stg_tsla_2010_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tsla_2010_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tsla_2010_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:18:06.400535 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:de5a8ef8-a8b3-46cd-8942-ad5ad08cd97a&page=queryresults
[0m02:19:30.219330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da9bca0>]}
[0m02:19:30.222198 [info ] [Thread-1  ]: 33 of 39 OK created sql table model stock_analysis.stg_tsla_2010_2024 .......... [[32mCREATE TABLE (3.6k rows, 42.2 MiB processed)[0m in 84.68s]
[0m02:19:30.223417 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tsla_2010_2024
[0m02:19:30.224162 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_unh_1993_2024
[0m02:19:30.225035 [info ] [Thread-1  ]: 34 of 39 START sql table model stock_analysis.stg_unh_1993_2024 ................ [RUN]
[0m02:19:30.225835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_tsla_2010_2024, now model.stock_analysis.stg_unh_1993_2024)
[0m02:19:30.226280 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_unh_1993_2024
[0m02:19:30.232001 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_unh_1993_2024"
[0m02:19:30.233043 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_unh_1993_2024
[0m02:19:30.236310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:30.602430 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_unh_1993_2024"
[0m02:19:30.605052 [debug] [Thread-1  ]: On model.stock_analysis.stg_unh_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_unh_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_unh_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:19:31.085063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6c50d630-e179-4b09-8ed9-b4a65a1c5213&page=queryresults
[0m02:22:10.236923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da9c700>]}
[0m02:22:10.238457 [info ] [Thread-1  ]: 34 of 39 OK created sql table model stock_analysis.stg_unh_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 160.01s]
[0m02:22:10.239381 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_unh_1993_2024
[0m02:22:10.240096 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_v_1993_2024
[0m02:22:10.241142 [info ] [Thread-1  ]: 35 of 39 START sql table model stock_analysis.stg_v_1993_2024 .................. [RUN]
[0m02:22:10.241723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_unh_1993_2024, now model.stock_analysis.stg_v_1993_2024)
[0m02:22:10.242047 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_v_1993_2024
[0m02:22:10.246266 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_v_1993_2024"
[0m02:22:10.247223 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_v_1993_2024
[0m02:22:10.252434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:22:10.671584 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_v_1993_2024"
[0m02:22:10.674370 [debug] [Thread-1  ]: On model.stock_analysis.stg_v_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_v_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_v_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_v_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:22:11.140607 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b64dbf4b-3ff0-4b38-8cdf-d9dac7cc12f6&page=queryresults
[0m02:23:27.964590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da9c700>]}
[0m02:23:27.966093 [info ] [Thread-1  ]: 35 of 39 OK created sql table model stock_analysis.stg_v_1993_2024 ............. [[32mCREATE TABLE (4.1k rows, 42.2 MiB processed)[0m in 77.72s]
[0m02:23:27.967649 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_v_1993_2024
[0m02:23:27.968538 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_wmt_1993_2024
[0m02:23:27.969471 [info ] [Thread-1  ]: 36 of 39 START sql table model stock_analysis.stg_wmt_1993_2024 ................ [RUN]
[0m02:23:27.970311 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_v_1993_2024, now model.stock_analysis.stg_wmt_1993_2024)
[0m02:23:27.970767 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_wmt_1993_2024
[0m02:23:27.976397 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_wmt_1993_2024"
[0m02:23:27.977465 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_wmt_1993_2024
[0m02:23:27.980615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:23:28.353156 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_wmt_1993_2024"
[0m02:23:28.354911 [debug] [Thread-1  ]: On model.stock_analysis.stg_wmt_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_wmt_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_wmt_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:23:28.761615 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e19e5125-589f-49cb-a7d8-77e447a4e054&page=queryresults
[0m02:26:04.122240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da9c700>]}
[0m02:26:04.125098 [info ] [Thread-1  ]: 36 of 39 OK created sql table model stock_analysis.stg_wmt_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 156.15s]
[0m02:26:04.126002 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_wmt_1993_2024
[0m02:26:04.126766 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_xom_1993_2024
[0m02:26:04.127830 [info ] [Thread-1  ]: 37 of 39 START sql table model stock_analysis.stg_xom_1993_2024 ................ [RUN]
[0m02:26:04.128402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_wmt_1993_2024, now model.stock_analysis.stg_xom_1993_2024)
[0m02:26:04.128773 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_xom_1993_2024
[0m02:26:04.133591 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_xom_1993_2024"
[0m02:26:04.135127 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_xom_1993_2024
[0m02:26:04.139983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:26:04.563861 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_xom_1993_2024"
[0m02:26:04.566513 [debug] [Thread-1  ]: On model.stock_analysis.stg_xom_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_xom_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_xom_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m02:26:04.929716 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9f338855-098d-40ec-bef9-406e6002d686&page=queryresults
[0m02:28:36.979132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da04730>]}
[0m02:28:36.981412 [info ] [Thread-1  ]: 37 of 39 OK created sql table model stock_analysis.stg_xom_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 152.85s]
[0m02:28:36.982123 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_xom_1993_2024
[0m02:28:36.983526 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m02:28:36.984119 [info ] [Thread-1  ]: 38 of 39 START sql table model stock_analysis.int_stock_analysis ............... [RUN]
[0m02:28:36.984652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_xom_1993_2024, now model.stock_analysis.int_stock_analysis)
[0m02:28:36.985006 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m02:28:36.996983 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m02:28:36.997862 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m02:28:37.000543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:28:37.430644 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m02:28:37.433502 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from brk_b
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m02:28:37.835125 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8a795240-f6db-4866-a7d8-09804df6525b&page=queryresults
[0m02:28:43.473732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da9c700>]}
[0m02:28:43.475187 [info ] [Thread-1  ]: 38 of 39 OK created sql table model stock_analysis.int_stock_analysis .......... [[32mCREATE TABLE (224.9k rows, 90.4 MiB processed)[0m in 6.49s]
[0m02:28:43.476231 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m02:28:43.477841 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m02:28:43.478775 [info ] [Thread-1  ]: 39 of 39 START sql table model stock_analysis.stock_analysis ................... [RUN]
[0m02:28:43.479573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.int_stock_analysis, now model.stock_analysis.stock_analysis)
[0m02:28:43.480095 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m02:28:43.485205 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m02:28:43.488021 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m02:28:43.494317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:28:43.890611 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m02:28:43.894342 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m02:28:44.220371 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3b52ea22-23ce-4ac0-91f8-72ebb0fd5859&page=queryresults
[0m02:28:49.485935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcc6ff5b-bc83-47de-afd5-f8b315e426d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13da9c700>]}
[0m02:28:49.487461 [info ] [Thread-1  ]: 39 of 39 OK created sql table model stock_analysis.stock_analysis .............. [[32mCREATE TABLE (224.9k rows, 92.0 MiB processed)[0m in 6.01s]
[0m02:28:49.488847 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m02:28:49.491445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:28:49.491988 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m02:28:49.492695 [info ] [MainThread]: 
[0m02:28:49.493135 [info ] [MainThread]: Finished running 39 table models in 1 hours 11 minutes and 34.98 seconds (4294.98s).
[0m02:28:49.500549 [debug] [MainThread]: Command end result
[0m02:28:49.603462 [info ] [MainThread]: 
[0m02:28:49.603797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:28:49.603993 [info ] [MainThread]: 
[0m02:28:49.604171 [info ] [MainThread]: Done. PASS=39 WARN=0 ERROR=0 SKIP=0 TOTAL=39
[0m02:28:49.606244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4295.9585, "process_user_time": 12.053556, "process_kernel_time": 3.532853, "process_mem_max_rss": "194379776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:28:49.606586 [debug] [MainThread]: Command `dbt run` succeeded at 02:28:49.606531 after 4295.96 seconds
[0m02:28:49.606801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd91a60>]}
[0m02:28:49.606989 [debug] [MainThread]: Flushing usage events
[0m12:57:30.249846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076553a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076551c0>]}


============================== 12:57:30.252449 | 8f4faccd-a076-427f-bc5f-a7e39e0ba993 ==============================
[0m12:57:30.252449 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:57:30.252785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:30.966151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f4faccd-a076-427f-bc5f-a7e39e0ba993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f145b0>]}
[0m12:57:30.992335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f4faccd-a076-427f-bc5f-a7e39e0ba993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760e070>]}
[0m12:57:30.992618 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:57:31.004418 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:57:31.095074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 36 files changed.
[0m12:57:31.095555 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_1993_2024.sql
[0m12:57:31.095768 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_pep_1993_2024.sql
[0m12:57:31.095963 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_jpm_1993_2024.sql
[0m12:57:31.096146 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_hd_1993_2024.sql
[0m12:57:31.096326 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_wmt_1993_2024.sql
[0m12:57:31.096499 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_ko_1993_2024.sql
[0m12:57:31.096675 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_jnj_1993_2024.sql
[0m12:57:31.096847 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_pg_1993_2024.sql
[0m12:57:31.097032 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_unh_1993_2024.sql
[0m12:57:31.097206 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_brk-b_1996_2024.sql
[0m12:57:31.097382 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_v_1993_2024.sql
[0m12:57:31.097557 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_tmo_1993_2024.sql
[0m12:57:31.097739 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_cost_1993_2024.sql
[0m12:57:31.097912 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_nflx_1993_2024.sql
[0m12:57:31.098092 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_meta_2012_2024.sql
[0m12:57:31.098269 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_googl_2004_2024.sql
[0m12:57:31.098440 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m12:57:31.098624 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_hlal_2019_2024.sql
[0m12:57:31.098803 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_mrk_1993_2024.sql
[0m12:57:31.098987 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_bac_1993_2024.sql
[0m12:57:31.099161 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_adbe_1993_2024.sql
[0m12:57:31.099332 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_xom_1993_2024.sql
[0m12:57:31.099504 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_nvda_1999_2024.sql
[0m12:57:31.099680 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_ma_2006_2024.sql
[0m12:57:31.099850 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_amzn_1997_2024.sql
[0m12:57:31.100020 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spus_2019_2024.sql
[0m12:57:31.100194 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_avgo_2009_2024.sql
[0m12:57:31.100370 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_msft_1993_2024.sql
[0m12:57:31.100544 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_tsla_2010_2024.sql
[0m12:57:31.100714 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_lly_1993_2024.sql
[0m12:57:31.100886 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_goog_2004_2024.sql
[0m12:57:31.101064 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_aapl_1993_2024.sql
[0m12:57:31.101235 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_amd_1993_2024.sql
[0m12:57:31.101407 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_crm_2004_2024.sql
[0m12:57:31.101586 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_cvx_1993_2024.sql
[0m12:57:31.101761 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_abbv_2013_2024.sql
[0m12:57:31.307367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f4faccd-a076-427f-bc5f-a7e39e0ba993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146554130>]}
[0m12:57:31.375421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f4faccd-a076-427f-bc5f-a7e39e0ba993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146054310>]}
[0m12:57:31.375710 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m12:57:31.375900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f4faccd-a076-427f-bc5f-a7e39e0ba993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146525a00>]}
[0m12:57:31.376414 [warn ] [MainThread]: The selection criterion 'staging+' does not match any enabled nodes
[0m12:57:31.377112 [info ] [MainThread]: 
[0m12:57:31.377274 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:57:31.377512 [debug] [MainThread]: Command end result
[0m12:57:31.406296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2076205, "process_user_time": 1.81869, "process_kernel_time": 2.681684, "process_mem_max_rss": "197689344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:57:31.406613 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:31.406560 after 1.21 seconds
[0m12:57:31.406817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146199b80>]}
[0m12:57:31.407012 [debug] [MainThread]: Flushing usage events
[0m12:57:36.444480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022d4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c4d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c4d160>]}


============================== 12:57:36.446557 | 916ff616-4722-401a-a46c-f7d6e38877e7 ==============================
[0m12:57:36.446557 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:57:36.446883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:36.890477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '916ff616-4722-401a-a46c-f7d6e38877e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c2e580>]}
[0m12:57:36.916535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '916ff616-4722-401a-a46c-f7d6e38877e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12adba2b0>]}
[0m12:57:36.916849 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:57:36.927742 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:57:37.003849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:37.004110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:37.062221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '916ff616-4722-401a-a46c-f7d6e38877e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1c9fd0>]}
[0m12:57:37.127797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '916ff616-4722-401a-a46c-f7d6e38877e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b080b20>]}
[0m12:57:37.128072 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m12:57:37.128263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '916ff616-4722-401a-a46c-f7d6e38877e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b1d5e80>]}
[0m12:57:37.128765 [warn ] [MainThread]: The selection criterion 'staging' does not match any enabled nodes
[0m12:57:37.129463 [info ] [MainThread]: 
[0m12:57:37.129627 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:57:37.130526 [debug] [MainThread]: Command end result
[0m12:57:37.159338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7606127, "process_user_time": 1.695233, "process_kernel_time": 2.631559, "process_mem_max_rss": "190840832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:57:37.159672 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:37.159625 after 0.76 seconds
[0m12:57:37.159880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022d4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102604640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c2e580>]}
[0m12:57:37.160057 [debug] [MainThread]: Flushing usage events
[0m12:58:43.035038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102978ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f11c0>]}


============================== 12:58:43.037653 | 0e8dff14-1da0-4a29-bc49-00c528ae90f7 ==============================
[0m12:58:43.037653 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:58:43.037960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:58:43.548895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e8dff14-1da0-4a29-bc49-00c528ae90f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124145430>]}
[0m12:58:43.574575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e8dff14-1da0-4a29-bc49-00c528ae90f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412cac0>]}
[0m12:58:43.574873 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:58:43.587290 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:58:43.676381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:43.676600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:43.733429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e8dff14-1da0-4a29-bc49-00c528ae90f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124283910>]}
[0m12:58:43.801749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e8dff14-1da0-4a29-bc49-00c528ae90f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124493550>]}
[0m12:58:43.802011 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m12:58:43.802200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e8dff14-1da0-4a29-bc49-00c528ae90f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246d5e50>]}
[0m12:58:43.802575 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any enabled nodes
[0m12:58:43.803296 [info ] [MainThread]: 
[0m12:58:43.803458 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:58:43.804372 [debug] [MainThread]: Command end result
[0m12:58:43.832556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84628356, "process_user_time": 1.548393, "process_kernel_time": 2.667346, "process_mem_max_rss": "192692224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:58:43.832900 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:43.832850 after 0.85 seconds
[0m12:58:43.833158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102978ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241b02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124145430>]}
[0m12:58:43.833359 [debug] [MainThread]: Flushing usage events
[0m13:00:04.078925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104934ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c11c0>]}


============================== 13:00:04.081562 | 14f386d9-5bc1-4d49-b58f-f6fbc08ff6a4 ==============================
[0m13:00:04.081562 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:04.081883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select 2-stock_analysis.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:00:04.590173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f386d9-5bc1-4d49-b58f-f6fbc08ff6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc99430>]}
[0m13:00:04.615873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f386d9-5bc1-4d49-b58f-f6fbc08ff6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fcac0>]}
[0m13:00:04.616160 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:00:04.628453 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:00:04.717815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:04.718049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:04.774346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14f386d9-5bc1-4d49-b58f-f6fbc08ff6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cdd7910>]}
[0m13:00:04.843311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14f386d9-5bc1-4d49-b58f-f6fbc08ff6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cf6eac0>]}
[0m13:00:04.843582 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m13:00:04.843774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f386d9-5bc1-4d49-b58f-f6fbc08ff6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14da15e50>]}
[0m13:00:04.844838 [warn ] [MainThread]: The selection criterion '2-stock_analysis.sql' does not match any enabled nodes
[0m13:00:04.845568 [info ] [MainThread]: 
[0m13:00:04.845737 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:00:04.846684 [debug] [MainThread]: Command end result
[0m13:00:04.874719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84328365, "process_user_time": 1.562936, "process_kernel_time": 2.660329, "process_mem_max_rss": "189661184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:00:04.875050 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:04.875000 after 0.84 seconds
[0m13:00:04.875261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104934ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cd052b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc99430>]}
[0m13:00:04.875443 [debug] [MainThread]: Flushing usage events
[0m13:00:18.343431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106675a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f04430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f04250>]}


============================== 13:00:18.345901 | 67582c46-f0c4-4832-ab2e-cd45437b76d1 ==============================
[0m13:00:18.345901 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:18.346226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql+2', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:18.835077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67582c46-f0c4-4832-ab2e-cd45437b76d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f42eeb0>]}
[0m13:00:18.860994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67582c46-f0c4-4832-ab2e-cd45437b76d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f470a60>]}
[0m13:00:18.861315 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:00:18.873874 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:00:18.962022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:18.962245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:19.019663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67582c46-f0c4-4832-ab2e-cd45437b76d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f7d5eb0>]}
[0m13:00:19.087905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67582c46-f0c4-4832-ab2e-cd45437b76d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f649d00>]}
[0m13:00:19.088172 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m13:00:19.088363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67582c46-f0c4-4832-ab2e-cd45437b76d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8b2280>]}
[0m13:00:19.090007 [info ] [MainThread]: 
[0m13:00:19.090276 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:00:19.090720 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:00:19.090919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:19.671295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:00:19.671862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:20.080961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67582c46-f0c4-4832-ab2e-cd45437b76d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f6497f0>]}
[0m13:00:20.081656 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m13:00:20.081980 [info ] [MainThread]: 
[0m13:00:20.086500 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m13:00:20.086938 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m13:00:20.087367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m13:00:20.087744 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m13:00:20.097221 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m13:00:20.099072 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m13:00:20.111281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:00:20.524095 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m13:00:20.524823 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m13:00:21.505156 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:548d16dc-c5cd-4044-af25-b0771cdcefc4&page=queryresults
[0m13:00:31.699818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a45370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a45190>]}


============================== 13:00:31.701900 | c8455fb9-fe2a-4266-b515-417ff1f141d1 ==============================
[0m13:00:31.701900 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:31.702244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stock_analysis.sql-2', 'send_anonymous_usage_stats': 'True'}
[0m13:00:32.158282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8455fb9-fe2a-4266-b515-417ff1f141d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c67c0>]}
[0m13:00:32.184332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8455fb9-fe2a-4266-b515-417ff1f141d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cf2ea30>]}
[0m13:00:32.184632 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:00:32.194610 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:00:32.272684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:32.272960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:32.330804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8455fb9-fe2a-4266-b515-417ff1f141d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160399f40>]}
[0m13:00:32.396370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8455fb9-fe2a-4266-b515-417ff1f141d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160120c40>]}
[0m13:00:32.396628 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m13:00:32.396830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8455fb9-fe2a-4266-b515-417ff1f141d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1603c22e0>]}
[0m13:00:32.397374 [warn ] [MainThread]: The selection criterion 'stock_analysis.sql-2' does not match any enabled nodes
[0m13:00:32.398092 [info ] [MainThread]: 
[0m13:00:32.398261 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:00:32.399167 [debug] [MainThread]: Command end result
[0m13:00:32.426300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.77402765, "process_user_time": 1.640175, "process_kernel_time": 2.713005, "process_mem_max_rss": "193675264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:00:32.426627 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:32.426580 after 0.77 seconds
[0m13:00:32.426824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cf430a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c67c0>]}
[0m13:00:32.426998 [debug] [MainThread]: Flushing usage events
[0m13:02:46.935711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f411c0>]}


============================== 13:02:46.938325 | a692ac53-7de6-4b5c-abbb-6cefc4a79047 ==============================
[0m13:02:46.938325 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:02:46.938653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/2_staging path:models/3_intermediary path:models/4_final', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:02:47.441222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ec5b0>]}
[0m13:02:47.467237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efa070>]}
[0m13:02:47.467512 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:02:47.479194 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:02:47.569135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:47.569360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:47.626082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e48b20>]}
[0m13:02:47.702005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14497dfa0>]}
[0m13:02:47.702386 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m13:02:47.702586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144af2280>]}
[0m13:02:47.706547 [info ] [MainThread]: 
[0m13:02:47.706872 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:02:47.711253 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:02:47.711509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:48.142993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:02:48.143720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:48.550249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10400b7c0>]}
[0m13:02:48.551100 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m13:02:48.551498 [info ] [MainThread]: 
[0m13:02:48.556935 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:02:48.557437 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_symbols_meta
[0m13:02:48.557955 [info ] [Thread-1  ]: 1 of 40 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m13:02:48.558443 [info ] [Thread-2  ]: 2 of 40 START sql table model stock_analysis.stg_symbols_meta .................. [RUN]
[0m13:02:48.558931 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m13:02:48.559400 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_symbols_meta'
[0m13:02:48.559830 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:02:48.560160 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m13:02:48.571337 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m13:02:48.574556 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:02:48.575597 [debug] [Thread-2  ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m13:02:48.578331 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:02:48.590590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:48.591862 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:02:49.019095 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:02:49.020173 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , concat(base.year_full,'-',base.week_number) as year_week
    , concat(base.year_full,'-',base.month_abbrev,'-',base.week_number) as year_month_week
    , concat(base.year_full,'-',base.month_abbrev) as year_month

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m13:02:49.059106 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.stg_symbols_meta"
[0m13:02:49.060115 [debug] [Thread-2  ]: On model.stock_analysis.stg_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_symbols_meta`
      
    
    

    OPTIONS()
    as (
      with 

symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`base_symbols_meta` )

select 
    symbol
    , security_name
    , listing_exchange
    , market_category
    , is_ETF
from symbols_meta
    );
  
[0m13:02:49.587121 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26150215-e1d6-45f8-a7d1-4fd3226d7be5&page=queryresults
[0m13:02:49.677666 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1522bd5f-4a6c-4f74-9dc1-14cc4528fb69&page=queryresults
[0m13:02:51.438371 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275c15e0>]}
[0m13:02:51.439128 [info ] [Thread-2  ]: 2 of 40 OK created sql table model stock_analysis.stg_symbols_meta ............. [[32mCREATE TABLE (8.0k rows, 495.2 KiB processed)[0m in 2.88s]
[0m13:02:51.439715 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m13:02:55.016973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144beedf0>]}
[0m13:02:55.018418 [info ] [Thread-1  ]: 1 of 40 OK created sql table model stock_analysis.stg_calendar ................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 6.46s]
[0m13:02:55.019324 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:02:55.021926 [debug] [Thread-4  ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m13:02:55.022782 [debug] [Thread-5  ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m13:02:55.023530 [debug] [Thread-6  ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m13:02:55.024679 [debug] [Thread-7  ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m13:02:55.025249 [debug] [Thread-8  ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m13:02:55.024229 [info ] [Thread-4  ]: 3 of 40 START sql table model stock_analysis.stg_aapl_1993_2024 ................ [RUN]
[0m13:02:55.025771 [debug] [Thread-9  ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m13:02:55.026929 [debug] [Thread-10 ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m13:02:55.026487 [info ] [Thread-5  ]: 4 of 40 START sql table model stock_analysis.stg_abbv_2013_2024 ................ [RUN]
[0m13:02:55.027502 [debug] [Thread-11 ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m13:02:55.027991 [info ] [Thread-6  ]: 5 of 40 START sql table model stock_analysis.stg_adbe_1993_2024 ................ [RUN]
[0m13:02:55.028467 [debug] [Thread-12 ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m13:02:55.028878 [debug] [Thread-13 ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m13:02:55.029387 [info ] [Thread-7  ]: 6 of 40 START sql table model stock_analysis.stg_amd_1993_2024 ................. [RUN]
[0m13:02:55.030253 [debug] [Thread-14 ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m13:02:55.030929 [info ] [Thread-8  ]: 7 of 40 START sql table model stock_analysis.stg_amzn_1997_2024 ................ [RUN]
[0m13:02:55.031585 [debug] [Thread-15 ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m13:02:55.032296 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_aapl_1993_2024'
[0m13:02:55.032761 [debug] [Thread-16 ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m13:02:55.033210 [debug] [Thread-17 ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m13:02:55.033632 [debug] [Thread-18 ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m13:02:55.034398 [debug] [Thread-19 ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m13:02:55.034077 [info ] [Thread-9  ]: 8 of 40 START sql table model stock_analysis.stg_avgo_2009_2024 ................ [RUN]
[0m13:02:55.034886 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m13:02:55.035361 [info ] [Thread-10 ]: 9 of 40 START sql table model stock_analysis.stg_bac_1993_2024 ................. [RUN]
[0m13:02:55.035776 [debug] [Thread-21 ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m13:02:55.036284 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_abbv_2013_2024'
[0m13:02:55.036756 [debug] [Thread-22 ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m13:02:55.037206 [debug] [Thread-23 ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m13:02:55.038211 [debug] [Thread-24 ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m13:02:55.037825 [info ] [Thread-11 ]: 10 of 40 START sql table model stock_analysis.stg_brk-b_1996_2024 .............. [RUN]
[0m13:02:55.038789 [debug] [Thread-25 ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m13:02:55.039212 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_adbe_1993_2024'
[0m13:02:55.039519 [debug] [Thread-26 ]: Began running node model.stock_analysis.stg_msft_1993_2024
[0m13:02:55.039860 [debug] [Thread-27 ]: Began running node model.stock_analysis.stg_nflx_1993_2024
[0m13:02:55.040276 [info ] [Thread-12 ]: 11 of 40 START sql table model stock_analysis.stg_cost_1993_2024 ............... [RUN]
[0m13:02:55.040656 [debug] [Thread-28 ]: Began running node model.stock_analysis.stg_nvda_1999_2024
[0m13:02:55.040980 [debug] [Thread-29 ]: Began running node model.stock_analysis.stg_pep_1993_2024
[0m13:02:55.041296 [debug] [Thread-30 ]: Began running node model.stock_analysis.stg_pg_1993_2024
[0m13:02:55.041675 [info ] [Thread-13 ]: 12 of 40 START sql table model stock_analysis.stg_crm_2004_2024 ................ [RUN]
[0m13:02:55.042052 [debug] [Thread-31 ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m13:02:55.042441 [debug] [Thread-7  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_amd_1993_2024'
[0m13:02:55.042777 [debug] [Thread-32 ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m13:02:55.043177 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:02:55.043622 [info ] [Thread-14 ]: 13 of 40 START sql table model stock_analysis.stg_cvx_1993_2024 ................ [RUN]
[0m13:02:55.044080 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_tmo_1993_2024
[0m13:02:55.044380 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_tsla_2010_2024
[0m13:02:55.044857 [debug] [Thread-8  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_amzn_1997_2024'
[0m13:02:55.045342 [info ] [Thread-15 ]: 14 of 40 START sql table model stock_analysis.stg_goog_2004_2024 ............... [RUN]
[0m13:02:55.045684 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.stg_aapl_1993_2024
[0m13:02:55.046053 [info ] [Thread-16 ]: 15 of 40 START sql table model stock_analysis.stg_googl_2004_2024 .............. [RUN]
[0m13:02:55.046600 [info ] [Thread-17 ]: 16 of 40 START sql table model stock_analysis.stg_hd_1993_2024 ................. [RUN]
[0m13:02:55.047182 [info ] [Thread-18 ]: 17 of 40 START sql table model stock_analysis.stg_hlal_2019_2024 ............... [RUN]
[0m13:02:55.047644 [info ] [Thread-19 ]: 18 of 40 START sql table model stock_analysis.stg_jnj_1993_2024 ................ [RUN]
[0m13:02:55.048172 [debug] [Thread-9  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_avgo_2009_2024'
[0m13:02:55.048554 [info ] [Thread-20 ]: 19 of 40 START sql table model stock_analysis.stg_jpm_1993_2024 ................ [RUN]
[0m13:02:55.048967 [debug] [Thread-10 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_bac_1993_2024'
[0m13:02:55.049333 [info ] [Thread-21 ]: 20 of 40 START sql table model stock_analysis.stg_ko_1993_2024 ................. [RUN]
[0m13:02:55.049660 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.stg_abbv_2013_2024
[0m13:02:55.050007 [info ] [Thread-22 ]: 21 of 40 START sql table model stock_analysis.stg_lly_1993_2024 ................ [RUN]
[0m13:02:55.050416 [info ] [Thread-23 ]: 22 of 40 START sql table model stock_analysis.stg_ma_2006_2024 ................. [RUN]
[0m13:02:55.050816 [info ] [Thread-24 ]: 23 of 40 START sql table model stock_analysis.stg_meta_2012_2024 ............... [RUN]
[0m13:02:55.051257 [debug] [Thread-11 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_brk-b_1996_2024'
[0m13:02:55.051640 [info ] [Thread-25 ]: 24 of 40 START sql table model stock_analysis.stg_mrk_1993_2024 ................ [RUN]
[0m13:02:55.051949 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.stg_adbe_1993_2024
[0m13:02:55.052316 [info ] [Thread-26 ]: 25 of 40 START sql table model stock_analysis.stg_msft_1993_2024 ............... [RUN]
[0m13:02:55.052787 [info ] [Thread-27 ]: 26 of 40 START sql table model stock_analysis.stg_nflx_1993_2024 ............... [RUN]
[0m13:02:55.053224 [debug] [Thread-12 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_cost_1993_2024'
[0m13:02:55.053597 [info ] [Thread-28 ]: 27 of 40 START sql table model stock_analysis.stg_nvda_1999_2024 ............... [RUN]
[0m13:02:55.054005 [info ] [Thread-29 ]: 28 of 40 START sql table model stock_analysis.stg_pep_1993_2024 ................ [RUN]
[0m13:02:55.054407 [info ] [Thread-30 ]: 29 of 40 START sql table model stock_analysis.stg_pg_1993_2024 ................. [RUN]
[0m13:02:55.054813 [debug] [Thread-13 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_crm_2004_2024'
[0m13:02:55.055181 [info ] [Thread-31 ]: 30 of 40 START sql table model stock_analysis.stg_spus_2019_2024 ............... [RUN]
[0m13:02:55.055487 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.stg_amd_1993_2024
[0m13:02:55.055829 [info ] [Thread-32 ]: 31 of 40 START sql table model stock_analysis.stg_spy_1993_2024 ................ [RUN]
[0m13:02:55.056368 [info ] [Thread-3  ]: 32 of 40 START sql table model stock_analysis.stg_spy_2014_2024 ................ [RUN]
[0m13:02:55.056815 [debug] [Thread-14 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_cvx_1993_2024'
[0m13:02:55.057161 [info ] [Thread-2  ]: 33 of 40 START sql table model stock_analysis.stg_tmo_1993_2024 ................ [RUN]
[0m13:02:55.057528 [info ] [Thread-1  ]: 34 of 40 START sql table model stock_analysis.stg_tsla_2010_2024 ............... [RUN]
[0m13:02:55.057826 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.stg_amzn_1997_2024
[0m13:02:55.058150 [debug] [Thread-15 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_goog_2004_2024'
[0m13:02:55.061722 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.stg_aapl_1993_2024"
[0m13:02:55.062220 [debug] [Thread-16 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_googl_2004_2024'
[0m13:02:55.062601 [debug] [Thread-17 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_hd_1993_2024'
[0m13:02:55.063008 [debug] [Thread-18 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_hlal_2019_2024'
[0m13:02:55.063405 [debug] [Thread-19 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_jnj_1993_2024'
[0m13:02:55.063703 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.stg_avgo_2009_2024
[0m13:02:55.064135 [debug] [Thread-20 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_jpm_1993_2024'
[0m13:02:55.064388 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.stg_bac_1993_2024
[0m13:02:55.064699 [debug] [Thread-21 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_ko_1993_2024'
[0m13:02:55.067703 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.stg_abbv_2013_2024"
[0m13:02:55.068042 [debug] [Thread-22 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_lly_1993_2024'
[0m13:02:55.068462 [debug] [Thread-23 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_ma_2006_2024'
[0m13:02:55.068814 [debug] [Thread-24 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_meta_2012_2024'
[0m13:02:55.069071 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.stg_brk-b_1996_2024
[0m13:02:55.069407 [debug] [Thread-25 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_mrk_1993_2024'
[0m13:02:55.072935 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.stg_adbe_1993_2024"
[0m13:02:55.073309 [debug] [Thread-26 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_msft_1993_2024'
[0m13:02:55.073678 [debug] [Thread-27 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nflx_1993_2024'
[0m13:02:55.073910 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.stg_cost_1993_2024
[0m13:02:55.074202 [debug] [Thread-28 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nvda_1999_2024'
[0m13:02:55.074484 [debug] [Thread-29 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_pep_1993_2024'
[0m13:02:55.074770 [debug] [Thread-30 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_pg_1993_2024'
[0m13:02:55.074991 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.stg_crm_2004_2024
[0m13:02:55.075266 [debug] [Thread-31 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_spus_2019_2024'
[0m13:02:55.077755 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.stg_amd_1993_2024"
[0m13:02:55.078067 [debug] [Thread-32 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_spy_1993_2024'
[0m13:02:55.078349 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_spy_2014_2024'
[0m13:02:55.078567 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.stg_cvx_1993_2024
[0m13:02:55.078852 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_symbols_meta, now model.stock_analysis.stg_tmo_1993_2024)
[0m13:02:55.079082 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_tsla_2010_2024)
[0m13:02:55.081374 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.stg_amzn_1997_2024"
[0m13:02:55.081612 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.stg_goog_2004_2024
[0m13:02:55.082014 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.stg_googl_2004_2024
[0m13:02:55.082372 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.stg_hd_1993_2024
[0m13:02:55.082648 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m13:02:55.082887 [debug] [Thread-19 ]: Began compiling node model.stock_analysis.stg_jnj_1993_2024
[0m13:02:55.085820 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.stg_avgo_2009_2024"
[0m13:02:55.086080 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_jpm_1993_2024
[0m13:02:55.088592 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.stg_bac_1993_2024"
[0m13:02:55.088845 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.stg_ko_1993_2024
[0m13:02:55.089083 [debug] [Thread-4  ]: Began executing node model.stock_analysis.stg_aapl_1993_2024
[0m13:02:55.089339 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.stg_lly_1993_2024
[0m13:02:55.089572 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.stg_ma_2006_2024
[0m13:02:55.089778 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.stg_meta_2012_2024
[0m13:02:55.092012 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m13:02:55.092231 [debug] [Thread-5  ]: Began executing node model.stock_analysis.stg_abbv_2013_2024
[0m13:02:55.092434 [debug] [Thread-25 ]: Began compiling node model.stock_analysis.stg_mrk_1993_2024
[0m13:02:55.092673 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.stg_msft_1993_2024
[0m13:02:55.092872 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.stg_nflx_1993_2024
[0m13:02:55.095188 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.stg_cost_1993_2024"
[0m13:02:55.095468 [debug] [Thread-6  ]: Began executing node model.stock_analysis.stg_adbe_1993_2024
[0m13:02:55.095705 [debug] [Thread-28 ]: Began compiling node model.stock_analysis.stg_nvda_1999_2024
[0m13:02:55.095913 [debug] [Thread-29 ]: Began compiling node model.stock_analysis.stg_pep_1993_2024
[0m13:02:55.096107 [debug] [Thread-30 ]: Began compiling node model.stock_analysis.stg_pg_1993_2024
[0m13:02:55.099322 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.stg_crm_2004_2024"
[0m13:02:55.099542 [debug] [Thread-31 ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m13:02:55.099777 [debug] [Thread-32 ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m13:02:55.099981 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:02:55.102100 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.stg_cvx_1993_2024"
[0m13:02:55.102334 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.stg_tmo_1993_2024
[0m13:02:55.102530 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_tsla_2010_2024
[0m13:02:55.104817 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.stg_goog_2004_2024"
[0m13:02:55.105046 [debug] [Thread-7  ]: Began executing node model.stock_analysis.stg_amd_1993_2024
[0m13:02:55.107082 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.stg_googl_2004_2024"
[0m13:02:55.109087 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.stg_hd_1993_2024"
[0m13:02:55.109285 [debug] [Thread-8  ]: Began executing node model.stock_analysis.stg_amzn_1997_2024
[0m13:02:55.111214 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m13:02:55.113190 [debug] [Thread-19 ]: Writing injected SQL for node "model.stock_analysis.stg_jnj_1993_2024"
[0m13:02:55.115867 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_jpm_1993_2024"
[0m13:02:55.117881 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.stg_ko_1993_2024"
[0m13:02:55.119519 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:02:55.121519 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.stg_lly_1993_2024"
[0m13:02:55.121707 [debug] [Thread-9  ]: Began executing node model.stock_analysis.stg_avgo_2009_2024
[0m13:02:55.121887 [debug] [Thread-10 ]: Began executing node model.stock_analysis.stg_bac_1993_2024
[0m13:02:55.123713 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.stg_ma_2006_2024"
[0m13:02:55.125637 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.stg_meta_2012_2024"
[0m13:02:55.127252 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m13:02:55.129313 [debug] [Thread-25 ]: Writing injected SQL for node "model.stock_analysis.stg_mrk_1993_2024"
[0m13:02:55.131904 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.stg_msft_1993_2024"
[0m13:02:55.133803 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.stg_nflx_1993_2024"
[0m13:02:55.134004 [debug] [Thread-11 ]: Began executing node model.stock_analysis.stg_brk-b_1996_2024
[0m13:02:55.135512 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m13:02:55.137449 [debug] [Thread-28 ]: Writing injected SQL for node "model.stock_analysis.stg_nvda_1999_2024"
[0m13:02:55.139345 [debug] [Thread-29 ]: Writing injected SQL for node "model.stock_analysis.stg_pep_1993_2024"
[0m13:02:55.141261 [debug] [Thread-30 ]: Writing injected SQL for node "model.stock_analysis.stg_pg_1993_2024"
[0m13:02:55.141461 [debug] [Thread-12 ]: Began executing node model.stock_analysis.stg_cost_1993_2024
[0m13:02:55.143533 [debug] [Thread-31 ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m13:02:55.146054 [debug] [Thread-32 ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m13:02:55.147930 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:02:55.148130 [debug] [Thread-13 ]: Began executing node model.stock_analysis.stg_crm_2004_2024
[0m13:02:55.150047 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.stg_tmo_1993_2024"
[0m13:02:55.152032 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_tsla_2010_2024"
[0m13:02:55.153595 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m13:02:55.153783 [debug] [Thread-14 ]: Began executing node model.stock_analysis.stg_cvx_1993_2024
[0m13:02:55.155301 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m13:02:55.155481 [debug] [Thread-15 ]: Began executing node model.stock_analysis.stg_goog_2004_2024
[0m13:02:55.155762 [debug] [Thread-16 ]: Began executing node model.stock_analysis.stg_googl_2004_2024
[0m13:02:55.155941 [debug] [Thread-17 ]: Began executing node model.stock_analysis.stg_hd_1993_2024
[0m13:02:55.156388 [debug] [Thread-18 ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m13:02:55.156721 [debug] [Thread-21 ]: Began executing node model.stock_analysis.stg_ko_1993_2024
[0m13:02:55.156906 [debug] [Thread-19 ]: Began executing node model.stock_analysis.stg_jnj_1993_2024
[0m13:02:55.158447 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m13:02:55.216757 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_jpm_1993_2024
[0m13:02:55.219058 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m13:02:55.221872 [debug] [Thread-22 ]: Began executing node model.stock_analysis.stg_lly_1993_2024
[0m13:02:55.280437 [debug] [Thread-23 ]: Began executing node model.stock_analysis.stg_ma_2006_2024
[0m13:02:55.283754 [debug] [Thread-24 ]: Began executing node model.stock_analysis.stg_meta_2012_2024
[0m13:02:55.285422 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m13:02:55.285840 [debug] [Thread-25 ]: Began executing node model.stock_analysis.stg_mrk_1993_2024
[0m13:02:55.346179 [debug] [Thread-26 ]: Began executing node model.stock_analysis.stg_msft_1993_2024
[0m13:02:55.346363 [debug] [Thread-27 ]: Began executing node model.stock_analysis.stg_nflx_1993_2024
[0m13:02:55.348404 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m13:02:55.348605 [debug] [Thread-29 ]: Began executing node model.stock_analysis.stg_pep_1993_2024
[0m13:02:55.348783 [debug] [Thread-28 ]: Began executing node model.stock_analysis.stg_nvda_1999_2024
[0m13:02:55.349256 [debug] [Thread-30 ]: Began executing node model.stock_analysis.stg_pg_1993_2024
[0m13:02:55.351122 [debug] [Thread-13 ]: Opening a new connection, currently in state init
[0m13:02:55.351441 [debug] [Thread-31 ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m13:02:55.351689 [debug] [Thread-32 ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m13:02:55.351870 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:02:55.352054 [debug] [Thread-2  ]: Began executing node model.stock_analysis.stg_tmo_1993_2024
[0m13:02:55.353555 [debug] [Thread-14 ]: Opening a new connection, currently in state init
[0m13:02:55.353856 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_tsla_2010_2024
[0m13:02:55.415347 [debug] [Thread-15 ]: Opening a new connection, currently in state init
[0m13:02:55.477007 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m13:02:55.479208 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m13:02:55.480754 [debug] [Thread-18 ]: Opening a new connection, currently in state init
[0m13:02:55.482237 [debug] [Thread-21 ]: Opening a new connection, currently in state init
[0m13:02:55.483994 [debug] [Thread-19 ]: Opening a new connection, currently in state init
[0m13:02:55.485574 [debug] [Thread-20 ]: Opening a new connection, currently in state init
[0m13:02:55.547921 [debug] [Thread-22 ]: Opening a new connection, currently in state init
[0m13:02:55.608154 [debug] [Thread-23 ]: Opening a new connection, currently in state init
[0m13:02:55.648487 [debug] [Thread-24 ]: Opening a new connection, currently in state init
[0m13:02:55.655098 [debug] [Thread-25 ]: Opening a new connection, currently in state init
[0m13:02:55.715068 [debug] [Thread-26 ]: Opening a new connection, currently in state init
[0m13:02:55.720188 [debug] [Thread-27 ]: Opening a new connection, currently in state init
[0m13:02:55.723068 [debug] [Thread-29 ]: Opening a new connection, currently in state init
[0m13:02:55.786474 [debug] [Thread-28 ]: Opening a new connection, currently in state init
[0m13:02:55.788364 [debug] [Thread-30 ]: Opening a new connection, currently in state init
[0m13:02:55.790759 [debug] [Thread-31 ]: Opening a new connection, currently in state init
[0m13:02:55.850968 [debug] [Thread-32 ]: Opening a new connection, currently in state init
[0m13:02:55.855142 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:02:55.856930 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:02:55.858696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:56.232492 [debug] [Thread-6  ]: Writing runtime sql for node "model.stock_analysis.stg_adbe_1993_2024"
[0m13:02:56.295556 [debug] [Thread-4  ]: Writing runtime sql for node "model.stock_analysis.stg_aapl_1993_2024"
[0m13:02:56.296284 [debug] [Thread-7  ]: Writing runtime sql for node "model.stock_analysis.stg_amd_1993_2024"
[0m13:02:56.558351 [debug] [Thread-8  ]: Writing runtime sql for node "model.stock_analysis.stg_amzn_1997_2024"
[0m13:02:56.559871 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.stg_abbv_2013_2024"
[0m13:02:57.117242 [debug] [Thread-9  ]: Writing runtime sql for node "model.stock_analysis.stg_avgo_2009_2024"
[0m13:02:57.120731 [debug] [Thread-10 ]: Writing runtime sql for node "model.stock_analysis.stg_bac_1993_2024"
[0m13:02:57.121337 [debug] [Thread-11 ]: Writing runtime sql for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m13:02:57.123691 [debug] [Thread-6  ]: On model.stock_analysis.stg_adbe_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_adbe_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_adbe_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.243043 [debug] [Thread-13 ]: Writing runtime sql for node "model.stock_analysis.stg_crm_2004_2024"
[0m13:02:57.244118 [debug] [Thread-12 ]: Writing runtime sql for node "model.stock_analysis.stg_cost_1993_2024"
[0m13:02:57.251690 [debug] [Thread-4  ]: On model.stock_analysis.stg_aapl_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_aapl_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_aapl_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.253821 [debug] [Thread-14 ]: Writing runtime sql for node "model.stock_analysis.stg_cvx_1993_2024"
[0m13:02:57.255439 [debug] [Thread-7  ]: On model.stock_analysis.stg_amd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.256188 [debug] [Thread-8  ]: On model.stock_analysis.stg_amzn_1997_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amzn_1997_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amzn_1997_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.257274 [debug] [Thread-5  ]: On model.stock_analysis.stg_abbv_2013_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_abbv_2013_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_abbv_2013_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.258588 [debug] [Thread-9  ]: On model.stock_analysis.stg_avgo_2009_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_avgo_2009_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_avgo_2009_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.259145 [debug] [Thread-10 ]: On model.stock_analysis.stg_bac_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_bac_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_bac_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.260959 [debug] [Thread-11 ]: On model.stock_analysis.stg_brk-b_1996_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_brk-b_1996_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_brk-b_1996_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.262027 [debug] [Thread-13 ]: On model.stock_analysis.stg_crm_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_crm_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_crm_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.262563 [debug] [Thread-12 ]: On model.stock_analysis.stg_cost_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cost_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cost_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.263176 [debug] [Thread-14 ]: On model.stock_analysis.stg_cvx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cvx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cvx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.381927 [debug] [Thread-16 ]: Writing runtime sql for node "model.stock_analysis.stg_googl_2004_2024"
[0m13:02:57.382804 [debug] [Thread-16 ]: On model.stock_analysis.stg_googl_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_googl_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_googl_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.442649 [debug] [Thread-19 ]: Writing runtime sql for node "model.stock_analysis.stg_jnj_1993_2024"
[0m13:02:57.444495 [debug] [Thread-19 ]: On model.stock_analysis.stg_jnj_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jnj_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jnj_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.449811 [debug] [Thread-21 ]: Writing runtime sql for node "model.stock_analysis.stg_ko_1993_2024"
[0m13:02:57.450927 [debug] [Thread-21 ]: On model.stock_analysis.stg_ko_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ko_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ko_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.454386 [debug] [Thread-24 ]: Writing runtime sql for node "model.stock_analysis.stg_meta_2012_2024"
[0m13:02:57.455307 [debug] [Thread-24 ]: On model.stock_analysis.stg_meta_2012_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_meta_2012_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_meta_2012_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.462164 [debug] [Thread-25 ]: Writing runtime sql for node "model.stock_analysis.stg_mrk_1993_2024"
[0m13:02:57.463145 [debug] [Thread-23 ]: Writing runtime sql for node "model.stock_analysis.stg_ma_2006_2024"
[0m13:02:57.464366 [debug] [Thread-20 ]: Writing runtime sql for node "model.stock_analysis.stg_jpm_1993_2024"
[0m13:02:57.465433 [debug] [Thread-18 ]: Writing runtime sql for node "model.stock_analysis.stg_hlal_2019_2024"
[0m13:02:57.466106 [debug] [Thread-25 ]: On model.stock_analysis.stg_mrk_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_mrk_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_mrk_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.466998 [debug] [Thread-23 ]: On model.stock_analysis.stg_ma_2006_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ma_2006_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ma_2006_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.467862 [debug] [Thread-20 ]: On model.stock_analysis.stg_jpm_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jpm_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jpm_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.468879 [debug] [Thread-18 ]: On model.stock_analysis.stg_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.474003 [debug] [Thread-26 ]: Writing runtime sql for node "model.stock_analysis.stg_msft_1993_2024"
[0m13:02:57.474683 [debug] [Thread-26 ]: On model.stock_analysis.stg_msft_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_msft_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_msft_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.489260 [debug] [Thread-28 ]: Writing runtime sql for node "model.stock_analysis.stg_nvda_1999_2024"
[0m13:02:57.489967 [debug] [Thread-28 ]: On model.stock_analysis.stg_nvda_1999_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nvda_1999_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nvda_1999_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.495808 [debug] [Thread-22 ]: Writing runtime sql for node "model.stock_analysis.stg_lly_1993_2024"
[0m13:02:57.496473 [debug] [Thread-22 ]: On model.stock_analysis.stg_lly_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_lly_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_lly_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.504021 [debug] [Thread-15 ]: Writing runtime sql for node "model.stock_analysis.stg_goog_2004_2024"
[0m13:02:57.504766 [debug] [Thread-15 ]: On model.stock_analysis.stg_goog_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_goog_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_goog_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.517349 [debug] [Thread-17 ]: Writing runtime sql for node "model.stock_analysis.stg_hd_1993_2024"
[0m13:02:57.518111 [debug] [Thread-17 ]: On model.stock_analysis.stg_hd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.521972 [debug] [Thread-32 ]: Writing runtime sql for node "model.stock_analysis.stg_spy_1993_2024"
[0m13:02:57.523105 [debug] [Thread-32 ]: On model.stock_analysis.stg_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.526280 [debug] [Thread-27 ]: Writing runtime sql for node "model.stock_analysis.stg_nflx_1993_2024"
[0m13:02:57.527023 [debug] [Thread-27 ]: On model.stock_analysis.stg_nflx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nflx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nflx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.529903 [debug] [Thread-31 ]: Writing runtime sql for node "model.stock_analysis.stg_spus_2019_2024"
[0m13:02:57.531010 [debug] [Thread-31 ]: On model.stock_analysis.stg_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- --   DEPRACATED   -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 


with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.533601 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_tsla_2010_2024"
[0m13:02:57.534468 [debug] [Thread-1  ]: On model.stock_analysis.stg_tsla_2010_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tsla_2010_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tsla_2010_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.552174 [debug] [Thread-30 ]: Writing runtime sql for node "model.stock_analysis.stg_pg_1993_2024"
[0m13:02:57.552915 [debug] [Thread-30 ]: On model.stock_analysis.stg_pg_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pg_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pg_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.555016 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:02:57.556065 [debug] [Thread-3  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.560468 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.stg_tmo_1993_2024"
[0m13:02:57.561186 [debug] [Thread-2  ]: On model.stock_analysis.stg_tmo_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tmo_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tmo_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.578183 [debug] [Thread-29 ]: Writing runtime sql for node "model.stock_analysis.stg_pep_1993_2024"
[0m13:02:57.579126 [debug] [Thread-29 ]: On model.stock_analysis.stg_pep_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pep_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pep_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:02:57.661909 [debug] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:83bad44e-c978-4bb7-974c-1f9d5309df27&page=queryresults
[0m13:02:57.663955 [debug] [Thread-7  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:097e7c2e-397f-411d-9f60-959f9cf0d886&page=queryresults
[0m13:02:57.665975 [debug] [Thread-12 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:43f3bbc1-2f1e-4d97-8f27-d732dbfae242&page=queryresults
[0m13:02:57.667782 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3647cf25-f0af-4262-bac5-9f7778a48938&page=queryresults
[0m13:02:57.668754 [debug] [Thread-13 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a3cf359a-ca00-4c07-a8d9-53d5e8d62088&page=queryresults
[0m13:02:57.670547 [debug] [Thread-11 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7a1ba45f-1070-4ba6-9b34-ce947ec8357c&page=queryresults
[0m13:02:57.673320 [debug] [Thread-9  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7db88eae-28c2-4533-a0d8-b5c98fbe6e54&page=queryresults
[0m13:02:57.674905 [debug] [Thread-14 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:41e8620a-37df-4fb3-87eb-8609af7a7cfc&page=queryresults
[0m13:02:57.683204 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0a7409e0-8f18-47e3-8472-140f2e9c7893&page=queryresults
[0m13:02:57.692068 [debug] [Thread-6  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:91014954-f4c6-475b-9823-5f1c9ca37608&page=queryresults
[0m13:02:57.697761 [debug] [Thread-8  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:04a89b9f-c157-4ee2-a8c1-06b189b889f2&page=queryresults
[0m13:02:57.881104 [debug] [Thread-26 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:132c313e-4c88-4cf9-bf53-9f808e37cae1&page=queryresults
[0m13:02:57.883076 [debug] [Thread-22 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f756608a-12cc-40dd-ae1b-86bccefc65b4&page=queryresults
[0m13:02:57.888072 [debug] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0d46f37e-93c1-45c0-81c4-14f150b701f6&page=queryresults
[0m13:02:57.888961 [debug] [Thread-24 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:97413d84-e6e4-45ce-9f7d-75a4ae291bfc&page=queryresults
[0m13:02:57.890540 [debug] [Thread-21 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6b0e2dda-fb42-43a8-bfa3-ed7ed37d6dfa&page=queryresults
[0m13:02:57.891272 [debug] [Thread-23 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6d402456-a7fb-4783-8be6-cdeb49ad588b&page=queryresults
[0m13:02:57.891940 [debug] [Thread-15 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5290d813-4e51-48ce-b043-0a97b5fcf990&page=queryresults
[0m13:02:57.894177 [debug] [Thread-28 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fb3c3d9c-9b4d-4e67-a76b-ff403a9178cf&page=queryresults
[0m13:02:57.895235 [debug] [Thread-20 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b6b06b88-8061-4eb9-938d-79f74b64d23c&page=queryresults
[0m13:02:57.896749 [debug] [Thread-19 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8e3aa7c6-152d-41da-927b-287aacf116bd&page=queryresults
[0m13:02:57.898170 [debug] [Thread-16 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7806fa0e-4f70-48d7-9b00-903578e07163&page=queryresults
[0m13:02:57.902100 [debug] [Thread-25 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ac9aba39-f83d-4336-aea3-5a29b4b39d2d&page=queryresults
[0m13:02:58.058464 [debug] [Thread-17 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c6f8bbda-18f6-40a2-8edf-7ddca263909c&page=queryresults
[0m13:02:58.296758 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f770d894-7a77-44b3-b4be-6a1b984098be&page=queryresults
[0m13:02:58.615268 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5ffb1a4c-cccb-4aff-9203-a6b78416f349&page=queryresults
[0m13:02:58.624802 [debug] [Thread-30 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1e53ec2a-362b-4420-8f80-3f3c5336cfca&page=queryresults
[0m13:02:58.626307 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:66c3990a-c058-4f3f-b0cd-090bde483503&page=queryresults
[0m13:02:58.627932 [debug] [Thread-31 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:05ca453c-2171-4ae3-a24e-b3d8b4737c5a&page=queryresults
[0m13:02:58.629685 [debug] [Thread-29 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:62addc21-c835-441b-a05c-84816ed16067&page=queryresults
[0m13:02:58.630241 [debug] [Thread-32 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a47dc51b-aa3b-4337-a241-7078539344fd&page=queryresults
[0m13:02:58.634870 [debug] [Thread-27 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e4204643-feb8-45e6-9f6b-e401fce977bb&page=queryresults
[0m13:03:23.836978 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f1c040>]}
[0m13:03:23.839810 [info ] [Thread-18 ]: 17 of 40 OK created sql table model stock_analysis.stg_hlal_2019_2024 .......... [[32mCREATE TABLE (1.3k rows, 42.1 MiB processed)[0m in 28.77s]
[0m13:03:23.841093 [debug] [Thread-18 ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m13:03:23.841599 [debug] [Thread-18 ]: Began running node model.stock_analysis.stg_unh_1993_2024
[0m13:03:23.842231 [info ] [Thread-18 ]: 35 of 40 START sql table model stock_analysis.stg_unh_1993_2024 ................ [RUN]
[0m13:03:23.842810 [debug] [Thread-18 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hlal_2019_2024, now model.stock_analysis.stg_unh_1993_2024)
[0m13:03:23.843197 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.stg_unh_1993_2024
[0m13:03:23.847760 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.stg_unh_1993_2024"
[0m13:03:23.848690 [debug] [Thread-18 ]: Began executing node model.stock_analysis.stg_unh_1993_2024
[0m13:03:23.851646 [debug] [Thread-18 ]: Opening a new connection, currently in state closed
[0m13:03:24.192332 [debug] [Thread-31 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f02dc0>]}
[0m13:03:24.194502 [info ] [Thread-31 ]: 30 of 40 OK created sql table model stock_analysis.stg_spus_2019_2024 .......... [[32mCREATE TABLE (1.2k rows, 42.0 MiB processed)[0m in 29.12s]
[0m13:03:24.195840 [debug] [Thread-31 ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m13:03:24.196680 [debug] [Thread-31 ]: Began running node model.stock_analysis.stg_v_1993_2024
[0m13:03:24.197562 [info ] [Thread-31 ]: 36 of 40 START sql table model stock_analysis.stg_v_1993_2024 .................. [RUN]
[0m13:03:24.198104 [debug] [Thread-31 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spus_2019_2024, now model.stock_analysis.stg_v_1993_2024)
[0m13:03:24.198445 [debug] [Thread-31 ]: Began compiling node model.stock_analysis.stg_v_1993_2024
[0m13:03:24.202146 [debug] [Thread-31 ]: Writing injected SQL for node "model.stock_analysis.stg_v_1993_2024"
[0m13:03:24.203006 [debug] [Thread-31 ]: Began executing node model.stock_analysis.stg_v_1993_2024
[0m13:03:24.205263 [debug] [Thread-31 ]: Opening a new connection, currently in state closed
[0m13:03:24.276136 [debug] [Thread-18 ]: Writing runtime sql for node "model.stock_analysis.stg_unh_1993_2024"
[0m13:03:24.276749 [debug] [Thread-18 ]: On model.stock_analysis.stg_unh_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_unh_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_unh_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:03:24.573565 [debug] [Thread-31 ]: Writing runtime sql for node "model.stock_analysis.stg_v_1993_2024"
[0m13:03:24.577205 [debug] [Thread-31 ]: On model.stock_analysis.stg_v_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_v_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_v_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_v_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:03:24.634286 [debug] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5144ebf0-9827-4e6b-b55d-9b40f8321e42&page=queryresults
[0m13:03:24.917686 [debug] [Thread-31 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:faa6f5ab-c45b-4fa9-bd2b-dc2a0815ba09&page=queryresults
[0m13:03:54.362390 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f71cd0>]}
[0m13:03:54.364819 [info ] [Thread-3  ]: 32 of 40 OK created sql table model stock_analysis.stg_spy_2014_2024 ........... [[32mCREATE TABLE (2.5k rows, 42.1 MiB processed)[0m in 59.28s]
[0m13:03:54.365894 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:03:54.366634 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_wmt_1993_2024
[0m13:03:54.367442 [info ] [Thread-3  ]: 37 of 40 START sql table model stock_analysis.stg_wmt_1993_2024 ................ [RUN]
[0m13:03:54.367953 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.stg_wmt_1993_2024)
[0m13:03:54.368285 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_wmt_1993_2024
[0m13:03:54.375001 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_wmt_1993_2024"
[0m13:03:54.375718 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_wmt_1993_2024
[0m13:03:54.378376 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:03:54.719389 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_wmt_1993_2024"
[0m13:03:54.722325 [debug] [Thread-3  ]: On model.stock_analysis.stg_wmt_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_wmt_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_wmt_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:03:55.427501 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:39dea0ae-48b8-4737-a4d7-700997a38733&page=queryresults
[0m13:04:07.379106 [debug] [Thread-24 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144818310>]}
[0m13:04:07.380513 [info ] [Thread-24 ]: 23 of 40 OK created sql table model stock_analysis.stg_meta_2012_2024 .......... [[32mCREATE TABLE (3.1k rows, 42.1 MiB processed)[0m in 72.31s]
[0m13:04:07.381757 [debug] [Thread-24 ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m13:04:07.382683 [debug] [Thread-24 ]: Began running node model.stock_analysis.stg_xom_1993_2024
[0m13:04:07.383559 [info ] [Thread-24 ]: 38 of 40 START sql table model stock_analysis.stg_xom_1993_2024 ................ [RUN]
[0m13:04:07.384389 [debug] [Thread-24 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_meta_2012_2024, now model.stock_analysis.stg_xom_1993_2024)
[0m13:04:07.384928 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.stg_xom_1993_2024
[0m13:04:07.390615 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.stg_xom_1993_2024"
[0m13:04:07.392487 [debug] [Thread-24 ]: Began executing node model.stock_analysis.stg_xom_1993_2024
[0m13:04:07.395791 [debug] [Thread-24 ]: Opening a new connection, currently in state closed
[0m13:04:07.807180 [debug] [Thread-24 ]: Writing runtime sql for node "model.stock_analysis.stg_xom_1993_2024"
[0m13:04:07.809828 [debug] [Thread-24 ]: On model.stock_analysis.stg_xom_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_xom_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_xom_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m13:04:08.174775 [debug] [Thread-24 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4843b180-faa0-4945-b47c-9337670231fc&page=queryresults
[0m13:04:10.558862 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f2b280>]}
[0m13:04:10.560085 [info ] [Thread-5  ]: 4 of 40 OK created sql table model stock_analysis.stg_abbv_2013_2024 ........... [[32mCREATE TABLE (2.9k rows, 42.1 MiB processed)[0m in 75.52s]
[0m13:04:10.560867 [debug] [Thread-5  ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m13:04:13.550794 [debug] [Thread-23 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f98fa0>]}
[0m13:04:13.551668 [info ] [Thread-23 ]: 22 of 40 OK created sql table model stock_analysis.stg_ma_2006_2024 ............ [[32mCREATE TABLE (4.6k rows, 42.2 MiB processed)[0m in 78.48s]
[0m13:04:13.552405 [debug] [Thread-23 ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m13:04:13.868191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f71df0>]}
[0m13:04:13.869420 [info ] [Thread-1  ]: 34 of 40 OK created sql table model stock_analysis.stg_tsla_2010_2024 .......... [[32mCREATE TABLE (3.6k rows, 42.2 MiB processed)[0m in 78.79s]
[0m13:04:13.870262 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_tsla_2010_2024
[0m13:04:23.226348 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f1cd60>]}
[0m13:04:23.227755 [info ] [Thread-16 ]: 15 of 40 OK created sql table model stock_analysis.stg_googl_2004_2024 ......... [[32mCREATE TABLE (5.0k rows, 42.2 MiB processed)[0m in 88.16s]
[0m13:04:23.228868 [debug] [Thread-16 ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m13:04:23.306936 [debug] [Thread-15 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e9bbb0>]}
[0m13:04:23.307961 [info ] [Thread-15 ]: 14 of 40 OK created sql table model stock_analysis.stg_goog_2004_2024 .......... [[32mCREATE TABLE (5.0k rows, 42.2 MiB processed)[0m in 88.25s]
[0m13:04:23.308855 [debug] [Thread-15 ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m13:04:26.340546 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f6fc10>]}
[0m13:04:26.341969 [info ] [Thread-9  ]: 8 of 40 OK created sql table model stock_analysis.stg_avgo_2009_2024 ........... [[32mCREATE TABLE (3.8k rows, 42.2 MiB processed)[0m in 91.29s]
[0m13:04:26.342835 [debug] [Thread-9  ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m13:04:34.305680 [debug] [Thread-27 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f9e160>]}
[0m13:04:34.307998 [info ] [Thread-27 ]: 26 of 40 OK created sql table model stock_analysis.stg_nflx_1993_2024 .......... [[32mCREATE TABLE (5.6k rows, 42.2 MiB processed)[0m in 99.23s]
[0m13:04:34.308896 [debug] [Thread-27 ]: Finished running node model.stock_analysis.stg_nflx_1993_2024
[0m13:04:52.125914 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144beee80>]}
[0m13:04:52.127532 [info ] [Thread-13 ]: 12 of 40 OK created sql table model stock_analysis.stg_crm_2004_2024 ........... [[32mCREATE TABLE (5.1k rows, 42.2 MiB processed)[0m in 117.07s]
[0m13:04:52.128370 [debug] [Thread-13 ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m13:04:59.810836 [debug] [Thread-31 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462d2f40>]}
[0m13:04:59.812285 [info ] [Thread-31 ]: 36 of 40 OK created sql table model stock_analysis.stg_v_1993_2024 ............. [[32mCREATE TABLE (4.1k rows, 42.2 MiB processed)[0m in 95.61s]
[0m13:04:59.813127 [debug] [Thread-31 ]: Finished running node model.stock_analysis.stg_v_1993_2024
[0m13:05:02.905627 [debug] [Thread-29 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f6f2b0>]}
[0m13:05:02.906848 [info ] [Thread-29 ]: 28 of 40 OK created sql table model stock_analysis.stg_pep_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 127.83s]
[0m13:05:02.908136 [debug] [Thread-29 ]: Finished running node model.stock_analysis.stg_pep_1993_2024
[0m13:05:11.801663 [debug] [Thread-32 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144874310>]}
[0m13:05:11.802994 [info ] [Thread-32 ]: 31 of 40 OK created sql table model stock_analysis.stg_spy_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 136.72s]
[0m13:05:11.803903 [debug] [Thread-32 ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m13:05:13.185822 [debug] [Thread-28 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f3a130>]}
[0m13:05:13.187089 [info ] [Thread-28 ]: 27 of 40 OK created sql table model stock_analysis.stg_nvda_1999_2024 .......... [[32mCREATE TABLE (6.4k rows, 42.3 MiB processed)[0m in 138.11s]
[0m13:05:13.187863 [debug] [Thread-28 ]: Finished running node model.stock_analysis.stg_nvda_1999_2024
[0m13:05:13.946371 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fb3cd0>]}
[0m13:05:13.947628 [info ] [Thread-17 ]: 16 of 40 OK created sql table model stock_analysis.stg_hd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 138.88s]
[0m13:05:13.948730 [debug] [Thread-17 ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m13:05:16.111257 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a11d30>]}
[0m13:05:16.112705 [info ] [Thread-4  ]: 3 of 40 OK created sql table model stock_analysis.stg_aapl_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 141.08s]
[0m13:05:16.114072 [debug] [Thread-4  ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m13:05:20.101812 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146216be0>]}
[0m13:05:20.102918 [info ] [Thread-21 ]: 20 of 40 OK created sql table model stock_analysis.stg_ko_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 145.04s]
[0m13:05:20.103993 [debug] [Thread-21 ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m13:05:22.617544 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f0b2b0>]}
[0m13:05:22.618736 [info ] [Thread-7  ]: 6 of 40 OK created sql table model stock_analysis.stg_amd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 147.58s]
[0m13:05:22.619552 [debug] [Thread-7  ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m13:05:23.046159 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144fa2970>]}
[0m13:05:23.307205 [info ] [Thread-6  ]: 5 of 40 OK created sql table model stock_analysis.stg_adbe_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 148.01s]
[0m13:05:23.308662 [debug] [Thread-6  ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m13:05:24.146081 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f1ce50>]}
[0m13:05:24.147402 [info ] [Thread-19 ]: 18 of 40 OK created sql table model stock_analysis.stg_jnj_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 149.08s]
[0m13:05:24.148348 [debug] [Thread-19 ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m13:05:30.854497 [debug] [Thread-26 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146020dc0>]}
[0m13:05:30.855489 [info ] [Thread-26 ]: 25 of 40 OK created sql table model stock_analysis.stg_msft_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 155.78s]
[0m13:05:30.856201 [debug] [Thread-26 ]: Finished running node model.stock_analysis.stg_msft_1993_2024
[0m13:05:32.857132 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a11f40>]}
[0m13:05:32.857922 [info ] [Thread-22 ]: 21 of 40 OK created sql table model stock_analysis.stg_lly_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 157.79s]
[0m13:05:32.858505 [debug] [Thread-22 ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m13:05:32.950718 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f91ee0>]}
[0m13:05:32.951364 [info ] [Thread-10 ]: 9 of 40 OK created sql table model stock_analysis.stg_bac_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 157.90s]
[0m13:05:32.951901 [debug] [Thread-10 ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m13:05:35.726424 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14617ff70>]}
[0m13:05:35.727517 [info ] [Thread-14 ]: 13 of 40 OK created sql table model stock_analysis.stg_cvx_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 160.67s]
[0m13:05:35.728243 [debug] [Thread-14 ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m13:05:42.098935 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f78b80>]}
[0m13:05:42.100290 [info ] [Thread-2  ]: 33 of 40 OK created sql table model stock_analysis.stg_tmo_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 167.02s]
[0m13:05:42.101104 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_tmo_1993_2024
[0m13:05:43.308123 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f6f8b0>]}
[0m13:05:43.309329 [info ] [Thread-8  ]: 7 of 40 OK created sql table model stock_analysis.stg_amzn_1997_2024 ........... [[32mCREATE TABLE (6.9k rows, 42.3 MiB processed)[0m in 168.26s]
[0m13:05:43.310529 [debug] [Thread-8  ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m13:05:48.746167 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146787ca0>]}
[0m13:05:48.747756 [info ] [Thread-18 ]: 35 of 40 OK created sql table model stock_analysis.stg_unh_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 144.90s]
[0m13:05:48.748873 [debug] [Thread-18 ]: Finished running node model.stock_analysis.stg_unh_1993_2024
[0m13:05:49.730259 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039c5d30>]}
[0m13:05:49.731496 [info ] [Thread-11 ]: 10 of 40 OK created sql table model stock_analysis.stg_brk-b_1996_2024 ......... [[32mCREATE TABLE (7.1k rows, 42.3 MiB processed)[0m in 174.68s]
[0m13:05:49.732328 [debug] [Thread-11 ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m13:05:51.662927 [debug] [Thread-30 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14608a5e0>]}
[0m13:05:51.664390 [info ] [Thread-30 ]: 29 of 40 OK created sql table model stock_analysis.stg_pg_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 176.59s]
[0m13:05:51.665321 [debug] [Thread-30 ]: Finished running node model.stock_analysis.stg_pg_1993_2024
[0m13:05:57.523060 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a052e0>]}
[0m13:05:57.524452 [info ] [Thread-12 ]: 11 of 40 OK created sql table model stock_analysis.stg_cost_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 182.47s]
[0m13:05:57.525317 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m13:06:02.468998 [debug] [Thread-25 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f9e3a0>]}
[0m13:06:02.471233 [info ] [Thread-25 ]: 24 of 40 OK created sql table model stock_analysis.stg_mrk_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 187.40s]
[0m13:06:02.472565 [debug] [Thread-25 ]: Finished running node model.stock_analysis.stg_mrk_1993_2024
[0m13:06:31.564492 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462551c0>]}
[0m13:06:31.566811 [info ] [Thread-20 ]: 19 of 40 OK created sql table model stock_analysis.stg_jpm_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 216.50s]
[0m13:06:31.568662 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m13:06:53.853134 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146152370>]}
[0m13:06:53.854701 [info ] [Thread-3  ]: 37 of 40 OK created sql table model stock_analysis.stg_wmt_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 179.49s]
[0m13:06:53.856242 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_wmt_1993_2024
[0m13:07:14.584761 [debug] [Thread-24 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460ebcd0>]}
[0m13:07:14.587135 [info ] [Thread-24 ]: 38 of 40 OK created sql table model stock_analysis.stg_xom_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 187.20s]
[0m13:07:14.589057 [debug] [Thread-24 ]: Finished running node model.stock_analysis.stg_xom_1993_2024
[0m13:07:14.590738 [debug] [Thread-5  ]: Began running node model.stock_analysis.int_stock_analysis
[0m13:07:14.591567 [info ] [Thread-5  ]: 39 of 40 START sql table model stock_analysis.int_stock_analysis ............... [RUN]
[0m13:07:14.592422 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_abbv_2013_2024, now model.stock_analysis.int_stock_analysis)
[0m13:07:14.592900 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m13:07:14.612234 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m13:07:14.614756 [debug] [Thread-5  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m13:07:14.617365 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m13:07:15.027417 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m13:07:15.030597 [debug] [Thread-5  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from brk_b
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m13:07:15.889656 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:66597fd3-3b03-4142-8aae-c4f1a2085880&page=queryresults
[0m13:07:22.542760 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f0b670>]}
[0m13:07:22.545107 [info ] [Thread-5  ]: 39 of 40 OK created sql table model stock_analysis.int_stock_analysis .......... [[32mCREATE TABLE (224.9k rows, 92.1 MiB processed)[0m in 7.95s]
[0m13:07:22.546622 [debug] [Thread-5  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m13:07:22.548164 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m13:07:22.549056 [info ] [Thread-1  ]: 40 of 40 START sql table model stock_analysis.stock_analysis ................... [RUN]
[0m13:07:22.549705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_tsla_2010_2024, now model.stock_analysis.stock_analysis)
[0m13:07:22.550159 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m13:07:22.556520 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m13:07:22.559011 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m13:07:22.562933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:22.960170 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m13:07:22.963069 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m13:07:23.308336 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1c0277a3-ca46-40ad-85fb-26779a33e7a9&page=queryresults
[0m13:07:31.501233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a692ac53-7de6-4b5c-abbb-6cefc4a79047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146422eb0>]}
[0m13:07:31.502496 [info ] [Thread-1  ]: 40 of 40 OK created sql table model stock_analysis.stock_analysis .............. [[32mCREATE TABLE (224.9k rows, 93.7 MiB processed)[0m in 8.95s]
[0m13:07:31.503678 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m13:07:31.507030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:31.507457 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m13:07:31.507776 [debug] [MainThread]: Connection 'model.stock_analysis.stg_tmo_1993_2024' was properly closed.
[0m13:07:31.508062 [debug] [MainThread]: Connection 'model.stock_analysis.stg_aapl_1993_2024' was properly closed.
[0m13:07:31.508351 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m13:07:31.508628 [debug] [MainThread]: Connection 'model.stock_analysis.stg_adbe_1993_2024' was properly closed.
[0m13:07:31.508903 [debug] [MainThread]: Connection 'model.stock_analysis.stg_amd_1993_2024' was properly closed.
[0m13:07:31.509181 [debug] [MainThread]: Connection 'model.stock_analysis.stg_amzn_1997_2024' was properly closed.
[0m13:07:31.509453 [debug] [MainThread]: Connection 'model.stock_analysis.stg_avgo_2009_2024' was properly closed.
[0m13:07:31.509724 [debug] [MainThread]: Connection 'model.stock_analysis.stg_bac_1993_2024' was properly closed.
[0m13:07:31.510154 [debug] [MainThread]: Connection 'model.stock_analysis.stg_brk-b_1996_2024' was properly closed.
[0m13:07:31.510489 [debug] [MainThread]: Connection 'model.stock_analysis.stg_cost_1993_2024' was properly closed.
[0m13:07:31.510777 [debug] [MainThread]: Connection 'model.stock_analysis.stg_crm_2004_2024' was properly closed.
[0m13:07:31.511058 [debug] [MainThread]: Connection 'model.stock_analysis.stg_cvx_1993_2024' was properly closed.
[0m13:07:31.511333 [debug] [MainThread]: Connection 'model.stock_analysis.stg_goog_2004_2024' was properly closed.
[0m13:07:31.511611 [debug] [MainThread]: Connection 'model.stock_analysis.stg_googl_2004_2024' was properly closed.
[0m13:07:31.511885 [debug] [MainThread]: Connection 'model.stock_analysis.stg_hd_1993_2024' was properly closed.
[0m13:07:31.512151 [debug] [MainThread]: Connection 'model.stock_analysis.stg_unh_1993_2024' was properly closed.
[0m13:07:31.512418 [debug] [MainThread]: Connection 'model.stock_analysis.stg_jnj_1993_2024' was properly closed.
[0m13:07:31.512681 [debug] [MainThread]: Connection 'model.stock_analysis.stg_jpm_1993_2024' was properly closed.
[0m13:07:31.512944 [debug] [MainThread]: Connection 'model.stock_analysis.stg_ko_1993_2024' was properly closed.
[0m13:07:31.513218 [debug] [MainThread]: Connection 'model.stock_analysis.stg_lly_1993_2024' was properly closed.
[0m13:07:31.513478 [debug] [MainThread]: Connection 'model.stock_analysis.stg_ma_2006_2024' was properly closed.
[0m13:07:31.513739 [debug] [MainThread]: Connection 'model.stock_analysis.stg_xom_1993_2024' was properly closed.
[0m13:07:31.514007 [debug] [MainThread]: Connection 'model.stock_analysis.stg_mrk_1993_2024' was properly closed.
[0m13:07:31.514268 [debug] [MainThread]: Connection 'model.stock_analysis.stg_msft_1993_2024' was properly closed.
[0m13:07:31.514529 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nflx_1993_2024' was properly closed.
[0m13:07:31.514790 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nvda_1999_2024' was properly closed.
[0m13:07:31.515048 [debug] [MainThread]: Connection 'model.stock_analysis.stg_pep_1993_2024' was properly closed.
[0m13:07:31.515273 [debug] [MainThread]: Connection 'model.stock_analysis.stg_pg_1993_2024' was properly closed.
[0m13:07:31.515494 [debug] [MainThread]: Connection 'model.stock_analysis.stg_v_1993_2024' was properly closed.
[0m13:07:31.515717 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_1993_2024' was properly closed.
[0m13:07:31.515934 [debug] [MainThread]: Connection 'model.stock_analysis.stg_wmt_1993_2024' was properly closed.
[0m13:07:31.516468 [info ] [MainThread]: 
[0m13:07:31.516805 [info ] [MainThread]: Finished running 40 table models in 0 hours 4 minutes and 43.81 seconds (283.81s).
[0m13:07:31.523232 [debug] [MainThread]: Command end result
[0m13:07:31.632151 [info ] [MainThread]: 
[0m13:07:31.632465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:31.632658 [info ] [MainThread]: 
[0m13:07:31.632826 [info ] [MainThread]: Done. PASS=40 WARN=0 ERROR=0 SKIP=0 TOTAL=40
[0m13:07:31.633997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 284.7451, "process_user_time": 10.048719, "process_kernel_time": 3.531328, "process_mem_max_rss": "224100352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:07:31.634276 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:31.634227 after 284.75 seconds
[0m13:07:31.634486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efa070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593ddc0>]}
[0m13:07:31.634685 [debug] [MainThread]: Flushing usage events
[0m12:11:47.646385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2de20>]}


============================== 12:11:47.649070 | 2902b947-259c-41a5-a268-8fa0306b1ef2 ==============================
[0m12:11:47.649070 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:11:47.649378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:48.408816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dd7f0>]}
[0m12:11:48.434595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea7df0>]}
[0m12:11:48.434889 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:11:48.446914 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:11:48.537960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 36 files changed.
[0m12:11:48.538428 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_xom_1993_2024.sql
[0m12:11:48.538636 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_amd_1993_2024.sql
[0m12:11:48.538823 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_v_1993_2024.sql
[0m12:11:48.539008 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_spy_2014_2024.sql
[0m12:11:48.539187 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_wmt_1993_2024.sql
[0m12:11:48.539364 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_unh_1993_2024.sql
[0m12:11:48.539541 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_jnj_1993_2024.sql
[0m12:11:48.539714 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_nflx_1993_2024.sql
[0m12:11:48.539885 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_cost_1993_2024.sql
[0m12:11:48.540053 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_brk-b_1996_2024.sql
[0m12:11:48.540220 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_pg_1993_2024.sql
[0m12:11:48.540390 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_avgo_2009_2024.sql
[0m12:11:48.540557 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_aapl_1993_2024.sql
[0m12:11:48.540724 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_amzn_1997_2024.sql
[0m12:11:48.540891 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_ko_1993_2024.sql
[0m12:11:48.541062 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_adbe_1993_2024.sql
[0m12:11:48.541228 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_crm_2004_2024.sql
[0m12:11:48.541397 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_pep_1993_2024.sql
[0m12:11:48.541572 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_hlal_2019_2024.sql
[0m12:11:48.541753 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_nvda_1999_2024.sql
[0m12:11:48.541933 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_googl_2004_2024.sql
[0m12:11:48.542108 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_spus_2019_2024.sql
[0m12:11:48.542276 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_cvx_1993_2024.sql
[0m12:11:48.542445 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_abbv_2013_2024.sql
[0m12:11:48.542618 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_msft_1993_2024.sql
[0m12:11:48.542786 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_mrk_1993_2024.sql
[0m12:11:48.542957 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_hd_1993_2024.sql
[0m12:11:48.543134 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_lly_1993_2024.sql
[0m12:11:48.543307 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_jpm_1993_2024.sql
[0m12:11:48.543481 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_tmo_1993_2024.sql
[0m12:11:48.543654 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_bac_1993_2024.sql
[0m12:11:48.543821 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_meta_2012_2024.sql
[0m12:11:48.543987 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_goog_2004_2024.sql
[0m12:11:48.544169 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_ma_2006_2024.sql
[0m12:11:48.544349 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_tsla_2010_2024.sql
[0m12:11:48.544529 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_spy_1993_2024.sql
[0m12:11:48.745813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cfd4130>]}
[0m12:11:48.814500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc5bb0>]}
[0m12:11:48.814762 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m12:11:48.814949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8193a0>]}
[0m12:11:48.817204 [info ] [MainThread]: 
[0m12:11:48.817483 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:48.822776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:11:48.823035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:49.451024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:11:49.451693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:50.014297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daa580>]}
[0m12:11:50.014771 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m12:11:50.015062 [info ] [MainThread]: 
[0m12:11:50.018190 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_aapl_1993_2024
[0m12:11:50.018490 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_abbv_2013_2024
[0m12:11:50.019063 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_adbe_1993_2024
[0m12:11:50.018846 [info ] [Thread-1  ]: 1 of 78 START sql table model stock_analysis.base_aapl_1993_2024 ............... [RUN]
[0m12:11:50.019407 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_amd_1993_2024
[0m12:11:50.019917 [debug] [Thread-5  ]: Began running node model.stock_analysis.base_amzn_1997_2024
[0m12:11:50.019705 [info ] [Thread-2  ]: 2 of 78 START sql table model stock_analysis.base_abbv_2013_2024 ............... [RUN]
[0m12:11:50.020262 [debug] [Thread-6  ]: Began running node model.stock_analysis.base_avgo_2009_2024
[0m12:11:50.020738 [debug] [Thread-7  ]: Began running node model.stock_analysis.base_bac_1993_2024
[0m12:11:50.020547 [info ] [Thread-3  ]: 3 of 78 START sql table model stock_analysis.base_adbe_1993_2024 ............... [RUN]
[0m12:11:50.021021 [debug] [Thread-8  ]: Began running node model.stock_analysis.base_brk-b_1996_2024
[0m12:11:50.021262 [debug] [Thread-9  ]: Began running node model.stock_analysis.base_calendar
[0m12:11:50.021540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_aapl_1993_2024)
[0m12:11:50.021776 [debug] [Thread-10 ]: Began running node model.stock_analysis.base_cost_1993_2024
[0m12:11:50.022010 [debug] [Thread-11 ]: Began running node model.stock_analysis.base_crm_2004_2024
[0m12:11:50.022240 [debug] [Thread-12 ]: Began running node model.stock_analysis.base_cvx_1993_2024
[0m12:11:50.022459 [debug] [Thread-13 ]: Began running node model.stock_analysis.base_goog_2004_2024
[0m12:11:50.022935 [debug] [Thread-14 ]: Began running node model.stock_analysis.base_googl_2004_2024
[0m12:11:50.023157 [debug] [Thread-15 ]: Began running node model.stock_analysis.base_hd_1993_2024
[0m12:11:50.022746 [info ] [Thread-4  ]: 4 of 78 START sql table model stock_analysis.base_amd_1993_2024 ................ [RUN]
[0m12:11:50.023454 [debug] [Thread-16 ]: Began running node model.stock_analysis.base_hlal_2019_2024
[0m12:11:50.023891 [debug] [Thread-17 ]: Began running node model.stock_analysis.base_jnj_1993_2024
[0m12:11:50.023714 [info ] [Thread-5  ]: 5 of 78 START sql table model stock_analysis.base_amzn_1997_2024 ............... [RUN]
[0m12:11:50.024155 [debug] [Thread-18 ]: Began running node model.stock_analysis.base_jpm_1993_2024
[0m12:11:50.024446 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_abbv_2013_2024'
[0m12:11:50.024667 [debug] [Thread-19 ]: Began running node model.stock_analysis.base_ko_1993_2024
[0m12:11:50.024913 [debug] [Thread-20 ]: Began running node model.stock_analysis.base_lly_1993_2024
[0m12:11:50.025122 [debug] [Thread-21 ]: Began running node model.stock_analysis.base_ma_2006_2024
[0m12:11:50.025328 [debug] [Thread-22 ]: Began running node model.stock_analysis.base_meta_2012_2024
[0m12:11:50.025767 [debug] [Thread-23 ]: Began running node model.stock_analysis.base_mrk_1993_2024
[0m12:11:50.025982 [debug] [Thread-24 ]: Began running node model.stock_analysis.base_msft_1993_2024
[0m12:11:50.025593 [info ] [Thread-6  ]: 6 of 78 START sql table model stock_analysis.base_avgo_2009_2024 ............... [RUN]
[0m12:11:50.026229 [debug] [Thread-25 ]: Began running node model.stock_analysis.base_nflx_1993_2024
[0m12:11:50.026647 [debug] [Thread-26 ]: Began running node model.stock_analysis.base_nvda_1999_2024
[0m12:11:50.026477 [info ] [Thread-7  ]: 7 of 78 START sql table model stock_analysis.base_bac_1993_2024 ................ [RUN]
[0m12:11:50.026909 [debug] [Thread-27 ]: Began running node model.stock_analysis.base_pep_1993_2024
[0m12:11:50.027242 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.base_adbe_1993_2024'
[0m12:11:50.027491 [debug] [Thread-28 ]: Began running node model.stock_analysis.base_pg_1993_2024
[0m12:11:50.027758 [debug] [Thread-29 ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m12:11:50.028081 [info ] [Thread-8  ]: 8 of 78 START sql table model stock_analysis.base_brk-b_1996_2024 .............. [RUN]
[0m12:11:50.028391 [debug] [Thread-30 ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m12:11:50.028619 [debug] [Thread-31 ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:11:50.029384 [debug] [Thread-32 ]: Began running node model.stock_analysis.base_symbols_meta
[0m12:11:50.029097 [info ] [Thread-9  ]: 9 of 78 START sql table model stock_analysis.base_calendar ..................... [RUN]
[0m12:11:50.029783 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_aapl_1993_2024
[0m12:11:50.030158 [info ] [Thread-10 ]: 10 of 78 START sql table model stock_analysis.base_cost_1993_2024 .............. [RUN]
[0m12:11:50.030517 [info ] [Thread-11 ]: 11 of 78 START sql table model stock_analysis.base_crm_2004_2024 ............... [RUN]
[0m12:11:50.031096 [info ] [Thread-12 ]: 12 of 78 START sql table model stock_analysis.base_cvx_1993_2024 ............... [RUN]
[0m12:11:50.031534 [info ] [Thread-13 ]: 13 of 78 START sql table model stock_analysis.base_goog_2004_2024 .............. [RUN]
[0m12:11:50.031911 [info ] [Thread-14 ]: 14 of 78 START sql table model stock_analysis.base_googl_2004_2024 ............. [RUN]
[0m12:11:50.032430 [info ] [Thread-15 ]: 15 of 78 START sql table model stock_analysis.base_hd_1993_2024 ................ [RUN]
[0m12:11:50.032842 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.stock_analysis.base_amd_1993_2024'
[0m12:11:50.033130 [info ] [Thread-16 ]: 16 of 78 START sql table model stock_analysis.base_hlal_2019_2024 .............. [RUN]
[0m12:11:50.033463 [info ] [Thread-17 ]: 17 of 78 START sql table model stock_analysis.base_jnj_1993_2024 ............... [RUN]
[0m12:11:50.033841 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.base_amzn_1997_2024'
[0m12:11:50.034193 [info ] [Thread-18 ]: 18 of 78 START sql table model stock_analysis.base_jpm_1993_2024 ............... [RUN]
[0m12:11:50.034606 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_abbv_2013_2024
[0m12:11:50.035055 [info ] [Thread-19 ]: 19 of 78 START sql table model stock_analysis.base_ko_1993_2024 ................ [RUN]
[0m12:11:50.035390 [info ] [Thread-20 ]: 20 of 78 START sql table model stock_analysis.base_lly_1993_2024 ............... [RUN]
[0m12:11:50.035678 [info ] [Thread-21 ]: 21 of 78 START sql table model stock_analysis.base_ma_2006_2024 ................ [RUN]
[0m12:11:50.035948 [info ] [Thread-22 ]: 22 of 78 START sql table model stock_analysis.base_meta_2012_2024 .............. [RUN]
[0m12:11:50.036224 [info ] [Thread-23 ]: 23 of 78 START sql table model stock_analysis.base_mrk_1993_2024 ............... [RUN]
[0m12:11:50.036495 [info ] [Thread-24 ]: 24 of 78 START sql table model stock_analysis.base_msft_1993_2024 .............. [RUN]
[0m12:11:50.036907 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.base_avgo_2009_2024'
[0m12:11:50.037305 [info ] [Thread-25 ]: 25 of 78 START sql table model stock_analysis.base_nflx_1993_2024 .............. [RUN]
[0m12:11:50.037765 [info ] [Thread-26 ]: 26 of 78 START sql table model stock_analysis.base_nvda_1999_2024 .............. [RUN]
[0m12:11:50.038200 [debug] [Thread-7  ]: Acquiring new bigquery connection 'model.stock_analysis.base_bac_1993_2024'
[0m12:11:50.038510 [info ] [Thread-27 ]: 27 of 78 START sql table model stock_analysis.base_pep_1993_2024 ............... [RUN]
[0m12:11:50.038763 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_adbe_1993_2024
[0m12:11:50.039057 [info ] [Thread-28 ]: 28 of 78 START sql table model stock_analysis.base_pg_1993_2024 ................ [RUN]
[0m12:11:50.039355 [info ] [Thread-29 ]: 29 of 78 START sql table model stock_analysis.base_spus_2019_2024 .............. [RUN]
[0m12:11:50.039662 [debug] [Thread-8  ]: Acquiring new bigquery connection 'model.stock_analysis.base_brk-b_1996_2024'
[0m12:11:50.039934 [info ] [Thread-30 ]: 30 of 78 START sql table model stock_analysis.base_spy_1993_2024 ............... [RUN]
[0m12:11:50.040229 [info ] [Thread-31 ]: 31 of 78 START sql table model stock_analysis.base_spy_2014_2024 ............... [RUN]
[0m12:11:50.040514 [info ] [Thread-32 ]: 32 of 78 START sql table model stock_analysis.base_symbols_meta ................ [RUN]
[0m12:11:50.040838 [debug] [Thread-9  ]: Acquiring new bigquery connection 'model.stock_analysis.base_calendar'
[0m12:11:50.046596 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_aapl_1993_2024"
[0m12:11:50.047003 [debug] [Thread-10 ]: Acquiring new bigquery connection 'model.stock_analysis.base_cost_1993_2024'
[0m12:11:50.047288 [debug] [Thread-11 ]: Acquiring new bigquery connection 'model.stock_analysis.base_crm_2004_2024'
[0m12:11:50.047551 [debug] [Thread-12 ]: Acquiring new bigquery connection 'model.stock_analysis.base_cvx_1993_2024'
[0m12:11:50.047809 [debug] [Thread-13 ]: Acquiring new bigquery connection 'model.stock_analysis.base_goog_2004_2024'
[0m12:11:50.048061 [debug] [Thread-14 ]: Acquiring new bigquery connection 'model.stock_analysis.base_googl_2004_2024'
[0m12:11:50.048361 [debug] [Thread-15 ]: Acquiring new bigquery connection 'model.stock_analysis.base_hd_1993_2024'
[0m12:11:50.048555 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_amd_1993_2024
[0m12:11:50.048792 [debug] [Thread-16 ]: Acquiring new bigquery connection 'model.stock_analysis.base_hlal_2019_2024'
[0m12:11:50.049036 [debug] [Thread-17 ]: Acquiring new bigquery connection 'model.stock_analysis.base_jnj_1993_2024'
[0m12:11:50.049221 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.base_amzn_1997_2024
[0m12:11:50.049450 [debug] [Thread-18 ]: Acquiring new bigquery connection 'model.stock_analysis.base_jpm_1993_2024'
[0m12:11:50.050776 [debug] [Thread-19 ]: Acquiring new bigquery connection 'model.stock_analysis.base_ko_1993_2024'
[0m12:11:50.051243 [debug] [Thread-20 ]: Acquiring new bigquery connection 'model.stock_analysis.base_lly_1993_2024'
[0m12:11:50.053141 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_abbv_2013_2024"
[0m12:11:50.053439 [debug] [Thread-21 ]: Acquiring new bigquery connection 'model.stock_analysis.base_ma_2006_2024'
[0m12:11:50.053719 [debug] [Thread-22 ]: Acquiring new bigquery connection 'model.stock_analysis.base_meta_2012_2024'
[0m12:11:50.053967 [debug] [Thread-23 ]: Acquiring new bigquery connection 'model.stock_analysis.base_mrk_1993_2024'
[0m12:11:50.054218 [debug] [Thread-24 ]: Acquiring new bigquery connection 'model.stock_analysis.base_msft_1993_2024'
[0m12:11:50.054433 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.base_avgo_2009_2024
[0m12:11:50.054681 [debug] [Thread-25 ]: Acquiring new bigquery connection 'model.stock_analysis.base_nflx_1993_2024'
[0m12:11:50.055057 [debug] [Thread-26 ]: Acquiring new bigquery connection 'model.stock_analysis.base_nvda_1999_2024'
[0m12:11:50.055264 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.base_bac_1993_2024
[0m12:11:50.055536 [debug] [Thread-27 ]: Acquiring new bigquery connection 'model.stock_analysis.base_pep_1993_2024'
[0m12:11:50.057384 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_adbe_1993_2024"
[0m12:11:50.057675 [debug] [Thread-28 ]: Acquiring new bigquery connection 'model.stock_analysis.base_pg_1993_2024'
[0m12:11:50.057928 [debug] [Thread-29 ]: Acquiring new bigquery connection 'model.stock_analysis.base_spus_2019_2024'
[0m12:11:50.058113 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.base_brk-b_1996_2024
[0m12:11:50.058349 [debug] [Thread-30 ]: Acquiring new bigquery connection 'model.stock_analysis.base_spy_1993_2024'
[0m12:11:50.058574 [debug] [Thread-31 ]: Acquiring new bigquery connection 'model.stock_analysis.base_spy_2014_2024'
[0m12:11:50.058804 [debug] [Thread-32 ]: Acquiring new bigquery connection 'model.stock_analysis.base_symbols_meta'
[0m12:11:50.059003 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:11:50.059258 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.base_cost_1993_2024
[0m12:11:50.059473 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.base_crm_2004_2024
[0m12:11:50.059657 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.base_cvx_1993_2024
[0m12:11:50.059878 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.base_goog_2004_2024
[0m12:11:50.060078 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_aapl_1993_2024
[0m12:11:50.060251 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.base_googl_2004_2024
[0m12:11:50.060419 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.base_hd_1993_2024
[0m12:11:50.062048 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_amd_1993_2024"
[0m12:11:50.062262 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.base_hlal_2019_2024
[0m12:11:50.062451 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.base_jnj_1993_2024
[0m12:11:50.064071 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.base_amzn_1997_2024"
[0m12:11:50.064286 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.base_jpm_1993_2024
[0m12:11:50.064477 [debug] [Thread-19 ]: Began compiling node model.stock_analysis.base_ko_1993_2024
[0m12:11:50.064673 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.base_lly_1993_2024
[0m12:11:50.064897 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.base_ma_2006_2024
[0m12:11:50.065082 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.base_meta_2012_2024
[0m12:11:50.065277 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.base_mrk_1993_2024
[0m12:11:50.065450 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_abbv_2013_2024
[0m12:11:50.065617 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.base_msft_1993_2024
[0m12:11:50.067257 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.base_avgo_2009_2024"
[0m12:11:50.067464 [debug] [Thread-25 ]: Began compiling node model.stock_analysis.base_nflx_1993_2024
[0m12:11:50.067645 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.base_nvda_1999_2024
[0m12:11:50.069237 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.base_bac_1993_2024"
[0m12:11:50.069438 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.base_pep_1993_2024
[0m12:11:50.069650 [debug] [Thread-28 ]: Began compiling node model.stock_analysis.base_pg_1993_2024
[0m12:11:50.069835 [debug] [Thread-29 ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m12:11:50.071360 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.base_brk-b_1996_2024"
[0m12:11:50.071550 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_adbe_1993_2024
[0m12:11:50.071713 [debug] [Thread-30 ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m12:11:50.071889 [debug] [Thread-31 ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:11:50.072069 [debug] [Thread-32 ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m12:11:50.074294 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:11:50.075843 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.base_cost_1993_2024"
[0m12:11:50.077332 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.base_crm_2004_2024"
[0m12:11:50.078860 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.base_cvx_1993_2024"
[0m12:11:50.080318 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.base_goog_2004_2024"
[0m12:11:50.088934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:11:50.090453 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.base_googl_2004_2024"
[0m12:11:50.092530 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.base_hd_1993_2024"
[0m12:11:50.094099 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.base_hlal_2019_2024"
[0m12:11:50.095576 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.base_jnj_1993_2024"
[0m12:11:50.097184 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.base_jpm_1993_2024"
[0m12:11:50.097390 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_amd_1993_2024
[0m12:11:50.098839 [debug] [Thread-19 ]: Writing injected SQL for node "model.stock_analysis.base_ko_1993_2024"
[0m12:11:50.100313 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.base_lly_1993_2024"
[0m12:11:50.101804 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.base_ma_2006_2024"
[0m12:11:50.101999 [debug] [Thread-5  ]: Began executing node model.stock_analysis.base_amzn_1997_2024
[0m12:11:50.103403 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.base_meta_2012_2024"
[0m12:11:50.105650 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.base_mrk_1993_2024"
[0m12:11:50.107113 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:11:50.108654 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.base_msft_1993_2024"
[0m12:11:50.110215 [debug] [Thread-25 ]: Writing injected SQL for node "model.stock_analysis.base_nflx_1993_2024"
[0m12:11:50.111691 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.base_nvda_1999_2024"
[0m12:11:50.111940 [debug] [Thread-6  ]: Began executing node model.stock_analysis.base_avgo_2009_2024
[0m12:11:50.113449 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.base_pep_1993_2024"
[0m12:11:50.114924 [debug] [Thread-28 ]: Writing injected SQL for node "model.stock_analysis.base_pg_1993_2024"
[0m12:11:50.116988 [debug] [Thread-29 ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m12:11:50.117182 [debug] [Thread-7  ]: Began executing node model.stock_analysis.base_bac_1993_2024
[0m12:11:50.118764 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:11:50.120238 [debug] [Thread-30 ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m12:11:50.121675 [debug] [Thread-31 ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:11:50.121862 [debug] [Thread-8  ]: Began executing node model.stock_analysis.base_brk-b_1996_2024
[0m12:11:50.123307 [debug] [Thread-32 ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m12:11:50.123702 [debug] [Thread-9  ]: Began executing node model.stock_analysis.base_calendar
[0m12:11:50.123911 [debug] [Thread-10 ]: Began executing node model.stock_analysis.base_cost_1993_2024
[0m12:11:50.124148 [debug] [Thread-11 ]: Began executing node model.stock_analysis.base_crm_2004_2024
[0m12:11:50.124355 [debug] [Thread-12 ]: Began executing node model.stock_analysis.base_cvx_1993_2024
[0m12:11:50.183416 [debug] [Thread-13 ]: Began executing node model.stock_analysis.base_goog_2004_2024
[0m12:11:50.186700 [debug] [Thread-14 ]: Began executing node model.stock_analysis.base_googl_2004_2024
[0m12:11:50.186899 [debug] [Thread-15 ]: Began executing node model.stock_analysis.base_hd_1993_2024
[0m12:11:50.188690 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:11:50.188904 [debug] [Thread-16 ]: Began executing node model.stock_analysis.base_hlal_2019_2024
[0m12:11:50.189164 [debug] [Thread-17 ]: Began executing node model.stock_analysis.base_jnj_1993_2024
[0m12:11:50.189357 [debug] [Thread-18 ]: Began executing node model.stock_analysis.base_jpm_1993_2024
[0m12:11:50.189901 [debug] [Thread-19 ]: Began executing node model.stock_analysis.base_ko_1993_2024
[0m12:11:50.191363 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m12:11:50.191551 [debug] [Thread-20 ]: Began executing node model.stock_analysis.base_lly_1993_2024
[0m12:11:50.191752 [debug] [Thread-21 ]: Began executing node model.stock_analysis.base_ma_2006_2024
[0m12:11:50.192143 [debug] [Thread-22 ]: Began executing node model.stock_analysis.base_meta_2012_2024
[0m12:11:50.192337 [debug] [Thread-23 ]: Began executing node model.stock_analysis.base_mrk_1993_2024
[0m12:11:50.250639 [debug] [Thread-24 ]: Began executing node model.stock_analysis.base_msft_1993_2024
[0m12:11:50.255548 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m12:11:50.255830 [debug] [Thread-25 ]: Began executing node model.stock_analysis.base_nflx_1993_2024
[0m12:11:50.256219 [debug] [Thread-26 ]: Began executing node model.stock_analysis.base_nvda_1999_2024
[0m12:11:50.256495 [debug] [Thread-27 ]: Began executing node model.stock_analysis.base_pep_1993_2024
[0m12:11:50.257951 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m12:11:50.258178 [debug] [Thread-29 ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m12:11:50.258448 [debug] [Thread-28 ]: Began executing node model.stock_analysis.base_pg_1993_2024
[0m12:11:50.321559 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m12:11:50.321796 [debug] [Thread-30 ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m12:11:50.323966 [debug] [Thread-9  ]: Opening a new connection, currently in state init
[0m12:11:50.324297 [debug] [Thread-31 ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:11:50.325833 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m12:11:50.326041 [debug] [Thread-32 ]: Began executing node model.stock_analysis.base_symbols_meta
[0m12:11:50.327558 [debug] [Thread-11 ]: Opening a new connection, currently in state init
[0m12:11:50.329031 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m12:11:50.366456 [debug] [Thread-14 ]: Opening a new connection, currently in state init
[0m12:11:50.368494 [debug] [Thread-13 ]: Opening a new connection, currently in state init
[0m12:11:50.370008 [debug] [Thread-15 ]: Opening a new connection, currently in state init
[0m12:11:50.371554 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m12:11:50.373048 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m12:11:50.435315 [debug] [Thread-18 ]: Opening a new connection, currently in state init
[0m12:11:50.436988 [debug] [Thread-19 ]: Opening a new connection, currently in state init
[0m12:11:50.438599 [debug] [Thread-20 ]: Opening a new connection, currently in state init
[0m12:11:50.440613 [debug] [Thread-21 ]: Opening a new connection, currently in state init
[0m12:11:50.499400 [debug] [Thread-22 ]: Opening a new connection, currently in state init
[0m12:11:50.503754 [debug] [Thread-23 ]: Opening a new connection, currently in state init
[0m12:11:50.505634 [debug] [Thread-24 ]: Opening a new connection, currently in state init
[0m12:11:50.564562 [debug] [Thread-25 ]: Opening a new connection, currently in state init
[0m12:11:50.569302 [debug] [Thread-26 ]: Opening a new connection, currently in state init
[0m12:11:50.572670 [debug] [Thread-27 ]: Opening a new connection, currently in state init
[0m12:11:50.574417 [debug] [Thread-29 ]: Opening a new connection, currently in state init
[0m12:11:50.637216 [debug] [Thread-28 ]: Opening a new connection, currently in state init
[0m12:11:50.698981 [debug] [Thread-30 ]: Opening a new connection, currently in state init
[0m12:11:50.760788 [debug] [Thread-31 ]: Opening a new connection, currently in state init
[0m12:11:50.763378 [debug] [Thread-32 ]: Opening a new connection, currently in state init
[0m12:11:51.078675 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.base_abbv_2013_2024"
[0m12:11:51.142506 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_aapl_1993_2024"
[0m12:11:51.204866 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.base_adbe_1993_2024"
[0m12:11:51.939116 [debug] [Thread-4  ]: Writing runtime sql for node "model.stock_analysis.base_amd_1993_2024"
[0m12:11:51.945294 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.base_amzn_1997_2024"
[0m12:11:52.068561 [debug] [Thread-6  ]: Writing runtime sql for node "model.stock_analysis.base_avgo_2009_2024"
[0m12:11:52.129940 [debug] [Thread-9  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:11:52.193878 [debug] [Thread-7  ]: Writing runtime sql for node "model.stock_analysis.base_bac_1993_2024"
[0m12:11:52.196277 [debug] [Thread-2  ]: On model.stock_analysis.base_abbv_2013_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_abbv_2013_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_abbv_2013_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`abbv`
    );
  
[0m12:11:52.196522 [debug] [Thread-3  ]: On model.stock_analysis.base_adbe_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_adbe_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_adbe_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`adbe`
    );
  
[0m12:11:52.196758 [debug] [Thread-1  ]: On model.stock_analysis.base_aapl_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_aapl_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_aapl_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`aapl`
    );
  
[0m12:11:52.198238 [debug] [Thread-12 ]: Writing runtime sql for node "model.stock_analysis.base_cvx_1993_2024"
[0m12:11:52.198969 [debug] [Thread-10 ]: Writing runtime sql for node "model.stock_analysis.base_cost_1993_2024"
[0m12:11:52.199885 [debug] [Thread-4  ]: On model.stock_analysis.base_amd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_amd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_amd_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`amd`
    );
  
[0m12:11:52.200300 [debug] [Thread-5  ]: On model.stock_analysis.base_amzn_1997_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_amzn_1997_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_amzn_1997_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`amzn`
    );
  
[0m12:11:52.200956 [debug] [Thread-6  ]: On model.stock_analysis.base_avgo_2009_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_avgo_2009_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_avgo_2009_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`avgo`
    );
  
[0m12:11:52.201195 [debug] [Thread-7  ]: On model.stock_analysis.base_bac_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_bac_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_bac_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`bac`
    );
  
[0m12:11:52.202655 [debug] [Thread-9  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:11:52.203535 [debug] [Thread-12 ]: On model.stock_analysis.base_cvx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_cvx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_cvx_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`cvx`
    );
  
[0m12:11:52.203843 [debug] [Thread-10 ]: On model.stock_analysis.base_cost_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_cost_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_cost_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`cost`
    );
  
[0m12:11:52.218789 [debug] [Thread-11 ]: Writing runtime sql for node "model.stock_analysis.base_crm_2004_2024"
[0m12:11:52.219170 [debug] [Thread-11 ]: On model.stock_analysis.base_crm_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_crm_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_crm_2004_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`crm`
    );
  
[0m12:11:52.375352 [debug] [Thread-15 ]: Writing runtime sql for node "model.stock_analysis.base_hd_1993_2024"
[0m12:11:52.376032 [debug] [Thread-15 ]: On model.stock_analysis.base_hd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_hd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_hd_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`hd`
    );
  
[0m12:11:52.412998 [debug] [Thread-8  ]: Writing runtime sql for node "model.stock_analysis.base_brk-b_1996_2024"
[0m12:11:52.413669 [debug] [Thread-8  ]: On model.stock_analysis.base_brk-b_1996_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_brk-b_1996_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_brk-b_1996_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`brk-b`
    );
  
[0m12:11:52.416981 [debug] [Thread-13 ]: Writing runtime sql for node "model.stock_analysis.base_goog_2004_2024"
[0m12:11:52.417666 [debug] [Thread-13 ]: On model.stock_analysis.base_goog_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_goog_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_goog_2004_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`goog`
    );
  
[0m12:11:52.467060 [debug] [Thread-20 ]: Writing runtime sql for node "model.stock_analysis.base_lly_1993_2024"
[0m12:11:52.467834 [debug] [Thread-20 ]: On model.stock_analysis.base_lly_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_lly_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_lly_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`lly`
    );
  
[0m12:11:52.477743 [debug] [Thread-21 ]: Writing runtime sql for node "model.stock_analysis.base_ma_2006_2024"
[0m12:11:52.478474 [debug] [Thread-21 ]: On model.stock_analysis.base_ma_2006_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_ma_2006_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_ma_2006_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`ma`
    );
  
[0m12:11:52.480346 [debug] [Thread-17 ]: Writing runtime sql for node "model.stock_analysis.base_jnj_1993_2024"
[0m12:11:52.482194 [debug] [Thread-14 ]: Writing runtime sql for node "model.stock_analysis.base_googl_2004_2024"
[0m12:11:52.483155 [debug] [Thread-17 ]: On model.stock_analysis.base_jnj_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_jnj_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_jnj_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`jnj`
    );
  
[0m12:11:52.484548 [debug] [Thread-14 ]: On model.stock_analysis.base_googl_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_googl_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_googl_2004_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`googl`
    );
  
[0m12:11:52.487229 [debug] [Thread-16 ]: Writing runtime sql for node "model.stock_analysis.base_hlal_2019_2024"
[0m12:11:52.487905 [debug] [Thread-16 ]: On model.stock_analysis.base_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`hlal`
    );
  
[0m12:11:52.491908 [debug] [Thread-22 ]: Writing runtime sql for node "model.stock_analysis.base_meta_2012_2024"
[0m12:11:52.492843 [debug] [Thread-19 ]: Writing runtime sql for node "model.stock_analysis.base_ko_1993_2024"
[0m12:11:52.493438 [debug] [Thread-22 ]: On model.stock_analysis.base_meta_2012_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_meta_2012_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_meta_2012_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`meta`
    );
  
[0m12:11:52.493807 [debug] [Thread-19 ]: On model.stock_analysis.base_ko_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_ko_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_ko_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`ko`
    );
  
[0m12:11:52.521964 [debug] [Thread-23 ]: Writing runtime sql for node "model.stock_analysis.base_mrk_1993_2024"
[0m12:11:52.522593 [debug] [Thread-23 ]: On model.stock_analysis.base_mrk_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_mrk_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_mrk_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`mrk`
    );
  
[0m12:11:52.532604 [debug] [Thread-26 ]: Writing runtime sql for node "model.stock_analysis.base_nvda_1999_2024"
[0m12:11:52.533220 [debug] [Thread-26 ]: On model.stock_analysis.base_nvda_1999_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_nvda_1999_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_nvda_1999_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`nvda`
    );
  
[0m12:11:52.543836 [debug] [Thread-18 ]: Writing runtime sql for node "model.stock_analysis.base_jpm_1993_2024"
[0m12:11:52.544442 [debug] [Thread-18 ]: On model.stock_analysis.base_jpm_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_jpm_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_jpm_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`jpm`
    );
  
[0m12:11:52.583950 [debug] [Thread-27 ]: Writing runtime sql for node "model.stock_analysis.base_pep_1993_2024"
[0m12:11:52.585358 [debug] [Thread-24 ]: Writing runtime sql for node "model.stock_analysis.base_msft_1993_2024"
[0m12:11:52.586102 [debug] [Thread-27 ]: On model.stock_analysis.base_pep_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_pep_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_pep_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`pep`
    );
  
[0m12:11:52.586598 [debug] [Thread-24 ]: On model.stock_analysis.base_msft_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_msft_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_msft_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`msft`
    );
  
[0m12:11:52.591408 [debug] [Thread-25 ]: Writing runtime sql for node "model.stock_analysis.base_nflx_1993_2024"
[0m12:11:52.592126 [debug] [Thread-25 ]: On model.stock_analysis.base_nflx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_nflx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_nflx_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`nflx`
    );
  
[0m12:11:52.615923 [debug] [Thread-28 ]: Writing runtime sql for node "model.stock_analysis.base_pg_1993_2024"
[0m12:11:52.616637 [debug] [Thread-28 ]: On model.stock_analysis.base_pg_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_pg_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_pg_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`pg`
    );
  
[0m12:11:52.628234 [debug] [Thread-7  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:85b5634e-c080-4ce1-80e8-8929f783076b&page=queryresults
[0m12:11:52.629422 [debug] [Thread-32 ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m12:11:52.629936 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e682c344-6ffa-48b2-a95f-367b21c7aac2&page=queryresults
[0m12:11:52.632372 [debug] [Thread-32 ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_valid_meta`
    );
  
[0m12:11:52.634344 [debug] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e9f2a8ff-a52e-4541-b2e4-9a00f3f911a0&page=queryresults
[0m12:11:52.636181 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8e928764-09b3-408b-be9e-916256caac42&page=queryresults
[0m12:11:52.637367 [debug] [Thread-12 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:95ce08f6-1b93-471b-8607-65d7dfb5e148&page=queryresults
[0m12:11:52.638342 [debug] [Thread-31 ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:11:52.642501 [debug] [Thread-29 ]: Writing runtime sql for node "model.stock_analysis.base_spus_2019_2024"
[0m12:11:52.645411 [debug] [Thread-30 ]: Writing runtime sql for node "model.stock_analysis.base_spy_1993_2024"
[0m12:11:52.645914 [debug] [Thread-31 ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:11:52.646554 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:891338a3-e0a0-4cd9-8db1-3ebf6a34d1f5&page=queryresults
[0m12:11:52.646915 [debug] [Thread-29 ]: On model.stock_analysis.base_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spus_2019_2024`
    );
  
[0m12:11:52.648976 [debug] [Thread-30 ]: On model.stock_analysis.base_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_1993_2024`
    );
  
[0m12:11:52.779205 [debug] [Thread-14 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6da6e3f9-45f6-4185-9f4b-bdb162d728f4&page=queryresults
[0m12:11:52.933942 [debug] [Thread-19 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9d099eb5-e3cc-4a09-a166-ffcb9f4d431e&page=queryresults
[0m12:11:52.935402 [debug] [Thread-11 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5c01c1c7-2f6e-4c0b-9cd6-f7fbf785c747&page=queryresults
[0m12:11:52.942210 [debug] [Thread-8  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c8547bda-7cd6-48f6-86b2-fbad7cace83c&page=queryresults
[0m12:11:52.943391 [debug] [Thread-9  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ab6b6f43-2673-48aa-9872-03e845984be6&page=queryresults
[0m12:11:52.947501 [debug] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:73184ee6-3220-4ae8-a5e0-c44f8fc6d8d2&page=queryresults
[0m12:11:52.948408 [debug] [Thread-17 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a4c10d0b-d9f1-450f-a693-a13e1a44a5aa&page=queryresults
[0m12:11:52.951343 [debug] [Thread-15 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9775fcff-eba8-4527-bd0e-d3d465698397&page=queryresults
[0m12:11:52.952759 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:37cb315a-0508-4edd-9ed2-7c6ccd0afeaf&page=queryresults
[0m12:11:52.955903 [debug] [Thread-22 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ca7dc5ba-51e4-42d5-a483-5481e365e743&page=queryresults
[0m12:11:52.957010 [debug] [Thread-13 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ce04099b-bdc0-4755-a3e0-ecee98f0906a&page=queryresults
[0m12:11:52.957610 [debug] [Thread-30 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bd27e17a-faea-4159-b1f7-0a1bb82e219d&page=queryresults
[0m12:11:52.958151 [debug] [Thread-16 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bdaf219b-b5e8-4bca-885c-e2beea371abb&page=queryresults
[0m12:11:52.958681 [debug] [Thread-23 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:77297bec-a45d-46b9-863e-f102b10750e5&page=queryresults
[0m12:11:52.959352 [debug] [Thread-25 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:76203470-65fc-4011-b2c7-7a70bae4d60f&page=queryresults
[0m12:11:52.960459 [debug] [Thread-29 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:40f18248-b9c4-4c18-99a1-9d00198c0fdb&page=queryresults
[0m12:11:52.960902 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5ebdcfcc-c557-46e1-86f7-450764fff2e3&page=queryresults
[0m12:11:52.962833 [debug] [Thread-24 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bd6326c7-469d-465b-9ff2-f88ab168432b&page=queryresults
[0m12:11:52.963230 [debug] [Thread-20 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:32df4110-661e-455d-866c-ffd0267adff0&page=queryresults
[0m12:11:52.964909 [debug] [Thread-21 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cafdb116-6343-4e2c-92b3-add1746d2cef&page=queryresults
[0m12:11:52.967679 [debug] [Thread-6  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:45902781-08c2-4f91-ba9f-24759bea67c2&page=queryresults
[0m12:11:52.974092 [debug] [Thread-32 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c829662a-066c-495f-a526-1acc6da76ae1&page=queryresults
[0m12:11:52.974423 [debug] [Thread-28 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:78cb2bcd-0b40-4f81-8da9-fd110a3701cc&page=queryresults
[0m12:11:52.981860 [debug] [Thread-31 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:72ecf9bf-c57e-45bb-96c6-ad74b4689539&page=queryresults
[0m12:11:52.982565 [debug] [Thread-26 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4dbefdba-ffb0-40bd-9eb9-31a1fb13c7ba&page=queryresults
[0m12:11:53.075580 [debug] [Thread-27 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b3c93fe4-baa1-4b2f-8790-52ac3c52b883&page=queryresults
[0m12:11:53.234895 [debug] [Thread-31 ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/72ecf9bf-c57e-45bb-96c6-ad74b4689539?maxResults=0&location=US&prettyPrint=false: Unrecognized name: adj_close at [16:5]')
[0m12:11:54.101284 [debug] [Thread-31 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f148950b-f5aa-4cee-af60-86b9ca9f68e2&page=queryresults
[0m12:11:54.259311 [error] [Thread-31 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f148950b-f5aa-4cee-af60-86b9ca9f68e2&page=queryresults
[0m12:11:54.302692 [debug] [Thread-31 ]: Database Error in model base_spy_2014_2024 (models/1_base/base_spy_2014_2024.sql)
  Unrecognized name: adj_close at [16:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_spy_2014_2024.sql
[0m12:11:54.303956 [debug] [Thread-31 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c272fa0>]}
[0m12:11:54.304414 [error] [Thread-31 ]: 31 of 78 ERROR creating sql table model stock_analysis.base_spy_2014_2024 ...... [[31mERROR[0m in 4.24s]
[0m12:11:54.304815 [debug] [Thread-31 ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:11:54.305080 [debug] [Thread-31 ]: Began running node model.stock_analysis.base_tmo_1993_2024
[0m12:11:54.305538 [info ] [Thread-31 ]: 33 of 78 START sql table model stock_analysis.base_tmo_1993_2024 ............... [RUN]
[0m12:11:54.306022 [debug] [Thread-31 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.base_tmo_1993_2024)
[0m12:11:54.306287 [debug] [Thread-31 ]: Began compiling node model.stock_analysis.base_tmo_1993_2024
[0m12:11:54.309144 [debug] [Thread-31 ]: Writing injected SQL for node "model.stock_analysis.base_tmo_1993_2024"
[0m12:11:54.309638 [debug] [Thread-31 ]: Began executing node model.stock_analysis.base_tmo_1993_2024
[0m12:11:54.311621 [debug] [Thread-31 ]: Opening a new connection, currently in state closed
[0m12:11:54.785999 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c238ca0>]}
[0m12:11:54.786513 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c255100>]}
[0m12:11:54.789387 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c238280>]}
[0m12:11:54.789855 [info ] [Thread-12 ]: 12 of 78 OK created sql table model stock_analysis.base_cvx_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 4.74s]
[0m12:11:54.790358 [info ] [Thread-2  ]: 2 of 78 OK created sql table model stock_analysis.base_abbv_2013_2024 .......... [[32mCREATE TABLE (2.9k rows, 160.6 KiB processed)[0m in 4.76s]
[0m12:11:54.790889 [info ] [Thread-4  ]: 4 of 78 OK created sql table model stock_analysis.base_amd_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 4.76s]
[0m12:11:54.791349 [debug] [Thread-12 ]: Finished running node model.stock_analysis.base_cvx_1993_2024
[0m12:11:54.791830 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_abbv_2013_2024
[0m12:11:54.792423 [debug] [Thread-4  ]: Finished running node model.stock_analysis.base_amd_1993_2024
[0m12:11:54.792851 [debug] [Thread-12 ]: Began running node model.stock_analysis.base_tsla_2010_2024
[0m12:11:54.793209 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_unh_1993_2024
[0m12:11:54.793563 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_v_1993_2024
[0m12:11:54.793935 [info ] [Thread-12 ]: 34 of 78 START sql table model stock_analysis.base_tsla_2010_2024 .............. [RUN]
[0m12:11:54.794316 [info ] [Thread-2  ]: 35 of 78 START sql table model stock_analysis.base_unh_1993_2024 ............... [RUN]
[0m12:11:54.794686 [info ] [Thread-4  ]: 36 of 78 START sql table model stock_analysis.base_v_1993_2024 ................. [RUN]
[0m12:11:54.795029 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cvx_1993_2024, now model.stock_analysis.base_tsla_2010_2024)
[0m12:11:54.795308 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_abbv_2013_2024, now model.stock_analysis.base_unh_1993_2024)
[0m12:11:54.795560 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amd_1993_2024, now model.stock_analysis.base_v_1993_2024)
[0m12:11:54.795807 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.base_tsla_2010_2024
[0m12:11:54.796056 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_unh_1993_2024
[0m12:11:54.796298 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_v_1993_2024
[0m12:11:54.798749 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.base_tsla_2010_2024"
[0m12:11:54.800913 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_unh_1993_2024"
[0m12:11:54.803583 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_v_1993_2024"
[0m12:11:54.804864 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_unh_1993_2024
[0m12:11:54.805126 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_v_1993_2024
[0m12:11:54.807290 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:11:54.807665 [debug] [Thread-12 ]: Began executing node model.stock_analysis.base_tsla_2010_2024
[0m12:11:54.811655 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:11:54.813830 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m12:11:55.002470 [debug] [Thread-31 ]: Writing runtime sql for node "model.stock_analysis.base_tmo_1993_2024"
[0m12:11:55.003805 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c248b20>]}
[0m12:11:55.005066 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c255610>]}
[0m12:11:55.005852 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c238fa0>]}
[0m12:11:55.006251 [info ] [Thread-14 ]: 14 of 78 OK created sql table model stock_analysis.base_googl_2004_2024 ........ [[32mCREATE TABLE (5.0k rows, 275.8 KiB processed)[0m in 4.96s]
[0m12:11:55.009378 [info ] [Thread-3  ]: 3 of 78 OK created sql table model stock_analysis.base_adbe_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 4.98s]
[0m12:11:55.009803 [info ] [Thread-10 ]: 10 of 78 OK created sql table model stock_analysis.base_cost_1993_2024 ......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 4.96s]
[0m12:11:55.010135 [debug] [Thread-14 ]: Finished running node model.stock_analysis.base_googl_2004_2024
[0m12:11:55.010365 [debug] [Thread-31 ]: On model.stock_analysis.base_tmo_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_tmo_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_tmo_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`tmo`
    );
  
[0m12:11:55.011424 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_adbe_1993_2024
[0m12:11:55.011963 [debug] [Thread-10 ]: Finished running node model.stock_analysis.base_cost_1993_2024
[0m12:11:55.012385 [debug] [Thread-14 ]: Began running node model.stock_analysis.base_wmt_1993_2024
[0m12:11:55.013191 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_xom_1993_2024
[0m12:11:55.013651 [info ] [Thread-14 ]: 37 of 78 START sql table model stock_analysis.base_wmt_1993_2024 ............... [RUN]
[0m12:11:55.014392 [debug] [Thread-14 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_googl_2004_2024, now model.stock_analysis.base_wmt_1993_2024)
[0m12:11:55.013999 [info ] [Thread-3  ]: 38 of 78 START sql table model stock_analysis.base_xom_1993_2024 ............... [RUN]
[0m12:11:55.014856 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.base_wmt_1993_2024
[0m12:11:55.015187 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_adbe_1993_2024, now model.stock_analysis.base_xom_1993_2024)
[0m12:11:55.017436 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.base_wmt_1993_2024"
[0m12:11:55.017683 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_xom_1993_2024
[0m12:11:55.019426 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_xom_1993_2024"
[0m12:11:55.019829 [debug] [Thread-14 ]: Began executing node model.stock_analysis.base_wmt_1993_2024
[0m12:11:55.021523 [debug] [Thread-14 ]: Opening a new connection, currently in state closed
[0m12:11:55.021756 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_xom_1993_2024
[0m12:11:55.023545 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:11:55.163109 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c38efa0>]}
[0m12:11:55.163532 [info ] [Thread-7  ]: 7 of 78 OK created sql table model stock_analysis.base_bac_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.12s]
[0m12:11:55.163878 [debug] [Thread-7  ]: Finished running node model.stock_analysis.base_bac_1993_2024
[0m12:11:55.310666 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c263190>]}
[0m12:11:55.311620 [info ] [Thread-20 ]: 20 of 78 OK created sql table model stock_analysis.base_lly_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.26s]
[0m12:11:55.312189 [debug] [Thread-20 ]: Finished running node model.stock_analysis.base_lly_1993_2024
[0m12:11:55.393790 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c238c40>]}
[0m12:11:55.396079 [info ] [Thread-5  ]: 5 of 78 OK created sql table model stock_analysis.base_amzn_1997_2024 .......... [[32mCREATE TABLE (6.9k rows, 375.6 KiB processed)[0m in 5.36s]
[0m12:11:55.397411 [debug] [Thread-5  ]: Finished running node model.stock_analysis.base_amzn_1997_2024
[0m12:11:55.398816 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2639d0>]}
[0m12:11:55.399419 [info ] [Thread-22 ]: 22 of 78 OK created sql table model stock_analysis.base_meta_2012_2024 ......... [[32mCREATE TABLE (3.1k rows, 169.0 KiB processed)[0m in 5.35s]
[0m12:11:55.399925 [debug] [Thread-22 ]: Finished running node model.stock_analysis.base_meta_2012_2024
[0m12:11:55.413594 [debug] [Thread-31 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:243c8bf2-34ff-4121-9ac1-80c5376b76d5&page=queryresults
[0m12:11:55.418439 [debug] [Thread-32 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c281280>]}
[0m12:11:55.418951 [info ] [Thread-32 ]: 32 of 78 OK created sql table model stock_analysis.base_symbols_meta ........... [[32mCREATE TABLE (8.0k rows, 0 processed)[0m in 5.36s]
[0m12:11:55.419458 [debug] [Thread-32 ]: Finished running node model.stock_analysis.base_symbols_meta
[0m12:11:55.420197 [debug] [Thread-10 ]: Began running node model.stock_analysis.stg_symbols_meta
[0m12:11:55.420930 [info ] [Thread-10 ]: 39 of 78 START sql table model stock_analysis.stg_symbols_meta ................. [RUN]
[0m12:11:55.421322 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cost_1993_2024, now model.stock_analysis.stg_symbols_meta)
[0m12:11:55.422599 [debug] [Thread-26 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c272490>]}
[0m12:11:55.423417 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m12:11:55.426462 [debug] [Thread-15 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c255700>]}
[0m12:11:55.427020 [info ] [Thread-26 ]: 26 of 78 OK created sql table model stock_analysis.base_nvda_1999_2024 ......... [[32mCREATE TABLE (6.4k rows, 352.4 KiB processed)[0m in 5.37s]
[0m12:11:55.430775 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m12:11:55.432073 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c248280>]}
[0m12:11:55.433972 [debug] [Thread-29 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c272d90>]}
[0m12:11:55.434486 [info ] [Thread-15 ]: 15 of 78 OK created sql table model stock_analysis.base_hd_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.38s]
[0m12:11:55.434968 [debug] [Thread-26 ]: Finished running node model.stock_analysis.base_nvda_1999_2024
[0m12:11:55.436143 [info ] [Thread-8  ]: 8 of 78 OK created sql table model stock_analysis.base_brk-b_1996_2024 ......... [[32mCREATE TABLE (7.1k rows, 389.7 KiB processed)[0m in 5.39s]
[0m12:11:55.436572 [info ] [Thread-29 ]: 29 of 78 OK created sql table model stock_analysis.base_spus_2019_2024 ......... [[32mCREATE TABLE (1.2k rows, 64.7 KiB processed)[0m in 5.38s]
[0m12:11:55.437103 [debug] [Thread-15 ]: Finished running node model.stock_analysis.base_hd_1993_2024
[0m12:11:55.437982 [debug] [Thread-8  ]: Finished running node model.stock_analysis.base_brk-b_1996_2024
[0m12:11:55.438461 [debug] [Thread-29 ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m12:11:55.438823 [debug] [Thread-10 ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m12:11:55.441405 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m12:11:55.443017 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c248730>]}
[0m12:11:55.510337 [debug] [Thread-4  ]: Writing runtime sql for node "model.stock_analysis.base_v_1993_2024"
[0m12:11:55.510942 [info ] [Thread-16 ]: 16 of 78 OK created sql table model stock_analysis.base_hlal_2019_2024 ......... [[32mCREATE TABLE (1.3k rows, 70.8 KiB processed)[0m in 5.39s]
[0m12:11:55.515175 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.base_unh_1993_2024"
[0m12:11:55.516841 [debug] [Thread-12 ]: Writing runtime sql for node "model.stock_analysis.base_tsla_2010_2024"
[0m12:11:55.517535 [debug] [Thread-16 ]: Finished running node model.stock_analysis.base_hlal_2019_2024
[0m12:11:55.518537 [debug] [Thread-30 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c272940>]}
[0m12:11:55.520478 [debug] [Thread-4  ]: On model.stock_analysis.base_v_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_v_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_v_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`v`
    );
  
[0m12:11:55.521205 [debug] [Thread-2  ]: On model.stock_analysis.base_unh_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_unh_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_unh_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`unh`
    );
  
[0m12:11:55.521659 [info ] [Thread-30 ]: 30 of 78 OK created sql table model stock_analysis.base_spy_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.46s]
[0m12:11:55.522604 [debug] [Thread-12 ]: On model.stock_analysis.base_tsla_2010_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_tsla_2010_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_tsla_2010_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`tsla`
    );
  
[0m12:11:55.523122 [debug] [Thread-30 ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m12:11:55.562746 [debug] [Thread-14 ]: Writing runtime sql for node "model.stock_analysis.base_wmt_1993_2024"
[0m12:11:55.563375 [debug] [Thread-14 ]: On model.stock_analysis.base_wmt_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_wmt_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_wmt_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`wmt`
    );
  
[0m12:11:55.572273 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.base_xom_1993_2024"
[0m12:11:55.572687 [debug] [Thread-3  ]: On model.stock_analysis.base_xom_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_xom_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_xom_1993_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , adj_close
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`xom`
    );
  
[0m12:11:55.655767 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c248d60>]}
[0m12:11:55.656359 [info ] [Thread-11 ]: 11 of 78 OK created sql table model stock_analysis.base_crm_2004_2024 .......... [[32mCREATE TABLE (5.1k rows, 278.0 KiB processed)[0m in 5.61s]
[0m12:11:55.656850 [debug] [Thread-11 ]: Finished running node model.stock_analysis.base_crm_2004_2024
[0m12:11:55.664619 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2633a0>]}
[0m12:11:55.665160 [info ] [Thread-19 ]: 19 of 78 OK created sql table model stock_analysis.base_ko_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.61s]
[0m12:11:55.665610 [debug] [Thread-19 ]: Finished running node model.stock_analysis.base_ko_1993_2024
[0m12:11:55.678586 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c238400>]}
[0m12:11:55.679214 [info ] [Thread-6  ]: 6 of 78 OK created sql table model stock_analysis.base_avgo_2009_2024 .......... [[32mCREATE TABLE (3.8k rows, 207.4 KiB processed)[0m in 5.64s]
[0m12:11:55.679905 [debug] [Thread-6  ]: Finished running node model.stock_analysis.base_avgo_2009_2024
[0m12:11:55.726070 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c263760>]}
[0m12:11:55.726724 [info ] [Thread-21 ]: 21 of 78 OK created sql table model stock_analysis.base_ma_2006_2024 ........... [[32mCREATE TABLE (4.6k rows, 251.5 KiB processed)[0m in 5.67s]
[0m12:11:55.727295 [debug] [Thread-21 ]: Finished running node model.stock_analysis.base_ma_2006_2024
[0m12:11:55.766232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2387c0>]}
[0m12:11:55.781756 [debug] [Thread-27 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2725e0>]}
[0m12:11:55.831438 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b7305286-3a74-4bbc-b8e0-3a2bc25dbf00&page=queryresults
[0m12:11:55.855441 [debug] [Thread-12 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b72a5500-cbe2-496e-84b3-7dba54421322&page=queryresults
[0m12:11:55.863087 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cd0ee6a3-f1cf-4d73-9249-73e93f23db27&page=queryresults
[0m12:11:55.892091 [debug] [Thread-14 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a77b7052-9b03-4218-8597-763f8fc15af9&page=queryresults
[0m12:11:55.906738 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:45b6e179-952b-4d48-849d-4e26a2fc73bf&page=queryresults
[0m12:11:56.003217 [debug] [Thread-10 ]: Writing runtime sql for node "model.stock_analysis.stg_symbols_meta"
[0m12:11:56.004706 [debug] [Thread-10 ]: On model.stock_analysis.stg_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_symbols_meta`
      
    
    

    OPTIONS()
    as (
      with 

symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`base_symbols_meta` )

select 
    symbol
    , security_name
    , listing_exchange
    , market_category
    , is_ETF
from symbols_meta
    );
  
[0m12:11:56.008548 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c255280>]}
[0m12:11:56.012548 [debug] [Thread-23 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cc6fcd0>]}
[0m12:11:56.251669 [debug] [Thread-24 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4c76d0>]}
[0m12:11:56.254702 [debug] [Thread-28 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c255d60>]}
[0m12:11:56.268711 [debug] [Thread-25 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4dc7c0>]}
[0m12:11:56.285787 [info ] [Thread-1  ]: 1 of 78 OK created sql table model stock_analysis.base_aapl_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.74s]
[0m12:11:56.286666 [info ] [Thread-27 ]: 27 of 78 OK created sql table model stock_analysis.base_pep_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.73s]
[0m12:11:56.289194 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_aapl_1993_2024
[0m12:11:56.287440 [info ] [Thread-13 ]: 13 of 78 OK created sql table model stock_analysis.base_goog_2004_2024 ......... [[32mCREATE TABLE (5.0k rows, 275.8 KiB processed)[0m in 5.96s]
[0m12:11:56.291530 [debug] [Thread-27 ]: Finished running node model.stock_analysis.base_pep_1993_2024
[0m12:11:56.288183 [info ] [Thread-23 ]: 23 of 78 OK created sql table model stock_analysis.base_mrk_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 5.96s]
[0m12:11:56.289979 [info ] [Thread-24 ]: 24 of 78 OK created sql table model stock_analysis.base_msft_1993_2024 ......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 6.20s]
[0m12:11:56.290801 [info ] [Thread-28 ]: 28 of 78 OK created sql table model stock_analysis.base_pg_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 6.20s]
[0m12:11:56.293489 [debug] [Thread-13 ]: Finished running node model.stock_analysis.base_goog_2004_2024
[0m12:11:56.292173 [info ] [Thread-25 ]: 25 of 78 OK created sql table model stock_analysis.base_nflx_1993_2024 ......... [[32mCREATE TABLE (5.6k rows, 306.6 KiB processed)[0m in 6.21s]
[0m12:11:56.294435 [debug] [Thread-23 ]: Finished running node model.stock_analysis.base_mrk_1993_2024
[0m12:11:56.295097 [debug] [Thread-24 ]: Finished running node model.stock_analysis.base_msft_1993_2024
[0m12:11:56.295704 [debug] [Thread-28 ]: Finished running node model.stock_analysis.base_pg_1993_2024
[0m12:11:56.296456 [debug] [Thread-25 ]: Finished running node model.stock_analysis.base_nflx_1993_2024
[0m12:11:56.305981 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c255c10>]}
[0m12:11:56.308087 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c255a00>]}
[0m12:11:56.308938 [info ] [Thread-18 ]: 18 of 78 OK created sql table model stock_analysis.base_jpm_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 6.26s]
[0m12:11:56.309784 [info ] [Thread-17 ]: 17 of 78 OK created sql table model stock_analysis.base_jnj_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 6.26s]
[0m12:11:56.310536 [debug] [Thread-18 ]: Finished running node model.stock_analysis.base_jpm_1993_2024
[0m12:11:56.311207 [debug] [Thread-17 ]: Finished running node model.stock_analysis.base_jnj_1993_2024
[0m12:11:56.416932 [debug] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:586f4a53-956e-46a3-92a9-6640bd1ad380&page=queryresults
[0m12:11:56.914085 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c42d4f0>]}
[0m12:11:56.916339 [info ] [Thread-9  ]: 9 of 78 OK created sql table model stock_analysis.base_calendar ................ [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 6.87s]
[0m12:11:56.917688 [debug] [Thread-9  ]: Finished running node model.stock_analysis.base_calendar
[0m12:11:56.918797 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_calendar
[0m12:11:56.919591 [info ] [Thread-20 ]: 40 of 78 START sql table model stock_analysis.stg_calendar ..................... [RUN]
[0m12:11:56.920163 [debug] [Thread-20 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_lly_1993_2024, now model.stock_analysis.stg_calendar)
[0m12:11:56.920545 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_calendar
[0m12:11:56.925177 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m12:11:56.928319 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_calendar
[0m12:11:56.931070 [debug] [Thread-20 ]: Opening a new connection, currently in state closed
[0m12:11:57.398784 [debug] [Thread-20 ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m12:11:57.401625 [debug] [Thread-20 ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , concat(base.year_full,'-',base.week_number) as year_week
    , concat(base.year_full,'-',base.month_abbrev,'-',base.week_number) as year_month_week
    , concat(base.year_full,'-',base.month_abbrev) as year_month

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m12:11:57.548676 [debug] [Thread-31 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c234580>]}
[0m12:11:57.549876 [info ] [Thread-31 ]: 33 of 78 OK created sql table model stock_analysis.base_tmo_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 3.24s]
[0m12:11:57.550759 [debug] [Thread-31 ]: Finished running node model.stock_analysis.base_tmo_1993_2024
[0m12:11:57.730234 [debug] [Thread-20 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3a6e0d07-2dd4-4fca-9d5b-77e1eb0008ba&page=queryresults
[0m12:11:57.741351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4ff0d0>]}
[0m12:11:57.742287 [info ] [Thread-3  ]: 38 of 78 OK created sql table model stock_analysis.base_xom_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 2.73s]
[0m12:11:57.743043 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_xom_1993_2024
[0m12:11:57.931274 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c56cd60>]}
[0m12:11:57.932647 [info ] [Thread-12 ]: 34 of 78 OK created sql table model stock_analysis.base_tsla_2010_2024 ......... [[32mCREATE TABLE (3.6k rows, 195.1 KiB processed)[0m in 3.14s]
[0m12:11:57.933427 [debug] [Thread-12 ]: Finished running node model.stock_analysis.base_tsla_2010_2024
[0m12:11:57.979910 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c90a700>]}
[0m12:11:57.981968 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14caefb80>]}
[0m12:11:57.983338 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c6c8220>]}
[0m12:11:57.984014 [info ] [Thread-4  ]: 36 of 78 OK created sql table model stock_analysis.base_v_1993_2024 ............ [[32mCREATE TABLE (4.1k rows, 226.5 KiB processed)[0m in 3.18s]
[0m12:11:57.984661 [info ] [Thread-14 ]: 37 of 78 OK created sql table model stock_analysis.base_wmt_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 2.97s]
[0m12:11:57.985164 [info ] [Thread-2  ]: 35 of 78 OK created sql table model stock_analysis.base_unh_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 435.0 KiB processed)[0m in 3.19s]
[0m12:11:57.985878 [debug] [Thread-4  ]: Finished running node model.stock_analysis.base_v_1993_2024
[0m12:11:57.986360 [debug] [Thread-14 ]: Finished running node model.stock_analysis.base_wmt_1993_2024
[0m12:11:57.986823 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_unh_1993_2024
[0m12:11:58.563359 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c281040>]}
[0m12:11:58.564928 [info ] [Thread-10 ]: 39 of 78 OK created sql table model stock_analysis.stg_symbols_meta ............ [[32mCREATE TABLE (8.0k rows, 495.2 KiB processed)[0m in 3.14s]
[0m12:11:58.566442 [debug] [Thread-10 ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m12:12:03.752378 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2315b0>]}
[0m12:12:03.753939 [info ] [Thread-20 ]: 40 of 78 OK created sql table model stock_analysis.stg_calendar ................ [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 6.83s]
[0m12:12:03.754902 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_calendar
[0m12:12:03.759123 [debug] [Thread-22 ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m12:12:03.759963 [debug] [Thread-32 ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m12:12:03.760586 [debug] [Thread-7  ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m12:12:03.761162 [debug] [Thread-26 ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m12:12:03.762490 [debug] [Thread-15 ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m12:12:03.761996 [info ] [Thread-22 ]: 41 of 78 START sql table model stock_analysis.stg_aapl_1993_2024 ............... [RUN]
[0m12:12:03.763087 [debug] [Thread-8  ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m12:12:03.763983 [debug] [Thread-29 ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m12:12:03.763600 [info ] [Thread-32 ]: 42 of 78 START sql table model stock_analysis.stg_abbv_2013_2024 ............... [RUN]
[0m12:12:03.764551 [debug] [Thread-16 ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m12:12:03.765049 [info ] [Thread-7  ]: 43 of 78 START sql table model stock_analysis.stg_adbe_1993_2024 ............... [RUN]
[0m12:12:03.765535 [debug] [Thread-30 ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m12:12:03.766018 [info ] [Thread-26 ]: 44 of 78 START sql table model stock_analysis.stg_amd_1993_2024 ................ [RUN]
[0m12:12:03.766488 [debug] [Thread-11 ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m12:12:03.766981 [info ] [Thread-15 ]: 45 of 78 START sql table model stock_analysis.stg_amzn_1997_2024 ............... [RUN]
[0m12:12:03.767436 [debug] [Thread-19 ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m12:12:03.767901 [debug] [Thread-22 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_meta_2012_2024, now model.stock_analysis.stg_aapl_1993_2024)
[0m12:12:03.768304 [debug] [Thread-6  ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m12:12:03.768894 [debug] [Thread-21 ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m12:12:03.769874 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m12:12:03.769486 [info ] [Thread-8  ]: 46 of 78 START sql table model stock_analysis.stg_avgo_2009_2024 ............... [RUN]
[0m12:12:03.770499 [debug] [Thread-27 ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m12:12:03.771008 [info ] [Thread-29 ]: 47 of 78 START sql table model stock_analysis.stg_bac_1993_2024 ................ [RUN]
[0m12:12:03.771464 [debug] [Thread-13 ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m12:12:03.771883 [debug] [Thread-23 ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m12:12:03.772322 [debug] [Thread-32 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_symbols_meta, now model.stock_analysis.stg_abbv_2013_2024)
[0m12:12:03.772726 [debug] [Thread-24 ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m12:12:03.775513 [debug] [Thread-28 ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m12:12:03.775971 [debug] [Thread-25 ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m12:12:03.776771 [debug] [Thread-18 ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m12:12:03.777222 [debug] [Thread-17 ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m12:12:03.776444 [info ] [Thread-16 ]: 48 of 78 START sql table model stock_analysis.stg_brk-b_1996_2024 .............. [RUN]
[0m12:12:03.777673 [debug] [Thread-9  ]: Began running node model.stock_analysis.stg_msft_1993_2024
[0m12:12:03.778055 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_bac_1993_2024, now model.stock_analysis.stg_adbe_1993_2024)
[0m12:12:03.778390 [debug] [Thread-5  ]: Began running node model.stock_analysis.stg_nflx_1993_2024
[0m12:12:03.778764 [debug] [Thread-31 ]: Began running node model.stock_analysis.stg_nvda_1999_2024
[0m12:12:03.779134 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_pep_1993_2024
[0m12:12:03.779560 [info ] [Thread-30 ]: 49 of 78 START sql table model stock_analysis.stg_cost_1993_2024 ............... [RUN]
[0m12:12:03.779970 [debug] [Thread-12 ]: Began running node model.stock_analysis.stg_pg_1993_2024
[0m12:12:03.780385 [debug] [Thread-26 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nvda_1999_2024, now model.stock_analysis.stg_amd_1993_2024)
[0m12:12:03.780719 [debug] [Thread-4  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m12:12:03.781098 [debug] [Thread-14 ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m12:12:03.781545 [info ] [Thread-11 ]: 50 of 78 START sql table model stock_analysis.stg_crm_2004_2024 ................ [RUN]
[0m12:12:03.781952 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:12:03.782258 [debug] [Thread-10 ]: Began running node model.stock_analysis.stg_tmo_1993_2024
[0m12:12:03.782566 [debug] [Thread-15 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_hd_1993_2024, now model.stock_analysis.stg_amzn_1997_2024)
[0m12:12:03.782916 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_tsla_2010_2024
[0m12:12:03.783344 [info ] [Thread-19 ]: 51 of 78 START sql table model stock_analysis.stg_cvx_1993_2024 ................ [RUN]
[0m12:12:03.783752 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.stg_aapl_1993_2024
[0m12:12:03.784142 [info ] [Thread-6  ]: 52 of 78 START sql table model stock_analysis.stg_goog_2004_2024 ............... [RUN]
[0m12:12:03.784655 [info ] [Thread-21 ]: 53 of 78 START sql table model stock_analysis.stg_googl_2004_2024 .............. [RUN]
[0m12:12:03.785121 [info ] [Thread-1  ]: 54 of 78 START sql table model stock_analysis.stg_hd_1993_2024 ................. [RUN]
[0m12:12:03.785527 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_brk-b_1996_2024, now model.stock_analysis.stg_avgo_2009_2024)
[0m12:12:03.785922 [info ] [Thread-27 ]: 55 of 78 START sql table model stock_analysis.stg_hlal_2019_2024 ............... [RUN]
[0m12:12:03.786284 [debug] [Thread-29 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spus_2019_2024, now model.stock_analysis.stg_bac_1993_2024)
[0m12:12:03.786664 [info ] [Thread-13 ]: 56 of 78 START sql table model stock_analysis.stg_jnj_1993_2024 ................ [RUN]
[0m12:12:03.787054 [info ] [Thread-23 ]: 57 of 78 START sql table model stock_analysis.stg_jpm_1993_2024 ................ [RUN]
[0m12:12:03.787359 [debug] [Thread-32 ]: Began compiling node model.stock_analysis.stg_abbv_2013_2024
[0m12:12:03.787739 [info ] [Thread-24 ]: 58 of 78 START sql table model stock_analysis.stg_ko_1993_2024 ................. [RUN]
[0m12:12:03.788106 [info ] [Thread-28 ]: 59 of 78 START sql table model stock_analysis.stg_lly_1993_2024 ................ [RUN]
[0m12:12:03.788466 [info ] [Thread-25 ]: 60 of 78 START sql table model stock_analysis.stg_ma_2006_2024 ................. [RUN]
[0m12:12:03.788824 [info ] [Thread-18 ]: 61 of 78 START sql table model stock_analysis.stg_meta_2012_2024 ............... [RUN]
[0m12:12:03.789258 [info ] [Thread-17 ]: 62 of 78 START sql table model stock_analysis.stg_mrk_1993_2024 ................ [RUN]
[0m12:12:03.789719 [debug] [Thread-16 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_hlal_2019_2024, now model.stock_analysis.stg_brk-b_1996_2024)
[0m12:12:03.790093 [info ] [Thread-9  ]: 63 of 78 START sql table model stock_analysis.stg_msft_1993_2024 ............... [RUN]
[0m12:12:03.790389 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.stg_adbe_1993_2024
[0m12:12:03.790734 [info ] [Thread-5  ]: 64 of 78 START sql table model stock_analysis.stg_nflx_1993_2024 ............... [RUN]
[0m12:12:03.791089 [info ] [Thread-31 ]: 65 of 78 START sql table model stock_analysis.stg_nvda_1999_2024 ............... [RUN]
[0m12:12:03.791524 [info ] [Thread-3  ]: 66 of 78 START sql table model stock_analysis.stg_pep_1993_2024 ................ [RUN]
[0m12:12:03.791980 [debug] [Thread-30 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_1993_2024, now model.stock_analysis.stg_cost_1993_2024)
[0m12:12:03.792386 [info ] [Thread-12 ]: 67 of 78 START sql table model stock_analysis.stg_pg_1993_2024 ................. [RUN]
[0m12:12:03.792734 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.stg_amd_1993_2024
[0m12:12:03.793116 [info ] [Thread-4  ]: 68 of 78 START sql table model stock_analysis.stg_spus_2019_2024 ............... [RUN]
[0m12:12:03.793511 [info ] [Thread-14 ]: 69 of 78 START sql table model stock_analysis.stg_spy_1993_2024 ................ [RUN]
[0m12:12:03.793859 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_crm_2004_2024, now model.stock_analysis.stg_crm_2004_2024)
[0m12:12:03.794152 [info ] [Thread-2  ]: 70 of 78 SKIP relation stock_analysis.stg_spy_2014_2024 ........................ [[33mSKIP[0m]
[0m12:12:03.794560 [info ] [Thread-10 ]: 71 of 78 START sql table model stock_analysis.stg_tmo_1993_2024 ................ [RUN]
[0m12:12:03.794857 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.stg_amzn_1997_2024
[0m12:12:03.795169 [info ] [Thread-20 ]: 72 of 78 START sql table model stock_analysis.stg_tsla_2010_2024 ............... [RUN]
[0m12:12:03.795493 [debug] [Thread-19 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ko_1993_2024, now model.stock_analysis.stg_cvx_1993_2024)
[0m12:12:03.798937 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.stg_aapl_1993_2024"
[0m12:12:03.799278 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_avgo_2009_2024, now model.stock_analysis.stg_goog_2004_2024)
[0m12:12:03.799565 [debug] [Thread-21 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ma_2006_2024, now model.stock_analysis.stg_googl_2004_2024)
[0m12:12:03.799847 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_aapl_1993_2024, now model.stock_analysis.stg_hd_1993_2024)
[0m12:12:03.800106 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.stg_avgo_2009_2024
[0m12:12:03.800486 [debug] [Thread-27 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pep_1993_2024, now model.stock_analysis.stg_hlal_2019_2024)
[0m12:12:03.800805 [debug] [Thread-29 ]: Began compiling node model.stock_analysis.stg_bac_1993_2024
[0m12:12:03.801144 [debug] [Thread-13 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_goog_2004_2024, now model.stock_analysis.stg_jnj_1993_2024)
[0m12:12:03.801415 [debug] [Thread-23 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_mrk_1993_2024, now model.stock_analysis.stg_jpm_1993_2024)
[0m12:12:03.804229 [debug] [Thread-32 ]: Writing injected SQL for node "model.stock_analysis.stg_abbv_2013_2024"
[0m12:12:03.804498 [debug] [Thread-24 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_msft_1993_2024, now model.stock_analysis.stg_ko_1993_2024)
[0m12:12:03.804819 [debug] [Thread-28 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pg_1993_2024, now model.stock_analysis.stg_lly_1993_2024)
[0m12:12:03.805045 [debug] [Thread-25 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nflx_1993_2024, now model.stock_analysis.stg_ma_2006_2024)
[0m12:12:03.805264 [debug] [Thread-18 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jpm_1993_2024, now model.stock_analysis.stg_meta_2012_2024)
[0m12:12:03.805468 [debug] [Thread-17 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jnj_1993_2024, now model.stock_analysis.stg_mrk_1993_2024)
[0m12:12:03.805695 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.stg_brk-b_1996_2024
[0m12:12:03.806045 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.stg_msft_1993_2024)
[0m12:12:03.808363 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.stg_adbe_1993_2024"
[0m12:12:03.808600 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amzn_1997_2024, now model.stock_analysis.stg_nflx_1993_2024)
[0m12:12:03.808915 [debug] [Thread-31 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tmo_1993_2024, now model.stock_analysis.stg_nvda_1999_2024)
[0m12:12:03.809194 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_xom_1993_2024, now model.stock_analysis.stg_pep_1993_2024)
[0m12:12:03.809420 [debug] [Thread-30 ]: Began compiling node model.stock_analysis.stg_cost_1993_2024
[0m12:12:03.809732 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tsla_2010_2024, now model.stock_analysis.stg_pg_1993_2024)
[0m12:12:03.812340 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.stg_amd_1993_2024"
[0m12:12:03.812686 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_v_1993_2024, now model.stock_analysis.stg_spus_2019_2024)
[0m12:12:03.812932 [debug] [Thread-14 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_wmt_1993_2024, now model.stock_analysis.stg_spy_1993_2024)
[0m12:12:03.813149 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.stg_crm_2004_2024
[0m12:12:03.813400 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:12:03.813604 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_symbols_meta, now model.stock_analysis.stg_tmo_1993_2024)
[0m12:12:03.815682 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.stg_amzn_1997_2024"
[0m12:12:03.815904 [debug] [Thread-20 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_tsla_2010_2024)
[0m12:12:03.816093 [debug] [Thread-19 ]: Began compiling node model.stock_analysis.stg_cvx_1993_2024
[0m12:12:03.816403 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.stg_goog_2004_2024
[0m12:12:03.816690 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.stg_googl_2004_2024
[0m12:12:03.816888 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_hd_1993_2024
[0m12:12:03.820754 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.stg_avgo_2009_2024"
[0m12:12:03.821024 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m12:12:03.823207 [debug] [Thread-29 ]: Writing injected SQL for node "model.stock_analysis.stg_bac_1993_2024"
[0m12:12:03.823471 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.stg_jnj_1993_2024
[0m12:12:03.823673 [debug] [Thread-22 ]: Began executing node model.stock_analysis.stg_aapl_1993_2024
[0m12:12:03.823867 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.stg_jpm_1993_2024
[0m12:12:03.824142 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.stg_ko_1993_2024
[0m12:12:03.824360 [debug] [Thread-28 ]: Began compiling node model.stock_analysis.stg_lly_1993_2024
[0m12:12:03.824563 [debug] [Thread-25 ]: Began compiling node model.stock_analysis.stg_ma_2006_2024
[0m12:12:03.824759 [debug] [Thread-32 ]: Began executing node model.stock_analysis.stg_abbv_2013_2024
[0m12:12:03.824922 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.stg_meta_2012_2024
[0m12:12:03.825120 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.stg_mrk_1993_2024
[0m12:12:03.827107 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m12:12:03.827308 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.stg_msft_1993_2024
[0m12:12:03.827526 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.stg_nflx_1993_2024
[0m12:12:03.827708 [debug] [Thread-31 ]: Began compiling node model.stock_analysis.stg_nvda_1999_2024
[0m12:12:03.827895 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_pep_1993_2024
[0m12:12:03.828063 [debug] [Thread-7  ]: Began executing node model.stock_analysis.stg_adbe_1993_2024
[0m12:12:03.829909 [debug] [Thread-30 ]: Writing injected SQL for node "model.stock_analysis.stg_cost_1993_2024"
[0m12:12:03.830116 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.stg_pg_1993_2024
[0m12:12:03.830320 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m12:12:03.830495 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m12:12:03.832385 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.stg_crm_2004_2024"
[0m12:12:03.832664 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_unh_1993_2024
[0m12:12:03.832876 [debug] [Thread-26 ]: Began executing node model.stock_analysis.stg_amd_1993_2024
[0m12:12:03.833036 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.stg_tmo_1993_2024
[0m12:12:03.833252 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_tsla_2010_2024
[0m12:12:03.835241 [debug] [Thread-19 ]: Writing injected SQL for node "model.stock_analysis.stg_cvx_1993_2024"
[0m12:12:03.837136 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.stg_goog_2004_2024"
[0m12:12:03.839066 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.stg_googl_2004_2024"
[0m12:12:03.839262 [debug] [Thread-15 ]: Began executing node model.stock_analysis.stg_amzn_1997_2024
[0m12:12:03.841908 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_hd_1993_2024"
[0m12:12:03.843845 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m12:12:03.845813 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.stg_jnj_1993_2024"
[0m12:12:03.847340 [debug] [Thread-22 ]: Opening a new connection, currently in state closed
[0m12:12:03.847554 [debug] [Thread-8  ]: Began executing node model.stock_analysis.stg_avgo_2009_2024
[0m12:12:03.849386 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.stg_jpm_1993_2024"
[0m12:12:03.849567 [debug] [Thread-29 ]: Began executing node model.stock_analysis.stg_bac_1993_2024
[0m12:12:03.851416 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.stg_ko_1993_2024"
[0m12:12:03.853256 [debug] [Thread-28 ]: Writing injected SQL for node "model.stock_analysis.stg_lly_1993_2024"
[0m12:12:03.855917 [debug] [Thread-25 ]: Writing injected SQL for node "model.stock_analysis.stg_ma_2006_2024"
[0m12:12:03.895584 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.stg_meta_2012_2024"
[0m12:12:03.897603 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.stg_mrk_1993_2024"
[0m12:12:03.899687 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.stg_msft_1993_2024"
[0m12:12:03.901617 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.stg_nflx_1993_2024"
[0m12:12:03.903686 [debug] [Thread-31 ]: Writing injected SQL for node "model.stock_analysis.stg_nvda_1999_2024"
[0m12:12:03.905792 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_pep_1993_2024"
[0m12:12:03.906077 [debug] [Thread-16 ]: Began executing node model.stock_analysis.stg_brk-b_1996_2024
[0m12:12:03.907543 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m12:12:03.909826 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.stg_pg_1993_2024"
[0m12:12:03.911998 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:12:03.913955 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m12:12:03.914209 [debug] [Thread-30 ]: Began executing node model.stock_analysis.stg_cost_1993_2024
[0m12:12:03.914616 [info ] [Thread-2  ]: 73 of 78 START sql table model stock_analysis.stg_unh_1993_2024 ................ [RUN]
[0m12:12:03.916123 [debug] [Thread-26 ]: Opening a new connection, currently in state closed
[0m12:12:03.918143 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.stg_tmo_1993_2024"
[0m12:12:03.918468 [debug] [Thread-11 ]: Began executing node model.stock_analysis.stg_crm_2004_2024
[0m12:12:03.920318 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_tsla_2010_2024"
[0m12:12:03.921235 [debug] [Thread-19 ]: Began executing node model.stock_analysis.stg_cvx_1993_2024
[0m12:12:03.922761 [debug] [Thread-15 ]: Opening a new connection, currently in state closed
[0m12:12:03.923044 [debug] [Thread-6  ]: Began executing node model.stock_analysis.stg_goog_2004_2024
[0m12:12:03.923972 [debug] [Thread-21 ]: Began executing node model.stock_analysis.stg_googl_2004_2024
[0m12:12:03.924422 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_hd_1993_2024
[0m12:12:03.926372 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m12:12:03.987443 [debug] [Thread-13 ]: Began executing node model.stock_analysis.stg_jnj_1993_2024
[0m12:12:03.988008 [debug] [Thread-27 ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m12:12:03.989961 [debug] [Thread-29 ]: Opening a new connection, currently in state closed
[0m12:12:03.990847 [debug] [Thread-23 ]: Began executing node model.stock_analysis.stg_jpm_1993_2024
[0m12:12:03.991171 [debug] [Thread-24 ]: Began executing node model.stock_analysis.stg_ko_1993_2024
[0m12:12:03.991423 [debug] [Thread-28 ]: Began executing node model.stock_analysis.stg_lly_1993_2024
[0m12:12:03.991881 [debug] [Thread-25 ]: Began executing node model.stock_analysis.stg_ma_2006_2024
[0m12:12:03.992342 [debug] [Thread-18 ]: Began executing node model.stock_analysis.stg_meta_2012_2024
[0m12:12:03.992922 [debug] [Thread-17 ]: Began executing node model.stock_analysis.stg_mrk_1993_2024
[0m12:12:03.999930 [debug] [Thread-32 ]: Opening a new connection, currently in state closed
[0m12:12:04.000324 [debug] [Thread-9  ]: Began executing node model.stock_analysis.stg_msft_1993_2024
[0m12:12:04.000500 [debug] [Thread-5  ]: Began executing node model.stock_analysis.stg_nflx_1993_2024
[0m12:12:04.003496 [debug] [Thread-16 ]: Opening a new connection, currently in state closed
[0m12:12:04.003816 [debug] [Thread-31 ]: Began executing node model.stock_analysis.stg_nvda_1999_2024
[0m12:12:04.004009 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_pep_1993_2024
[0m12:12:04.061979 [debug] [Thread-12 ]: Began executing node model.stock_analysis.stg_pg_1993_2024
[0m12:12:04.066484 [debug] [Thread-30 ]: Opening a new connection, currently in state closed
[0m12:12:04.066804 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_unh_1993_2024, now model.stock_analysis.stg_unh_1993_2024)
[0m12:12:04.066983 [debug] [Thread-4  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m12:12:04.067357 [debug] [Thread-14 ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m12:12:04.129241 [debug] [Thread-11 ]: Opening a new connection, currently in state closed
[0m12:12:04.131265 [debug] [Thread-19 ]: Opening a new connection, currently in state closed
[0m12:12:04.131454 [debug] [Thread-10 ]: Began executing node model.stock_analysis.stg_tmo_1993_2024
[0m12:12:04.131836 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_tsla_2010_2024
[0m12:12:04.193021 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m12:12:04.195726 [debug] [Thread-21 ]: Opening a new connection, currently in state closed
[0m12:12:04.197198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:12:04.199037 [debug] [Thread-13 ]: Opening a new connection, currently in state closed
[0m12:12:04.200564 [debug] [Thread-27 ]: Opening a new connection, currently in state closed
[0m12:12:04.262834 [debug] [Thread-23 ]: Opening a new connection, currently in state closed
[0m12:12:04.264367 [debug] [Thread-24 ]: Opening a new connection, currently in state closed
[0m12:12:04.326007 [debug] [Thread-28 ]: Opening a new connection, currently in state closed
[0m12:12:04.328272 [debug] [Thread-25 ]: Opening a new connection, currently in state closed
[0m12:12:04.329995 [debug] [Thread-18 ]: Opening a new connection, currently in state closed
[0m12:12:04.331663 [debug] [Thread-17 ]: Opening a new connection, currently in state closed
[0m12:12:04.390704 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
[0m12:12:04.395788 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m12:12:04.397460 [debug] [Thread-31 ]: Opening a new connection, currently in state closed
[0m12:12:04.459534 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:12:04.461261 [debug] [Thread-12 ]: Opening a new connection, currently in state closed
[0m12:12:04.462468 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.stg_unh_1993_2024
[0m12:12:04.527045 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:12:04.529139 [debug] [Thread-14 ]: Opening a new connection, currently in state closed
[0m12:12:04.591242 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
[0m12:12:04.654119 [debug] [Thread-20 ]: Opening a new connection, currently in state closed
[0m12:12:04.717177 [debug] [Thread-22 ]: Writing runtime sql for node "model.stock_analysis.stg_aapl_1993_2024"
[0m12:12:05.080845 [debug] [Thread-26 ]: Writing runtime sql for node "model.stock_analysis.stg_amd_1993_2024"
[0m12:12:05.084403 [debug] [Thread-7  ]: Writing runtime sql for node "model.stock_analysis.stg_adbe_1993_2024"
[0m12:12:05.147239 [debug] [Thread-15 ]: Writing runtime sql for node "model.stock_analysis.stg_amzn_1997_2024"
[0m12:12:05.271976 [debug] [Thread-29 ]: Writing runtime sql for node "model.stock_analysis.stg_bac_1993_2024"
[0m12:12:05.333792 [debug] [Thread-8  ]: Writing runtime sql for node "model.stock_analysis.stg_avgo_2009_2024"
[0m12:12:05.461444 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.stg_unh_1993_2024"
[0m12:12:05.706032 [debug] [Thread-30 ]: Writing runtime sql for node "model.stock_analysis.stg_cost_1993_2024"
[0m12:12:05.774301 [debug] [Thread-32 ]: Writing runtime sql for node "model.stock_analysis.stg_abbv_2013_2024"
[0m12:12:05.900533 [debug] [Thread-16 ]: Writing runtime sql for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m12:12:05.901617 [debug] [Thread-22 ]: On model.stock_analysis.stg_aapl_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_aapl_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_aapl_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.902430 [debug] [Thread-7  ]: On model.stock_analysis.stg_adbe_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_adbe_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_adbe_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.903109 [debug] [Thread-6  ]: Writing runtime sql for node "model.stock_analysis.stg_goog_2004_2024"
[0m12:12:05.904601 [debug] [Thread-11 ]: Writing runtime sql for node "model.stock_analysis.stg_crm_2004_2024"
[0m12:12:05.905658 [debug] [Thread-15 ]: On model.stock_analysis.stg_amzn_1997_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amzn_1997_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amzn_1997_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.906803 [debug] [Thread-26 ]: On model.stock_analysis.stg_amd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_amd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_amd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.907289 [debug] [Thread-8  ]: On model.stock_analysis.stg_avgo_2009_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_avgo_2009_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_avgo_2009_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.907918 [debug] [Thread-29 ]: On model.stock_analysis.stg_bac_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_bac_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_bac_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.908544 [debug] [Thread-2  ]: Began executing node model.stock_analysis.stg_unh_1993_2024
[0m12:12:05.908905 [debug] [Thread-30 ]: On model.stock_analysis.stg_cost_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cost_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cost_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.909485 [debug] [Thread-32 ]: On model.stock_analysis.stg_abbv_2013_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_abbv_2013_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_abbv_2013_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.910677 [debug] [Thread-16 ]: On model.stock_analysis.stg_brk-b_1996_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_brk-b_1996_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_brk-b_1996_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.912105 [debug] [Thread-11 ]: On model.stock_analysis.stg_crm_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_crm_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_crm_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.912570 [debug] [Thread-6  ]: On model.stock_analysis.stg_goog_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_goog_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_goog_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:05.916290 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:12:05.978458 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_hd_1993_2024"
[0m12:12:05.984661 [debug] [Thread-1  ]: On model.stock_analysis.stg_hd_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hd_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hd_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.045726 [debug] [Thread-21 ]: Writing runtime sql for node "model.stock_analysis.stg_googl_2004_2024"
[0m12:12:06.046411 [debug] [Thread-21 ]: On model.stock_analysis.stg_googl_2004_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_googl_2004_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_googl_2004_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.068909 [debug] [Thread-13 ]: Writing runtime sql for node "model.stock_analysis.stg_jnj_1993_2024"
[0m12:12:06.069612 [debug] [Thread-13 ]: On model.stock_analysis.stg_jnj_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jnj_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jnj_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.087948 [debug] [Thread-19 ]: Writing runtime sql for node "model.stock_analysis.stg_cvx_1993_2024"
[0m12:12:06.088635 [debug] [Thread-19 ]: On model.stock_analysis.stg_cvx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_cvx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_cvx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.134226 [debug] [Thread-24 ]: Writing runtime sql for node "model.stock_analysis.stg_ko_1993_2024"
[0m12:12:06.135066 [debug] [Thread-24 ]: On model.stock_analysis.stg_ko_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ko_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ko_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.185085 [debug] [Thread-23 ]: Writing runtime sql for node "model.stock_analysis.stg_jpm_1993_2024"
[0m12:12:06.186141 [debug] [Thread-27 ]: Writing runtime sql for node "model.stock_analysis.stg_hlal_2019_2024"
[0m12:12:06.187497 [debug] [Thread-23 ]: On model.stock_analysis.stg_jpm_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_jpm_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_jpm_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.188495 [debug] [Thread-27 ]: On model.stock_analysis.stg_hlal_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_hlal_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_hlal_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.189770 [debug] [Thread-28 ]: Writing runtime sql for node "model.stock_analysis.stg_lly_1993_2024"
[0m12:12:06.191764 [debug] [Thread-28 ]: On model.stock_analysis.stg_lly_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_lly_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_lly_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.194520 [debug] [Thread-18 ]: Writing runtime sql for node "model.stock_analysis.stg_meta_2012_2024"
[0m12:12:06.195682 [debug] [Thread-18 ]: On model.stock_analysis.stg_meta_2012_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_meta_2012_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_meta_2012_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.198511 [debug] [Thread-25 ]: Writing runtime sql for node "model.stock_analysis.stg_ma_2006_2024"
[0m12:12:06.199254 [debug] [Thread-25 ]: On model.stock_analysis.stg_ma_2006_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_ma_2006_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_ma_2006_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.203926 [debug] [Thread-17 ]: Writing runtime sql for node "model.stock_analysis.stg_mrk_1993_2024"
[0m12:12:06.204667 [debug] [Thread-17 ]: On model.stock_analysis.stg_mrk_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_mrk_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_mrk_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.239073 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_pep_1993_2024"
[0m12:12:06.240012 [debug] [Thread-3  ]: On model.stock_analysis.stg_pep_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pep_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pep_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.248092 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.stg_nflx_1993_2024"
[0m12:12:06.248925 [debug] [Thread-5  ]: On model.stock_analysis.stg_nflx_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nflx_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nflx_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.253780 [debug] [Thread-9  ]: Writing runtime sql for node "model.stock_analysis.stg_msft_1993_2024"
[0m12:12:06.254622 [debug] [Thread-9  ]: On model.stock_analysis.stg_msft_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_msft_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_msft_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.266268 [debug] [Thread-4  ]: Writing runtime sql for node "model.stock_analysis.stg_spus_2019_2024"
[0m12:12:06.267154 [debug] [Thread-4  ]: On model.stock_analysis.stg_spus_2019_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spus_2019_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024`
      
    
    

    OPTIONS()
    as (
      -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- --   DEPRACATED   -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 


with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spus_2019_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.281410 [debug] [Thread-31 ]: Writing runtime sql for node "model.stock_analysis.stg_nvda_1999_2024"
[0m12:12:06.282289 [debug] [Thread-31 ]: On model.stock_analysis.stg_nvda_1999_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nvda_1999_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_nvda_1999_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.302829 [debug] [Thread-12 ]: Writing runtime sql for node "model.stock_analysis.stg_pg_1993_2024"
[0m12:12:06.303820 [debug] [Thread-12 ]: On model.stock_analysis.stg_pg_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_pg_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_pg_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.324095 [debug] [Thread-10 ]: Writing runtime sql for node "model.stock_analysis.stg_tmo_1993_2024"
[0m12:12:06.325131 [debug] [Thread-10 ]: On model.stock_analysis.stg_tmo_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tmo_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tmo_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.358961 [debug] [Thread-14 ]: Writing runtime sql for node "model.stock_analysis.stg_spy_1993_2024"
[0m12:12:06.360488 [debug] [Thread-20 ]: Writing runtime sql for node "model.stock_analysis.stg_tsla_2010_2024"
[0m12:12:06.361315 [debug] [Thread-20 ]: On model.stock_analysis.stg_tsla_2010_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_tsla_2010_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_tsla_2010_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.362006 [debug] [Thread-14 ]: On model.stock_analysis.stg_spy_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.365977 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.stg_unh_1993_2024"
[0m12:12:06.366939 [debug] [Thread-2  ]: On model.stock_analysis.stg_unh_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_unh_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_unh_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:06.395051 [debug] [Thread-26 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d9ac205a-cbd7-4503-9918-9dc4c7112ea9&page=queryresults
[0m12:12:06.397164 [debug] [Thread-7  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1c16b342-3dfa-461e-919d-91a6fa39bbc9&page=queryresults
[0m12:12:06.400221 [debug] [Thread-15 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:58b25a0c-51ac-4113-bed6-f238dbb166f5&page=queryresults
[0m12:12:06.406315 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12a0b9dd-f83f-4b8e-a1cb-69a7256ae1b4&page=queryresults
[0m12:12:06.407398 [debug] [Thread-8  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:73b3653f-a437-44f2-96c6-329a6b546a17&page=queryresults
[0m12:12:06.411897 [debug] [Thread-22 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bc645b69-607c-4768-8c28-5778c989ec28&page=queryresults
[0m12:12:06.412300 [debug] [Thread-11 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:079d527a-2449-4f7a-82ec-d8b205c7b1e0&page=queryresults
[0m12:12:06.412664 [debug] [Thread-29 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:84a8c816-b07b-4b1f-8663-f13205b53041&page=queryresults
[0m12:12:06.413001 [debug] [Thread-30 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4d3dafce-bfe5-4cbe-9ee8-f6cd17140bef&page=queryresults
[0m12:12:06.414867 [debug] [Thread-6  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9da90ef5-4521-460a-aee8-6ae8ab0f93d8&page=queryresults
[0m12:12:06.416041 [debug] [Thread-32 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8e467d84-1fc1-4ea2-96ee-86efdc48f9a7&page=queryresults
[0m12:12:06.420261 [debug] [Thread-19 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:18faddf8-a97c-498d-a711-3e89f90713cf&page=queryresults
[0m12:12:06.430783 [debug] [Thread-13 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:007d37e3-c786-4bd7-8de6-fa7a049228b7&page=queryresults
[0m12:12:06.438066 [debug] [Thread-16 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6baa1c90-2c27-403a-9a1b-83ac169133d6&page=queryresults
[0m12:12:06.467438 [debug] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8bbb7222-f1bb-403a-af5e-5b13ffa2dc90&page=queryresults
[0m12:12:06.472737 [debug] [Thread-21 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12e8ee06-f447-4da6-9374-8491d52f6de1&page=queryresults
[0m12:12:06.517207 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a90aa9e3-4ebc-4ceb-b1e3-b91c7f2a756f&page=queryresults
[0m12:12:06.530601 [debug] [Thread-27 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1a03dd9e-c082-4564-9d11-38289f52b827&page=queryresults
[0m12:12:06.548421 [debug] [Thread-17 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bcbc6130-a47d-4224-af9f-b50729177519&page=queryresults
[0m12:12:06.567811 [debug] [Thread-28 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9cd3a94c-89cc-4d3a-a5eb-8d68bb63ef2b&page=queryresults
[0m12:12:06.572264 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7f8df8a2-1ee6-4dd6-98ed-5326cc1fb443&page=queryresults
[0m12:12:06.591997 [debug] [Thread-23 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:595db6aa-3605-40ab-abd5-c82245f6a0e1&page=queryresults
[0m12:12:06.592975 [debug] [Thread-14 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c4ad6444-dd82-493a-9ed0-90136a70055c&page=queryresults
[0m12:12:06.622997 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b73b02b0-18b6-4bad-8bfb-50bf6133684f&page=queryresults
[0m12:12:06.628715 [debug] [Thread-24 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:84fd7d30-5f30-4836-acf7-e40557c15e86&page=queryresults
[0m12:12:06.658364 [debug] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e369a9a9-f53e-4596-abe0-8a91eb6cb83c&page=queryresults
[0m12:12:06.661181 [debug] [Thread-9  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:523299f8-3257-47f1-a474-46adc65e1235&page=queryresults
[0m12:12:06.662137 [debug] [Thread-25 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:71ec3ee7-0167-4ed4-b389-e8ff5576ee33&page=queryresults
[0m12:12:06.719976 [debug] [Thread-31 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b0b1c0a8-b3c8-41d3-855e-46f4700fb924&page=queryresults
[0m12:12:06.725229 [debug] [Thread-12 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4f1e422c-32e8-4746-a9cc-c965ffa7dd30&page=queryresults
[0m12:12:06.728696 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:59294914-657f-4685-bce7-6e670d580913&page=queryresults
[0m12:12:06.751066 [debug] [Thread-20 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6f20cf16-8a77-4e72-868d-aaad20a433e5&page=queryresults
[0m12:12:33.668946 [debug] [Thread-27 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ca5fc70>]}
[0m12:12:33.670452 [info ] [Thread-27 ]: 55 of 78 OK created sql table model stock_analysis.stg_hlal_2019_2024 .......... [[32mCREATE TABLE (1.3k rows, 42.1 MiB processed)[0m in 29.87s]
[0m12:12:33.671352 [debug] [Thread-27 ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m12:12:33.672217 [debug] [Thread-27 ]: Began running node model.stock_analysis.stg_v_1993_2024
[0m12:12:33.673417 [info ] [Thread-27 ]: 74 of 78 START sql table model stock_analysis.stg_v_1993_2024 .................. [RUN]
[0m12:12:33.674242 [debug] [Thread-27 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hlal_2019_2024, now model.stock_analysis.stg_v_1993_2024)
[0m12:12:33.674786 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.stg_v_1993_2024
[0m12:12:33.680713 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.stg_v_1993_2024"
[0m12:12:33.681866 [debug] [Thread-27 ]: Began executing node model.stock_analysis.stg_v_1993_2024
[0m12:12:33.685449 [debug] [Thread-27 ]: Opening a new connection, currently in state closed
[0m12:12:34.206331 [debug] [Thread-27 ]: Writing runtime sql for node "model.stock_analysis.stg_v_1993_2024"
[0m12:12:34.210620 [debug] [Thread-27 ]: On model.stock_analysis.stg_v_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_v_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_v_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_v_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:34.553561 [debug] [Thread-27 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:49584e86-ffa4-4230-914a-1060c20ab096&page=queryresults
[0m12:12:39.011222 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c29d0d0>]}
[0m12:12:39.012258 [info ] [Thread-4  ]: 68 of 78 OK created sql table model stock_analysis.stg_spus_2019_2024 .......... [[32mCREATE TABLE (1.2k rows, 42.1 MiB processed)[0m in 35.20s]
[0m12:12:39.013010 [debug] [Thread-4  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m12:12:39.013515 [debug] [Thread-4  ]: Began running node model.stock_analysis.stg_wmt_1993_2024
[0m12:12:39.014207 [info ] [Thread-4  ]: 75 of 78 START sql table model stock_analysis.stg_wmt_1993_2024 ................ [RUN]
[0m12:12:39.014819 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spus_2019_2024, now model.stock_analysis.stg_wmt_1993_2024)
[0m12:12:39.015249 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.stg_wmt_1993_2024
[0m12:12:39.020210 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.stg_wmt_1993_2024"
[0m12:12:39.021260 [debug] [Thread-4  ]: Began executing node model.stock_analysis.stg_wmt_1993_2024
[0m12:12:39.024415 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:12:39.521079 [debug] [Thread-4  ]: Writing runtime sql for node "model.stock_analysis.stg_wmt_1993_2024"
[0m12:12:39.523387 [debug] [Thread-4  ]: On model.stock_analysis.stg_wmt_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_wmt_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_wmt_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:12:39.931497 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9e8788ed-3ff4-4d05-b927-8eb9e5339217&page=queryresults
[0m12:13:05.284414 [debug] [Thread-32 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4ff0d0>]}
[0m12:13:05.286842 [info ] [Thread-32 ]: 42 of 78 OK created sql table model stock_analysis.stg_abbv_2013_2024 .......... [[32mCREATE TABLE (2.9k rows, 42.1 MiB processed)[0m in 61.51s]
[0m12:13:05.287923 [debug] [Thread-32 ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m12:13:05.288771 [debug] [Thread-32 ]: Began running node model.stock_analysis.stg_xom_1993_2024
[0m12:13:05.289888 [info ] [Thread-32 ]: 76 of 78 START sql table model stock_analysis.stg_xom_1993_2024 ................ [RUN]
[0m12:13:05.290591 [debug] [Thread-32 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_abbv_2013_2024, now model.stock_analysis.stg_xom_1993_2024)
[0m12:13:05.291033 [debug] [Thread-32 ]: Began compiling node model.stock_analysis.stg_xom_1993_2024
[0m12:13:05.301696 [debug] [Thread-32 ]: Writing injected SQL for node "model.stock_analysis.stg_xom_1993_2024"
[0m12:13:05.304275 [debug] [Thread-32 ]: Began executing node model.stock_analysis.stg_xom_1993_2024
[0m12:13:05.307628 [debug] [Thread-32 ]: Opening a new connection, currently in state closed
[0m12:13:05.769775 [debug] [Thread-32 ]: Writing runtime sql for node "model.stock_analysis.stg_xom_1993_2024"
[0m12:13:05.772547 [debug] [Thread-32 ]: On model.stock_analysis.stg_xom_1993_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_xom_1993_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_xom_1993_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, yearly_price as 
(
    select 
        year_full
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join yearly_price using (year_full)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m12:13:06.145989 [debug] [Thread-32 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:95a908c5-02eb-4a5e-b741-65dc71ff7b0f&page=queryresults
[0m12:13:23.731288 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c38b130>]}
[0m12:13:23.732932 [info ] [Thread-18 ]: 61 of 78 OK created sql table model stock_analysis.stg_meta_2012_2024 .......... [[32mCREATE TABLE (3.1k rows, 42.2 MiB processed)[0m in 79.93s]
[0m12:13:23.734133 [debug] [Thread-18 ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m12:13:36.950616 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c45fa30>]}
[0m12:13:36.951842 [info ] [Thread-20 ]: 72 of 78 OK created sql table model stock_analysis.stg_tsla_2010_2024 .......... [[32mCREATE TABLE (3.6k rows, 42.2 MiB processed)[0m in 93.13s]
[0m12:13:36.954055 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_tsla_2010_2024
[0m12:13:46.526082 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2f74f0>]}
[0m12:13:46.527722 [info ] [Thread-5  ]: 64 of 78 OK created sql table model stock_analysis.stg_nflx_1993_2024 .......... [[32mCREATE TABLE (5.6k rows, 42.3 MiB processed)[0m in 102.72s]
[0m12:13:46.529088 [debug] [Thread-5  ]: Finished running node model.stock_analysis.stg_nflx_1993_2024
[0m12:13:55.062207 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c568bb0>]}
[0m12:13:55.064551 [info ] [Thread-21 ]: 53 of 78 OK created sql table model stock_analysis.stg_googl_2004_2024 ......... [[32mCREATE TABLE (5.0k rows, 42.3 MiB processed)[0m in 111.26s]
[0m12:13:55.065529 [debug] [Thread-21 ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m12:13:55.430172 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cbe8250>]}
[0m12:13:55.431878 [info ] [Thread-8  ]: 46 of 78 OK created sql table model stock_analysis.stg_avgo_2009_2024 .......... [[32mCREATE TABLE (3.8k rows, 42.2 MiB processed)[0m in 111.64s]
[0m12:13:55.432988 [debug] [Thread-8  ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m12:13:56.209058 [debug] [Thread-25 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c625b50>]}
[0m12:13:56.209780 [info ] [Thread-25 ]: 60 of 78 OK created sql table model stock_analysis.stg_ma_2006_2024 ............ [[32mCREATE TABLE (4.6k rows, 42.2 MiB processed)[0m in 112.40s]
[0m12:13:56.210394 [debug] [Thread-25 ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m12:13:56.297124 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c0f35e0>]}
[0m12:13:56.297685 [info ] [Thread-6  ]: 52 of 78 OK created sql table model stock_analysis.stg_goog_2004_2024 .......... [[32mCREATE TABLE (5.0k rows, 42.3 MiB processed)[0m in 112.50s]
[0m12:13:56.298078 [debug] [Thread-6  ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m12:14:11.637571 [debug] [Thread-27 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cb1bee0>]}
[0m12:14:11.638906 [info ] [Thread-27 ]: 74 of 78 OK created sql table model stock_analysis.stg_v_1993_2024 ............. [[32mCREATE TABLE (4.1k rows, 42.2 MiB processed)[0m in 97.96s]
[0m12:14:11.639867 [debug] [Thread-27 ]: Finished running node model.stock_analysis.stg_v_1993_2024
[0m12:14:15.448307 [debug] [Thread-11 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5193a0>]}
[0m12:14:15.449696 [info ] [Thread-11 ]: 50 of 78 OK created sql table model stock_analysis.stg_crm_2004_2024 ........... [[32mCREATE TABLE (5.1k rows, 42.3 MiB processed)[0m in 131.65s]
[0m12:14:15.450640 [debug] [Thread-11 ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m12:14:18.749783 [debug] [Thread-31 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2f7d90>]}
[0m12:14:19.037499 [info ] [Thread-31 ]: 65 of 78 OK created sql table model stock_analysis.stg_nvda_1999_2024 .......... [[32mCREATE TABLE (6.4k rows, 42.3 MiB processed)[0m in 134.94s]
[0m12:14:19.039235 [debug] [Thread-31 ]: Finished running node model.stock_analysis.stg_nvda_1999_2024
[0m12:14:22.540492 [debug] [Thread-29 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cbe8af0>]}
[0m12:14:22.542287 [info ] [Thread-29 ]: 47 of 78 OK created sql table model stock_analysis.stg_bac_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 138.75s]
[0m12:14:22.543618 [debug] [Thread-29 ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m12:14:23.643979 [debug] [Thread-30 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cb23e80>]}
[0m12:14:23.645326 [info ] [Thread-30 ]: 49 of 78 OK created sql table model stock_analysis.stg_cost_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 139.85s]
[0m12:14:23.646217 [debug] [Thread-30 ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m12:14:27.229327 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cdfa5b0>]}
[0m12:14:27.230664 [info ] [Thread-16 ]: 48 of 78 OK created sql table model stock_analysis.stg_brk-b_1996_2024 ......... [[32mCREATE TABLE (7.1k rows, 42.4 MiB processed)[0m in 143.44s]
[0m12:14:27.231429 [debug] [Thread-16 ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m12:14:32.561628 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2e37c0>]}
[0m12:14:32.563990 [info ] [Thread-17 ]: 62 of 78 OK created sql table model stock_analysis.stg_mrk_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 148.76s]
[0m12:14:32.565210 [debug] [Thread-17 ]: Finished running node model.stock_analysis.stg_mrk_1993_2024
[0m12:14:43.092962 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cac2250>]}
[0m12:14:43.094215 [info ] [Thread-22 ]: 41 of 78 OK created sql table model stock_analysis.stg_aapl_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 159.32s]
[0m12:14:43.095130 [debug] [Thread-22 ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m12:14:48.550537 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2f70a0>]}
[0m12:14:48.552032 [info ] [Thread-9  ]: 63 of 78 OK created sql table model stock_analysis.stg_msft_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 164.74s]
[0m12:14:48.552964 [debug] [Thread-9  ]: Finished running node model.stock_analysis.stg_msft_1993_2024
[0m12:14:49.229133 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c318760>]}
[0m12:14:49.231507 [info ] [Thread-2  ]: 73 of 78 OK created sql table model stock_analysis.stg_unh_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 165.16s]
[0m12:14:49.233445 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_unh_1993_2024
[0m12:14:52.793265 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c299df0>]}
[0m12:14:52.794802 [info ] [Thread-19 ]: 51 of 78 OK created sql table model stock_analysis.stg_cvx_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 169.00s]
[0m12:14:52.795781 [debug] [Thread-19 ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m12:14:56.342420 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2f7730>]}
[0m12:14:56.343759 [info ] [Thread-3  ]: 66 of 78 OK created sql table model stock_analysis.stg_pep_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 172.53s]
[0m12:14:56.344447 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_pep_1993_2024
[0m12:14:59.276427 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c426b80>]}
[0m12:14:59.277985 [info ] [Thread-14 ]: 69 of 78 OK created sql table model stock_analysis.stg_spy_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 175.46s]
[0m12:14:59.279427 [debug] [Thread-14 ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m12:15:00.789922 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8d2d90>]}
[0m12:15:00.791235 [info ] [Thread-12 ]: 67 of 78 OK created sql table model stock_analysis.stg_pg_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 176.98s]
[0m12:15:00.792076 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stg_pg_1993_2024
[0m12:15:08.677393 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cb09f10>]}
[0m12:15:08.679799 [info ] [Thread-13 ]: 56 of 78 OK created sql table model stock_analysis.stg_jnj_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 184.88s]
[0m12:15:08.681762 [debug] [Thread-13 ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m12:15:09.425397 [debug] [Thread-24 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c45bc70>]}
[0m12:15:09.426839 [info ] [Thread-24 ]: 58 of 78 OK created sql table model stock_analysis.stg_ko_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 185.62s]
[0m12:15:09.427718 [debug] [Thread-24 ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m12:15:11.442762 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2a0160>]}
[0m12:15:11.444324 [info ] [Thread-7  ]: 43 of 78 OK created sql table model stock_analysis.stg_adbe_1993_2024 .......... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 187.66s]
[0m12:15:11.445509 [debug] [Thread-7  ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m12:15:13.625886 [debug] [Thread-15 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8e96d0>]}
[0m12:15:13.628320 [info ] [Thread-15 ]: 45 of 78 OK created sql table model stock_analysis.stg_amzn_1997_2024 .......... [[32mCREATE TABLE (6.9k rows, 42.4 MiB processed)[0m in 189.84s]
[0m12:15:13.629549 [debug] [Thread-15 ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m12:15:17.008331 [debug] [Thread-28 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c9132b0>]}
[0m12:15:17.009802 [info ] [Thread-28 ]: 59 of 78 OK created sql table model stock_analysis.stg_lly_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 193.20s]
[0m12:15:17.015577 [debug] [Thread-28 ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m12:15:29.701274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8d3ee0>]}
[0m12:15:29.703665 [info ] [Thread-1  ]: 54 of 78 OK created sql table model stock_analysis.stg_hd_1993_2024 ............ [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 205.90s]
[0m12:15:29.704591 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m12:15:32.079032 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cc9a340>]}
[0m12:15:32.080519 [info ] [Thread-4  ]: 75 of 78 OK created sql table model stock_analysis.stg_wmt_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 173.06s]
[0m12:15:32.081460 [debug] [Thread-4  ]: Finished running node model.stock_analysis.stg_wmt_1993_2024
[0m12:15:36.883251 [debug] [Thread-23 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cf041c0>]}
[0m12:15:36.884728 [info ] [Thread-23 ]: 57 of 78 OK created sql table model stock_analysis.stg_jpm_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 213.08s]
[0m12:15:36.885606 [debug] [Thread-23 ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m12:15:51.518571 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8e96d0>]}
[0m12:15:51.520140 [info ] [Thread-10 ]: 71 of 78 OK created sql table model stock_analysis.stg_tmo_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 227.70s]
[0m12:15:51.520971 [debug] [Thread-10 ]: Finished running node model.stock_analysis.stg_tmo_1993_2024
[0m12:16:00.122625 [debug] [Thread-26 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3bc340>]}
[0m12:16:00.124237 [info ] [Thread-26 ]: 44 of 78 OK created sql table model stock_analysis.stg_amd_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 236.34s]
[0m12:16:00.125316 [debug] [Thread-26 ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m12:16:16.203944 [debug] [Thread-32 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e5ecf10>]}
[0m12:16:16.206434 [info ] [Thread-32 ]: 76 of 78 OK created sql table model stock_analysis.stg_xom_1993_2024 ........... [[32mCREATE TABLE (8.0k rows, 42.4 MiB processed)[0m in 190.91s]
[0m12:16:16.207381 [debug] [Thread-32 ]: Finished running node model.stock_analysis.stg_xom_1993_2024
[0m12:16:16.209007 [debug] [Thread-18 ]: Began running node model.stock_analysis.int_stock_analysis
[0m12:16:16.209887 [info ] [Thread-18 ]: 77 of 78 START sql table model stock_analysis.int_stock_analysis ............... [RUN]
[0m12:16:16.211051 [debug] [Thread-18 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_meta_2012_2024, now model.stock_analysis.int_stock_analysis)
[0m12:16:16.211900 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m12:16:16.225524 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m12:16:16.227843 [debug] [Thread-18 ]: Began executing node model.stock_analysis.int_stock_analysis
[0m12:16:16.230872 [debug] [Thread-18 ]: Opening a new connection, currently in state closed
[0m12:16:16.697473 [debug] [Thread-18 ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m12:16:16.699910 [debug] [Thread-18 ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from brk_b
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m12:16:17.106749 [debug] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:322e664d-6f7b-4f9f-bb6c-8058ace2d666&page=queryresults
[0m12:16:24.216093 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cf04b20>]}
[0m12:16:24.218538 [info ] [Thread-18 ]: 77 of 78 OK created sql table model stock_analysis.int_stock_analysis .......... [[32mCREATE TABLE (224.9k rows, 93.8 MiB processed)[0m in 8.01s]
[0m12:16:24.219316 [debug] [Thread-18 ]: Finished running node model.stock_analysis.int_stock_analysis
[0m12:16:24.220291 [debug] [Thread-5  ]: Began running node model.stock_analysis.stock_analysis
[0m12:16:24.221142 [info ] [Thread-5  ]: 78 of 78 START sql table model stock_analysis.stock_analysis ................... [RUN]
[0m12:16:24.221618 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nflx_1993_2024, now model.stock_analysis.stock_analysis)
[0m12:16:24.221926 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.stock_analysis
[0m12:16:24.225564 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m12:16:24.227066 [debug] [Thread-5  ]: Began executing node model.stock_analysis.stock_analysis
[0m12:16:24.231977 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m12:16:24.696252 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m12:16:24.698596 [debug] [Thread-5  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m12:16:25.065760 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f40bd89e-ec79-44ad-99ae-b21c52ccd0c1&page=queryresults
[0m12:16:32.487222 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2902b947-259c-41a5-a268-8fa0306b1ef2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4c7550>]}
[0m12:16:32.488729 [info ] [Thread-5  ]: 78 of 78 OK created sql table model stock_analysis.stock_analysis .............. [[32mCREATE TABLE (224.9k rows, 95.4 MiB processed)[0m in 8.27s]
[0m12:16:32.489581 [debug] [Thread-5  ]: Finished running node model.stock_analysis.stock_analysis
[0m12:16:32.492170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:32.492638 [debug] [MainThread]: Connection 'model.stock_analysis.stg_hd_1993_2024' was properly closed.
[0m12:16:32.492870 [debug] [MainThread]: Connection 'model.stock_analysis.stg_unh_1993_2024' was properly closed.
[0m12:16:32.493076 [debug] [MainThread]: Connection 'model.stock_analysis.stg_pep_1993_2024' was properly closed.
[0m12:16:32.493265 [debug] [MainThread]: Connection 'model.stock_analysis.stg_wmt_1993_2024' was properly closed.
[0m12:16:32.493447 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m12:16:32.493633 [debug] [MainThread]: Connection 'model.stock_analysis.stg_goog_2004_2024' was properly closed.
[0m12:16:32.493810 [debug] [MainThread]: Connection 'model.stock_analysis.stg_adbe_1993_2024' was properly closed.
[0m12:16:32.493984 [debug] [MainThread]: Connection 'model.stock_analysis.stg_avgo_2009_2024' was properly closed.
[0m12:16:32.494162 [debug] [MainThread]: Connection 'model.stock_analysis.stg_msft_1993_2024' was properly closed.
[0m12:16:32.494336 [debug] [MainThread]: Connection 'model.stock_analysis.stg_tmo_1993_2024' was properly closed.
[0m12:16:32.494506 [debug] [MainThread]: Connection 'model.stock_analysis.stg_crm_2004_2024' was properly closed.
[0m12:16:32.494680 [debug] [MainThread]: Connection 'model.stock_analysis.stg_pg_1993_2024' was properly closed.
[0m12:16:32.494851 [debug] [MainThread]: Connection 'model.stock_analysis.stg_jnj_1993_2024' was properly closed.
[0m12:16:32.495020 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_1993_2024' was properly closed.
[0m12:16:32.495187 [debug] [MainThread]: Connection 'model.stock_analysis.stg_amzn_1997_2024' was properly closed.
[0m12:16:32.495358 [debug] [MainThread]: Connection 'model.stock_analysis.stg_brk-b_1996_2024' was properly closed.
[0m12:16:32.495528 [debug] [MainThread]: Connection 'model.stock_analysis.stg_mrk_1993_2024' was properly closed.
[0m12:16:32.495699 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m12:16:32.495872 [debug] [MainThread]: Connection 'model.stock_analysis.stg_cvx_1993_2024' was properly closed.
[0m12:16:32.496221 [debug] [MainThread]: Connection 'model.stock_analysis.stg_tsla_2010_2024' was properly closed.
[0m12:16:32.496428 [debug] [MainThread]: Connection 'model.stock_analysis.stg_googl_2004_2024' was properly closed.
[0m12:16:32.496610 [debug] [MainThread]: Connection 'model.stock_analysis.stg_aapl_1993_2024' was properly closed.
[0m12:16:32.496784 [debug] [MainThread]: Connection 'model.stock_analysis.stg_jpm_1993_2024' was properly closed.
[0m12:16:32.496958 [debug] [MainThread]: Connection 'model.stock_analysis.stg_ko_1993_2024' was properly closed.
[0m12:16:32.497136 [debug] [MainThread]: Connection 'model.stock_analysis.stg_ma_2006_2024' was properly closed.
[0m12:16:32.497307 [debug] [MainThread]: Connection 'model.stock_analysis.stg_amd_1993_2024' was properly closed.
[0m12:16:32.497474 [debug] [MainThread]: Connection 'model.stock_analysis.stg_v_1993_2024' was properly closed.
[0m12:16:32.497647 [debug] [MainThread]: Connection 'model.stock_analysis.stg_lly_1993_2024' was properly closed.
[0m12:16:32.497819 [debug] [MainThread]: Connection 'model.stock_analysis.stg_bac_1993_2024' was properly closed.
[0m12:16:32.497987 [debug] [MainThread]: Connection 'model.stock_analysis.stg_cost_1993_2024' was properly closed.
[0m12:16:32.498156 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nvda_1999_2024' was properly closed.
[0m12:16:32.498330 [debug] [MainThread]: Connection 'model.stock_analysis.stg_xom_1993_2024' was properly closed.
[0m12:16:32.498849 [info ] [MainThread]: 
[0m12:16:32.499100 [info ] [MainThread]: Finished running 78 table models in 0 hours 4 minutes and 43.68 seconds (283.68s).
[0m12:16:32.507385 [debug] [MainThread]: Command end result
[0m12:16:32.548476 [info ] [MainThread]: 
[0m12:16:32.548828 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:32.548996 [info ] [MainThread]: 
[0m12:16:32.549214 [error] [MainThread]:   Database Error in model base_spy_2014_2024 (models/1_base/base_spy_2014_2024.sql)
  Unrecognized name: adj_close at [16:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_spy_2014_2024.sql
[0m12:16:32.549415 [info ] [MainThread]: 
[0m12:16:32.549585 [info ] [MainThread]: Done. PASS=76 WARN=0 ERROR=1 SKIP=1 TOTAL=78
[0m12:16:32.551389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 284.9549, "process_user_time": 12.944659, "process_kernel_time": 3.766483, "process_mem_max_rss": "234897408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:32.551658 [debug] [MainThread]: Command `dbt run` failed at 12:16:32.551614 after 284.96 seconds
[0m12:16:32.551875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c33a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c33adf0>]}
[0m12:16:32.552056 [debug] [MainThread]: Flushing usage events
[0m12:18:36.310936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106741340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106741160>]}


============================== 12:18:36.313719 | 74dd338b-21d3-4b7b-8870-2813850b02eb ==============================
[0m12:18:36.313719 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:18:36.314050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_stock_analysis+', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:36.872303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106722580>]}
[0m12:18:36.898203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154e7a2b0>]}
[0m12:18:36.898507 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:18:36.912066 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:18:37.005891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:37.006414 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_spy_2014_2024.sql
[0m12:18:37.172035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158659130>]}
[0m12:18:37.251116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158501340>]}
[0m12:18:37.251472 [info ] [MainThread]: Found 78 models, 38 sources, 469 macros
[0m12:18:37.251700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158612040>]}
[0m12:18:37.252969 [info ] [MainThread]: 
[0m12:18:37.253295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:37.255623 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:18:37.255833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:37.882607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:18:37.883512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:38.393152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104606a90>]}
[0m12:18:38.393994 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m12:18:38.394348 [info ] [MainThread]: 
[0m12:18:38.400667 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m12:18:38.401297 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m12:18:38.401721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m12:18:38.402042 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m12:18:38.417043 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m12:18:38.418142 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m12:18:38.430866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:38.922724 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m12:18:38.923887 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
, abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
, adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
, amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
, amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
, avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
, bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
, brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
, cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
, crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
, cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
, goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
, googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
, hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
, jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
, jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
, ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
, lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
, ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
, meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
, mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
, msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
, nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
, nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
, pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
, pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
, tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
, tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
, unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
, v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
, wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
, xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * , 'AAPL' as symbol from aapl
union all
select * , 'ABBV' as symbol from abbv
union all
select * , 'ADBE' as symbol from adbe
union all
select * , 'AMD' as symbol from amd
union all
select * , 'AMZN' as symbol from amzn
union all
select * , 'AVGO' as symbol from avgo
union all
select * , 'BAC' as symbol from bac
union all
select * , 'BRK-B' as symbol from brk_b
union all
select * , 'COST' as symbol from cost
union all
select * , 'CRM' as symbol from crm
union all
select * , 'CVX' as symbol from cvx
union all
select * , 'GOOG' as symbol from goog
union all
select * , 'GOOGL' as symbol from googl
union all
select * , 'HD' as symbol from hd
union all
select * , 'JNJ' as symbol from jnj
union all
select * , 'JPM' as symbol from jpm
union all
select * , 'KO' as symbol from ko
union all
select * , 'LLY' as symbol from lly
union all
select * , 'MA' as symbol from ma
union all
select * , 'META' as symbol from meta
union all
select * , 'MRK' as symbol from mrk
union all
select * , 'MSFT' as symbol from msft
union all
select * , 'NFLX' as symbol from nflx
union all
select * , 'NVDA' as symbol from nvda
union all
select * , 'PEP' as symbol from pep
union all
select * , 'PG' as symbol from pg
union all
select * , 'TMO' as symbol from tmo
union all
select * , 'TSLA' as symbol from tsla
union all
select * , 'UNH' as symbol from unh
union all
select * , 'V' as symbol from v
union all
select * , 'WMT' as symbol from wmt
union all
select * , 'XOM' as symbol from xom
    );
  
[0m12:18:39.356373 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dca3ea87-e42f-451e-b7f2-a5dbc642ba32&page=queryresults
[0m12:18:46.197442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158798fd0>]}
[0m12:18:46.198127 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.int_stock_analysis ............ [[32mCREATE TABLE (224.9k rows, 93.8 MiB processed)[0m in 7.79s]
[0m12:18:46.198653 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m12:18:46.199354 [debug] [Thread-3  ]: Began running node model.stock_analysis.stock_analysis
[0m12:18:46.199823 [info ] [Thread-3  ]: 2 of 2 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m12:18:46.200213 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stock_analysis'
[0m12:18:46.200463 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stock_analysis
[0m12:18:46.203311 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m12:18:46.204787 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stock_analysis
[0m12:18:46.207156 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:18:46.712001 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m12:18:46.715401 [debug] [Thread-3  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m12:18:47.140180 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:592e04a7-cb2a-41c7-9bc4-6a29f9420ceb&page=queryresults
[0m12:18:53.897439 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74dd338b-21d3-4b7b-8870-2813850b02eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158798ee0>]}
[0m12:18:53.898439 [info ] [Thread-3  ]: 2 of 2 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (224.9k rows, 95.4 MiB processed)[0m in 7.70s]
[0m12:18:53.899187 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stock_analysis
[0m12:18:53.901305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:53.901709 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m12:18:53.902021 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m12:18:53.902427 [info ] [MainThread]: 
[0m12:18:53.902810 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 16.65 seconds (16.65s).
[0m12:18:53.903754 [debug] [MainThread]: Command end result
[0m12:18:53.951565 [info ] [MainThread]: 
[0m12:18:53.952108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:53.952363 [info ] [MainThread]: 
[0m12:18:53.952572 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:18:53.954322 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.690418, "process_user_time": 2.187599, "process_kernel_time": 2.73574, "process_mem_max_rss": "200065024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:53.954760 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:53.954699 after 17.69 seconds
[0m12:18:53.955015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585768b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612f7c0>]}
[0m12:18:53.955268 [debug] [MainThread]: Flushing usage events
[0m19:36:11.372863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a26ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839e1c0>]}


============================== 19:36:11.375934 | be8529d1-752a-4b39-b8d1-38a604b81513 ==============================
[0m19:36:11.375934 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:36:11.376287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:11.975741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8529d1-752a-4b39-b8d1-38a604b81513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108098fd0>]}
[0m19:36:12.001663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be8529d1-752a-4b39-b8d1-38a604b81513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806d2b0>]}
[0m19:36:12.001945 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:36:12.014496 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:36:12.107449 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m19:36:12.107916 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m19:36:12.108100 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_all_nasdaq_stock_history.sql
[0m19:36:12.110299 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m19:36:12.110449 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:36:12.110580 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_spy_2014_2024.sql
[0m19:36:12.110729 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_aapl_1993_2024.sql
[0m19:36:12.417808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be8529d1-752a-4b39-b8d1-38a604b81513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589d7130>]}
[0m19:36:12.485663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be8529d1-752a-4b39-b8d1-38a604b81513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589f9c10>]}
[0m19:36:12.485923 [info ] [MainThread]: Found 78 models, 40 sources, 469 macros
[0m19:36:12.486110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8529d1-752a-4b39-b8d1-38a604b81513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589a6a90>]}
[0m19:36:12.487186 [info ] [MainThread]: 
[0m19:36:12.487452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:36:12.487881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:36:12.488092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:12.937042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:36:12.937731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:13.325487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8529d1-752a-4b39-b8d1-38a604b81513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1583664c0>]}
[0m19:36:13.326146 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:36:13.326450 [info ] [MainThread]: 
[0m19:36:13.331050 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:13.331657 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_nasdaq_stock_history ...... [RUN]
[0m19:36:13.332215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m19:36:13.332551 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:13.340727 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:36:13.341500 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:13.371420 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:36:13.372067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:13.434644 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    Open as open
    High as high
    Low as low
    Close as close_last
    'Adj Close' as adj_close
    Volume as volume
    Symbol as symbol
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m19:36:13.760543 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b24f4753-7a45-40c4-a573-3ac064f04d68&page=queryresults
[0m19:36:13.761007 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "Open" at [16:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "Open" at [16:5]')
[0m19:36:14.755453 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:340ecdff-e93f-449e-9a56-ae7d63339d8c&page=queryresults
[0m19:36:14.756297 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:340ecdff-e93f-449e-9a56-ae7d63339d8c&page=queryresults
[0m19:36:14.795011 [debug] [Thread-1  ]: Database Error in model base_all_nasdaq_stock_history (models/1_base/base_all_nasdaq_stock_history.sql)
  Syntax error: Expected ")" but got identifier "Open" at [16:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_history.sql
[0m19:36:14.796389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8529d1-752a-4b39-b8d1-38a604b81513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158d0b7f0>]}
[0m19:36:14.796900 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_history  [[31mERROR[0m in 1.46s]
[0m19:36:14.797319 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:14.798699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:14.798957 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m19:36:14.799182 [info ] [MainThread]: 
[0m19:36:14.799495 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m19:36:14.799964 [debug] [MainThread]: Command end result
[0m19:36:14.889268 [info ] [MainThread]: 
[0m19:36:14.889633 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:14.889800 [info ] [MainThread]: 
[0m19:36:14.890010 [error] [MainThread]:   Database Error in model base_all_nasdaq_stock_history (models/1_base/base_all_nasdaq_stock_history.sql)
  Syntax error: Expected ")" but got identifier "Open" at [16:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_history.sql
[0m19:36:14.890171 [info ] [MainThread]: 
[0m19:36:14.890338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:36:14.892066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5707743, "process_user_time": 4.662261, "process_kernel_time": 0.227668, "process_mem_max_rss": "203472896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:14.892395 [debug] [MainThread]: Command `dbt run` failed at 19:36:14.892343 after 3.57 seconds
[0m19:36:14.892618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a26ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1588e7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158916d90>]}
[0m19:36:14.892807 [debug] [MainThread]: Flushing usage events
[0m19:36:41.188280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082063a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082061c0>]}


============================== 19:36:41.190782 | 8a743730-9f57-4f52-b2a1-c8042ca5ef71 ==============================
[0m19:36:41.190782 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:36:41.191094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:41.697969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a743730-9f57-4f52-b2a1-c8042ca5ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f00fd0>]}
[0m19:36:41.723897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a743730-9f57-4f52-b2a1-c8042ca5ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed52b0>]}
[0m19:36:41.724181 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:36:41.734665 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:36:41.824885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:36:41.825384 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_history.sql
[0m19:36:41.981769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a743730-9f57-4f52-b2a1-c8042ca5ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f7cf130>]}
[0m19:36:42.048920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a743730-9f57-4f52-b2a1-c8042ca5ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f57a3a0>]}
[0m19:36:42.049191 [info ] [MainThread]: Found 78 models, 40 sources, 469 macros
[0m19:36:42.049388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a743730-9f57-4f52-b2a1-c8042ca5ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f7a3910>]}
[0m19:36:42.050464 [info ] [MainThread]: 
[0m19:36:42.050729 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:36:42.051147 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:36:42.051345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:42.481100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:36:42.481734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:42.849900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a743730-9f57-4f52-b2a1-c8042ca5ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f574460>]}
[0m19:36:42.850744 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:36:42.851095 [info ] [MainThread]: 
[0m19:36:42.855874 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:42.856409 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_nasdaq_stock_history ...... [RUN]
[0m19:36:42.856868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m19:36:42.857257 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:42.865021 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:36:42.866050 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:42.896872 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:36:42.897424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:42.959304 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m19:36:43.587017 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b29cd4d3-94b4-4c45-bedd-f27f73e654c4&page=queryresults
[0m19:36:49.679084 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a743730-9f57-4f52-b2a1-c8042ca5ef71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158b17d00>]}
[0m19:36:49.679875 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.base_all_nasdaq_stock_history . [[32mCREATE TABLE (12.5m rows, 641.5 MiB processed)[0m in 6.82s]
[0m19:36:49.680461 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:36:49.682179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:49.682472 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m19:36:49.682745 [info ] [MainThread]: 
[0m19:36:49.683048 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m19:36:49.683615 [debug] [MainThread]: Command end result
[0m19:36:49.724935 [info ] [MainThread]: 
[0m19:36:49.725305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:36:49.725500 [info ] [MainThread]: 
[0m19:36:49.725712 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:36:49.726947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.586478, "process_user_time": 4.472128, "process_kernel_time": 0.190359, "process_mem_max_rss": "202342400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:49.727274 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:49.727219 after 8.59 seconds
[0m19:36:49.727503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf57c0>]}
[0m19:36:49.727719 [debug] [MainThread]: Flushing usage events
[0m19:53:17.956960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839b190>]}


============================== 19:53:17.959508 | bcb41d72-3e8e-4229-bb5b-5d238f56d0a8 ==============================
[0m19:53:17.959508 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:53:17.959835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_info', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:53:18.460564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb41d72-3e8e-4229-bb5b-5d238f56d0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5a7f0>]}
[0m19:53:18.486434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcb41d72-3e8e-4229-bb5b-5d238f56d0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108320f10>]}
[0m19:53:18.486725 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:53:18.498177 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:53:18.589933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:53:18.590441 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m19:53:18.590652 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_history.sql
[0m19:53:18.749724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcb41d72-3e8e-4229-bb5b-5d238f56d0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128b12130>]}
[0m19:53:18.818165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcb41d72-3e8e-4229-bb5b-5d238f56d0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12868fc70>]}
[0m19:53:18.818435 [info ] [MainThread]: Found 78 models, 40 sources, 469 macros
[0m19:53:18.818621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb41d72-3e8e-4229-bb5b-5d238f56d0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128b5dbe0>]}
[0m19:53:18.819702 [info ] [MainThread]: 
[0m19:53:18.819975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:53:18.820417 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:53:18.820615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:19.265906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:53:19.266523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:19.681096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcb41d72-3e8e-4229-bb5b-5d238f56d0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12867db80>]}
[0m19:53:19.681772 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:53:19.682044 [info ] [MainThread]: 
[0m19:53:19.686142 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:19.686605 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m19:53:19.686997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m19:53:19.687329 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:19.694784 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m19:53:19.695515 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:19.723994 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m19:53:19.724594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:19.785262 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    , index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio	
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m19:53:20.099064 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0d117071-f36b-4adf-a786-c1d227a41307&page=queryresults
[0m19:53:20.101203 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "," at [15:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected "," at [15:5]')
[0m19:53:21.090701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5aef8384-14ae-484d-9516-319dcb107498&page=queryresults
[0m19:53:21.093063 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5aef8384-14ae-484d-9516-319dcb107498&page=queryresults
[0m19:53:21.135177 [debug] [Thread-1  ]: Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Unexpected "," at [15:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m19:53:21.136573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcb41d72-3e8e-4229-bb5b-5d238f56d0a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c54af0>]}
[0m19:53:21.137093 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_info  [[31mERROR[0m in 1.45s]
[0m19:53:21.137511 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:21.138663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:21.138853 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m19:53:21.139054 [info ] [MainThread]: 
[0m19:53:21.139265 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m19:53:21.139665 [debug] [MainThread]: Command end result
[0m19:53:21.175183 [info ] [MainThread]: 
[0m19:53:21.175507 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:53:21.175683 [info ] [MainThread]: 
[0m19:53:21.175902 [error] [MainThread]:   Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Unexpected "," at [15:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m19:53:21.176067 [info ] [MainThread]: 
[0m19:53:21.176233 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:53:21.177507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2672226, "process_user_time": 4.434244, "process_kernel_time": 0.200136, "process_mem_max_rss": "199507968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:53:21.177833 [debug] [MainThread]: Command `dbt run` failed at 19:53:21.177780 after 3.27 seconds
[0m19:53:21.178048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a23a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1286fc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c6b3d0>]}
[0m19:53:21.178248 [debug] [MainThread]: Flushing usage events
[0m19:53:43.274408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a12ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638a3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638a1c0>]}


============================== 19:53:43.276972 | f3066ab8-aace-48c8-ac0f-f56a47c845ae ==============================
[0m19:53:43.276972 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:53:43.277277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_info', 'send_anonymous_usage_stats': 'True'}
[0m19:53:43.794292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3066ab8-aace-48c8-ac0f-f56a47c845ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106084fd0>]}
[0m19:53:43.820333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3066ab8-aace-48c8-ac0f-f56a47c845ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060592b0>]}
[0m19:53:43.820625 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:53:43.832156 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:53:43.920710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:43.921196 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m19:53:44.076489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3066ab8-aace-48c8-ac0f-f56a47c845ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc49130>]}
[0m19:53:44.143662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3066ab8-aace-48c8-ac0f-f56a47c845ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b5f9e50>]}
[0m19:53:44.143922 [info ] [MainThread]: Found 78 models, 40 sources, 469 macros
[0m19:53:44.144108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3066ab8-aace-48c8-ac0f-f56a47c845ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc9ec10>]}
[0m19:53:44.145158 [info ] [MainThread]: 
[0m19:53:44.145425 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:53:44.145858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:53:44.146067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:44.566721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:53:44.567327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:44.983728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3066ab8-aace-48c8-ac0f-f56a47c845ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b5f5280>]}
[0m19:53:44.984442 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:53:44.984737 [info ] [MainThread]: 
[0m19:53:44.988356 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:44.988906 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m19:53:44.989308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m19:53:44.989569 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:44.997191 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m19:53:44.997881 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:45.029159 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m19:53:45.029756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:53:45.092857 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio	
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m19:53:45.873606 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c792d13a-a91d-47c6-9104-8fdf5de2acdf&page=queryresults
[0m19:53:49.880821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3066ab8-aace-48c8-ac0f-f56a47c845ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12be95be0>]}
[0m19:53:49.881347 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.base_all_nasdaq_stock_info .... [[32mCREATE TABLE (27.7k rows, 56.2 MiB processed)[0m in 4.89s]
[0m19:53:49.881771 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:53:49.882998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:49.883184 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m19:53:49.883370 [info ] [MainThread]: 
[0m19:53:49.883580 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m19:53:49.884003 [debug] [MainThread]: Command end result
[0m19:53:49.917624 [info ] [MainThread]: 
[0m19:53:49.917939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:49.918113 [info ] [MainThread]: 
[0m19:53:49.918282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:53:49.919503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.692808, "process_user_time": 4.439804, "process_kernel_time": 0.197651, "process_mem_max_rss": "201768960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:53:49.919789 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:49.919739 after 6.69 seconds
[0m19:53:49.919999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a12ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bec48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060592b0>]}
[0m19:53:49.920193 [debug] [MainThread]: Flushing usage events
[0m20:02:44.863286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020b3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104043430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104043250>]}


============================== 20:02:44.865702 | f62f5b1a-6b78-4c58-9f69-a927ac6dda1c ==============================
[0m20:02:44.865702 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:02:44.866020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_info', 'send_anonymous_usage_stats': 'True'}
[0m20:02:45.362110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f62f5b1a-6b78-4c58-9f69-a927ac6dda1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffda00>]}
[0m20:02:45.388004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f62f5b1a-6b78-4c58-9f69-a927ac6dda1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffd070>]}
[0m20:02:45.388298 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:02:45.400666 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:02:45.491022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:02:45.491451 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_info.sql
[0m20:02:45.491633 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m20:02:45.647227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f62f5b1a-6b78-4c58-9f69-a927ac6dda1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a7979a0>]}
[0m20:02:45.715114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f62f5b1a-6b78-4c58-9f69-a927ac6dda1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a529df0>]}
[0m20:02:45.715378 [info ] [MainThread]: Found 80 models, 40 sources, 469 macros
[0m20:02:45.715563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62f5b1a-6b78-4c58-9f69-a927ac6dda1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a7e16d0>]}
[0m20:02:45.716659 [info ] [MainThread]: 
[0m20:02:45.716926 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:02:45.717346 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:02:45.717559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:02:46.216058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:02:46.216651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:02:46.597494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62f5b1a-6b78-4c58-9f69-a927ac6dda1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a529ca0>]}
[0m20:02:46.598398 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:02:46.598790 [info ] [MainThread]: 
[0m20:02:46.604213 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:02:46.604763 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_all_nasdaq_stock_info .......... [RUN]
[0m20:02:46.605241 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_info)
[0m20:02:46.605650 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:02:46.613746 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m20:02:46.614448 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:02:46.646897 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m20:02:46.647436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:02:46.710138 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info` )

select
    distinct 
    *
from base
where index = 0
    );
  
[0m20:02:47.431601 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7babd792-ac4b-4b6b-b4ea-33b69f9de69c&page=queryresults
[0m20:02:50.520890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62f5b1a-6b78-4c58-9f69-a927ac6dda1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b0de5b0>]}
[0m20:02:50.521718 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_all_nasdaq_stock_info ..... [[32mCREATE TABLE (3.9k rows, 56.2 MiB processed)[0m in 3.91s]
[0m20:02:50.522307 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:02:50.524048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:02:50.524352 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m20:02:50.524633 [info ] [MainThread]: 
[0m20:02:50.524928 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m20:02:50.525546 [debug] [MainThread]: Command end result
[0m20:02:50.567451 [info ] [MainThread]: 
[0m20:02:50.567800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:02:50.567993 [info ] [MainThread]: 
[0m20:02:50.568185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:02:50.569475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7529182, "process_user_time": 3.96515, "process_kernel_time": 0.682597, "process_mem_max_rss": "198410240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:02:50.569798 [debug] [MainThread]: Command `dbt run` succeeded at 20:02:50.569742 after 5.75 seconds
[0m20:02:50.570024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020b3a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a127b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffd070>]}
[0m20:02:50.570224 [debug] [MainThread]: Flushing usage events
[0m20:09:30.215775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041beac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b37310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b37130>]}


============================== 20:09:30.218493 | 79beb234-857b-4b8c-8f00-62b8277a377a ==============================
[0m20:09:30.218493 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:09:30.218810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select +stg_all_nasdaq_stock_info', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:09:30.743678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79beb234-857b-4b8c-8f00-62b8277a377a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f30a0>]}
[0m20:09:30.769592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79beb234-857b-4b8c-8f00-62b8277a377a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ace5e0>]}
[0m20:09:30.769884 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:09:30.781172 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:09:30.907771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:30.908293 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m20:09:31.030378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79beb234-857b-4b8c-8f00-62b8277a377a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c94ef10>]}
[0m20:09:31.099427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79beb234-857b-4b8c-8f00-62b8277a377a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b9f0fd0>]}
[0m20:09:31.099681 [info ] [MainThread]: Found 80 models, 40 sources, 469 macros
[0m20:09:31.099873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79beb234-857b-4b8c-8f00-62b8277a377a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9a5400>]}
[0m20:09:31.101004 [info ] [MainThread]: 
[0m20:09:31.101267 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:09:31.103334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:09:31.103537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:31.573939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:09:31.574727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:32.046941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79beb234-857b-4b8c-8f00-62b8277a377a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abbca0>]}
[0m20:09:32.047605 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:09:32.047861 [info ] [MainThread]: 
[0m20:09:32.051734 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:09:32.052156 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m20:09:32.052491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m20:09:32.052742 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:09:32.060263 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:09:32.060964 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:09:32.072410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:09:32.489580 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:09:32.490704 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio	
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    , 52WeekChange
    , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m20:09:32.661861 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e17eb514-6e72-4fa3-a67a-4b2b9d32c3de&page=queryresults
[0m20:09:32.664076 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Missing whitespace between literal and alias at [83:9]; reason: invalidQuery, location: query, message: Syntax error: Missing whitespace between literal and alias at [83:9]')
[0m20:09:33.805193 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:73cd6f7b-8c80-47e7-8184-c554e2c541d7&page=queryresults
[0m20:09:33.806087 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:73cd6f7b-8c80-47e7-8184-c554e2c541d7&page=queryresults
[0m20:09:33.846312 [debug] [Thread-1  ]: Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Missing whitespace between literal and alias at [83:9]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:09:33.847644 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79beb234-857b-4b8c-8f00-62b8277a377a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14caa2550>]}
[0m20:09:33.848180 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_info  [[31mERROR[0m in 1.79s]
[0m20:09:33.848597 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:09:33.849147 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:09:33.849557 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stg_all_nasdaq_stock_info .................. [[33mSKIP[0m]
[0m20:09:33.849853 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:09:33.850858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:33.851033 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m20:09:33.851265 [info ] [MainThread]: 
[0m20:09:33.851456 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m20:09:33.851861 [debug] [MainThread]: Command end result
[0m20:09:33.887943 [info ] [MainThread]: 
[0m20:09:33.888242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:09:33.888406 [info ] [MainThread]: 
[0m20:09:33.888614 [error] [MainThread]:   Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Missing whitespace between literal and alias at [83:9]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:09:33.888774 [info ] [MainThread]: 
[0m20:09:33.888941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:09:33.890228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7227576, "process_user_time": 4.41532, "process_kernel_time": 0.2073, "process_mem_max_rss": "199196672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:09:33.890570 [debug] [MainThread]: Command `dbt run` failed at 20:09:33.890515 after 3.72 seconds
[0m20:09:33.890798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041beac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ace5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105524d00>]}
[0m20:09:33.890997 [debug] [MainThread]: Flushing usage events
[0m20:10:56.099490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d70d0>]}


============================== 20:10:56.102034 | 8104f227-f202-4828-a896-da1c7917df1c ==============================
[0m20:10:56.102034 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:10:56.102361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select +stg_all_nasdaq_stock_info', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:10:56.608856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8104f227-f202-4828-a896-da1c7917df1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080832e0>]}
[0m20:10:56.635383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8104f227-f202-4828-a896-da1c7917df1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146c2b5b0>]}
[0m20:10:56.635698 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:10:56.646811 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:10:56.774257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:10:56.774777 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m20:10:56.900320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8104f227-f202-4828-a896-da1c7917df1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472cefd0>]}
[0m20:10:56.971269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8104f227-f202-4828-a896-da1c7917df1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147170e50>]}
[0m20:10:56.971562 [info ] [MainThread]: Found 80 models, 40 sources, 469 macros
[0m20:10:56.971753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8104f227-f202-4828-a896-da1c7917df1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473259d0>]}
[0m20:10:56.973043 [info ] [MainThread]: 
[0m20:10:56.973397 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:10:56.975625 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:10:56.975844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:10:57.400955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:10:57.401820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:10:57.815909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8104f227-f202-4828-a896-da1c7917df1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146d05c40>]}
[0m20:10:57.816632 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:10:57.816931 [info ] [MainThread]: 
[0m20:10:57.820995 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:10:57.821410 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m20:10:57.821753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m20:10:57.822022 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:10:57.830371 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:10:57.831121 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:10:57.843180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:10:58.223488 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:10:58.224412 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    , 52WeekChange
    , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m20:10:58.390030 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:84929cee-c001-42dd-bf77-a53476b4ae4f&page=queryresults
[0m20:10:58.391641 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Missing whitespace between literal and alias at [83:9]; reason: invalidQuery, location: query, message: Syntax error: Missing whitespace between literal and alias at [83:9]')
[0m20:10:58.801131 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:948ba22a-0bbf-419c-96d9-74fd0766fae0&page=queryresults
[0m20:10:58.802223 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:948ba22a-0bbf-419c-96d9-74fd0766fae0&page=queryresults
[0m20:10:58.840833 [debug] [Thread-1  ]: Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Missing whitespace between literal and alias at [83:9]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:10:58.842036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8104f227-f202-4828-a896-da1c7917df1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147422550>]}
[0m20:10:58.842511 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_info  [[31mERROR[0m in 1.02s]
[0m20:10:58.842909 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:10:58.843408 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:10:58.843756 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stg_all_nasdaq_stock_info .................. [[33mSKIP[0m]
[0m20:10:58.844089 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:10:58.845102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:10:58.845290 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m20:10:58.845515 [info ] [MainThread]: 
[0m20:10:58.845729 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m20:10:58.846152 [debug] [MainThread]: Command end result
[0m20:10:58.882858 [info ] [MainThread]: 
[0m20:10:58.883146 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:10:58.883315 [info ] [MainThread]: 
[0m20:10:58.883533 [error] [MainThread]:   Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Missing whitespace between literal and alias at [83:9]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:10:58.883706 [info ] [MainThread]: 
[0m20:10:58.883878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:10:58.885152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8334813, "process_user_time": 4.441646, "process_kernel_time": 0.196087, "process_mem_max_rss": "203096064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:10:58.885457 [debug] [MainThread]: Command `dbt run` failed at 20:10:58.885410 after 2.83 seconds
[0m20:10:58.885673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146c2b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac5910>]}
[0m20:10:58.885869 [debug] [MainThread]: Flushing usage events
[0m20:12:42.950517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106126a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e160>]}


============================== 20:12:42.953120 | beccd94c-9514-4a51-a236-1cf3ede23606 ==============================
[0m20:12:42.953120 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:12:42.953443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select +stg_all_nasdaq_stock_info', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:12:43.465522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'beccd94c-9514-4a51-a236-1cf3ede23606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306c71c0>]}
[0m20:12:43.491456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'beccd94c-9514-4a51-a236-1cf3ede23606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaa310>]}
[0m20:12:43.491739 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:12:43.504405 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:12:43.630777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:43.631305 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m20:12:43.754514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'beccd94c-9514-4a51-a236-1cf3ede23606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15304cf10>]}
[0m20:12:43.822417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'beccd94c-9514-4a51-a236-1cf3ede23606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146cba5e0>]}
[0m20:12:43.822678 [info ] [MainThread]: Found 80 models, 40 sources, 469 macros
[0m20:12:43.822868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beccd94c-9514-4a51-a236-1cf3ede23606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530a5af0>]}
[0m20:12:43.824031 [info ] [MainThread]: 
[0m20:12:43.824311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:12:43.826419 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:12:43.826628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:44.267844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:12:44.268638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:44.653380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'beccd94c-9514-4a51-a236-1cf3ede23606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146dc94c0>]}
[0m20:12:44.653947 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:12:44.654170 [info ] [MainThread]: 
[0m20:12:44.657800 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:12:44.658135 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m20:12:44.658426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m20:12:44.658655 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:12:44.665421 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:12:44.666037 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:12:44.676533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:45.068900 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:12:45.070087 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    , '52WeekChange'
    , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m20:12:45.455244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ae5dbc84-85a5-4a37-83fa-f142cc49bb1b&page=queryresults
[0m20:12:45.687702 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/ae5dbc84-85a5-4a37-83fa-f142cc49bb1b?maxResults=0&location=US&prettyPrint=false: CREATE TABLE columns must be named, but column 69 has no name at [13:7]')
[0m20:12:46.189925 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9a56c2c9-5e31-40a5-add7-2b5d5a8e0e7a&page=queryresults
[0m20:12:46.407592 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9a56c2c9-5e31-40a5-add7-2b5d5a8e0e7a&page=queryresults
[0m20:12:46.451235 [debug] [Thread-1  ]: Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  CREATE TABLE columns must be named, but column 69 has no name at [13:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:12:46.452524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'beccd94c-9514-4a51-a236-1cf3ede23606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531a25e0>]}
[0m20:12:46.452972 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_info  [[31mERROR[0m in 1.79s]
[0m20:12:46.453357 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:12:46.453890 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:12:46.454219 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stg_all_nasdaq_stock_info .................. [[33mSKIP[0m]
[0m20:12:46.454522 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:12:46.455576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:46.455758 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m20:12:46.455983 [info ] [MainThread]: 
[0m20:12:46.456178 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m20:12:46.456584 [debug] [MainThread]: Command end result
[0m20:12:46.492120 [info ] [MainThread]: 
[0m20:12:46.492453 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:12:46.492616 [info ] [MainThread]: 
[0m20:12:46.492835 [error] [MainThread]:   Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  CREATE TABLE columns must be named, but column 69 has no name at [13:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:12:46.492992 [info ] [MainThread]: 
[0m20:12:46.493164 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:12:46.494392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.594388, "process_user_time": 4.466664, "process_kernel_time": 0.208706, "process_mem_max_rss": "202833920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:12:46.494708 [debug] [MainThread]: Command `dbt run` failed at 20:12:46.494659 after 3.59 seconds
[0m20:12:46.494916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106126a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306c71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1468120d0>]}
[0m20:12:46.495112 [debug] [MainThread]: Flushing usage events
[0m20:13:13.890082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102572ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eea310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eea130>]}


============================== 20:13:13.892143 | d129f0f1-b214-4062-b993-64779e941760 ==============================
[0m20:13:13.892143 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:13:13.892467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select +stg_all_nasdaq_stock_info', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:14.351065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd129f0f1-b214-4062-b993-64779e941760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027a40a0>]}
[0m20:13:14.377158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd129f0f1-b214-4062-b993-64779e941760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e825e0>]}
[0m20:13:14.377453 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:13:14.388232 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:13:14.512262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:13:14.512833 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m20:13:14.635184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd129f0f1-b214-4062-b993-64779e941760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c315f10>]}
[0m20:13:14.704864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd129f0f1-b214-4062-b993-64779e941760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375abfd0>]}
[0m20:13:14.705135 [info ] [MainThread]: Found 80 models, 40 sources, 469 macros
[0m20:13:14.705322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd129f0f1-b214-4062-b993-64779e941760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c365400>]}
[0m20:13:14.706469 [info ] [MainThread]: 
[0m20:13:14.706740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:13:14.708856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:13:14.709062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:15.121880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:13:15.122582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:15.507393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd129f0f1-b214-4062-b993-64779e941760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6fca0>]}
[0m20:13:15.508231 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:13:15.508575 [info ] [MainThread]: 
[0m20:13:15.513608 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:13:15.514137 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m20:13:15.514559 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m20:13:15.514928 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:13:15.524084 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:13:15.524692 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:13:15.538054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:13:15.939343 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:13:15.940062 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    , 52WeekChange
    , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m20:13:16.130399 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:39b7038c-dc97-452a-a0c3-6cd889f425ec&page=queryresults
[0m20:13:16.131971 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Missing whitespace between literal and alias at [83:9]; reason: invalidQuery, location: query, message: Syntax error: Missing whitespace between literal and alias at [83:9]')
[0m20:13:16.973191 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6c9720b8-a23e-42bc-adaf-a186629616ce&page=queryresults
[0m20:13:16.973948 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6c9720b8-a23e-42bc-adaf-a186629616ce&page=queryresults
[0m20:13:17.006755 [debug] [Thread-1  ]: Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Missing whitespace between literal and alias at [83:9]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:13:17.007759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd129f0f1-b214-4062-b993-64779e941760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c463430>]}
[0m20:13:17.008181 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_info  [[31mERROR[0m in 1.49s]
[0m20:13:17.008584 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:13:17.009070 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:13:17.009401 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stg_all_nasdaq_stock_info .................. [[33mSKIP[0m]
[0m20:13:17.009774 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:13:17.010737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:17.010947 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m20:13:17.011175 [info ] [MainThread]: 
[0m20:13:17.011379 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:13:17.011797 [debug] [MainThread]: Command end result
[0m20:13:17.045487 [info ] [MainThread]: 
[0m20:13:17.045772 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:13:17.045940 [info ] [MainThread]: 
[0m20:13:17.046156 [error] [MainThread]:   Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  Syntax error: Missing whitespace between literal and alias at [83:9]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:13:17.046318 [info ] [MainThread]: 
[0m20:13:17.046498 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:13:17.047702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2030091, "process_user_time": 4.672292, "process_kernel_time": 0.170451, "process_mem_max_rss": "201457664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:13:17.047985 [debug] [MainThread]: Command `dbt run` failed at 20:13:17.047936 after 3.20 seconds
[0m20:13:17.048199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102572ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e825e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d9d00>]}
[0m20:13:17.048389 [debug] [MainThread]: Flushing usage events
[0m20:14:13.885278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fa6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e42280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e420a0>]}


============================== 20:14:13.887427 | 983efb09-af44-43d1-bedd-c5faba5d4124 ==============================
[0m20:14:13.887427 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:14:13.887748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select +stg_all_nasdaq_stock_info', 'send_anonymous_usage_stats': 'True'}
[0m20:14:14.319017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '983efb09-af44-43d1-bedd-c5faba5d4124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ad9a940>]}
[0m20:14:14.344663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '983efb09-af44-43d1-bedd-c5faba5d4124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a8fbb0>]}
[0m20:14:14.344961 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:14:14.355834 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:14:14.468485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:14.469031 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m20:14:14.591303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '983efb09-af44-43d1-bedd-c5faba5d4124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b60d130>]}
[0m20:14:14.655470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '983efb09-af44-43d1-bedd-c5faba5d4124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b01bb80>]}
[0m20:14:14.655723 [info ] [MainThread]: Found 80 models, 40 sources, 469 macros
[0m20:14:14.655917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983efb09-af44-43d1-bedd-c5faba5d4124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b666b50>]}
[0m20:14:14.657076 [info ] [MainThread]: 
[0m20:14:14.657368 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:14:14.659480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:14:14.659707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:15.062951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:14:15.063584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:15.494993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983efb09-af44-43d1-bedd-c5faba5d4124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15afb94f0>]}
[0m20:14:15.495813 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:14:15.496139 [info ] [MainThread]: 
[0m20:14:15.499928 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:15.500471 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m20:14:15.500904 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m20:14:15.501222 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:15.510224 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:14:15.511036 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:15.523802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:14:15.932802 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:14:15.933690 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    , "52WeekChange"
    , "SandP52WeekChange"
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m20:14:16.714081 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c8054b6c-2e75-448e-abf6-cba3d22fbca1&page=queryresults
[0m20:14:16.999604 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/c8054b6c-2e75-448e-abf6-cba3d22fbca1?maxResults=0&location=US&prettyPrint=false: CREATE TABLE columns must be named, but column 69 has no name at [13:7]')
[0m20:14:18.228809 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2931f060-5a22-4237-a22f-44253bcf0105&page=queryresults
[0m20:14:18.433424 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2931f060-5a22-4237-a22f-44253bcf0105&page=queryresults
[0m20:14:18.483123 [debug] [Thread-1  ]: Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  CREATE TABLE columns must be named, but column 69 has no name at [13:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:14:18.484513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '983efb09-af44-43d1-bedd-c5faba5d4124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b7626d0>]}
[0m20:14:18.485015 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_info  [[31mERROR[0m in 2.98s]
[0m20:14:18.485433 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:18.485982 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:14:18.486360 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stg_all_nasdaq_stock_info .................. [[33mSKIP[0m]
[0m20:14:18.486648 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:14:18.487788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:18.488030 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m20:14:18.488286 [info ] [MainThread]: 
[0m20:14:18.488516 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m20:14:18.488962 [debug] [MainThread]: Command end result
[0m20:14:18.525953 [info ] [MainThread]: 
[0m20:14:18.526267 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:14:18.526442 [info ] [MainThread]: 
[0m20:14:18.526669 [error] [MainThread]:   Database Error in model base_all_nasdaq_stock_info (models/1_base/base_all_nasdaq_stock_info.sql)
  CREATE TABLE columns must be named, but column 69 has no name at [13:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_nasdaq_stock_info.sql
[0m20:14:18.526848 [info ] [MainThread]: 
[0m20:14:18.527018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:14:18.528221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6893435, "process_user_time": 4.624338, "process_kernel_time": 0.184683, "process_mem_max_rss": "201965568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:14:18.528541 [debug] [MainThread]: Command `dbt run` failed at 20:14:18.528490 after 4.69 seconds
[0m20:14:18.528766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fa6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022c37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df0df0>]}
[0m20:14:18.528963 [debug] [MainThread]: Flushing usage events
[0m20:14:46.199003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101beeaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103567340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103567160>]}


============================== 20:14:46.201147 | cec90c47-7660-4026-a2f7-ac491fcf3dcc ==============================
[0m20:14:46.201147 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:14:46.201476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_all_nasdaq_stock_info', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:46.663067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e260d0>]}
[0m20:14:46.689189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef41e20>]}
[0m20:14:46.689492 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:14:46.699872 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:14:46.815864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:46.816373 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m20:14:46.938804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a751fa0>]}
[0m20:14:47.003100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3f0e80>]}
[0m20:14:47.003356 [info ] [MainThread]: Found 80 models, 40 sources, 469 macros
[0m20:14:47.003546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a7a5430>]}
[0m20:14:47.004672 [info ] [MainThread]: 
[0m20:14:47.004938 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:14:47.007019 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:14:47.007227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:47.527590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:14:47.528357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:47.883088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a0f35e0>]}
[0m20:14:47.883979 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:14:47.884327 [info ] [MainThread]: 
[0m20:14:47.888284 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:47.888788 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m20:14:47.889223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m20:14:47.889611 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:47.899442 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:14:47.900188 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:47.913358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:14:48.334947 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m20:14:48.335746 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m20:14:48.745899 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:818e53ad-d831-4fc2-8790-0fc15d1d937b&page=queryresults
[0m20:14:53.478913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef41b20>]}
[0m20:14:53.479644 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.base_all_nasdaq_stock_info .... [[32mCREATE TABLE (27.7k rows, 59.7 MiB processed)[0m in 5.59s]
[0m20:14:53.480215 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m20:14:53.480915 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:14:53.481407 [info ] [Thread-3  ]: 2 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_info .......... [RUN]
[0m20:14:53.481977 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_info'
[0m20:14:53.482360 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:14:53.485189 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m20:14:53.485914 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:14:53.488299 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:14:53.875341 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m20:14:53.877801 [debug] [Thread-3  ]: On model.stock_analysis.stg_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info` )

select
    distinct 
    *
from base
where index = 0
    );
  
[0m20:14:54.236272 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a12b0f0e-3f3c-4f12-b933-2ede017c47d5&page=queryresults
[0m20:14:57.316383 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec90c47-7660-4026-a2f7-ac491fcf3dcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a899d90>]}
[0m20:14:57.317059 [info ] [Thread-3  ]: 2 of 2 OK created sql table model stock_analysis.stg_all_nasdaq_stock_info ..... [[32mCREATE TABLE (3.9k rows, 59.7 MiB processed)[0m in 3.83s]
[0m20:14:57.317593 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m20:14:57.319312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:57.319594 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m20:14:57.319816 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m20:14:57.320103 [info ] [MainThread]: 
[0m20:14:57.320392 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m20:14:57.321016 [debug] [MainThread]: Command end result
[0m20:14:57.360916 [info ] [MainThread]: 
[0m20:14:57.361240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:57.361423 [info ] [MainThread]: 
[0m20:14:57.361609 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:14:57.362887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.209444, "process_user_time": 4.777318, "process_kernel_time": 0.186101, "process_mem_max_rss": "202833920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:14:57.363200 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:57.363150 after 11.21 seconds
[0m20:14:57.363420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101beeaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f547c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a911340>]}
[0m20:14:57.363617 [debug] [MainThread]: Flushing usage events
[0m21:52:30.955705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026eab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040632b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040630d0>]}


============================== 21:52:30.958433 | 4e43148c-3e9d-4478-881d-a2d613059839 ==============================
[0m21:52:30.958433 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:52:30.958775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history stg_all_nasdaq_stock_info int_nasdaq', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:52:31.508105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10400f2e0>]}
[0m21:52:31.534149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f075b0>]}
[0m21:52:31.534447 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:52:31.546091 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:52:31.682078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m21:52:31.682555 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m21:52:31.682750 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/4_final/nasdaq.sql
[0m21:52:31.682953 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m21:52:31.815158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244a4ee0>]}
[0m21:52:31.891035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12434c580>]}
[0m21:52:31.891378 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m21:52:31.891574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124503730>]}
[0m21:52:31.893309 [info ] [MainThread]: 
[0m21:52:31.893658 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:52:31.896108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:52:31.896342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:32.358433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:52:32.359192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:52:32.771813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12402ae20>]}
[0m21:52:32.772699 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m21:52:32.773054 [info ] [MainThread]: 
[0m21:52:32.778481 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:52:32.778867 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m21:52:32.779379 [info ] [Thread-1  ]: 1 of 3 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m21:52:32.779884 [info ] [Thread-2  ]: 2 of 3 START sql table model stock_analysis.stg_all_nasdaq_stock_info .......... [RUN]
[0m21:52:32.780310 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m21:52:32.780786 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_info'
[0m21:52:32.781181 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:52:32.781513 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m21:52:32.790682 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m21:52:32.794159 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m21:52:32.794655 [debug] [Thread-2  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m21:52:32.807186 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:52:32.807582 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:52:32.827076 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m21:52:32.891891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:52:32.950673 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)




select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m21:52:33.363512 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m21:52:33.366036 [debug] [Thread-2  ]: On model.stock_analysis.stg_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info` )

select
    distinct 
    *
from base
where index = 0
    );
  
[0m21:52:33.735957 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:450c1d6d-6ea6-43cb-8b36-cc1a286c0870&page=queryresults
[0m21:52:33.737682 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4e02af00-3a10-4381-86c4-6ea313e133b9&page=queryresults
[0m21:52:36.810697 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246011c0>]}
[0m21:52:36.811424 [info ] [Thread-2  ]: 2 of 3 OK created sql table model stock_analysis.stg_all_nasdaq_stock_info ..... [[32mCREATE TABLE (3.9k rows, 59.7 MiB processed)[0m in 4.03s]
[0m21:52:36.811926 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m21:52:41.124666 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/4e02af00-3a10-4381-86c4-6ea313e133b9?maxResults=0&location=US&prettyPrint=false: division by zero: 0 / 0')
[0m21:52:41.611854 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ae87fdb0-3ee2-44f6-a44a-608d2b2ea7af&page=queryresults
[0m21:52:49.522646 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ae87fdb0-3ee2-44f6-a44a-608d2b2ea7af&page=queryresults
[0m21:52:49.572288 [debug] [Thread-1  ]: Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  division by zero: 0 / 0
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m21:52:49.572745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e43148c-3e9d-4478-881d-a2d613059839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124601160>]}
[0m21:52:49.573223 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model stock_analysis.stg_all_nasdaq_stock_history  [[31mERROR[0m in 16.79s]
[0m21:52:49.573631 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:52:49.574193 [debug] [Thread-4  ]: Began running node model.stock_analysis.int_nasdaq
[0m21:52:49.574569 [info ] [Thread-4  ]: 3 of 3 SKIP relation stock_analysis.int_nasdaq ................................. [[33mSKIP[0m]
[0m21:52:49.574852 [debug] [Thread-4  ]: Finished running node model.stock_analysis.int_nasdaq
[0m21:52:49.575819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:49.575996 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m21:52:49.576156 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m21:52:49.576373 [info ] [MainThread]: 
[0m21:52:49.576578 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 17.68 seconds (17.68s).
[0m21:52:49.577102 [debug] [MainThread]: Command end result
[0m21:52:49.614165 [info ] [MainThread]: 
[0m21:52:49.614466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:52:49.614633 [info ] [MainThread]: 
[0m21:52:49.614840 [error] [MainThread]:   Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  division by zero: 0 / 0
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m21:52:49.614998 [info ] [MainThread]: 
[0m21:52:49.615171 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m21:52:49.616631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.70884, "process_user_time": 3.088815, "process_kernel_time": 1.766143, "process_mem_max_rss": "201375744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:52:49.616922 [debug] [MainThread]: Command `dbt run` failed at 21:52:49.616878 after 18.71 seconds
[0m21:52:49.617136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026eab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a52910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246ea3d0>]}
[0m21:52:49.617335 [debug] [MainThread]: Flushing usage events
[0m21:57:16.862930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102636a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c3190>]}


============================== 21:57:16.865478 | e22ceb26-307e-4fa2-9b2a-048828afc3bc ==============================
[0m21:57:16.865478 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:57:16.865789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history int_nasdaq', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:57:17.359926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e22ceb26-307e-4fa2-9b2a-048828afc3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d8b1c0>]}
[0m21:57:17.385531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e22ceb26-307e-4fa2-9b2a-048828afc3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ba310>]}
[0m21:57:17.385814 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:57:17.398163 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:57:17.534884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:17.535427 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m21:57:17.660385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e22ceb26-307e-4fa2-9b2a-048828afc3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c28a130>]}
[0m21:57:17.729750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e22ceb26-307e-4fa2-9b2a-048828afc3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a793cd0>]}
[0m21:57:17.730023 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m21:57:17.730207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e22ceb26-307e-4fa2-9b2a-048828afc3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4514f0>]}
[0m21:57:17.731547 [info ] [MainThread]: 
[0m21:57:17.731855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:57:17.734034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:57:17.734244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:18.188571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:57:18.189251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:18.639685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e22ceb26-307e-4fa2-9b2a-048828afc3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414b5b0>]}
[0m21:57:18.640495 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m21:57:18.640834 [info ] [MainThread]: 
[0m21:57:18.645841 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:57:18.646378 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m21:57:18.646781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m21:57:18.647096 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:57:18.656774 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m21:57:18.657701 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:57:18.687564 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m21:57:18.688199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:57:18.749974 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((safe_divide(avg_daily_price_week_end/avg_daily_price_week_start))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((safe_divide(avg_daily_price_month_end/avg_daily_price_month_start))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((safe_divide(avg_daily_price_year_end/avg_daily_price_year_start))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)




select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m21:57:19.349552 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f76cdf6f-0bb4-45b5-8b32-52d7f2055685&page=queryresults
[0m21:57:19.493456 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]; reason: invalidQuery, location: query, message: No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]')
[0m21:57:20.784696 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9df80756-4c47-4e95-8ac6-b5c7a5581d9d&page=queryresults
[0m21:57:20.910421 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9df80756-4c47-4e95-8ac6-b5c7a5581d9d&page=queryresults
[0m21:57:20.953168 [debug] [Thread-1  ]: Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m21:57:20.954517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e22ceb26-307e-4fa2-9b2a-048828afc3bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c55ff10>]}
[0m21:57:20.955018 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.stg_all_nasdaq_stock_history  [[31mERROR[0m in 2.31s]
[0m21:57:20.955442 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:57:20.955983 [debug] [Thread-3  ]: Began running node model.stock_analysis.int_nasdaq
[0m21:57:20.956351 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.int_nasdaq ................................. [[33mSKIP[0m]
[0m21:57:20.956713 [debug] [Thread-3  ]: Finished running node model.stock_analysis.int_nasdaq
[0m21:57:20.957754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:20.957930 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m21:57:20.958144 [info ] [MainThread]: 
[0m21:57:20.958344 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m21:57:20.958744 [debug] [MainThread]: Command end result
[0m21:57:20.994099 [info ] [MainThread]: 
[0m21:57:20.994395 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:57:20.994560 [info ] [MainThread]: 
[0m21:57:20.994775 [error] [MainThread]:   Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m21:57:20.994939 [info ] [MainThread]: 
[0m21:57:20.995105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m21:57:20.996506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.179848, "process_user_time": 4.239783, "process_kernel_time": 0.430607, "process_mem_max_rss": "200327168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:20.996827 [debug] [MainThread]: Command `dbt run` failed at 21:57:20.996778 after 4.18 seconds
[0m21:57:20.997042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102636a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5bb040>]}
[0m21:57:20.997234 [debug] [MainThread]: Flushing usage events
[0m21:59:57.776326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043eaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d63370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d63190>]}


============================== 21:59:57.778943 | 81558341-c5bc-4d44-9f6e-0ad6b11291e9 ==============================
[0m21:59:57.778943 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:59:57.779254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history int_nasdaq', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:59:58.328825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81558341-c5bc-4d44-9f6e-0ad6b11291e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa0b1c0>]}
[0m21:59:58.354883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81558341-c5bc-4d44-9f6e-0ad6b11291e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e310>]}
[0m21:59:58.355183 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:59:58.367050 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:59:58.497926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:59:58.498415 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m21:59:58.620013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81558341-c5bc-4d44-9f6e-0ad6b11291e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a10a130>]}
[0m21:59:58.693421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81558341-c5bc-4d44-9f6e-0ad6b11291e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe13cd0>]}
[0m21:59:58.693745 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m21:59:58.693940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81558341-c5bc-4d44-9f6e-0ad6b11291e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1d14f0>]}
[0m21:59:58.695388 [info ] [MainThread]: 
[0m21:59:58.695737 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:59:58.697927 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:59:58.698147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:59.520775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:59:59.521529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:59.971809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81558341-c5bc-4d44-9f6e-0ad6b11291e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105beb5b0>]}
[0m21:59:59.972552 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m21:59:59.972825 [info ] [MainThread]: 
[0m21:59:59.977330 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:59:59.977804 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m21:59:59.978204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m21:59:59.978560 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m21:59:59.986370 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m21:59:59.986921 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:00:00.014007 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:00:00.014622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:00.075410 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(volume)/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((safe_divide(cast(avg_daily_price_week_end as float64)/cast(avg_daily_price_week_start as float64)))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((safe_divide(cast(avg_daily_price_month_end as float64)/cast(avg_daily_price_month_start as float64)))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((safe_divide(cast(avg_daily_price_year_end as float64)/cast(avg_daily_price_year_start as float64)))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)




select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m22:00:00.839487 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a636e7d3-94dd-42ba-bdf2-20e536c61687&page=queryresults
[0m22:00:00.968179 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]; reason: invalidQuery, location: query, message: No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]')
[0m22:00:01.838406 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3ed779b6-85cc-4390-876b-cd9385ecaea1&page=queryresults
[0m22:00:02.027742 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3ed779b6-85cc-4390-876b-cd9385ecaea1&page=queryresults
[0m22:00:02.079694 [debug] [Thread-1  ]: Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:00:02.080785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81558341-c5bc-4d44-9f6e-0ad6b11291e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a3e0f70>]}
[0m22:00:02.081160 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.stg_all_nasdaq_stock_history  [[31mERROR[0m in 2.10s]
[0m22:00:02.081484 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:00:02.081925 [debug] [Thread-3  ]: Began running node model.stock_analysis.int_nasdaq
[0m22:00:02.082214 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.int_nasdaq ................................. [[33mSKIP[0m]
[0m22:00:02.082439 [debug] [Thread-3  ]: Finished running node model.stock_analysis.int_nasdaq
[0m22:00:02.083249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:02.083426 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m22:00:02.083632 [info ] [MainThread]: 
[0m22:00:02.083802 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m22:00:02.084155 [debug] [MainThread]: Command end result
[0m22:00:02.116177 [info ] [MainThread]: 
[0m22:00:02.116480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:00:02.116645 [info ] [MainThread]: 
[0m22:00:02.116863 [error] [MainThread]:   Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  No matching signature for function SAFE_DIVIDE for argument types: FLOAT64. Supported signatures: SAFE_DIVIDE(FLOAT64, FLOAT64); SAFE_DIVIDE(NUMERIC, NUMERIC); SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC) at [93:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:00:02.117037 [info ] [MainThread]: 
[0m22:00:02.117204 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:00:02.118425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.3890433, "process_user_time": 4.456978, "process_kernel_time": 0.217612, "process_mem_max_rss": "202424320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:02.118704 [debug] [MainThread]: Command `dbt run` failed at 22:00:02.118662 after 4.39 seconds
[0m22:00:02.118893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043eaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a3ea100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a427820>]}
[0m22:00:02.119087 [debug] [MainThread]: Flushing usage events
[0m22:03:31.610953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e6b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053862e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105386100>]}


============================== 22:03:31.613014 | cd2ef47d-4ca6-4343-9959-831275cd2ea7 ==============================
[0m22:03:31.613014 [info ] [MainThread]: Running with dbt=1.8.2
[0m22:03:31.613336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history int_nasdaq', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:03:32.138799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd2ef47d-4ca6-4343-9959-831275cd2ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16619b760>]}
[0m22:03:32.167259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd2ef47d-4ca6-4343-9959-831275cd2ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16cbf62e0>]}
[0m22:03:32.167699 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:03:32.179780 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m22:03:32.302343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:32.302882 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:03:32.435970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd2ef47d-4ca6-4343-9959-831275cd2ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d082df0>]}
[0m22:03:32.510353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd2ef47d-4ca6-4343-9959-831275cd2ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16cfc2ca0>]}
[0m22:03:32.510701 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m22:03:32.510914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2ef47d-4ca6-4343-9959-831275cd2ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d266670>]}
[0m22:03:32.512448 [info ] [MainThread]: 
[0m22:03:32.512784 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:32.515147 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m22:03:32.515453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:32.961609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m22:03:32.962343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:33.358267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2ef47d-4ca6-4343-9959-831275cd2ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d1b220>]}
[0m22:03:33.358899 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m22:03:33.359193 [info ] [MainThread]: 
[0m22:03:33.362094 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:03:33.362562 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m22:03:33.362928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m22:03:33.363206 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:03:33.371445 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:03:33.372108 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:03:33.400234 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:03:33.400789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:33.461951 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((nullif(open + close_last + high + low))/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)




select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m22:03:34.141987 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:71388d05-47ea-4a11-9f94-9d03ea2b2152&page=queryresults
[0m22:03:34.267899 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Number of arguments does not match for function NULLIF. Supported signature: NULLIF(ANY, ANY) at [23:19]; reason: invalidQuery, location: query, message: Number of arguments does not match for function NULLIF. Supported signature: NULLIF(ANY, ANY) at [23:19]')
[0m22:03:35.061254 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ee3e0e8b-47e7-4e70-bbd1-f7764828cc6e&page=queryresults
[0m22:03:35.373037 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ee3e0e8b-47e7-4e70-bbd1-f7764828cc6e&page=queryresults
[0m22:03:35.411343 [debug] [Thread-1  ]: Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Number of arguments does not match for function NULLIF. Supported signature: NULLIF(ANY, ANY) at [23:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:03:35.412723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2ef47d-4ca6-4343-9959-831275cd2ea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d368040>]}
[0m22:03:35.413291 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.stg_all_nasdaq_stock_history  [[31mERROR[0m in 2.05s]
[0m22:03:35.413747 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:03:35.414354 [debug] [Thread-3  ]: Began running node model.stock_analysis.int_nasdaq
[0m22:03:35.414775 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.int_nasdaq ................................. [[33mSKIP[0m]
[0m22:03:35.415074 [debug] [Thread-3  ]: Finished running node model.stock_analysis.int_nasdaq
[0m22:03:35.416303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:35.416599 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m22:03:35.416884 [info ] [MainThread]: 
[0m22:03:35.417138 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m22:03:35.417650 [debug] [MainThread]: Command end result
[0m22:03:35.455178 [info ] [MainThread]: 
[0m22:03:35.455486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:03:35.455672 [info ] [MainThread]: 
[0m22:03:35.455891 [error] [MainThread]:   Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Number of arguments does not match for function NULLIF. Supported signature: NULLIF(ANY, ANY) at [23:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:03:35.456062 [info ] [MainThread]: 
[0m22:03:35.456234 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:03:35.457399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8918424, "process_user_time": 2.847078, "process_kernel_time": 1.745418, "process_mem_max_rss": "206127104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:03:35.457698 [debug] [MainThread]: Command `dbt run` failed at 22:03:35.457649 after 3.89 seconds
[0m22:03:35.457907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e6b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16cbf62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c707c0>]}
[0m22:03:35.458116 [debug] [MainThread]: Flushing usage events
[0m22:04:01.027544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113063a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113061c0>]}


============================== 22:04:01.029639 | 54d7bf77-8cfd-46a6-b2ab-32d3d78b1246 ==============================
[0m22:04:01.029639 [info ] [MainThread]: Running with dbt=1.8.2
[0m22:04:01.029965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history int_nasdaq', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:01.478132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54d7bf77-8cfd-46a6-b2ab-32d3d78b1246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146daddf0>]}
[0m22:04:01.504010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54d7bf77-8cfd-46a6-b2ab-32d3d78b1246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115fd60>]}
[0m22:04:01.504303 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:04:01.515079 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m22:04:01.626919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:04:01.627487 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:04:01.749275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54d7bf77-8cfd-46a6-b2ab-32d3d78b1246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f5ca130>]}
[0m22:04:01.813606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54d7bf77-8cfd-46a6-b2ab-32d3d78b1246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2cf910>]}
[0m22:04:01.813860 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m22:04:01.814046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54d7bf77-8cfd-46a6-b2ab-32d3d78b1246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8a6b80>]}
[0m22:04:01.815378 [info ] [MainThread]: 
[0m22:04:01.815645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:04:01.817730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m22:04:01.817955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:02.252110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m22:04:02.252843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:02.649555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54d7bf77-8cfd-46a6-b2ab-32d3d78b1246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11074f760>]}
[0m22:04:02.650475 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m22:04:02.650909 [info ] [MainThread]: 
[0m22:04:02.654833 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:04:02.655397 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m22:04:02.655859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m22:04:02.656212 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:04:02.666530 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:04:02.667257 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:04:02.698418 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:04:02.698973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:02.761597 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((nullif(open + close_last + high + low,0))/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)




select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m22:04:03.938398 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:97dea96e-cf37-4170-99a9-6d3c4319a6c7&page=queryresults
[0m22:08:09.771220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10415eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad6100>]}


============================== 22:08:09.773976 | 03a56a89-c576-4de8-8676-220024021421 ==============================
[0m22:08:09.773976 [info ] [MainThread]: Running with dbt=1.8.2
[0m22:08:09.774303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history int_nasdaq', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:08:10.285028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03a56a89-c576-4de8-8676-220024021421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c0b760>]}
[0m22:08:10.310742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03a56a89-c576-4de8-8676-220024021421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1424342e0>]}
[0m22:08:10.311013 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:08:10.322550 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m22:08:10.447880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:10.448180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:10.471600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03a56a89-c576-4de8-8676-220024021421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143111100>]}
[0m22:08:10.541764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03a56a89-c576-4de8-8676-220024021421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14311ae20>]}
[0m22:08:10.542026 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m22:08:10.542212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03a56a89-c576-4de8-8676-220024021421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1431145e0>]}
[0m22:08:10.543534 [info ] [MainThread]: 
[0m22:08:10.543796 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:08:10.545878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m22:08:10.546084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:11.006565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m22:08:11.007135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:11.418398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03a56a89-c576-4de8-8676-220024021421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d78610>]}
[0m22:08:11.419149 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m22:08:11.419481 [info ] [MainThread]: 
[0m22:08:11.424654 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:08:11.425246 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m22:08:11.425714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m22:08:11.426101 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:08:11.436760 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:08:11.437534 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:08:11.469161 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:08:11.469762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:08:11.532424 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((nullif(open + close_last + high + low,0))/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)




select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m22:08:12.163496 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9b3720ea-b6fb-4bc4-852e-4f3d58daadda&page=queryresults
[0m22:15:36.859520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063832e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106383100>]}


============================== 22:15:36.862111 | baa4abd9-71c7-4932-a30c-b1c96abe22d0 ==============================
[0m22:15:36.862111 [info ] [MainThread]: Running with dbt=1.8.2
[0m22:15:36.862421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history int_nasdaq', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:37.400033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baa4abd9-71c7-4932-a30c-b1c96abe22d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275c3520>]}
[0m22:15:37.425784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baa4abd9-71c7-4932-a30c-b1c96abe22d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275f9d90>]}
[0m22:15:37.426071 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:15:37.437455 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m22:15:37.565538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:15:37.566052 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:15:37.688930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baa4abd9-71c7-4932-a30c-b1c96abe22d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132ed4e20>]}
[0m22:15:37.759008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baa4abd9-71c7-4932-a30c-b1c96abe22d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132a93a60>]}
[0m22:15:37.759266 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m22:15:37.759457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa4abd9-71c7-4932-a30c-b1c96abe22d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132e9a700>]}
[0m22:15:37.760814 [info ] [MainThread]: 
[0m22:15:37.761100 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:15:37.763251 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m22:15:37.763451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:38.170513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m22:15:38.171136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:38.567052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa4abd9-71c7-4932-a30c-b1c96abe22d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132bf5eb0>]}
[0m22:15:38.567861 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m22:15:38.568215 [info ] [MainThread]: 
[0m22:15:38.573658 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:15:38.574430 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m22:15:38.575097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m22:15:38.575469 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:15:38.585075 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:15:38.586747 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:15:38.618525 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:15:38.619649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:38.682229 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)




select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m22:15:39.017414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:79b3491a-c3a1-4360-aa78-a88002939f96&page=queryresults
[0m22:15:39.019699 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword FROM at [94:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword FROM at [94:5]')
[0m22:15:39.648344 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a0474f11-7359-4679-a380-55c05bdd4d35&page=queryresults
[0m22:15:39.649546 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a0474f11-7359-4679-a380-55c05bdd4d35&page=queryresults
[0m22:15:39.697710 [debug] [Thread-1  ]: Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Syntax error: Expected ")" but got keyword FROM at [94:5]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:15:39.699113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baa4abd9-71c7-4932-a30c-b1c96abe22d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133198ee0>]}
[0m22:15:39.699611 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.stg_all_nasdaq_stock_history  [[31mERROR[0m in 1.12s]
[0m22:15:39.700011 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:15:39.700548 [debug] [Thread-3  ]: Began running node model.stock_analysis.int_nasdaq
[0m22:15:39.700894 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.int_nasdaq ................................. [[33mSKIP[0m]
[0m22:15:39.701205 [debug] [Thread-3  ]: Finished running node model.stock_analysis.int_nasdaq
[0m22:15:39.702219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:39.702396 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m22:15:39.702613 [info ] [MainThread]: 
[0m22:15:39.702809 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m22:15:39.703226 [debug] [MainThread]: Command end result
[0m22:15:39.739684 [info ] [MainThread]: 
[0m22:15:39.739990 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:15:39.740156 [info ] [MainThread]: 
[0m22:15:39.740376 [error] [MainThread]:   Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Syntax error: Expected ")" but got keyword FROM at [94:5]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:15:39.740541 [info ] [MainThread]: 
[0m22:15:39.740716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:15:39.741985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9297917, "process_user_time": 3.456889, "process_kernel_time": 1.230661, "process_mem_max_rss": "201211904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:39.742284 [debug] [MainThread]: Command `dbt run` failed at 22:15:39.742236 after 2.93 seconds
[0m22:15:39.742501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13280aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1275f9d90>]}
[0m22:15:39.742696 [debug] [MainThread]: Flushing usage events
[0m22:18:25.822507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102372a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ceb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ceb190>]}


============================== 22:18:25.825001 | 29e3ade4-f64d-420c-b1c4-dbf8359aff92 ==============================
[0m22:18:25.825001 [info ] [MainThread]: Running with dbt=1.8.2
[0m22:18:25.825306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history int_nasdaq', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:26.299429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29e3ade4-f64d-420c-b1c4-dbf8359aff92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff041c0>]}
[0m22:18:26.325442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29e3ade4-f64d-420c-b1c4-dbf8359aff92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030f6310>]}
[0m22:18:26.325745 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m22:18:26.337189 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m22:18:26.448252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:18:26.448731 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:18:26.570410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29e3ade4-f64d-420c-b1c4-dbf8359aff92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149cc9130>]}
[0m22:18:26.634443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29e3ade4-f64d-420c-b1c4-dbf8359aff92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1499d3cd0>]}
[0m22:18:26.634711 [info ] [MainThread]: Found 82 models, 40 sources, 469 macros
[0m22:18:26.634900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29e3ade4-f64d-420c-b1c4-dbf8359aff92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d38b20>]}
[0m22:18:26.636213 [info ] [MainThread]: 
[0m22:18:26.636479 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:18:26.638563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m22:18:26.638774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:27.062375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m22:18:27.062833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:27.418744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29e3ade4-f64d-420c-b1c4-dbf8359aff92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b735b0>]}
[0m22:18:27.419514 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m22:18:27.419871 [info ] [MainThread]: 
[0m22:18:27.423667 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:18:27.424225 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m22:18:27.424668 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m22:18:27.425015 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:18:27.435799 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:18:27.436578 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:18:27.466842 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m22:18:27.467370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:18:27.529838 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)








, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)









, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)








, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)









select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
left join daily_price_movement_in_week using (year_full, week_number, symbol)
left join daily_price_movement_in_month using (year_full, month_number, symbol)
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m22:18:28.234448 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:343af413-54ae-46a3-895c-92874f05334b&page=queryresults
[0m22:30:45.540119 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Query exceeded resource limits. This query used 618943 CPU seconds but would charge only 815M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to a capacity-based pricing model, which does not have this limit. 618943 CPU seconds were used, and this query must use less than 208600 CPU seconds.; reason: billingTierLimitExceeded, message: Query exceeded resource limits. This query used 618943 CPU seconds but would charge only 815M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to a capacity-based pricing model, which does not have this limit. 618943 CPU seconds were used, and this query must use less than 208600 CPU seconds.')
[0m22:30:47.068937 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9793b852-b142-497d-9462-fcc149a02108&page=queryresults
[0m22:41:45.403802 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9793b852-b142-497d-9462-fcc149a02108&page=queryresults
[0m22:41:45.462358 [debug] [Thread-1  ]: Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Query exceeded resource limits. This query used 616216 CPU seconds but would charge only 815M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to a capacity-based pricing model, which does not have this limit. 616216 CPU seconds were used, and this query must use less than 208600 CPU seconds.
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:41:45.464391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e3ade4-f64d-420c-b1c4-dbf8359aff92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ac2a790>]}
[0m22:41:45.465421 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.stg_all_nasdaq_stock_history  [[31mERROR[0m in 1398.04s]
[0m22:41:45.465980 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m22:41:45.466978 [debug] [Thread-3  ]: Began running node model.stock_analysis.int_nasdaq
[0m22:41:45.467363 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.int_nasdaq ................................. [[33mSKIP[0m]
[0m22:41:45.467819 [debug] [Thread-3  ]: Finished running node model.stock_analysis.int_nasdaq
[0m22:41:45.469029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:45.469227 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m22:41:45.469477 [info ] [MainThread]: 
[0m22:41:45.469692 [info ] [MainThread]: Finished running 2 table models in 0 hours 23 minutes and 18.83 seconds (1398.83s).
[0m22:41:45.470205 [debug] [MainThread]: Command end result
[0m22:41:45.550528 [info ] [MainThread]: 
[0m22:41:45.550804 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:41:45.550969 [info ] [MainThread]: 
[0m22:41:45.551180 [error] [MainThread]:   Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Query exceeded resource limits. This query used 616216 CPU seconds but would charge only 815M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to a capacity-based pricing model, which does not have this limit. 616216 CPU seconds were used, and this query must use less than 208600 CPU seconds.
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m22:41:45.551346 [info ] [MainThread]: 
[0m22:41:45.551505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:41:45.553097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1399.7826, "process_user_time": 5.933301, "process_kernel_time": 1.058159, "process_mem_max_rss": "201768960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:41:45.553365 [debug] [MainThread]: Command `dbt run` failed at 22:41:45.553322 after 1399.78 seconds
[0m22:41:45.553565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102372a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ac2adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ac2ac70>]}
[0m22:41:45.553742 [debug] [MainThread]: Flushing usage events
[0m00:19:46.569646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108743340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108743160>]}


============================== 00:19:46.572483 | d494c03f-3347-403a-8d7e-d743b0177376 ==============================
[0m00:19:46.572483 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:19:46.572797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_nasdaq_history_base', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:19:47.140065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd494c03f-3347-403a-8d7e-d743b0177376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cee0d0>]}
[0m00:19:47.168344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd494c03f-3347-403a-8d7e-d743b0177376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e741e20>]}
[0m00:19:47.168720 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:19:47.180695 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:19:47.312429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:19:47.312914 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m00:19:47.437931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd494c03f-3347-403a-8d7e-d743b0177376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15274afa0>]}
[0m00:19:47.507584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd494c03f-3347-403a-8d7e-d743b0177376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152749f40>]}
[0m00:19:47.507881 [info ] [MainThread]: Found 83 models, 40 sources, 469 macros
[0m00:19:47.508076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd494c03f-3347-403a-8d7e-d743b0177376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15983d100>]}
[0m00:19:47.509248 [info ] [MainThread]: 
[0m00:19:47.509522 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:19:47.509958 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:19:47.510170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:48.006353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:19:48.006882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:48.406150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd494c03f-3347-403a-8d7e-d743b0177376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152740e20>]}
[0m00:19:48.406769 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:19:48.407077 [info ] [MainThread]: 
[0m00:19:48.411882 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nasdaq_history_base
[0m00:19:48.412313 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_nasdaq_history_base ............ [RUN]
[0m00:19:48.412684 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_nasdaq_history_base)
[0m00:19:48.412918 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nasdaq_history_base
[0m00:19:48.419811 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_base"
[0m00:19:48.420512 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nasdaq_history_base
[0m00:19:48.444731 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_history_base"
[0m00:19:48.445599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:19:48.512306 [debug] [Thread-1  ]: On model.stock_analysis.stg_nasdaq_history_base: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_history_base"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

select * from base
    );
  
[0m00:19:49.143452 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:da49262b-05e1-4849-a72c-925b2cbc580d&page=queryresults
[0m00:19:58.781853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd494c03f-3347-403a-8d7e-d743b0177376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1598d75b0>]}
[0m00:19:58.782542 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_nasdaq_history_base ....... [[32mCREATE TABLE (12.5m rows, 814.4 MiB processed)[0m in 10.37s]
[0m00:19:58.783126 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nasdaq_history_base
[0m00:19:58.784728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:58.785007 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_base' was properly closed.
[0m00:19:58.785290 [info ] [MainThread]: 
[0m00:19:58.785575 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m00:19:58.786098 [debug] [MainThread]: Command end result
[0m00:19:58.828203 [info ] [MainThread]: 
[0m00:19:58.828593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:58.828797 [info ] [MainThread]: 
[0m00:19:58.829000 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:19:58.830776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.312285, "process_user_time": 4.423686, "process_kernel_time": 0.20562, "process_mem_max_rss": "202620928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:19:58.831117 [debug] [MainThread]: Command `dbt run` succeeded at 00:19:58.831062 after 12.31 seconds
[0m00:19:58.831345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1526f4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cee0d0>]}
[0m00:19:58.831556 [debug] [MainThread]: Flushing usage events
[0m00:27:46.968000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106147340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106147160>]}


============================== 00:27:46.970658 | 32296a97-ba8d-4193-9005-89c0d7ffa220 ==============================
[0m00:27:46.970658 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:27:46.970980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_nasdaq_history_weekly_monthly_yearly_price', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:27:47.517712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32296a97-ba8d-4193-9005-89c0d7ffa220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151cfb1c0>]}
[0m00:27:47.543506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32296a97-ba8d-4193-9005-89c0d7ffa220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3a310>]}
[0m00:27:47.543791 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:27:47.556154 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:27:47.683656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:27:47.684148 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m00:27:47.684378 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m00:27:47.807786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32296a97-ba8d-4193-9005-89c0d7ffa220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d4a130>]}
[0m00:27:47.879641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32296a97-ba8d-4193-9005-89c0d7ffa220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152c05e50>]}
[0m00:27:47.879947 [info ] [MainThread]: Found 84 models, 40 sources, 469 macros
[0m00:27:47.880148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32296a97-ba8d-4193-9005-89c0d7ffa220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d1e6d0>]}
[0m00:27:47.881278 [info ] [MainThread]: 
[0m00:27:47.881572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:27:47.882013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:27:47.882222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:48.325833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:27:48.326496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:27:48.711879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32296a97-ba8d-4193-9005-89c0d7ffa220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152c050d0>]}
[0m00:27:48.712528 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:27:48.712833 [info ] [MainThread]: 
[0m00:27:48.716507 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m00:27:48.716938 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price  [RUN]
[0m00:27:48.717276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price)
[0m00:27:48.717546 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m00:27:48.725655 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price"
[0m00:27:48.726306 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m00:27:48.753930 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price"
[0m00:27:48.754509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:27:48.814511 [debug] [Thread-1  ]: On model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_weekly_monthly_yearly_price`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base` )

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)








select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
    );
  
[0m00:27:49.404234 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bb4eaaca-caee-41db-aab4-bcba031106cd&page=queryresults
[0m00:28:11.973720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32296a97-ba8d-4193-9005-89c0d7ffa220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152f5abb0>]}
[0m00:28:11.974412 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price  [[32mCREATE TABLE (12.5m rows, 4.3 GiB processed)[0m in 23.26s]
[0m00:28:11.974932 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m00:28:11.976719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:11.977163 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price' was properly closed.
[0m00:28:11.977494 [info ] [MainThread]: 
[0m00:28:11.977806 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 24.10 seconds (24.10s).
[0m00:28:11.978387 [debug] [MainThread]: Command end result
[0m00:28:12.016660 [info ] [MainThread]: 
[0m00:28:12.017121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:12.017396 [info ] [MainThread]: 
[0m00:28:12.017613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:28:12.019103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.09861, "process_user_time": 2.061004, "process_kernel_time": 2.698722, "process_mem_max_rss": "200409088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:28:12.019436 [debug] [MainThread]: Command `dbt run` succeeded at 00:28:12.019379 after 25.10 seconds
[0m00:28:12.019660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053317c0>]}
[0m00:28:12.019882 [debug] [MainThread]: Flushing usage events
[0m00:36:39.776461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c2160>]}


============================== 00:36:39.779031 | 513d4785-cba9-4757-8b26-1ae4e58c0acc ==============================
[0m00:36:39.779031 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:36:39.779352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_nasdaq_weekly_price_movement', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:36:40.321836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '513d4785-cba9-4757-8b26-1ae4e58c0acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796b0d0>]}
[0m00:36:40.347550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '513d4785-cba9-4757-8b26-1ae4e58c0acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156141e20>]}
[0m00:36:40.347848 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:36:40.359175 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:36:40.488296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:36:40.488786 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m00:36:40.489032 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m00:36:40.613288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '513d4785-cba9-4757-8b26-1ae4e58c0acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a099130>]}
[0m00:36:40.681565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '513d4785-cba9-4757-8b26-1ae4e58c0acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a093cd0>]}
[0m00:36:40.681823 [info ] [MainThread]: Found 85 models, 40 sources, 469 macros
[0m00:36:40.682016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '513d4785-cba9-4757-8b26-1ae4e58c0acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a5430d0>]}
[0m00:36:40.683128 [info ] [MainThread]: 
[0m00:36:40.683400 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:36:40.683817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:36:40.684026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:36:41.296159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:36:41.296855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:36:41.672992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '513d4785-cba9-4757-8b26-1ae4e58c0acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a0913d0>]}
[0m00:36:41.673972 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:36:41.674305 [info ] [MainThread]: 
[0m00:36:41.679504 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:36:41.679990 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_nasdaq_weekly_price_movement ... [RUN]
[0m00:36:41.680403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_nasdaq_weekly_price_movement)
[0m00:36:41.680768 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:36:41.688884 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_weekly_price_movement"
[0m00:36:41.689709 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:36:41.718210 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_weekly_price_movement"
[0m00:36:41.718816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:36:41.779725 [debug] [Thread-1  ]: On model.stock_analysis.stg_nasdaq_weekly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_weekly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_weekly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base` )


, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)



select
    distinct *
from base
left join daily_price_movement_in_week using (year_full, week_number, symbol)
    );
  
[0m00:36:42.417169 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:43d691f1-c2f4-4f40-ac05-853b09937acd&page=queryresults
[0m00:36:59.616585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513d4785-cba9-4757-8b26-1ae4e58c0acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a5daeb0>]}
[0m00:36:59.617391 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_nasdaq_weekly_price_movement  [[32mCREATE TABLE (12.5m rows, 4.3 GiB processed)[0m in 17.94s]
[0m00:36:59.617926 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:36:59.619407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:36:59.619646 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement' was properly closed.
[0m00:36:59.619870 [info ] [MainThread]: 
[0m00:36:59.620122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.94 seconds (18.94s).
[0m00:36:59.620610 [debug] [MainThread]: Command end result
[0m00:36:59.660524 [info ] [MainThread]: 
[0m00:36:59.660880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:36:59.661059 [info ] [MainThread]: 
[0m00:36:59.661236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:36:59.662705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.934479, "process_user_time": 4.463026, "process_kernel_time": 0.202484, "process_mem_max_rss": "200065024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:36:59.663018 [debug] [MainThread]: Command `dbt run` succeeded at 00:36:59.662965 after 19.93 seconds
[0m00:36:59.663233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156f5aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c9e7c0>]}
[0m00:36:59.663422 [debug] [MainThread]: Flushing usage events
[0m00:43:45.512339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077233a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077231c0>]}


============================== 00:43:45.514970 | 08b43236-bec6-4672-a25d-e933956a04b2 ==============================
[0m00:43:45.514970 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:43:45.515284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_nasdaq_monthly_price_movement', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:43:46.012431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08b43236-bec6-4672-a25d-e933956a04b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b6c2d30>]}
[0m00:43:46.038029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08b43236-bec6-4672-a25d-e933956a04b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dc070>]}
[0m00:43:46.038306 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:43:46.050229 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:43:46.177144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:43:46.177642 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m00:43:46.177871 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m00:43:46.300661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08b43236-bec6-4672-a25d-e933956a04b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd87130>]}
[0m00:43:46.370674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08b43236-bec6-4672-a25d-e933956a04b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb499d0>]}
[0m00:43:46.370939 [info ] [MainThread]: Found 86 models, 40 sources, 469 macros
[0m00:43:46.371124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08b43236-bec6-4672-a25d-e933956a04b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c931070>]}
[0m00:43:46.372241 [info ] [MainThread]: 
[0m00:43:46.372519 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:43:46.372957 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:43:46.373160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:46.796436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:43:46.797120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:43:47.172095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08b43236-bec6-4672-a25d-e933956a04b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb412e0>]}
[0m00:43:47.172693 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:43:47.172937 [info ] [MainThread]: 
[0m00:43:47.176039 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:43:47.176418 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_nasdaq_monthly_price_movement .. [RUN]
[0m00:43:47.176724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_nasdaq_monthly_price_movement)
[0m00:43:47.176969 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:43:47.184199 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_monthly_price_movement"
[0m00:43:47.184911 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:43:47.211869 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_monthly_price_movement"
[0m00:43:47.212445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:43:47.272100 [debug] [Thread-1  ]: On model.stock_analysis.stg_nasdaq_monthly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_monthly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_monthly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base` )

, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






select
    distinct *
from base
left join daily_price_movement_in_month using (year_full, month_number, symbol)
    );
  
[0m00:43:47.837960 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f36e37ee-1e65-49d9-8803-82497a672f44&page=queryresults
[0m00:44:05.832763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08b43236-bec6-4672-a25d-e933956a04b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c9cd4f0>]}
[0m00:44:05.833551 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_nasdaq_monthly_price_movement  [[32mCREATE TABLE (12.5m rows, 4.3 GiB processed)[0m in 18.66s]
[0m00:44:05.834136 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:44:05.835985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:05.836299 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_monthly_price_movement' was properly closed.
[0m00:44:05.836579 [info ] [MainThread]: 
[0m00:44:05.836868 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.46 seconds (19.46s).
[0m00:44:05.837443 [debug] [MainThread]: Command end result
[0m00:44:05.881017 [info ] [MainThread]: 
[0m00:44:05.881350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:05.881535 [info ] [MainThread]: 
[0m00:44:05.881721 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:44:05.882990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.417894, "process_user_time": 4.227208, "process_kernel_time": 0.438913, "process_mem_max_rss": "200916992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:44:05.883291 [debug] [MainThread]: Command `dbt run` succeeded at 00:44:05.883241 after 20.42 seconds
[0m00:44:05.883502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711edc0>]}
[0m00:44:05.883701 [debug] [MainThread]: Flushing usage events
[0m00:46:38.754493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046aeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060263a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060261c0>]}


============================== 00:46:38.757182 | a729e28e-cf3f-41c5-acbf-aba31a1d52d1 ==============================
[0m00:46:38.757182 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:46:38.757520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_nasdaq_yearly_price_movement', 'send_anonymous_usage_stats': 'True'}
[0m00:46:39.304943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a729e28e-cf3f-41c5-acbf-aba31a1d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d20fd0>]}
[0m00:46:39.331042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a729e28e-cf3f-41c5-acbf-aba31a1d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf52b0>]}
[0m00:46:39.331328 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:46:39.343105 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:46:39.474228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:46:39.474707 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m00:46:39.597902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a729e28e-cf3f-41c5-acbf-aba31a1d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145414130>]}
[0m00:46:39.667348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a729e28e-cf3f-41c5-acbf-aba31a1d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144f9b790>]}
[0m00:46:39.667604 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m00:46:39.667792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a729e28e-cf3f-41c5-acbf-aba31a1d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1454f5a30>]}
[0m00:46:39.668941 [info ] [MainThread]: 
[0m00:46:39.669207 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:46:39.669635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:46:39.669841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:40.156827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:46:40.157482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:46:40.563777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a729e28e-cf3f-41c5-acbf-aba31a1d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145252160>]}
[0m00:46:40.564251 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:46:40.564462 [info ] [MainThread]: 
[0m00:46:40.568192 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:46:40.568560 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_nasdaq_yearly_price_movement ... [RUN]
[0m00:46:40.568903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_nasdaq_yearly_price_movement)
[0m00:46:40.569191 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:46:40.575825 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_yearly_price_movement"
[0m00:46:40.576468 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:46:40.601756 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_yearly_price_movement"
[0m00:46:40.602385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:46:40.661135 [debug] [Thread-1  ]: On model.stock_analysis.stg_nasdaq_yearly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_yearly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_yearly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base` )

, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)









select
    distinct *
from base
left join daily_price_movement_in_year using (year_full, symbol)
    );
  
[0m00:46:41.369692 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:122468d6-3f91-4b20-8ff3-0086c302e525&page=queryresults
[0m00:47:45.541331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a729e28e-cf3f-41c5-acbf-aba31a1d52d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14568dbb0>]}
[0m00:47:45.542854 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_nasdaq_yearly_price_movement  [[32mCREATE TABLE (12.5m rows, 4.3 GiB processed)[0m in 64.97s]
[0m00:47:45.543722 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:47:45.546369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:45.546691 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_yearly_price_movement' was properly closed.
[0m00:47:45.547108 [info ] [MainThread]: 
[0m00:47:45.547407 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 5.88 seconds (65.88s).
[0m00:47:45.547940 [debug] [MainThread]: Command end result
[0m00:47:45.591670 [info ] [MainThread]: 
[0m00:47:45.592065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:47:45.592256 [info ] [MainThread]: 
[0m00:47:45.592455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:47:45.594053 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 66.88654, "process_user_time": 3.555055, "process_kernel_time": 1.189885, "process_mem_max_rss": "199180288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:47:45.594428 [debug] [MainThread]: Command `dbt run` succeeded at 00:47:45.594374 after 66.89 seconds
[0m00:47:45.594694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046aeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a14d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144e8f1c0>]}
[0m00:47:45.594914 [debug] [MainThread]: Flushing usage events
[0m00:50:53.765944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c6eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e61c0>]}


============================== 00:50:53.768653 | d0d920aa-2e53-4664-af93-c8e7afea4055 ==============================
[0m00:50:53.768653 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:50:53.768976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_nasdaq_weekly_price_movement stg_nasdaq_monthly_price_movement stg_nasdaq_yearly_price_movement', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:54.269786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e0fd0>]}
[0m00:50:54.296028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b52b0>]}
[0m00:50:54.296347 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:50:54.308887 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:50:54.435877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:50:54.436412 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m00:50:54.436648 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m00:50:54.436846 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m00:50:54.561131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bca130>]}
[0m00:50:54.629782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d285e0>]}
[0m00:50:54.630046 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m00:50:54.630240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d099d0>]}
[0m00:50:54.631871 [info ] [MainThread]: 
[0m00:50:54.632157 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:50:54.634304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:50:54.634510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:55.055515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:50:55.056294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:50:55.424645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105470760>]}
[0m00:50:55.425292 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:50:55.425579 [info ] [MainThread]: 
[0m00:50:55.430812 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:50:55.431208 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:50:55.431722 [info ] [Thread-1  ]: 1 of 3 START sql table model stock_analysis.stg_nasdaq_monthly_price_movement .. [RUN]
[0m00:50:55.432152 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:50:55.432694 [info ] [Thread-2  ]: 2 of 3 START sql table model stock_analysis.stg_nasdaq_weekly_price_movement ... [RUN]
[0m00:50:55.433396 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_nasdaq_monthly_price_movement)
[0m00:50:55.433966 [info ] [Thread-3  ]: 3 of 3 START sql table model stock_analysis.stg_nasdaq_yearly_price_movement ... [RUN]
[0m00:50:55.434604 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement'
[0m00:50:55.434958 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:50:55.435389 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_yearly_price_movement'
[0m00:50:55.435745 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:50:55.443165 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_monthly_price_movement"
[0m00:50:55.443537 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:50:55.446175 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_weekly_price_movement"
[0m00:50:55.449126 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_yearly_price_movement"
[0m00:50:55.449656 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:50:55.461206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:50:55.461619 [debug] [Thread-2  ]: Began executing node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:50:55.463547 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:50:55.526394 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:50:55.530576 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m00:50:55.978830 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_weekly_price_movement"
[0m00:50:55.979724 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_monthly_price_movement"
[0m00:50:55.980894 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_nasdaq_yearly_price_movement"
[0m00:50:55.981588 [debug] [Thread-1  ]: On model.stock_analysis.stg_nasdaq_monthly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_monthly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_monthly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base` )

, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_month using (year_full, month_number, symbol)

select * from daily_price_movement_in_month
    );
  
[0m00:50:55.982060 [debug] [Thread-2  ]: On model.stock_analysis.stg_nasdaq_weekly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_weekly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_weekly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base` )

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_week using (year_full, week_number, symbol)

select * from daily_price_movement_in_week
    );
  
[0m00:50:55.982476 [debug] [Thread-3  ]: On model.stock_analysis.stg_nasdaq_yearly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_nasdaq_yearly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_nasdaq_yearly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_base` )

, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)









-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_year using (year_full, symbol)

select * from daily_price_movement_in_year
    );
  
[0m00:50:56.456550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e6b2378d-a479-4518-ab3e-097a7890fd02&page=queryresults
[0m00:50:56.457749 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ad46fb86-a809-41a6-bde4-bfdb2000eb5c&page=queryresults
[0m00:50:56.458542 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f7aadcc6-4796-4f76-92fd-96504cd59dd8&page=queryresults
[0m00:51:01.985049 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff08c10>]}
[0m00:51:01.985564 [info ] [Thread-3  ]: 3 of 3 OK created sql table model stock_analysis.stg_nasdaq_yearly_price_movement  [[32mCREATE TABLE (12.5m rows, 451.1 MiB processed)[0m in 6.55s]
[0m00:51:01.985973 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m00:51:03.459335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff08670>]}
[0m00:51:03.460671 [info ] [Thread-1  ]: 1 of 3 OK created sql table model stock_analysis.stg_nasdaq_monthly_price_movement  [[32mCREATE TABLE (12.5m rows, 546.3 MiB processed)[0m in 8.03s]
[0m00:51:03.461606 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m00:51:05.110119 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0d920aa-2e53-4664-af93-c8e7afea4055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff088e0>]}
[0m00:51:05.112509 [info ] [Thread-2  ]: 2 of 3 OK created sql table model stock_analysis.stg_nasdaq_weekly_price_movement  [[32mCREATE TABLE (12.5m rows, 498.7 MiB processed)[0m in 9.68s]
[0m00:51:05.113856 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m00:51:05.116549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:05.117075 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_monthly_price_movement' was properly closed.
[0m00:51:05.117344 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement' was properly closed.
[0m00:51:05.117599 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_yearly_price_movement' was properly closed.
[0m00:51:05.117990 [info ] [MainThread]: 
[0m00:51:05.118334 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m00:51:05.119418 [debug] [MainThread]: Command end result
[0m00:51:05.164168 [info ] [MainThread]: 
[0m00:51:05.164543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:51:05.164735 [info ] [MainThread]: 
[0m00:51:05.164923 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:51:05.166219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.45034, "process_user_time": 3.977686, "process_kernel_time": 0.988255, "process_mem_max_rss": "203915264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:51:05.166557 [debug] [MainThread]: Command `dbt run` succeeded at 00:51:05.166500 after 11.45 seconds
[0m00:51:05.166784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c6eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aec6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b52b0>]}
[0m00:51:05.166999 [debug] [MainThread]: Flushing usage events
[0m00:59:54.146410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104636ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c3130>]}


============================== 00:59:54.149972 | 739e4f8f-062e-4cde-8b40-19736a85a694 ==============================
[0m00:59:54.149972 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:59:54.150404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_all_nasdaq_history', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:59:54.712371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '739e4f8f-062e-4cde-8b40-19736a85a694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486b0a0>]}
[0m00:59:54.739322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '739e4f8f-062e-4cde-8b40-19736a85a694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625a5e0>]}
[0m00:59:54.739697 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:59:54.751298 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:59:54.880845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:59:54.881386 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m00:59:55.006956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '739e4f8f-062e-4cde-8b40-19736a85a694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1551cc130>]}
[0m00:59:55.078696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '739e4f8f-062e-4cde-8b40-19736a85a694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15508bc70>]}
[0m00:59:55.079067 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m00:59:55.079264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '739e4f8f-062e-4cde-8b40-19736a85a694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155478bb0>]}
[0m00:59:55.079860 [warn ] [MainThread]: The selection criterion 'stg_all_nasdaq_history' does not match any enabled nodes
[0m00:59:55.080680 [info ] [MainThread]: 
[0m00:59:55.080858 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:59:55.081105 [debug] [MainThread]: Command end result
[0m00:59:55.111978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0181258, "process_user_time": 4.097289, "process_kernel_time": 0.196519, "process_mem_max_rss": "198705152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:59:55.112356 [debug] [MainThread]: Command `dbt run` succeeded at 00:59:55.112304 after 1.02 seconds
[0m00:59:55.112560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104636ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106247ca0>]}
[0m00:59:55.112750 [debug] [MainThread]: Flushing usage events
[0m01:00:08.597776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111887340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111887160>]}


============================== 01:00:08.599921 | 23e7eaee-3f68-4686-a3b8-064431267d85 ==============================
[0m01:00:08.599921 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:00:08.600253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history', 'send_anonymous_usage_stats': 'True'}
[0m01:00:09.052481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e7eaee-3f68-4686-a3b8-064431267d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2b0d0>]}
[0m01:00:09.078318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e7eaee-3f68-4686-a3b8-064431267d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15eec1e20>]}
[0m01:00:09.078626 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:00:09.089283 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:00:09.206224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:09.206537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:09.230375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e7eaee-3f68-4686-a3b8-064431267d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fca4eb0>]}
[0m01:00:09.297940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e7eaee-3f68-4686-a3b8-064431267d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f97a7c0>]}
[0m01:00:09.298198 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:00:09.298388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e7eaee-3f68-4686-a3b8-064431267d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fcb9a30>]}
[0m01:00:09.299531 [info ] [MainThread]: 
[0m01:00:09.299809 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:00:09.300257 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:00:09.300480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:09.739326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:00:09.739801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:10.134957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e7eaee-3f68-4686-a3b8-064431267d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fbcaca0>]}
[0m01:00:10.135643 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:00:10.135965 [info ] [MainThread]: 
[0m01:00:10.140380 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:00:10.140896 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m01:00:10.141458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m01:00:10.142003 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:00:10.153426 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m01:00:10.155084 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:00:10.183496 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m01:00:10.185305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:10.247994 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

, nasdaq_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_weekly_monthly_yearly_price` )

, nasdaq_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_weekly_price_movement` )

, nasdaq_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_monthly_price_movement` )

, nasdaq_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_yearly_price_movement` )



select
    distinct *
from nasdaq_history_weekly_monthly_yearly_price
left join nasdaq_weekly_price_movement using (year_full, week_number, symbol)
left join nasdaq_monthly_price_movement using (year_full, month_number, symbol)
left join nasdaq_yearly_price_movement using (year_full, symbol)
    );
  
[0m01:00:10.532797 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5ad47b2b-a1d8-485e-8260-d7410aa8ca4f&page=queryresults
[0m01:00:10.534903 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "," at [15:1]; reason: invalidQuery, location: query, message: Syntax error: Unexpected "," at [15:1]')
[0m01:00:11.470017 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1a580435-b5bd-48d1-a797-8bb78b1f3aac&page=queryresults
[0m01:00:11.470848 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1a580435-b5bd-48d1-a797-8bb78b1f3aac&page=queryresults
[0m01:00:11.508536 [debug] [Thread-1  ]: Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Syntax error: Unexpected "," at [15:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m01:00:11.509743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23e7eaee-3f68-4686-a3b8-064431267d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fdcfe80>]}
[0m01:00:11.510218 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_all_nasdaq_stock_history  [[31mERROR[0m in 1.37s]
[0m01:00:11.510638 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:00:11.511815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:11.512007 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m01:00:11.512202 [info ] [MainThread]: 
[0m01:00:11.512408 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m01:00:11.512825 [debug] [MainThread]: Command end result
[0m01:00:11.549903 [info ] [MainThread]: 
[0m01:00:11.550242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:00:11.550411 [info ] [MainThread]: 
[0m01:00:11.550627 [error] [MainThread]:   Database Error in model stg_all_nasdaq_stock_history (models/2_staging/stg_all_nasdaq_stock_history.sql)
  Syntax error: Unexpected "," at [15:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_nasdaq_stock_history.sql
[0m01:00:11.550788 [info ] [MainThread]: 
[0m01:00:11.550956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:00:11.552097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9998865, "process_user_time": 3.3509, "process_kernel_time": 1.33619, "process_mem_max_rss": "200097792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:00:11.552387 [debug] [MainThread]: Command `dbt run` failed at 01:00:11.552339 after 3.00 seconds
[0m01:00:11.552588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15eec1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f97a940>]}
[0m01:00:11.552777 [debug] [MainThread]: Flushing usage events
[0m01:00:30.429233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107137a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195c3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195c3190>]}


============================== 01:00:30.431896 | b67326d9-3657-4bd7-b130-e8ae2f760b3d ==============================
[0m01:00:30.431896 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:00:30.432249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_all_nasdaq_stock_history', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:00:30.925755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b67326d9-3657-4bd7-b130-e8ae2f760b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746e7f0>]}
[0m01:00:30.952881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b67326d9-3657-4bd7-b130-e8ae2f760b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119549f10>]}
[0m01:00:30.953254 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:00:30.965777 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:00:31.101391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:00:31.101909 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m01:00:31.227849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67326d9-3657-4bd7-b130-e8ae2f760b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16730f130>]}
[0m01:00:31.300258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67326d9-3657-4bd7-b130-e8ae2f760b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166bc2eb0>]}
[0m01:00:31.300582 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:00:31.300773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67326d9-3657-4bd7-b130-e8ae2f760b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1673b9b20>]}
[0m01:00:31.301969 [info ] [MainThread]: 
[0m01:00:31.302276 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:00:31.302719 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:00:31.302929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:31.744149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:00:31.744854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:32.120050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67326d9-3657-4bd7-b130-e8ae2f760b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166e7b4c0>]}
[0m01:00:32.120818 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:00:32.121225 [info ] [MainThread]: 
[0m01:00:32.126824 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:00:32.127322 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_all_nasdaq_stock_history ....... [RUN]
[0m01:00:32.127774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m01:00:32.128151 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:00:32.136191 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m01:00:32.136744 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:00:32.167193 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m01:00:32.167804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:00:32.230272 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

nasdaq_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_history_weekly_monthly_yearly_price` )

, nasdaq_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_weekly_price_movement` )

, nasdaq_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_monthly_price_movement` )

, nasdaq_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_nasdaq_yearly_price_movement` )



select
    distinct *
from nasdaq_history_weekly_monthly_yearly_price
left join nasdaq_weekly_price_movement using (year_full, week_number, symbol)
left join nasdaq_monthly_price_movement using (year_full, month_number, symbol)
left join nasdaq_yearly_price_movement using (year_full, symbol)
    );
  
[0m01:00:32.773470 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:774105a6-0bf1-42e7-a86b-3e3e7bcfce06&page=queryresults
[0m01:13:16.353352 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67326d9-3657-4bd7-b130-e8ae2f760b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167556fa0>]}
[0m01:13:16.356401 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_all_nasdaq_stock_history .. [[32mCREATE TABLE (12.5m rows, 5.8 GiB processed)[0m in 764.22s]
[0m01:13:16.357224 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m01:13:16.360237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:16.360473 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m01:13:16.360741 [info ] [MainThread]: 
[0m01:13:16.361003 [info ] [MainThread]: Finished running 1 table model in 0 hours 12 minutes and 45.06 seconds (765.06s).
[0m01:13:16.361822 [debug] [MainThread]: Command end result
[0m01:13:16.415061 [info ] [MainThread]: 
[0m01:13:16.415630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:13:16.415831 [info ] [MainThread]: 
[0m01:13:16.416049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:13:16.418703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 766.0411, "process_user_time": 5.471759, "process_kernel_time": 0.333215, "process_mem_max_rss": "202981376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:13:16.419176 [debug] [MainThread]: Command `dbt run` succeeded at 01:13:16.419131 after 766.04 seconds
[0m01:13:16.419430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107137a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16761b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fbea60>]}
[0m01:13:16.419612 [debug] [MainThread]: Flushing usage events
[0m01:21:23.108511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102536af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c2160>]}


============================== 01:21:23.111287 | 9d383ae2-c3ef-4d8b-abcd-73b49d74daef ==============================
[0m01:21:23.111287 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:21:23.111622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select nasdaq', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:21:23.703958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d383ae2-c3ef-4d8b-abcd-73b49d74daef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10286b0d0>]}
[0m01:21:23.730517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d383ae2-c3ef-4d8b-abcd-73b49d74daef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127301e20>]}
[0m01:21:23.730870 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:21:23.742201 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:21:23.876902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:21:23.877420 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/nasdaq.sql
[0m01:21:23.877647 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m01:21:24.001784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d383ae2-c3ef-4d8b-abcd-73b49d74daef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1540cd130>]}
[0m01:21:24.072497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d383ae2-c3ef-4d8b-abcd-73b49d74daef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154138100>]}
[0m01:21:24.072766 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:21:24.072956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d383ae2-c3ef-4d8b-abcd-73b49d74daef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1541910a0>]}
[0m01:21:24.074098 [info ] [MainThread]: 
[0m01:21:24.074368 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:21:24.074797 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:21:24.074998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:24.491556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:21:24.492149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:24.902417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d383ae2-c3ef-4d8b-abcd-73b49d74daef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f8cb80>]}
[0m01:21:24.903206 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:21:24.903572 [info ] [MainThread]: 
[0m01:21:24.909571 [debug] [Thread-1  ]: Began running node model.stock_analysis.nasdaq
[0m01:21:24.910124 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.nasdaq ............................. [RUN]
[0m01:21:24.910652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.nasdaq)
[0m01:21:24.911024 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.nasdaq
[0m01:21:24.919710 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m01:21:24.920449 [debug] [Thread-1  ]: Began executing node model.stock_analysis.nasdaq
[0m01:21:24.951618 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.nasdaq"
[0m01:21:24.952303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:25.014512 [debug] [Thread-1  ]: On model.stock_analysis.nasdaq: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.nasdaq"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`nasdaq`
      
    
    

    OPTIONS()
    as (
      with

nasdaq_ticker_history as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

, nasdaq_ticker_info as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m01:21:25.325772 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8265a1eb-9274-4c49-bb6c-f88bb00ff7ec&page=queryresults
[0m01:21:25.327036 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "stock_analysis" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: stock_analysis, message: Table "stock_analysis" must be qualified with a dataset (e.g. dataset.table).')
[0m01:21:25.844657 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:23a2724e-093e-4b3f-adfc-b3e353cd9b4a&page=queryresults
[0m01:21:25.847027 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:23a2724e-093e-4b3f-adfc-b3e353cd9b4a&page=queryresults
[0m01:21:25.884989 [debug] [Thread-1  ]: Database Error in model nasdaq (models/4_final/nasdaq.sql)
  Table "stock_analysis" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/4_final/nasdaq.sql
[0m01:21:25.886285 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d383ae2-c3ef-4d8b-abcd-73b49d74daef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154505280>]}
[0m01:21:25.886753 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.nasdaq .................... [[31mERROR[0m in 0.97s]
[0m01:21:25.887165 [debug] [Thread-1  ]: Finished running node model.stock_analysis.nasdaq
[0m01:21:25.888291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:25.888472 [debug] [MainThread]: Connection 'model.stock_analysis.nasdaq' was properly closed.
[0m01:21:25.888661 [info ] [MainThread]: 
[0m01:21:25.888850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m01:21:25.889233 [debug] [MainThread]: Command end result
[0m01:21:25.925147 [info ] [MainThread]: 
[0m01:21:25.925436 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:21:25.925592 [info ] [MainThread]: 
[0m01:21:25.925787 [error] [MainThread]:   Database Error in model nasdaq (models/4_final/nasdaq.sql)
  Table "stock_analysis" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/4_final/nasdaq.sql
[0m01:21:25.925939 [info ] [MainThread]: 
[0m01:21:25.926108 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:21:25.927312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8714924, "process_user_time": 2.224661, "process_kernel_time": 2.518733, "process_mem_max_rss": "202981376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:21:25.927608 [debug] [MainThread]: Command `dbt run` failed at 01:21:25.927565 after 2.87 seconds
[0m01:21:25.927812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102536af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127301e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d8bdf0>]}
[0m01:21:25.927998 [debug] [MainThread]: Flushing usage events
[0m01:21:52.739746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034b6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051423a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051421c0>]}


============================== 01:21:52.742332 | 2963be86-6ac4-4d0f-9d0e-2d15972b1224 ==============================
[0m01:21:52.742332 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:21:52.742644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select nasdaq', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:21:53.246065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2963be86-6ac4-4d0f-9d0e-2d15972b1224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3cfd0>]}
[0m01:21:53.271931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2963be86-6ac4-4d0f-9d0e-2d15972b1224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e112b0>]}
[0m01:21:53.272215 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:21:53.283381 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:21:53.412022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:21:53.412574 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m01:21:53.412800 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/nasdaq.sql
[0m01:21:53.537952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2963be86-6ac4-4d0f-9d0e-2d15972b1224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16494b130>]}
[0m01:21:53.606764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2963be86-6ac4-4d0f-9d0e-2d15972b1224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1649b1bb0>]}
[0m01:21:53.607036 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:21:53.607226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2963be86-6ac4-4d0f-9d0e-2d15972b1224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164a12b50>]}
[0m01:21:53.608367 [info ] [MainThread]: 
[0m01:21:53.608635 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:21:53.609057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:21:53.609264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:54.055734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:21:54.056346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:54.421703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2963be86-6ac4-4d0f-9d0e-2d15972b1224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0caf40>]}
[0m01:21:54.422211 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:21:54.422446 [info ] [MainThread]: 
[0m01:21:54.426274 [debug] [Thread-1  ]: Began running node model.stock_analysis.nasdaq
[0m01:21:54.426609 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.nasdaq ............................. [RUN]
[0m01:21:54.426905 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.nasdaq)
[0m01:21:54.427116 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.nasdaq
[0m01:21:54.433219 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m01:21:54.433928 [debug] [Thread-1  ]: Began executing node model.stock_analysis.nasdaq
[0m01:21:54.459504 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.nasdaq"
[0m01:21:54.460151 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:54.519454 [debug] [Thread-1  ]: On model.stock_analysis.nasdaq: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.nasdaq"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`nasdaq`
      
    
    

    OPTIONS()
    as (
      with

nasdaq_ticker_history as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

, nasdaq_ticker_info as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info` )

select
    *
from nasdaq_ticker_history
left join nasdaq_ticker_info using (symbol)
    );
  
[0m01:21:55.099030 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cc68704b-6bfc-4fdf-95ad-19840ef8940d&page=queryresults
[0m01:21:55.294716 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/cc68704b-6bfc-4fdf-95ad-19840ef8940d?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name open at [13:7]')
[0m01:21:56.432806 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3de91105-bc0b-4c4e-b4d1-3d3453899451&page=queryresults
[0m01:21:56.625874 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3de91105-bc0b-4c4e-b4d1-3d3453899451&page=queryresults
[0m01:21:56.676965 [debug] [Thread-1  ]: Database Error in model nasdaq (models/4_final/nasdaq.sql)
  CREATE TABLE has columns with duplicate name open at [13:7]
  compiled Code at target/run/stock_analysis/models/4_final/nasdaq.sql
[0m01:21:56.678271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2963be86-6ac4-4d0f-9d0e-2d15972b1224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164a88340>]}
[0m01:21:56.678756 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.nasdaq .................... [[31mERROR[0m in 2.25s]
[0m01:21:56.679161 [debug] [Thread-1  ]: Finished running node model.stock_analysis.nasdaq
[0m01:21:56.680394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:56.680623 [debug] [MainThread]: Connection 'model.stock_analysis.nasdaq' was properly closed.
[0m01:21:56.680838 [info ] [MainThread]: 
[0m01:21:56.681046 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m01:21:56.681456 [debug] [MainThread]: Command end result
[0m01:21:56.717426 [info ] [MainThread]: 
[0m01:21:56.717748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:21:56.717918 [info ] [MainThread]: 
[0m01:21:56.718129 [error] [MainThread]:   Database Error in model nasdaq (models/4_final/nasdaq.sql)
  CREATE TABLE has columns with duplicate name open at [13:7]
  compiled Code at target/run/stock_analysis/models/4_final/nasdaq.sql
[0m01:21:56.718283 [info ] [MainThread]: 
[0m01:21:56.718443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:21:56.719634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0301, "process_user_time": 4.479343, "process_kernel_time": 0.182184, "process_mem_max_rss": "203522048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:21:56.719927 [debug] [MainThread]: Command `dbt run` failed at 01:21:56.719882 after 4.03 seconds
[0m01:21:56.720138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034b6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e7613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e112b0>]}
[0m01:21:56.720328 [debug] [MainThread]: Flushing usage events
[0m01:23:14.290090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef3250>]}


============================== 01:23:14.292691 | 0a8a6fac-213e-440a-accf-7d0edb45fbb5 ==============================
[0m01:23:14.292691 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:23:14.293017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select nasdaq', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:23:14.797478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a8a6fac-213e-440a-accf-7d0edb45fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaca00>]}
[0m01:23:14.824218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a8a6fac-213e-440a-accf-7d0edb45fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eac070>]}
[0m01:23:14.824545 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:23:14.836256 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:23:14.974684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:23:14.975243 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m01:23:15.104806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a8a6fac-213e-440a-accf-7d0edb45fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a2d2130>]}
[0m01:23:15.179181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a8a6fac-213e-440a-accf-7d0edb45fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc68160>]}
[0m01:23:15.179547 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:23:15.179750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a8a6fac-213e-440a-accf-7d0edb45fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a2bf070>]}
[0m01:23:15.181056 [info ] [MainThread]: 
[0m01:23:15.181419 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:23:15.181920 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:23:15.182150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:15.604837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:23:15.605513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:16.000872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a8a6fac-213e-440a-accf-7d0edb45fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fd9bdf0>]}
[0m01:23:16.001597 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:23:16.001972 [info ] [MainThread]: 
[0m01:23:16.007145 [debug] [Thread-1  ]: Began running node model.stock_analysis.nasdaq
[0m01:23:16.007658 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.nasdaq ............................. [RUN]
[0m01:23:16.008188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.nasdaq)
[0m01:23:16.008520 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.nasdaq
[0m01:23:16.016539 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m01:23:16.017325 [debug] [Thread-1  ]: Began executing node model.stock_analysis.nasdaq
[0m01:23:16.048136 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.nasdaq"
[0m01:23:16.048975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:23:16.111590 [debug] [Thread-1  ]: On model.stock_analysis.nasdaq: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.nasdaq"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`nasdaq`
      
    
    

    OPTIONS()
    as (
      with

nasdaq_ticker_history as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

, nasdaq_ticker_info as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info` )

select
    *
from nasdaq_ticker_history
left join nasdaq_ticker_info using (symbol)
    );
  
[0m01:23:16.751875 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06d4c0a3-de54-45e2-9c77-9af9a9f6df90&page=queryresults
[0m01:23:16.945903 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/06d4c0a3-de54-45e2-9c77-9af9a9f6df90?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name open at [13:7]')
[0m01:23:49.343800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b36ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc31c0>]}


============================== 01:23:49.345909 | 1cfeb119-747e-4da1-88ca-35326b76b6ab ==============================
[0m01:23:49.345909 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:23:49.346232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_info stg_all_nasdaq_stock_info nasdaq', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:23:49.816815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbcfd0>]}
[0m01:23:49.842994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c912b0>]}
[0m01:23:49.843311 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:23:49.854244 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:23:49.967569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:49.967876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:49.991451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1353a3eb0>]}
[0m01:23:50.058715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1353b87f0>]}
[0m01:23:50.058984 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:23:50.059171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134fe7d00>]}
[0m01:23:50.060806 [info ] [MainThread]: 
[0m01:23:50.061083 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:23:50.063222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:23:50.063440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:50.466879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:23:50.467690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:50.849107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134fcabe0>]}
[0m01:23:50.849659 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:23:50.849941 [info ] [MainThread]: 
[0m01:23:50.852872 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:23:50.853329 [info ] [Thread-1  ]: 1 of 3 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m01:23:50.853704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m01:23:50.853987 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:23:50.864877 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m01:23:50.866704 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:23:50.880637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:23:51.280500 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m01:23:51.281639 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m01:23:51.686372 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0e851cee-f7b0-42bb-b0b1-b3f4004110c3&page=queryresults
[0m01:23:55.958788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354d3fa0>]}
[0m01:23:55.959522 [info ] [Thread-1  ]: 1 of 3 OK created sql table model stock_analysis.base_all_nasdaq_stock_info .... [[32mCREATE TABLE (27.7k rows, 59.7 MiB processed)[0m in 5.10s]
[0m01:23:55.960089 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:23:55.960652 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:23:55.961036 [info ] [Thread-3  ]: 2 of 3 START sql table model stock_analysis.stg_all_nasdaq_stock_info .......... [RUN]
[0m01:23:55.961433 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_info'
[0m01:23:55.961618 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:23:55.964012 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m01:23:55.964664 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:23:55.967438 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:23:56.332987 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m01:23:56.335697 [debug] [Thread-3  ]: On model.stock_analysis.stg_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info` )

select
    distinct 
    *
from base
where index = 0
    );
  
[0m01:23:56.704568 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0b52355d-9edd-4dce-9cee-03b0665d6fc3&page=queryresults
[0m01:23:59.412932 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354d3eb0>]}
[0m01:23:59.413882 [info ] [Thread-3  ]: 2 of 3 OK created sql table model stock_analysis.stg_all_nasdaq_stock_info ..... [[32mCREATE TABLE (3.9k rows, 59.7 MiB processed)[0m in 3.45s]
[0m01:23:59.414621 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:23:59.415479 [debug] [Thread-5  ]: Began running node model.stock_analysis.nasdaq
[0m01:23:59.416178 [info ] [Thread-5  ]: 3 of 3 START sql table model stock_analysis.nasdaq ............................. [RUN]
[0m01:23:59.416828 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.nasdaq'
[0m01:23:59.417194 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.nasdaq
[0m01:23:59.421011 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m01:23:59.422021 [debug] [Thread-5  ]: Began executing node model.stock_analysis.nasdaq
[0m01:23:59.425694 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.nasdaq"
[0m01:23:59.426662 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m01:23:59.496944 [debug] [Thread-5  ]: On model.stock_analysis.nasdaq: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.nasdaq"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`nasdaq`
      
    
    

    OPTIONS()
    as (
      with

nasdaq_ticker_history as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

, nasdaq_ticker_info as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info` )

select
    *
from nasdaq_ticker_history
left join nasdaq_ticker_info using (symbol)
    );
  
[0m01:24:00.006053 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:db3b641a-5204-443b-8f67-ba90c1566563&page=queryresults
[0m01:24:00.188095 [debug] [Thread-5  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/db3b641a-5204-443b-8f67-ba90c1566563?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name volume at [13:7]')
[0m01:24:01.297553 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0baafda6-c6bc-48d3-b2bd-5da0aeeb6901&page=queryresults
[0m01:24:01.501693 [error] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0baafda6-c6bc-48d3-b2bd-5da0aeeb6901&page=queryresults
[0m01:24:01.534333 [debug] [Thread-5  ]: Database Error in model nasdaq (models/4_final/nasdaq.sql)
  CREATE TABLE has columns with duplicate name volume at [13:7]
  compiled Code at target/run/stock_analysis/models/4_final/nasdaq.sql
[0m01:24:01.534694 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cfeb119-747e-4da1-88ca-35326b76b6ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354d3eb0>]}
[0m01:24:01.535102 [error] [Thread-5  ]: 3 of 3 ERROR creating sql table model stock_analysis.nasdaq .................... [[31mERROR[0m in 2.12s]
[0m01:24:01.535430 [debug] [Thread-5  ]: Finished running node model.stock_analysis.nasdaq
[0m01:24:01.536541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:01.536715 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m01:24:01.536857 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m01:24:01.536991 [debug] [MainThread]: Connection 'model.stock_analysis.nasdaq' was properly closed.
[0m01:24:01.537194 [info ] [MainThread]: 
[0m01:24:01.537374 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.48 seconds (11.48s).
[0m01:24:01.537883 [debug] [MainThread]: Command end result
[0m01:24:01.570560 [info ] [MainThread]: 
[0m01:24:01.570860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:24:01.571080 [info ] [MainThread]: 
[0m01:24:01.571320 [error] [MainThread]:   Database Error in model nasdaq (models/4_final/nasdaq.sql)
  CREATE TABLE has columns with duplicate name volume at [13:7]
  compiled Code at target/run/stock_analysis/models/4_final/nasdaq.sql
[0m01:24:01.571487 [info ] [MainThread]: 
[0m01:24:01.571656 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m01:24:01.572885 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.274673, "process_user_time": 4.799711, "process_kernel_time": 0.190711, "process_mem_max_rss": "200900608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:24:01.573190 [debug] [MainThread]: Command `dbt run` failed at 01:24:01.573136 after 12.28 seconds
[0m01:24:01.573404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b36ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c912b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135360c40>]}
[0m01:24:01.573618 [debug] [MainThread]: Flushing usage events
[0m01:24:22.033527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104376ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068023a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068021c0>]}


============================== 01:24:22.035620 | 154abf62-e370-4489-b9a1-d134aeb0b947 ==============================
[0m01:24:22.035620 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:24:22.035931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_info stg_all_nasdaq_stock_info nasdaq', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:24:22.532334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fcfd0>]}
[0m01:24:22.558232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d12b0>]}
[0m01:24:22.558529 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:24:22.570443 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:24:22.700676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:22.701258 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m01:24:22.823576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155fd2130>]}
[0m01:24:22.893295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155fe5af0>]}
[0m01:24:22.893559 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:24:22.893748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155fff6d0>]}
[0m01:24:22.895344 [info ] [MainThread]: 
[0m01:24:22.895624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:24:22.897780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:24:22.897988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:23.298419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:24:23.300125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:23.665081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155d8a6a0>]}
[0m01:24:23.665987 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:24:23.666356 [info ] [MainThread]: 
[0m01:24:23.672566 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:24:23.673182 [info ] [Thread-1  ]: 1 of 3 START sql table model stock_analysis.base_all_nasdaq_stock_info ......... [RUN]
[0m01:24:23.673600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_info)
[0m01:24:23.673891 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:24:23.681673 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m01:24:23.682510 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:24:23.694671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:24:24.113095 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m01:24:24.114309 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume as volume_from_stock_info
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m01:24:24.476891 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:02ef9b0f-e8df-4f6d-ba43-5fb1b04bf727&page=queryresults
[0m01:24:28.719542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156086430>]}
[0m01:24:28.720370 [info ] [Thread-1  ]: 1 of 3 OK created sql table model stock_analysis.base_all_nasdaq_stock_info .... [[32mCREATE TABLE (27.7k rows, 59.7 MiB processed)[0m in 5.05s]
[0m01:24:28.720938 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m01:24:28.721620 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:24:28.722149 [info ] [Thread-3  ]: 2 of 3 START sql table model stock_analysis.stg_all_nasdaq_stock_info .......... [RUN]
[0m01:24:28.722766 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_info'
[0m01:24:28.723061 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:24:28.725729 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m01:24:28.726320 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:24:28.728905 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:24:29.080523 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m01:24:29.082030 [debug] [Thread-3  ]: On model.stock_analysis.stg_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info` )

select
    distinct 
    *
from base
where index = 0
    );
  
[0m01:24:29.374540 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:593fd28b-02b1-478e-98c4-817ea7646b9b&page=queryresults
[0m01:24:32.677443 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156096fd0>]}
[0m01:24:32.678875 [info ] [Thread-3  ]: 2 of 3 OK created sql table model stock_analysis.stg_all_nasdaq_stock_info ..... [[32mCREATE TABLE (3.9k rows, 59.7 MiB processed)[0m in 3.95s]
[0m01:24:32.679747 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m01:24:32.681087 [debug] [Thread-5  ]: Began running node model.stock_analysis.nasdaq
[0m01:24:32.682163 [info ] [Thread-5  ]: 3 of 3 START sql table model stock_analysis.nasdaq ............................. [RUN]
[0m01:24:32.682986 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.nasdaq'
[0m01:24:32.683420 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.nasdaq
[0m01:24:32.688215 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m01:24:32.689318 [debug] [Thread-5  ]: Began executing node model.stock_analysis.nasdaq
[0m01:24:32.693288 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.nasdaq"
[0m01:24:32.694144 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m01:24:32.771249 [debug] [Thread-5  ]: On model.stock_analysis.nasdaq: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.nasdaq"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`nasdaq`
      
    
    

    OPTIONS()
    as (
      with

nasdaq_ticker_history as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

, nasdaq_ticker_info as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info` )

select
    *
from nasdaq_ticker_history
left join nasdaq_ticker_info using (symbol)
    );
  
[0m01:24:33.309594 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9aacccd8-9b62-4007-86cd-64ea56d405a2&page=queryresults
[0m01:24:50.187049 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154abf62-e370-4489-b9a1-d134aeb0b947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156187c10>]}
[0m01:24:50.188528 [info ] [Thread-5  ]: 3 of 3 OK created sql table model stock_analysis.nasdaq ........................ [[32mCREATE TABLE (12.5m rows, 5.2 GiB processed)[0m in 17.50s]
[0m01:24:50.190076 [debug] [Thread-5  ]: Finished running node model.stock_analysis.nasdaq
[0m01:24:50.193390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:50.193898 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m01:24:50.194325 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m01:24:50.194738 [debug] [MainThread]: Connection 'model.stock_analysis.nasdaq' was properly closed.
[0m01:24:50.195332 [info ] [MainThread]: 
[0m01:24:50.196492 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 27.30 seconds (27.30s).
[0m01:24:50.198130 [debug] [MainThread]: Command end result
[0m01:24:50.247314 [info ] [MainThread]: 
[0m01:24:50.247684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:24:50.247866 [info ] [MainThread]: 
[0m01:24:50.248049 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:24:50.249258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.261736, "process_user_time": 2.494701, "process_kernel_time": 2.527776, "process_mem_max_rss": "201998336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:24:50.249566 [debug] [MainThread]: Command `dbt run` succeeded at 01:24:50.249517 after 28.26 seconds
[0m01:24:50.249774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104376ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e6dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064fcfd0>]}
[0m01:24:50.249960 [debug] [MainThread]: Flushing usage events
[0m01:47:49.760167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae6130>]}


============================== 01:47:49.762744 | 7cc30b53-f8b0-497f-bebd-0e95079403ab ==============================
[0m01:47:49.762744 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:47:49.763063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_stock_analysis+', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:47:50.475461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cc30b53-f8b0-497f-bebd-0e95079403ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c006d60>]}
[0m01:47:50.501705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cc30b53-f8b0-497f-bebd-0e95079403ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c76dbe0>]}
[0m01:47:50.502006 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:47:50.513706 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:47:50.645887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:47:50.646396 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m01:47:50.646619 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m01:47:50.772519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cc30b53-f8b0-497f-bebd-0e95079403ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cecd130>]}
[0m01:47:50.847214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cc30b53-f8b0-497f-bebd-0e95079403ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cf37700>]}
[0m01:47:50.847529 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:47:50.847762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cc30b53-f8b0-497f-bebd-0e95079403ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cf91100>]}
[0m01:47:50.849207 [info ] [MainThread]: 
[0m01:47:50.849523 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:47:50.851972 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:47:50.852175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:51.271752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:47:51.272403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:51.654088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cc30b53-f8b0-497f-bebd-0e95079403ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cc22e20>]}
[0m01:47:51.654809 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:47:51.655167 [info ] [MainThread]: 
[0m01:47:51.660664 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m01:47:51.661201 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m01:47:51.661613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m01:47:51.661937 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m01:47:51.677783 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m01:47:51.679099 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m01:47:51.691405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:47:52.080455 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m01:47:52.082722 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, nasdaq as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

-- , aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
-- , abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
-- , adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
-- , amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
-- , amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
-- , avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
-- , bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
-- , brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
-- , cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
-- , crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
-- , cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
-- , goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
-- , googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
-- , hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
-- , jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
-- , jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
-- , ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
-- , lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
-- , ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
-- , meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
-- , mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
-- , msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
-- , nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
-- , nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
-- , pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
-- , pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
-- , tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
-- , tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
-- , unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
-- , v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
-- , wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
-- , xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * from nasdaq

-- select * , 'AAPL' as symbol from aapl
-- union all
-- select * , 'ABBV' as symbol from abbv
-- union all
-- select * , 'ADBE' as symbol from adbe
-- union all
-- select * , 'AMD' as symbol from amd
-- union all
-- select * , 'AMZN' as symbol from amzn
-- union all
-- select * , 'AVGO' as symbol from avgo
-- union all
-- select * , 'BAC' as symbol from bac
-- union all
-- select * , 'BRK-B' as symbol from brk_b
-- union all
-- select * , 'COST' as symbol from cost
-- union all
-- select * , 'CRM' as symbol from crm
-- union all
-- select * , 'CVX' as symbol from cvx
-- union all
-- select * , 'GOOG' as symbol from goog
-- union all
-- select * , 'GOOGL' as symbol from googl
-- union all
-- select * , 'HD' as symbol from hd
-- union all
-- select * , 'JNJ' as symbol from jnj
-- union all
-- select * , 'JPM' as symbol from jpm
-- union all
-- select * , 'KO' as symbol from ko
-- union all
-- select * , 'LLY' as symbol from lly
-- union all
-- select * , 'MA' as symbol from ma
-- union all
-- select * , 'META' as symbol from meta
-- union all
-- select * , 'MRK' as symbol from mrk
-- union all
-- select * , 'MSFT' as symbol from msft
-- union all
-- select * , 'NFLX' as symbol from nflx
-- union all
-- select * , 'NVDA' as symbol from nvda
-- union all
-- select * , 'PEP' as symbol from pep
-- union all
-- select * , 'PG' as symbol from pg
-- union all
-- select * , 'TMO' as symbol from tmo
-- union all
-- select * , 'TSLA' as symbol from tsla
-- union all
-- select * , 'UNH' as symbol from unh
-- union all
-- select * , 'V' as symbol from v
-- union all
-- select * , 'WMT' as symbol from wmt
-- union all
-- select * , 'XOM' as symbol from xom
    );
  
[0m01:47:52.545008 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:774222d0-79ea-42d8-9eab-a7995b5c64b7&page=queryresults
[0m01:47:52.852591 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/774222d0-79ea-42d8-9eab-a7995b5c64b7?maxResults=0&location=US&prettyPrint=false: Column 2 in UNION ALL has incompatible types: INT64, INT64, INT64, STRING at [57:1]')
[0m01:47:53.978606 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1ab556e4-1e17-48ba-a822-2f83734b64c1&page=queryresults
[0m01:47:54.283633 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1ab556e4-1e17-48ba-a822-2f83734b64c1&page=queryresults
[0m01:47:54.318186 [debug] [Thread-1  ]: Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Column 2 in UNION ALL has incompatible types: INT64, INT64, INT64, STRING at [57:1]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:47:54.319593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cc30b53-f8b0-497f-bebd-0e95079403ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e00c280>]}
[0m01:47:54.320120 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.int_stock_analysis ........ [[31mERROR[0m in 2.66s]
[0m01:47:54.320570 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m01:47:54.321063 [debug] [Thread-3  ]: Began running node model.stock_analysis.stock_analysis
[0m01:47:54.321388 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stock_analysis ............................. [[33mSKIP[0m]
[0m01:47:54.321762 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stock_analysis
[0m01:47:54.322776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:47:54.323001 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m01:47:54.323373 [info ] [MainThread]: 
[0m01:47:54.323736 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m01:47:54.324222 [debug] [MainThread]: Command end result
[0m01:47:54.363723 [info ] [MainThread]: 
[0m01:47:54.364103 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:47:54.364306 [info ] [MainThread]: 
[0m01:47:54.364530 [error] [MainThread]:   Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Column 2 in UNION ALL has incompatible types: INT64, INT64, INT64, STRING at [57:1]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:47:54.364709 [info ] [MainThread]: 
[0m01:47:54.364887 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:47:54.366422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6543574, "process_user_time": 4.59437, "process_kernel_time": 0.275853, "process_mem_max_rss": "202604544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:47:54.366751 [debug] [MainThread]: Command `dbt run` failed at 01:47:54.366694 after 4.65 seconds
[0m01:47:54.366986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c76dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d4a60>]}
[0m01:47:54.367206 [debug] [MainThread]: Flushing usage events
[0m01:48:45.825644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104882a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fb160>]}


============================== 01:48:45.827797 | a357855c-4a8d-4daf-a5d9-8d6f8a67ee96 ==============================
[0m01:48:45.827797 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:48:45.828104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_stock_analysis+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:48:46.305654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a357855c-4a8d-4daf-a5d9-8d6f8a67ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bec21c0>]}
[0m01:48:46.331364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a357855c-4a8d-4daf-a5d9-8d6f8a67ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105606310>]}
[0m01:48:46.331659 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:48:46.342858 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:48:46.458359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:48:46.458907 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m01:48:46.581595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a357855c-4a8d-4daf-a5d9-8d6f8a67ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fccb130>]}
[0m01:48:46.647329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a357855c-4a8d-4daf-a5d9-8d6f8a67ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe2d100>]}
[0m01:48:46.647611 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:48:46.647812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a357855c-4a8d-4daf-a5d9-8d6f8a67ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe06d90>]}
[0m01:48:46.649068 [info ] [MainThread]: 
[0m01:48:46.649367 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:48:46.651485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:48:46.651727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:47.069792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:48:47.070371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:48:47.421886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a357855c-4a8d-4daf-a5d9-8d6f8a67ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e8cd0>]}
[0m01:48:47.422708 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:48:47.423066 [info ] [MainThread]: 
[0m01:48:47.427862 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m01:48:47.428410 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m01:48:47.428846 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m01:48:47.429167 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m01:48:47.443978 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m01:48:47.444680 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m01:48:47.457561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:48:47.841901 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m01:48:47.842857 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, nasdaq as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

-- , aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
-- , abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
-- , adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
-- , amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
-- , amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
-- , avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
-- , bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
-- , brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
-- , cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
-- , crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
-- , cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
-- , goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
-- , googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
-- , hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
-- , jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
-- , jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
-- , ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
-- , lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
-- , ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
-- , meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
-- , mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
-- , msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
-- , nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
-- , nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
-- , pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
-- , pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
-- , tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
-- , tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
-- , unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
-- , v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
-- , wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
-- , xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * (exclude symbol), symbol from nasdaq

-- select * , 'AAPL' as symbol from aapl
-- union all
-- select * , 'ABBV' as symbol from abbv
-- union all
-- select * , 'ADBE' as symbol from adbe
-- union all
-- select * , 'AMD' as symbol from amd
-- union all
-- select * , 'AMZN' as symbol from amzn
-- union all
-- select * , 'AVGO' as symbol from avgo
-- union all
-- select * , 'BAC' as symbol from bac
-- union all
-- select * , 'BRK-B' as symbol from brk_b
-- union all
-- select * , 'COST' as symbol from cost
-- union all
-- select * , 'CRM' as symbol from crm
-- union all
-- select * , 'CVX' as symbol from cvx
-- union all
-- select * , 'GOOG' as symbol from goog
-- union all
-- select * , 'GOOGL' as symbol from googl
-- union all
-- select * , 'HD' as symbol from hd
-- union all
-- select * , 'JNJ' as symbol from jnj
-- union all
-- select * , 'JPM' as symbol from jpm
-- union all
-- select * , 'KO' as symbol from ko
-- union all
-- select * , 'LLY' as symbol from lly
-- union all
-- select * , 'MA' as symbol from ma
-- union all
-- select * , 'META' as symbol from meta
-- union all
-- select * , 'MRK' as symbol from mrk
-- union all
-- select * , 'MSFT' as symbol from msft
-- union all
-- select * , 'NFLX' as symbol from nflx
-- union all
-- select * , 'NVDA' as symbol from nvda
-- union all
-- select * , 'PEP' as symbol from pep
-- union all
-- select * , 'PG' as symbol from pg
-- union all
-- select * , 'TMO' as symbol from tmo
-- union all
-- select * , 'TSLA' as symbol from tsla
-- union all
-- select * , 'UNH' as symbol from unh
-- union all
-- select * , 'V' as symbol from v
-- union all
-- select * , 'WMT' as symbol from wmt
-- union all
-- select * , 'XOM' as symbol from xom
    );
  
[0m01:48:47.988628 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:440b6ad2-bafb-4759-8f77-c287154a55e9&page=queryresults
[0m01:48:47.989522 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [62:10]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "(" at [62:10]')
[0m01:48:48.908102 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2886cd80-a5c5-4b7a-99ae-0489a92df0fd&page=queryresults
[0m01:48:48.910500 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2886cd80-a5c5-4b7a-99ae-0489a92df0fd&page=queryresults
[0m01:48:48.958969 [debug] [Thread-1  ]: Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected ")" but got "(" at [62:10]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:48:48.960303 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a357855c-4a8d-4daf-a5d9-8d6f8a67ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561ba60>]}
[0m01:48:48.960801 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.int_stock_analysis ........ [[31mERROR[0m in 1.53s]
[0m01:48:48.961252 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m01:48:48.961798 [debug] [Thread-3  ]: Began running node model.stock_analysis.stock_analysis
[0m01:48:48.962144 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stock_analysis ............................. [[33mSKIP[0m]
[0m01:48:48.962490 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stock_analysis
[0m01:48:48.963651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:48.963852 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m01:48:48.964099 [info ] [MainThread]: 
[0m01:48:48.964332 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m01:48:48.964786 [debug] [MainThread]: Command end result
[0m01:48:49.001548 [info ] [MainThread]: 
[0m01:48:49.001849 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:48:49.002039 [info ] [MainThread]: 
[0m01:48:49.002274 [error] [MainThread]:   Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected ")" but got "(" at [62:10]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:48:49.002456 [info ] [MainThread]: 
[0m01:48:49.002640 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:48:49.003807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2243056, "process_user_time": 4.352082, "process_kernel_time": 0.464446, "process_mem_max_rss": "205340672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:48:49.004112 [debug] [MainThread]: Command `dbt run` failed at 01:48:49.004065 after 3.22 seconds
[0m01:48:49.004339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104882a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105606310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be8d00>]}
[0m01:48:49.004544 [debug] [MainThread]: Flushing usage events
[0m01:49:01.584760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656f1c0>]}


============================== 01:49:01.586883 | e2a23b02-a3ea-49b8-bbbe-09d39868e22b ==============================
[0m01:49:01.586883 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:49:01.587212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select int_stock_analysis+', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:49:02.063814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2a23b02-a3ea-49b8-bbbe-09d39868e22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a4fd0>]}
[0m01:49:02.090311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2a23b02-a3ea-49b8-bbbe-09d39868e22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063792b0>]}
[0m01:49:02.090630 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:49:02.101666 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:49:02.223525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:49:02.224166 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m01:49:02.351448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2a23b02-a3ea-49b8-bbbe-09d39868e22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14274d130>]}
[0m01:49:02.417628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2a23b02-a3ea-49b8-bbbe-09d39868e22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1427ad220>]}
[0m01:49:02.417914 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:49:02.418115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a23b02-a3ea-49b8-bbbe-09d39868e22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142785b80>]}
[0m01:49:02.419397 [info ] [MainThread]: 
[0m01:49:02.419686 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:49:02.421816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:49:02.422029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:02.824742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:49:02.825540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:03.190917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a23b02-a3ea-49b8-bbbe-09d39868e22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f7760>]}
[0m01:49:03.191749 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:49:03.192112 [info ] [MainThread]: 
[0m01:49:03.197424 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m01:49:03.197960 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m01:49:03.198401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m01:49:03.198803 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m01:49:03.214321 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m01:49:03.214985 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m01:49:03.227005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:49:03.613371 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m01:49:03.614652 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, nasdaq as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

-- , aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
-- , abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
-- , adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
-- , amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
-- , amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
-- , avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
-- , bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
-- , brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
-- , cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
-- , crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
-- , cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
-- , goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
-- , googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
-- , hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
-- , jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
-- , jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
-- , ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
-- , lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
-- , ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
-- , meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
-- , mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
-- , msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
-- , nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
-- , nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
-- , pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
-- , pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
-- , tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
-- , tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
-- , unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
-- , v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
-- , wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
-- , xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * (except symbol), symbol from nasdaq

-- select * , 'AAPL' as symbol from aapl
-- union all
-- select * , 'ABBV' as symbol from abbv
-- union all
-- select * , 'ADBE' as symbol from adbe
-- union all
-- select * , 'AMD' as symbol from amd
-- union all
-- select * , 'AMZN' as symbol from amzn
-- union all
-- select * , 'AVGO' as symbol from avgo
-- union all
-- select * , 'BAC' as symbol from bac
-- union all
-- select * , 'BRK-B' as symbol from brk_b
-- union all
-- select * , 'COST' as symbol from cost
-- union all
-- select * , 'CRM' as symbol from crm
-- union all
-- select * , 'CVX' as symbol from cvx
-- union all
-- select * , 'GOOG' as symbol from goog
-- union all
-- select * , 'GOOGL' as symbol from googl
-- union all
-- select * , 'HD' as symbol from hd
-- union all
-- select * , 'JNJ' as symbol from jnj
-- union all
-- select * , 'JPM' as symbol from jpm
-- union all
-- select * , 'KO' as symbol from ko
-- union all
-- select * , 'LLY' as symbol from lly
-- union all
-- select * , 'MA' as symbol from ma
-- union all
-- select * , 'META' as symbol from meta
-- union all
-- select * , 'MRK' as symbol from mrk
-- union all
-- select * , 'MSFT' as symbol from msft
-- union all
-- select * , 'NFLX' as symbol from nflx
-- union all
-- select * , 'NVDA' as symbol from nvda
-- union all
-- select * , 'PEP' as symbol from pep
-- union all
-- select * , 'PG' as symbol from pg
-- union all
-- select * , 'TMO' as symbol from tmo
-- union all
-- select * , 'TSLA' as symbol from tsla
-- union all
-- select * , 'UNH' as symbol from unh
-- union all
-- select * , 'V' as symbol from v
-- union all
-- select * , 'WMT' as symbol from wmt
-- union all
-- select * , 'XOM' as symbol from xom
    );
  
[0m01:49:03.759442 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:eb9af784-4133-491b-8aab-cdc5edf5ce53&page=queryresults
[0m01:49:03.760773 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "(" at [62:10]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "(" at [62:10]')
[0m01:49:04.086179 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4f070be6-5f6c-4dc0-8cc0-c7a0ddde228b&page=queryresults
[0m01:49:04.087878 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4f070be6-5f6c-4dc0-8cc0-c7a0ddde228b&page=queryresults
[0m01:49:04.129481 [debug] [Thread-1  ]: Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected ")" but got "(" at [62:10]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:49:04.130909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a23b02-a3ea-49b8-bbbe-09d39868e22b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588fa60>]}
[0m01:49:04.131459 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.int_stock_analysis ........ [[31mERROR[0m in 0.93s]
[0m01:49:04.131916 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m01:49:04.132578 [debug] [Thread-3  ]: Began running node model.stock_analysis.stock_analysis
[0m01:49:04.132895 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stock_analysis ............................. [[33mSKIP[0m]
[0m01:49:04.133319 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stock_analysis
[0m01:49:04.134632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:04.134889 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m01:49:04.135177 [info ] [MainThread]: 
[0m01:49:04.135433 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m01:49:04.135900 [debug] [MainThread]: Command end result
[0m01:49:04.174231 [info ] [MainThread]: 
[0m01:49:04.174524 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:49:04.174701 [info ] [MainThread]: 
[0m01:49:04.174917 [error] [MainThread]:   Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Syntax error: Expected ")" but got "(" at [62:10]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:49:04.175081 [info ] [MainThread]: 
[0m01:49:04.175251 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:49:04.176407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6375525, "process_user_time": 3.939868, "process_kernel_time": 0.902689, "process_mem_max_rss": "203964416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:49:04.176719 [debug] [MainThread]: Command `dbt run` failed at 01:49:04.176671 after 2.64 seconds
[0m01:49:04.176941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a4fd0>]}
[0m01:49:04.177158 [debug] [MainThread]: Flushing usage events
[0m01:49:49.079834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a86b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106503280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065030a0>]}


============================== 01:49:49.082689 | e775913f-2c6a-4084-a078-7f30f09d11fa ==============================
[0m01:49:49.082689 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:49:49.083006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select int_stock_analysis+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:49:49.591033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e775913f-2c6a-4084-a078-7f30f09d11fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13879a940>]}
[0m01:49:49.618745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e775913f-2c6a-4084-a078-7f30f09d11fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525e3d0>]}
[0m01:49:49.619162 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:49:49.631812 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:49:49.762566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:49:49.763091 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m01:49:49.888239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e775913f-2c6a-4084-a078-7f30f09d11fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e8cb130>]}
[0m01:49:49.961992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e775913f-2c6a-4084-a078-7f30f09d11fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea33e80>]}
[0m01:49:49.962349 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:49:49.962548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e775913f-2c6a-4084-a078-7f30f09d11fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea91130>]}
[0m01:49:49.963856 [info ] [MainThread]: 
[0m01:49:49.964182 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:49:49.966568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:49:49.966786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:50.368277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:49:50.368869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:50.745987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e775913f-2c6a-4084-a078-7f30f09d11fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1393302b0>]}
[0m01:49:50.746699 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:49:50.747060 [info ] [MainThread]: 
[0m01:49:50.752440 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m01:49:50.753015 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m01:49:50.753516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m01:49:50.753867 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m01:49:50.768889 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m01:49:50.769537 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m01:49:50.781591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:49:51.223669 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m01:49:51.224971 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, nasdaq as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

-- , aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
-- , abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
-- , adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
-- , amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
-- , amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
-- , avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
-- , bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
-- , brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
-- , cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
-- , crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
-- , cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
-- , goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
-- , googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
-- , hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
-- , jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
-- , jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
-- , ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
-- , lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
-- , ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
-- , meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
-- , mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
-- , msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
-- , nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
-- , nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
-- , pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
-- , pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
-- , tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
-- , tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
-- , unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
-- , v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
-- , wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
-- , xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * except (symbol), symbol from nasdaq

-- select * , 'AAPL' as symbol from aapl
-- union all
-- select * , 'ABBV' as symbol from abbv
-- union all
-- select * , 'ADBE' as symbol from adbe
-- union all
-- select * , 'AMD' as symbol from amd
-- union all
-- select * , 'AMZN' as symbol from amzn
-- union all
-- select * , 'AVGO' as symbol from avgo
-- union all
-- select * , 'BAC' as symbol from bac
-- union all
-- select * , 'BRK-B' as symbol from brk_b
-- union all
-- select * , 'COST' as symbol from cost
-- union all
-- select * , 'CRM' as symbol from crm
-- union all
-- select * , 'CVX' as symbol from cvx
-- union all
-- select * , 'GOOG' as symbol from goog
-- union all
-- select * , 'GOOGL' as symbol from googl
-- union all
-- select * , 'HD' as symbol from hd
-- union all
-- select * , 'JNJ' as symbol from jnj
-- union all
-- select * , 'JPM' as symbol from jpm
-- union all
-- select * , 'KO' as symbol from ko
-- union all
-- select * , 'LLY' as symbol from lly
-- union all
-- select * , 'MA' as symbol from ma
-- union all
-- select * , 'META' as symbol from meta
-- union all
-- select * , 'MRK' as symbol from mrk
-- union all
-- select * , 'MSFT' as symbol from msft
-- union all
-- select * , 'NFLX' as symbol from nflx
-- union all
-- select * , 'NVDA' as symbol from nvda
-- union all
-- select * , 'PEP' as symbol from pep
-- union all
-- select * , 'PG' as symbol from pg
-- union all
-- select * , 'TMO' as symbol from tmo
-- union all
-- select * , 'TSLA' as symbol from tsla
-- union all
-- select * , 'UNH' as symbol from unh
-- union all
-- select * , 'V' as symbol from v
-- union all
-- select * , 'WMT' as symbol from wmt
-- union all
-- select * , 'XOM' as symbol from xom
    );
  
[0m01:49:51.576100 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b42ae64d-5f69-42c6-946a-d1f2be997040&page=queryresults
[0m01:49:51.772135 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/b42ae64d-5f69-42c6-946a-d1f2be997040?maxResults=0&location=US&prettyPrint=false: Column 9 in UNION ALL has incompatible types: DOUBLE, DOUBLE, DOUBLE, STRING at [57:1]')
[0m01:49:52.767075 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7d2fba26-5d45-42ed-b607-2691b644e82b&page=queryresults
[0m01:49:52.973267 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7d2fba26-5d45-42ed-b607-2691b644e82b&page=queryresults
[0m01:49:53.018012 [debug] [Thread-1  ]: Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Column 9 in UNION ALL has incompatible types: DOUBLE, DOUBLE, DOUBLE, STRING at [57:1]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:49:53.019259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e775913f-2c6a-4084-a078-7f30f09d11fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eb0b370>]}
[0m01:49:53.019758 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model stock_analysis.int_stock_analysis ........ [[31mERROR[0m in 2.26s]
[0m01:49:53.020177 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m01:49:53.020705 [debug] [Thread-3  ]: Began running node model.stock_analysis.stock_analysis
[0m01:49:53.021079 [info ] [Thread-3  ]: 2 of 2 SKIP relation stock_analysis.stock_analysis ............................. [[33mSKIP[0m]
[0m01:49:53.021480 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stock_analysis
[0m01:49:53.022666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:53.022908 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m01:49:53.023170 [info ] [MainThread]: 
[0m01:49:53.023470 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m01:49:53.024055 [debug] [MainThread]: Command end result
[0m01:49:53.060205 [info ] [MainThread]: 
[0m01:49:53.060471 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:49:53.060636 [info ] [MainThread]: 
[0m01:49:53.060850 [error] [MainThread]:   Database Error in model int_stock_analysis (models/3_intermediary/int_stock_analysis.sql)
  Column 9 in UNION ALL has incompatible types: DOUBLE, DOUBLE, DOUBLE, STRING at [57:1]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_stock_analysis.sql
[0m01:49:53.061013 [info ] [MainThread]: 
[0m01:49:53.061182 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m01:49:53.062413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.031955, "process_user_time": 4.48762, "process_kernel_time": 0.216895, "process_mem_max_rss": "204406784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:49:53.062805 [debug] [MainThread]: Command `dbt run` failed at 01:49:53.062750 after 4.03 seconds
[0m01:49:53.063039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a86b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df4700>]}
[0m01:49:53.063262 [debug] [MainThread]: Flushing usage events
[0m01:53:51.705133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c60d0>]}


============================== 01:53:51.707900 | c018417d-07af-434b-962d-25db6fa93eba ==============================
[0m01:53:51.707900 [info ] [MainThread]: Running with dbt=1.8.2
[0m01:53:51.708220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select int_stock_analysis+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:53:52.296021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084752e0>]}
[0m01:53:52.322589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12caeb5b0>]}
[0m01:53:52.322941 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m01:53:52.334144 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m01:53:52.470894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:53:52.471471 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m01:53:52.620909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dd4d130>]}
[0m01:53:52.698817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ddb9850>]}
[0m01:53:52.699206 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m01:53:52.699415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de11130>]}
[0m01:53:52.700800 [info ] [MainThread]: 
[0m01:53:52.701124 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:53:52.703440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m01:53:52.703664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:53.141518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m01:53:53.142016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:53:53.528272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb4ad00>]}
[0m01:53:53.529170 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m01:53:53.529545 [info ] [MainThread]: 
[0m01:53:53.536539 [debug] [Thread-1  ]: Began running node model.stock_analysis.int_stock_analysis
[0m01:53:53.537235 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.int_stock_analysis ................. [RUN]
[0m01:53:53.537727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.int_stock_analysis)
[0m01:53:53.538041 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m01:53:53.553062 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m01:53:53.554221 [debug] [Thread-1  ]: Began executing node model.stock_analysis.int_stock_analysis
[0m01:53:53.566403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:53:53.963714 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.int_stock_analysis"
[0m01:53:53.965791 [debug] [Thread-1  ]: On model.stock_analysis.int_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

spy as ( select * except (adj_close) from `first-project-262802`.`stock_analysis`.`stg_spy_1993_2024` )
, spus as ( select * except (adj_close) from `first-project-262802`.`stock_analysis`.`stg_spus_2019_2024` )
, hlal as ( select * except (adj_close) from `first-project-262802`.`stock_analysis`.`stg_hlal_2019_2024` )

, nasdaq as ( select * except (adj_close) from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_history` )

-- , aapl as ( select * from `first-project-262802`.`stock_analysis`.`stg_aapl_1993_2024` )
-- , abbv as ( select * from `first-project-262802`.`stock_analysis`.`stg_abbv_2013_2024` )
-- , adbe as ( select * from `first-project-262802`.`stock_analysis`.`stg_adbe_1993_2024` )
-- , amd as ( select * from `first-project-262802`.`stock_analysis`.`stg_amd_1993_2024` )
-- , amzn as ( select * from `first-project-262802`.`stock_analysis`.`stg_amzn_1997_2024` )
-- , avgo as ( select * from `first-project-262802`.`stock_analysis`.`stg_avgo_2009_2024` )
-- , bac as ( select * from `first-project-262802`.`stock_analysis`.`stg_bac_1993_2024` )
-- , brk_b as ( select * from `first-project-262802`.`stock_analysis`.`stg_brk-b_1996_2024` )
-- , cost as ( select * from `first-project-262802`.`stock_analysis`.`stg_cost_1993_2024` )
-- , crm as ( select * from `first-project-262802`.`stock_analysis`.`stg_crm_2004_2024` )
-- , cvx as ( select * from `first-project-262802`.`stock_analysis`.`stg_cvx_1993_2024` )
-- , goog as ( select * from `first-project-262802`.`stock_analysis`.`stg_goog_2004_2024` )
-- , googl as ( select * from `first-project-262802`.`stock_analysis`.`stg_googl_2004_2024` )
-- , hd as ( select * from `first-project-262802`.`stock_analysis`.`stg_hd_1993_2024` )
-- , jnj as ( select * from `first-project-262802`.`stock_analysis`.`stg_jnj_1993_2024` )
-- , jpm as ( select * from `first-project-262802`.`stock_analysis`.`stg_jpm_1993_2024` )
-- , ko as ( select * from `first-project-262802`.`stock_analysis`.`stg_ko_1993_2024` )
-- , lly as ( select * from `first-project-262802`.`stock_analysis`.`stg_lly_1993_2024` )
-- , ma as ( select * from `first-project-262802`.`stock_analysis`.`stg_ma_2006_2024` )
-- , meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_meta_2012_2024` )
-- , mrk as ( select * from `first-project-262802`.`stock_analysis`.`stg_mrk_1993_2024` )
-- , msft as ( select * from `first-project-262802`.`stock_analysis`.`stg_msft_1993_2024` )
-- , nflx as ( select * from `first-project-262802`.`stock_analysis`.`stg_nflx_1993_2024` )
-- , nvda as ( select * from `first-project-262802`.`stock_analysis`.`stg_nvda_1999_2024` )
-- , pep as ( select * from `first-project-262802`.`stock_analysis`.`stg_pep_1993_2024` )
-- , pg as ( select * from `first-project-262802`.`stock_analysis`.`stg_pg_1993_2024` )
-- , tmo as ( select * from `first-project-262802`.`stock_analysis`.`stg_tmo_1993_2024` )
-- , tsla as ( select * from `first-project-262802`.`stock_analysis`.`stg_tsla_2010_2024` )
-- , unh as ( select * from `first-project-262802`.`stock_analysis`.`stg_unh_1993_2024` )
-- , v as ( select * from `first-project-262802`.`stock_analysis`.`stg_v_1993_2024` )
-- , wmt as ( select * from `first-project-262802`.`stock_analysis`.`stg_wmt_1993_2024` )
-- , xom as ( select * from `first-project-262802`.`stock_analysis`.`stg_xom_1993_2024` )


select * , 'SPY' as symbol from spy
union all
select * , 'SPUS' as symbol from spus
union all
select * , 'HLAL' as symbol from hlal
union all

select * except (symbol), symbol from nasdaq

-- select * , 'AAPL' as symbol from aapl
-- union all
-- select * , 'ABBV' as symbol from abbv
-- union all
-- select * , 'ADBE' as symbol from adbe
-- union all
-- select * , 'AMD' as symbol from amd
-- union all
-- select * , 'AMZN' as symbol from amzn
-- union all
-- select * , 'AVGO' as symbol from avgo
-- union all
-- select * , 'BAC' as symbol from bac
-- union all
-- select * , 'BRK-B' as symbol from brk_b
-- union all
-- select * , 'COST' as symbol from cost
-- union all
-- select * , 'CRM' as symbol from crm
-- union all
-- select * , 'CVX' as symbol from cvx
-- union all
-- select * , 'GOOG' as symbol from goog
-- union all
-- select * , 'GOOGL' as symbol from googl
-- union all
-- select * , 'HD' as symbol from hd
-- union all
-- select * , 'JNJ' as symbol from jnj
-- union all
-- select * , 'JPM' as symbol from jpm
-- union all
-- select * , 'KO' as symbol from ko
-- union all
-- select * , 'LLY' as symbol from lly
-- union all
-- select * , 'MA' as symbol from ma
-- union all
-- select * , 'META' as symbol from meta
-- union all
-- select * , 'MRK' as symbol from mrk
-- union all
-- select * , 'MSFT' as symbol from msft
-- union all
-- select * , 'NFLX' as symbol from nflx
-- union all
-- select * , 'NVDA' as symbol from nvda
-- union all
-- select * , 'PEP' as symbol from pep
-- union all
-- select * , 'PG' as symbol from pg
-- union all
-- select * , 'TMO' as symbol from tmo
-- union all
-- select * , 'TSLA' as symbol from tsla
-- union all
-- select * , 'UNH' as symbol from unh
-- union all
-- select * , 'V' as symbol from v
-- union all
-- select * , 'WMT' as symbol from wmt
-- union all
-- select * , 'XOM' as symbol from xom
    );
  
[0m01:53:54.332304 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0551823d-2845-42c8-8e8e-6ca04f90966a&page=queryresults
[0m01:54:00.974509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de8b550>]}
[0m01:54:00.975200 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.int_stock_analysis ............ [[32mCREATE TABLE (12.5m rows, 5.1 GiB processed)[0m in 7.44s]
[0m01:54:00.975718 [debug] [Thread-1  ]: Finished running node model.stock_analysis.int_stock_analysis
[0m01:54:00.976432 [debug] [Thread-3  ]: Began running node model.stock_analysis.stock_analysis
[0m01:54:00.976866 [info ] [Thread-3  ]: 2 of 2 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m01:54:00.977307 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stock_analysis'
[0m01:54:00.977583 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stock_analysis
[0m01:54:00.980776 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m01:54:00.983170 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stock_analysis
[0m01:54:00.985527 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m01:54:01.343307 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m01:54:01.346023 [debug] [Thread-3  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_stock_analysis` )

-- , symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m01:54:02.190242 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bb506def-1b10-422f-b6f2-d8dca1f1fc34&page=queryresults
[0m01:54:16.190260 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c018417d-07af-434b-962d-25db6fa93eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dc6b460>]}
[0m01:54:16.191746 [info ] [Thread-3  ]: 2 of 2 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (12.5m rows, 5.1 GiB processed)[0m in 15.21s]
[0m01:54:16.192652 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stock_analysis
[0m01:54:16.194990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:16.195406 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m01:54:16.195726 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m01:54:16.196139 [info ] [MainThread]: 
[0m01:54:16.196523 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 23.50 seconds (23.50s).
[0m01:54:16.197467 [debug] [MainThread]: Command end result
[0m01:54:16.243945 [info ] [MainThread]: 
[0m01:54:16.244301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:54:16.244513 [info ] [MainThread]: 
[0m01:54:16.244710 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:54:16.246391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.591454, "process_user_time": 4.659917, "process_kernel_time": 0.235765, "process_mem_max_rss": "203571200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:54:16.246699 [debug] [MainThread]: Command `dbt run` succeeded at 01:54:16.246647 after 24.59 seconds
[0m01:54:16.246925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dcf7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084752e0>]}
[0m01:54:16.247131 [debug] [MainThread]: Flushing usage events
[0m10:26:30.440322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d41c0>]}


============================== 10:26:30.443209 | 4e321635-4594-48ee-9a73-6c25ce2f1f24 ==============================
[0m10:26:30.443209 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:26:30.443595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m10:26:33.756044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e321635-4594-48ee-9a73-6c25ce2f1f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6b640>]}
[0m10:26:33.782399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e321635-4594-48ee-9a73-6c25ce2f1f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654bfd0>]}
[0m10:26:33.782759 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m10:26:33.812018 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:26:33.942030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:33.942525 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m10:26:34.067675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e321635-4594-48ee-9a73-6c25ce2f1f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dc42130>]}
[0m10:26:34.081742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e321635-4594-48ee-9a73-6c25ce2f1f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d8adcd0>]}
[0m10:26:34.081997 [info ] [MainThread]: Found 87 models, 40 sources, 469 macros
[0m10:26:34.082195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e321635-4594-48ee-9a73-6c25ce2f1f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d8add90>]}
[0m10:26:34.084570 [info ] [MainThread]: 
[0m10:26:34.084847 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:26:34.090282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_stock_analysis'
[0m10:26:34.090551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:34.792281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e321635-4594-48ee-9a73-6c25ce2f1f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d8ad7f0>]}
[0m10:26:34.793106 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m10:26:34.793461 [info ] [MainThread]: 
[0m10:26:34.800801 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_aapl_1993_2024
[0m10:26:34.801252 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_abbv_2013_2024
[0m10:26:34.801577 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_adbe_1993_2024
[0m10:26:34.801962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_aapl_1993_2024)
[0m10:26:34.802326 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:26:34.802661 [debug] [Thread-5  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:26:34.803093 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_abbv_2013_2024'
[0m10:26:34.803418 [debug] [Thread-6  ]: Began running node model.stock_analysis.base_amd_1993_2024
[0m10:26:34.803738 [debug] [Thread-7  ]: Began running node model.stock_analysis.base_amzn_1997_2024
[0m10:26:34.804025 [debug] [Thread-8  ]: Began running node model.stock_analysis.base_avgo_2009_2024
[0m10:26:34.804402 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.base_adbe_1993_2024'
[0m10:26:34.804690 [debug] [Thread-9  ]: Began running node model.stock_analysis.base_bac_1993_2024
[0m10:26:34.805045 [debug] [Thread-10 ]: Began running node model.stock_analysis.base_brk-b_1996_2024
[0m10:26:34.805374 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_aapl_1993_2024
[0m10:26:34.805657 [debug] [Thread-11 ]: Began running node model.stock_analysis.base_calendar
[0m10:26:34.806094 [debug] [Thread-12 ]: Began running node model.stock_analysis.base_cost_1993_2024
[0m10:26:34.806567 [debug] [Thread-13 ]: Began running node model.stock_analysis.base_crm_2004_2024
[0m10:26:34.807035 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_nasdaq_stock_history'
[0m10:26:34.807519 [debug] [Thread-14 ]: Began running node model.stock_analysis.base_cvx_1993_2024
[0m10:26:34.807926 [debug] [Thread-15 ]: Began running node model.stock_analysis.base_goog_2004_2024
[0m10:26:34.808260 [debug] [Thread-16 ]: Began running node model.stock_analysis.base_googl_2004_2024
[0m10:26:34.808666 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_nasdaq_stock_info'
[0m10:26:34.808956 [debug] [Thread-17 ]: Began running node model.stock_analysis.base_hd_1993_2024
[0m10:26:34.809320 [debug] [Thread-18 ]: Began running node model.stock_analysis.base_hlal_2019_2024
[0m10:26:34.809655 [debug] [Thread-19 ]: Began running node model.stock_analysis.base_jnj_1993_2024
[0m10:26:34.809928 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_abbv_2013_2024
[0m10:26:34.810201 [debug] [Thread-20 ]: Began running node model.stock_analysis.base_jpm_1993_2024
[0m10:26:34.810483 [debug] [Thread-21 ]: Began running node model.stock_analysis.base_ko_1993_2024
[0m10:26:34.810742 [debug] [Thread-22 ]: Began running node model.stock_analysis.base_lly_1993_2024
[0m10:26:34.811080 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.base_amd_1993_2024'
[0m10:26:34.811349 [debug] [Thread-23 ]: Began running node model.stock_analysis.base_ma_2006_2024
[0m10:26:34.811621 [debug] [Thread-24 ]: Began running node model.stock_analysis.base_meta_2012_2024
[0m10:26:34.812003 [debug] [Thread-7  ]: Acquiring new bigquery connection 'model.stock_analysis.base_amzn_1997_2024'
[0m10:26:34.812282 [debug] [Thread-25 ]: Began running node model.stock_analysis.base_mrk_1993_2024
[0m10:26:34.812595 [debug] [Thread-26 ]: Began running node model.stock_analysis.base_msft_1993_2024
[0m10:26:34.812954 [debug] [Thread-8  ]: Acquiring new bigquery connection 'model.stock_analysis.base_avgo_2009_2024'
[0m10:26:34.813336 [debug] [Thread-27 ]: Began running node model.stock_analysis.base_nflx_1993_2024
[0m10:26:34.813666 [debug] [Thread-28 ]: Began running node model.stock_analysis.base_nvda_1999_2024
[0m10:26:34.813972 [debug] [Thread-29 ]: Began running node model.stock_analysis.base_pep_1993_2024
[0m10:26:34.814205 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_adbe_1993_2024
[0m10:26:34.814440 [debug] [Thread-30 ]: Began running node model.stock_analysis.base_pg_1993_2024
[0m10:26:34.814724 [debug] [Thread-31 ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m10:26:34.814986 [debug] [Thread-32 ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m10:26:34.815353 [debug] [Thread-9  ]: Acquiring new bigquery connection 'model.stock_analysis.base_bac_1993_2024'
[0m10:26:34.815708 [debug] [Thread-10 ]: Acquiring new bigquery connection 'model.stock_analysis.base_brk-b_1996_2024'
[0m10:26:34.822778 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_aapl_1993_2024"
[0m10:26:34.823147 [debug] [Thread-11 ]: Acquiring new bigquery connection 'model.stock_analysis.base_calendar'
[0m10:26:34.823499 [debug] [Thread-12 ]: Acquiring new bigquery connection 'model.stock_analysis.base_cost_1993_2024'
[0m10:26:34.823835 [debug] [Thread-13 ]: Acquiring new bigquery connection 'model.stock_analysis.base_crm_2004_2024'
[0m10:26:34.824097 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:26:34.824429 [debug] [Thread-14 ]: Acquiring new bigquery connection 'model.stock_analysis.base_cvx_1993_2024'
[0m10:26:34.824797 [debug] [Thread-15 ]: Acquiring new bigquery connection 'model.stock_analysis.base_goog_2004_2024'
[0m10:26:34.825106 [debug] [Thread-16 ]: Acquiring new bigquery connection 'model.stock_analysis.base_googl_2004_2024'
[0m10:26:34.825345 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:26:34.825642 [debug] [Thread-17 ]: Acquiring new bigquery connection 'model.stock_analysis.base_hd_1993_2024'
[0m10:26:34.825945 [debug] [Thread-18 ]: Acquiring new bigquery connection 'model.stock_analysis.base_hlal_2019_2024'
[0m10:26:34.826231 [debug] [Thread-19 ]: Acquiring new bigquery connection 'model.stock_analysis.base_jnj_1993_2024'
[0m10:26:34.828313 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_abbv_2013_2024"
[0m10:26:34.828654 [debug] [Thread-20 ]: Acquiring new bigquery connection 'model.stock_analysis.base_jpm_1993_2024'
[0m10:26:34.828992 [debug] [Thread-21 ]: Acquiring new bigquery connection 'model.stock_analysis.base_ko_1993_2024'
[0m10:26:34.829364 [debug] [Thread-22 ]: Acquiring new bigquery connection 'model.stock_analysis.base_lly_1993_2024'
[0m10:26:34.829648 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.base_amd_1993_2024
[0m10:26:34.829934 [debug] [Thread-23 ]: Acquiring new bigquery connection 'model.stock_analysis.base_ma_2006_2024'
[0m10:26:34.830212 [debug] [Thread-24 ]: Acquiring new bigquery connection 'model.stock_analysis.base_meta_2012_2024'
[0m10:26:34.830423 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.base_amzn_1997_2024
[0m10:26:34.830691 [debug] [Thread-25 ]: Acquiring new bigquery connection 'model.stock_analysis.base_mrk_1993_2024'
[0m10:26:34.830976 [debug] [Thread-26 ]: Acquiring new bigquery connection 'model.stock_analysis.base_msft_1993_2024'
[0m10:26:34.831200 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.base_avgo_2009_2024
[0m10:26:34.831466 [debug] [Thread-27 ]: Acquiring new bigquery connection 'model.stock_analysis.base_nflx_1993_2024'
[0m10:26:34.831748 [debug] [Thread-28 ]: Acquiring new bigquery connection 'model.stock_analysis.base_nvda_1999_2024'
[0m10:26:34.832017 [debug] [Thread-29 ]: Acquiring new bigquery connection 'model.stock_analysis.base_pep_1993_2024'
[0m10:26:34.834429 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_adbe_1993_2024"
[0m10:26:34.834760 [debug] [Thread-30 ]: Acquiring new bigquery connection 'model.stock_analysis.base_pg_1993_2024'
[0m10:26:34.835059 [debug] [Thread-31 ]: Acquiring new bigquery connection 'model.stock_analysis.base_spus_2019_2024'
[0m10:26:34.835335 [debug] [Thread-32 ]: Acquiring new bigquery connection 'model.stock_analysis.base_spy_1993_2024'
[0m10:26:34.835562 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.base_bac_1993_2024
[0m10:26:34.835783 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.base_brk-b_1996_2024
[0m10:26:34.836054 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.base_calendar
[0m10:26:34.836275 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.base_cost_1993_2024
[0m10:26:34.836492 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.base_crm_2004_2024
[0m10:26:34.838428 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m10:26:34.838659 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.base_cvx_1993_2024
[0m10:26:34.838891 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.base_goog_2004_2024
[0m10:26:34.839101 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_aapl_1993_2024
[0m10:26:34.839326 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.base_googl_2004_2024
[0m10:26:34.841492 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m10:26:34.841732 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.base_hd_1993_2024
[0m10:26:34.841940 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.base_hlal_2019_2024
[0m10:26:34.842135 [debug] [Thread-19 ]: Began compiling node model.stock_analysis.base_jnj_1993_2024
[0m10:26:34.842388 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.base_jpm_1993_2024
[0m10:26:34.842606 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.base_ko_1993_2024
[0m10:26:34.842802 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.base_lly_1993_2024
[0m10:26:34.843004 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_abbv_2013_2024
[0m10:26:34.844789 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.base_amd_1993_2024"
[0m10:26:34.845016 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.base_ma_2006_2024
[0m10:26:34.845216 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.base_meta_2012_2024
[0m10:26:34.846905 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.base_amzn_1997_2024"
[0m10:26:34.847110 [debug] [Thread-25 ]: Began compiling node model.stock_analysis.base_mrk_1993_2024
[0m10:26:34.847323 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.base_msft_1993_2024
[0m10:26:34.849048 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.base_avgo_2009_2024"
[0m10:26:34.849266 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.base_nflx_1993_2024
[0m10:26:34.849459 [debug] [Thread-28 ]: Began compiling node model.stock_analysis.base_nvda_1999_2024
[0m10:26:34.849652 [debug] [Thread-29 ]: Began compiling node model.stock_analysis.base_pep_1993_2024
[0m10:26:34.849865 [debug] [Thread-30 ]: Began compiling node model.stock_analysis.base_pg_1993_2024
[0m10:26:34.850074 [debug] [Thread-31 ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m10:26:34.850268 [debug] [Thread-32 ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m10:26:34.850458 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_adbe_1993_2024
[0m10:26:34.852143 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.base_bac_1993_2024"
[0m10:26:34.853842 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.base_brk-b_1996_2024"
[0m10:26:34.856254 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m10:26:34.857956 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.base_cost_1993_2024"
[0m10:26:34.859604 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.base_crm_2004_2024"
[0m10:26:34.861237 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.base_cvx_1993_2024"
[0m10:26:34.862871 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.base_goog_2004_2024"
[0m10:26:34.863289 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_aapl_1993_2024
[0m10:26:34.865010 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.base_googl_2004_2024"
[0m10:26:34.865267 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:26:34.866810 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.base_hd_1993_2024"
[0m10:26:34.869062 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.base_hlal_2019_2024"
[0m10:26:34.870578 [debug] [Thread-19 ]: Writing injected SQL for node "model.stock_analysis.base_jnj_1993_2024"
[0m10:26:34.870771 [debug] [Thread-5  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:26:34.872291 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.base_jpm_1993_2024"
[0m10:26:34.873837 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.base_ko_1993_2024"
[0m10:26:34.875351 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.base_lly_1993_2024"
[0m10:26:34.875703 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_abbv_2013_2024
[0m10:26:34.877249 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.base_ma_2006_2024"
[0m10:26:34.878771 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.base_meta_2012_2024"
[0m10:26:34.879015 [debug] [Thread-6  ]: Began executing node model.stock_analysis.base_amd_1993_2024
[0m10:26:34.880628 [debug] [Thread-25 ]: Writing injected SQL for node "model.stock_analysis.base_mrk_1993_2024"
[0m10:26:34.882867 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.base_msft_1993_2024"
[0m10:26:34.883097 [debug] [Thread-7  ]: Began executing node model.stock_analysis.base_amzn_1997_2024
[0m10:26:34.884549 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.base_nflx_1993_2024"
[0m10:26:34.886032 [debug] [Thread-28 ]: Writing injected SQL for node "model.stock_analysis.base_nvda_1999_2024"
[0m10:26:34.887502 [debug] [Thread-29 ]: Writing injected SQL for node "model.stock_analysis.base_pep_1993_2024"
[0m10:26:34.887683 [debug] [Thread-8  ]: Began executing node model.stock_analysis.base_avgo_2009_2024
[0m10:26:34.889214 [debug] [Thread-30 ]: Writing injected SQL for node "model.stock_analysis.base_pg_1993_2024"
[0m10:26:34.890685 [debug] [Thread-31 ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m10:26:34.892145 [debug] [Thread-32 ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m10:26:34.892503 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_adbe_1993_2024
[0m10:26:34.892909 [debug] [Thread-9  ]: Began executing node model.stock_analysis.base_bac_1993_2024
[0m10:26:34.893081 [debug] [Thread-10 ]: Began executing node model.stock_analysis.base_brk-b_1996_2024
[0m10:26:34.893364 [debug] [Thread-11 ]: Began executing node model.stock_analysis.base_calendar
[0m10:26:34.893546 [debug] [Thread-12 ]: Began executing node model.stock_analysis.base_cost_1993_2024
[0m10:26:34.893812 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_symbols_meta
[0m10:26:34.894068 [debug] [Thread-14 ]: Began executing node model.stock_analysis.base_cvx_1993_2024
[0m10:26:34.894418 [debug] [Thread-4  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:26:34.894615 [debug] [Thread-15 ]: Began executing node model.stock_analysis.base_goog_2004_2024
[0m10:26:34.894803 [debug] [Thread-13 ]: Began executing node model.stock_analysis.base_crm_2004_2024
[0m10:26:34.894993 [debug] [Thread-16 ]: Began executing node model.stock_analysis.base_googl_2004_2024
[0m10:26:34.895468 [debug] [Thread-5  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:26:34.895661 [debug] [Thread-17 ]: Began executing node model.stock_analysis.base_hd_1993_2024
[0m10:26:34.895830 [debug] [Thread-18 ]: Began executing node model.stock_analysis.base_hlal_2019_2024
[0m10:26:34.896050 [debug] [Thread-19 ]: Began executing node model.stock_analysis.base_jnj_1993_2024
[0m10:26:34.896394 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_tmo_1993_2024
[0m10:26:34.896615 [debug] [Thread-20 ]: Began executing node model.stock_analysis.base_jpm_1993_2024
[0m10:26:34.897034 [debug] [Thread-6  ]: Finished running node model.stock_analysis.base_amd_1993_2024
[0m10:26:34.897328 [debug] [Thread-22 ]: Began executing node model.stock_analysis.base_lly_1993_2024
[0m10:26:34.897509 [debug] [Thread-21 ]: Began executing node model.stock_analysis.base_ko_1993_2024
[0m10:26:34.897869 [debug] [Thread-7  ]: Finished running node model.stock_analysis.base_amzn_1997_2024
[0m10:26:34.898051 [debug] [Thread-23 ]: Began executing node model.stock_analysis.base_ma_2006_2024
[0m10:26:34.898208 [debug] [Thread-24 ]: Began executing node model.stock_analysis.base_meta_2012_2024
[0m10:26:34.898409 [debug] [Thread-26 ]: Began executing node model.stock_analysis.base_msft_1993_2024
[0m10:26:34.898608 [debug] [Thread-25 ]: Began executing node model.stock_analysis.base_mrk_1993_2024
[0m10:26:34.898979 [debug] [Thread-8  ]: Finished running node model.stock_analysis.base_avgo_2009_2024
[0m10:26:34.899144 [debug] [Thread-27 ]: Began executing node model.stock_analysis.base_nflx_1993_2024
[0m10:26:34.899373 [debug] [Thread-28 ]: Began executing node model.stock_analysis.base_nvda_1999_2024
[0m10:26:34.899549 [debug] [Thread-29 ]: Began executing node model.stock_analysis.base_pep_1993_2024
[0m10:26:34.899827 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_tsla_2010_2024
[0m10:26:34.900006 [debug] [Thread-30 ]: Began executing node model.stock_analysis.base_pg_1993_2024
[0m10:26:34.900347 [debug] [Thread-9  ]: Finished running node model.stock_analysis.base_bac_1993_2024
[0m10:26:34.900697 [debug] [Thread-10 ]: Finished running node model.stock_analysis.base_brk-b_1996_2024
[0m10:26:34.900884 [debug] [Thread-31 ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m10:26:34.901190 [debug] [Thread-11 ]: Finished running node model.stock_analysis.base_calendar
[0m10:26:34.901351 [debug] [Thread-32 ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m10:26:34.901738 [debug] [Thread-12 ]: Finished running node model.stock_analysis.base_cost_1993_2024
[0m10:26:34.901939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_aapl_1993_2024, now model.stock_analysis.base_symbols_meta)
[0m10:26:34.902250 [debug] [Thread-14 ]: Finished running node model.stock_analysis.base_cvx_1993_2024
[0m10:26:34.902446 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_unh_1993_2024
[0m10:26:34.902765 [debug] [Thread-15 ]: Finished running node model.stock_analysis.base_goog_2004_2024
[0m10:26:34.903067 [debug] [Thread-13 ]: Finished running node model.stock_analysis.base_crm_2004_2024
[0m10:26:34.903390 [debug] [Thread-16 ]: Finished running node model.stock_analysis.base_googl_2004_2024
[0m10:26:34.903595 [debug] [Thread-5  ]: Began running node model.stock_analysis.base_v_1993_2024
[0m10:26:34.903971 [debug] [Thread-17 ]: Finished running node model.stock_analysis.base_hd_1993_2024
[0m10:26:34.904281 [debug] [Thread-18 ]: Finished running node model.stock_analysis.base_hlal_2019_2024
[0m10:26:34.904597 [debug] [Thread-19 ]: Finished running node model.stock_analysis.base_jnj_1993_2024
[0m10:26:34.904790 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_abbv_2013_2024, now model.stock_analysis.base_tmo_1993_2024)
[0m10:26:34.905098 [debug] [Thread-20 ]: Finished running node model.stock_analysis.base_jpm_1993_2024
[0m10:26:34.905290 [debug] [Thread-6  ]: Began running node model.stock_analysis.base_wmt_1993_2024
[0m10:26:34.905614 [debug] [Thread-22 ]: Finished running node model.stock_analysis.base_lly_1993_2024
[0m10:26:34.905921 [debug] [Thread-21 ]: Finished running node model.stock_analysis.base_ko_1993_2024
[0m10:26:34.906117 [debug] [Thread-7  ]: Began running node model.stock_analysis.base_xom_1993_2024
[0m10:26:34.906433 [debug] [Thread-23 ]: Finished running node model.stock_analysis.base_ma_2006_2024
[0m10:26:34.906741 [debug] [Thread-24 ]: Finished running node model.stock_analysis.base_meta_2012_2024
[0m10:26:34.907061 [debug] [Thread-26 ]: Finished running node model.stock_analysis.base_msft_1993_2024
[0m10:26:34.907369 [debug] [Thread-25 ]: Finished running node model.stock_analysis.base_mrk_1993_2024
[0m10:26:34.907570 [debug] [Thread-8  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:26:34.907899 [debug] [Thread-27 ]: Finished running node model.stock_analysis.base_nflx_1993_2024
[0m10:26:34.908222 [debug] [Thread-28 ]: Finished running node model.stock_analysis.base_nvda_1999_2024
[0m10:26:34.908528 [debug] [Thread-29 ]: Finished running node model.stock_analysis.base_pep_1993_2024
[0m10:26:34.908734 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_adbe_1993_2024, now model.stock_analysis.base_tsla_2010_2024)
[0m10:26:34.909059 [debug] [Thread-30 ]: Finished running node model.stock_analysis.base_pg_1993_2024
[0m10:26:34.909913 [debug] [Thread-31 ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m10:26:34.910322 [debug] [Thread-32 ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m10:26:34.910497 [debug] [Thread-9  ]: Began running node model.stock_analysis.stg_calendar
[0m10:26:34.912302 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m10:26:34.912556 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_all_nasdaq_stock_history, now model.stock_analysis.base_unh_1993_2024)
[0m10:26:34.912892 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_all_nasdaq_stock_info, now model.stock_analysis.base_v_1993_2024)
[0m10:26:34.913180 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_tmo_1993_2024
[0m10:26:34.913423 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amd_1993_2024, now model.stock_analysis.base_wmt_1993_2024)
[0m10:26:34.913699 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_amzn_1997_2024, now model.stock_analysis.base_xom_1993_2024)
[0m10:26:34.914068 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_avgo_2009_2024, now model.stock_analysis.stg_all_nasdaq_stock_info)
[0m10:26:34.914360 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_tsla_2010_2024
[0m10:26:34.914663 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_bac_1993_2024, now model.stock_analysis.stg_calendar)
[0m10:26:34.917073 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m10:26:34.917281 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_unh_1993_2024
[0m10:26:34.917448 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.base_v_1993_2024
[0m10:26:34.918893 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_tmo_1993_2024"
[0m10:26:34.919074 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.base_wmt_1993_2024
[0m10:26:34.919233 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.base_xom_1993_2024
[0m10:26:34.919391 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:26:34.920818 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_tsla_2010_2024"
[0m10:26:34.921017 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.stg_calendar
[0m10:26:34.922590 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_unh_1993_2024"
[0m10:26:34.924029 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.base_v_1993_2024"
[0m10:26:34.925562 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.base_wmt_1993_2024"
[0m10:26:34.927123 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.base_xom_1993_2024"
[0m10:26:34.927334 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m10:26:34.927512 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_tmo_1993_2024
[0m10:26:34.928965 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m10:26:34.931642 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m10:26:34.932015 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_tsla_2010_2024
[0m10:26:34.932225 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_unh_1993_2024
[0m10:26:34.932407 [debug] [Thread-5  ]: Began executing node model.stock_analysis.base_v_1993_2024
[0m10:26:34.932776 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m10:26:34.932947 [debug] [Thread-6  ]: Began executing node model.stock_analysis.base_wmt_1993_2024
[0m10:26:34.933285 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_tmo_1993_2024
[0m10:26:34.933504 [debug] [Thread-7  ]: Began executing node model.stock_analysis.base_xom_1993_2024
[0m10:26:34.933847 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_tsla_2010_2024
[0m10:26:34.934176 [debug] [Thread-4  ]: Finished running node model.stock_analysis.base_unh_1993_2024
[0m10:26:34.934530 [debug] [Thread-5  ]: Finished running node model.stock_analysis.base_v_1993_2024
[0m10:26:34.934705 [debug] [Thread-9  ]: Began executing node model.stock_analysis.stg_calendar
[0m10:26:34.934953 [debug] [Thread-8  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:26:34.935138 [debug] [Thread-11 ]: Began running node model.stock_analysis.stg_symbols_meta
[0m10:26:34.935440 [debug] [Thread-6  ]: Finished running node model.stock_analysis.base_wmt_1993_2024
[0m10:26:34.935814 [debug] [Thread-7  ]: Finished running node model.stock_analysis.base_xom_1993_2024
[0m10:26:34.936248 [debug] [Thread-9  ]: Finished running node model.stock_analysis.stg_calendar
[0m10:26:34.936556 [debug] [Thread-8  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:26:34.936747 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.stg_symbols_meta)
[0m10:26:34.937500 [debug] [Thread-12 ]: Began running node model.stock_analysis.stg_aapl_1993_2024
[0m10:26:34.937667 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m10:26:34.937840 [debug] [Thread-14 ]: Began running node model.stock_analysis.stg_abbv_2013_2024
[0m10:26:34.938017 [debug] [Thread-15 ]: Began running node model.stock_analysis.stg_adbe_1993_2024
[0m10:26:34.938192 [debug] [Thread-13 ]: Began running node model.stock_analysis.stg_amd_1993_2024
[0m10:26:34.938364 [debug] [Thread-16 ]: Began running node model.stock_analysis.stg_amzn_1997_2024
[0m10:26:34.938542 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cost_1993_2024, now model.stock_analysis.stg_aapl_1993_2024)
[0m10:26:34.938711 [debug] [Thread-17 ]: Began running node model.stock_analysis.stg_avgo_2009_2024
[0m10:26:34.938888 [debug] [Thread-18 ]: Began running node model.stock_analysis.stg_bac_1993_2024
[0m10:26:34.940382 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m10:26:34.940571 [debug] [Thread-19 ]: Began running node model.stock_analysis.stg_brk-b_1996_2024
[0m10:26:34.940754 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_cost_1993_2024
[0m10:26:34.940923 [debug] [Thread-22 ]: Began running node model.stock_analysis.stg_crm_2004_2024
[0m10:26:34.941113 [debug] [Thread-14 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_cvx_1993_2024, now model.stock_analysis.stg_abbv_2013_2024)
[0m10:26:34.941281 [debug] [Thread-21 ]: Began running node model.stock_analysis.stg_cvx_1993_2024
[0m10:26:34.941457 [debug] [Thread-23 ]: Began running node model.stock_analysis.stg_goog_2004_2024
[0m10:26:34.941631 [debug] [Thread-15 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_goog_2004_2024, now model.stock_analysis.stg_adbe_1993_2024)
[0m10:26:34.941800 [debug] [Thread-24 ]: Began running node model.stock_analysis.stg_googl_2004_2024
[0m10:26:34.941977 [debug] [Thread-26 ]: Began running node model.stock_analysis.stg_hd_1993_2024
[0m10:26:34.942147 [debug] [Thread-13 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_crm_2004_2024, now model.stock_analysis.stg_amd_1993_2024)
[0m10:26:34.942315 [debug] [Thread-25 ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m10:26:34.942541 [debug] [Thread-27 ]: Began running node model.stock_analysis.stg_jnj_1993_2024
[0m10:26:34.942713 [debug] [Thread-16 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_googl_2004_2024, now model.stock_analysis.stg_amzn_1997_2024)
[0m10:26:34.942882 [debug] [Thread-28 ]: Began running node model.stock_analysis.stg_jpm_1993_2024
[0m10:26:34.943049 [debug] [Thread-29 ]: Began running node model.stock_analysis.stg_ko_1993_2024
[0m10:26:34.943216 [debug] [Thread-30 ]: Began running node model.stock_analysis.stg_lly_1993_2024
[0m10:26:34.943372 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.stg_aapl_1993_2024
[0m10:26:34.943533 [debug] [Thread-31 ]: Began running node model.stock_analysis.stg_ma_2006_2024
[0m10:26:34.943722 [debug] [Thread-32 ]: Began running node model.stock_analysis.stg_meta_2012_2024
[0m10:26:34.943896 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_mrk_1993_2024
[0m10:26:34.944083 [debug] [Thread-17 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_hd_1993_2024, now model.stock_analysis.stg_avgo_2009_2024)
[0m10:26:34.944254 [debug] [Thread-10 ]: Began running node model.stock_analysis.stg_msft_1993_2024
[0m10:26:34.944444 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_nasdaq_history_base
[0m10:26:34.944611 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_nflx_1993_2024
[0m10:26:34.944791 [debug] [Thread-18 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_hlal_2019_2024, now model.stock_analysis.stg_bac_1993_2024)
[0m10:26:34.944961 [debug] [Thread-4  ]: Began running node model.stock_analysis.stg_nvda_1999_2024
[0m10:26:34.945144 [debug] [Thread-5  ]: Began running node model.stock_analysis.stg_pep_1993_2024
[0m10:26:34.945307 [debug] [Thread-6  ]: Began running node model.stock_analysis.stg_pg_1993_2024
[0m10:26:34.945486 [debug] [Thread-7  ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m10:26:34.945694 [debug] [Thread-9  ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m10:26:34.945859 [debug] [Thread-8  ]: Began running node model.stock_analysis.stg_tmo_1993_2024
[0m10:26:34.946034 [debug] [Thread-19 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jnj_1993_2024, now model.stock_analysis.stg_brk-b_1996_2024)
[0m10:26:34.946237 [debug] [Thread-20 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_jpm_1993_2024, now model.stock_analysis.stg_cost_1993_2024)
[0m10:26:34.946403 [debug] [Thread-11 ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m10:26:34.946583 [debug] [Thread-22 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_lly_1993_2024, now model.stock_analysis.stg_crm_2004_2024)
[0m10:26:34.946754 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.stg_abbv_2013_2024
[0m10:26:34.946934 [debug] [Thread-21 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ko_1993_2024, now model.stock_analysis.stg_cvx_1993_2024)
[0m10:26:34.947119 [debug] [Thread-23 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_ma_2006_2024, now model.stock_analysis.stg_goog_2004_2024)
[0m10:26:34.947288 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.stg_adbe_1993_2024
[0m10:26:34.947473 [debug] [Thread-24 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_meta_2012_2024, now model.stock_analysis.stg_googl_2004_2024)
[0m10:26:34.947662 [debug] [Thread-26 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_msft_1993_2024, now model.stock_analysis.stg_hd_1993_2024)
[0m10:26:34.947837 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.stg_amd_1993_2024
[0m10:26:34.948017 [debug] [Thread-25 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_mrk_1993_2024, now model.stock_analysis.stg_hlal_2019_2024)
[0m10:26:34.948197 [debug] [Thread-27 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nflx_1993_2024, now model.stock_analysis.stg_jnj_1993_2024)
[0m10:26:34.948362 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.stg_amzn_1997_2024
[0m10:26:34.948532 [debug] [Thread-28 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_nvda_1999_2024, now model.stock_analysis.stg_jpm_1993_2024)
[0m10:26:34.948709 [debug] [Thread-29 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pep_1993_2024, now model.stock_analysis.stg_ko_1993_2024)
[0m10:26:34.948883 [debug] [Thread-30 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_pg_1993_2024, now model.stock_analysis.stg_lly_1993_2024)
[0m10:26:34.950762 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.stg_aapl_1993_2024"
[0m10:26:34.950966 [debug] [Thread-31 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spus_2019_2024, now model.stock_analysis.stg_ma_2006_2024)
[0m10:26:34.951151 [debug] [Thread-32 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_1993_2024, now model.stock_analysis.stg_meta_2012_2024)
[0m10:26:34.951334 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_symbols_meta, now model.stock_analysis.stg_mrk_1993_2024)
[0m10:26:34.951505 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.stg_avgo_2009_2024
[0m10:26:34.951682 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_brk-b_1996_2024, now model.stock_analysis.stg_msft_1993_2024)
[0m10:26:34.951869 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tmo_1993_2024, now model.stock_analysis.stg_nasdaq_history_base)
[0m10:26:34.952057 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_tsla_2010_2024, now model.stock_analysis.stg_nflx_1993_2024)
[0m10:26:34.952228 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.stg_bac_1993_2024
[0m10:26:34.952405 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_unh_1993_2024, now model.stock_analysis.stg_nvda_1999_2024)
[0m10:26:34.952587 [debug] [Thread-5  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_v_1993_2024, now model.stock_analysis.stg_pep_1993_2024)
[0m10:26:34.952769 [debug] [Thread-6  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_wmt_1993_2024, now model.stock_analysis.stg_pg_1993_2024)
[0m10:26:34.952948 [debug] [Thread-7  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_xom_1993_2024, now model.stock_analysis.stg_spus_2019_2024)
[0m10:26:34.953122 [debug] [Thread-9  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_1993_2024)
[0m10:26:34.953297 [debug] [Thread-8  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_all_nasdaq_stock_info, now model.stock_analysis.stg_tmo_1993_2024)
[0m10:26:34.953465 [debug] [Thread-19 ]: Began compiling node model.stock_analysis.stg_brk-b_1996_2024
[0m10:26:34.953627 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_cost_1993_2024
[0m10:26:34.953924 [debug] [Thread-11 ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m10:26:34.954090 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.stg_crm_2004_2024
[0m10:26:34.955995 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.stg_abbv_2013_2024"
[0m10:26:34.956177 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.stg_cvx_1993_2024
[0m10:26:34.956345 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.stg_goog_2004_2024
[0m10:26:34.958207 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.stg_adbe_1993_2024"
[0m10:26:34.958391 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.stg_googl_2004_2024
[0m10:26:34.958557 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.stg_hd_1993_2024
[0m10:26:34.960992 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.stg_amd_1993_2024"
[0m10:26:34.961187 [debug] [Thread-25 ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m10:26:34.961356 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.stg_jnj_1993_2024
[0m10:26:34.963260 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.stg_amzn_1997_2024"
[0m10:26:34.963438 [debug] [Thread-28 ]: Began compiling node model.stock_analysis.stg_jpm_1993_2024
[0m10:26:34.963596 [debug] [Thread-29 ]: Began compiling node model.stock_analysis.stg_ko_1993_2024
[0m10:26:34.963755 [debug] [Thread-30 ]: Began compiling node model.stock_analysis.stg_lly_1993_2024
[0m10:26:34.963976 [debug] [Thread-31 ]: Began compiling node model.stock_analysis.stg_ma_2006_2024
[0m10:26:34.964163 [debug] [Thread-32 ]: Began compiling node model.stock_analysis.stg_meta_2012_2024
[0m10:26:34.964331 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_mrk_1993_2024
[0m10:26:34.964493 [debug] [Thread-12 ]: Began executing node model.stock_analysis.stg_aapl_1993_2024
[0m10:26:34.966297 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.stg_avgo_2009_2024"
[0m10:26:34.966484 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.stg_msft_1993_2024
[0m10:26:34.966656 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.stg_nasdaq_history_base
[0m10:26:34.966822 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_nflx_1993_2024
[0m10:26:34.968630 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.stg_bac_1993_2024"
[0m10:26:34.968809 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.stg_nvda_1999_2024
[0m10:26:34.968974 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.stg_pep_1993_2024
[0m10:26:34.969139 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.stg_pg_1993_2024
[0m10:26:34.969300 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m10:26:34.969460 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m10:26:34.969622 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.stg_tmo_1993_2024
[0m10:26:34.971511 [debug] [Thread-19 ]: Writing injected SQL for node "model.stock_analysis.stg_brk-b_1996_2024"
[0m10:26:34.973315 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_cost_1993_2024"
[0m10:26:34.973525 [debug] [Thread-11 ]: Began running node model.stock_analysis.stg_tsla_2010_2024
[0m10:26:34.975386 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.stg_crm_2004_2024"
[0m10:26:34.977271 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.stg_cvx_1993_2024"
[0m10:26:34.979791 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.stg_goog_2004_2024"
[0m10:26:34.980026 [debug] [Thread-14 ]: Began executing node model.stock_analysis.stg_abbv_2013_2024
[0m10:26:34.981839 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.stg_googl_2004_2024"
[0m10:26:34.983669 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.stg_hd_1993_2024"
[0m10:26:34.983865 [debug] [Thread-15 ]: Began executing node model.stock_analysis.stg_adbe_1993_2024
[0m10:26:34.985704 [debug] [Thread-25 ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m10:26:34.987515 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.stg_jnj_1993_2024"
[0m10:26:34.989403 [debug] [Thread-28 ]: Writing injected SQL for node "model.stock_analysis.stg_jpm_1993_2024"
[0m10:26:34.989575 [debug] [Thread-13 ]: Began executing node model.stock_analysis.stg_amd_1993_2024
[0m10:26:34.991412 [debug] [Thread-29 ]: Writing injected SQL for node "model.stock_analysis.stg_ko_1993_2024"
[0m10:26:34.993883 [debug] [Thread-30 ]: Writing injected SQL for node "model.stock_analysis.stg_lly_1993_2024"
[0m10:26:34.994078 [debug] [Thread-16 ]: Began executing node model.stock_analysis.stg_amzn_1997_2024
[0m10:26:34.995892 [debug] [Thread-31 ]: Writing injected SQL for node "model.stock_analysis.stg_ma_2006_2024"
[0m10:26:34.997683 [debug] [Thread-32 ]: Writing injected SQL for node "model.stock_analysis.stg_meta_2012_2024"
[0m10:26:34.999479 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_mrk_1993_2024"
[0m10:26:34.999833 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stg_aapl_1993_2024
[0m10:26:35.001730 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.stg_msft_1993_2024"
[0m10:26:35.003275 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_base"
[0m10:26:35.005138 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_nflx_1993_2024"
[0m10:26:35.005317 [debug] [Thread-17 ]: Began executing node model.stock_analysis.stg_avgo_2009_2024
[0m10:26:35.007828 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.stg_nvda_1999_2024"
[0m10:26:35.009679 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.stg_pep_1993_2024"
[0m10:26:35.011504 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.stg_pg_1993_2024"
[0m10:26:35.011688 [debug] [Thread-18 ]: Began executing node model.stock_analysis.stg_bac_1993_2024
[0m10:26:35.013529 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m10:26:35.015369 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m10:26:35.017218 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.stg_tmo_1993_2024"
[0m10:26:35.017516 [debug] [Thread-11 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_symbols_meta, now model.stock_analysis.stg_tsla_2010_2024)
[0m10:26:35.017822 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_cost_1993_2024
[0m10:26:35.017995 [debug] [Thread-19 ]: Began executing node model.stock_analysis.stg_brk-b_1996_2024
[0m10:26:35.018422 [debug] [Thread-14 ]: Finished running node model.stock_analysis.stg_abbv_2013_2024
[0m10:26:35.018611 [debug] [Thread-22 ]: Began executing node model.stock_analysis.stg_crm_2004_2024
[0m10:26:35.018786 [debug] [Thread-21 ]: Began executing node model.stock_analysis.stg_cvx_1993_2024
[0m10:26:35.019006 [debug] [Thread-23 ]: Began executing node model.stock_analysis.stg_goog_2004_2024
[0m10:26:35.019320 [debug] [Thread-15 ]: Finished running node model.stock_analysis.stg_adbe_1993_2024
[0m10:26:35.019558 [debug] [Thread-24 ]: Began executing node model.stock_analysis.stg_googl_2004_2024
[0m10:26:35.019733 [debug] [Thread-26 ]: Began executing node model.stock_analysis.stg_hd_1993_2024
[0m10:26:35.020105 [debug] [Thread-13 ]: Finished running node model.stock_analysis.stg_amd_1993_2024
[0m10:26:35.020350 [debug] [Thread-25 ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m10:26:35.020522 [debug] [Thread-27 ]: Began executing node model.stock_analysis.stg_jnj_1993_2024
[0m10:26:35.020726 [debug] [Thread-28 ]: Began executing node model.stock_analysis.stg_jpm_1993_2024
[0m10:26:35.021060 [debug] [Thread-16 ]: Finished running node model.stock_analysis.stg_amzn_1997_2024
[0m10:26:35.021301 [debug] [Thread-29 ]: Began executing node model.stock_analysis.stg_ko_1993_2024
[0m10:26:35.021595 [debug] [Thread-12 ]: Began running node model.stock_analysis.stg_unh_1993_2024
[0m10:26:35.021818 [debug] [Thread-31 ]: Began executing node model.stock_analysis.stg_ma_2006_2024
[0m10:26:35.022055 [debug] [Thread-30 ]: Began executing node model.stock_analysis.stg_lly_1993_2024
[0m10:26:35.022421 [debug] [Thread-32 ]: Began executing node model.stock_analysis.stg_meta_2012_2024
[0m10:26:35.022601 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_mrk_1993_2024
[0m10:26:35.022995 [debug] [Thread-17 ]: Finished running node model.stock_analysis.stg_avgo_2009_2024
[0m10:26:35.023242 [debug] [Thread-2  ]: Began executing node model.stock_analysis.stg_nasdaq_history_base
[0m10:26:35.023405 [debug] [Thread-10 ]: Began executing node model.stock_analysis.stg_msft_1993_2024
[0m10:26:35.023577 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_nflx_1993_2024
[0m10:26:35.023785 [debug] [Thread-4  ]: Began executing node model.stock_analysis.stg_nvda_1999_2024
[0m10:26:35.024149 [debug] [Thread-18 ]: Finished running node model.stock_analysis.stg_bac_1993_2024
[0m10:26:35.024426 [debug] [Thread-5  ]: Began executing node model.stock_analysis.stg_pep_1993_2024
[0m10:26:35.024597 [debug] [Thread-6  ]: Began executing node model.stock_analysis.stg_pg_1993_2024
[0m10:26:35.024855 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.stg_tsla_2010_2024
[0m10:26:35.025032 [debug] [Thread-9  ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m10:26:35.025213 [debug] [Thread-7  ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m10:26:35.025526 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_cost_1993_2024
[0m10:26:35.025861 [debug] [Thread-19 ]: Finished running node model.stock_analysis.stg_brk-b_1996_2024
[0m10:26:35.026030 [debug] [Thread-8  ]: Began executing node model.stock_analysis.stg_tmo_1993_2024
[0m10:26:35.026212 [debug] [Thread-14 ]: Began running node model.stock_analysis.stg_v_1993_2024
[0m10:26:35.026538 [debug] [Thread-22 ]: Finished running node model.stock_analysis.stg_crm_2004_2024
[0m10:26:35.026847 [debug] [Thread-21 ]: Finished running node model.stock_analysis.stg_cvx_1993_2024
[0m10:26:35.027142 [debug] [Thread-23 ]: Finished running node model.stock_analysis.stg_goog_2004_2024
[0m10:26:35.027333 [debug] [Thread-15 ]: Began running node model.stock_analysis.stg_wmt_1993_2024
[0m10:26:35.027655 [debug] [Thread-24 ]: Finished running node model.stock_analysis.stg_googl_2004_2024
[0m10:26:35.027954 [debug] [Thread-26 ]: Finished running node model.stock_analysis.stg_hd_1993_2024
[0m10:26:35.028149 [debug] [Thread-13 ]: Began running node model.stock_analysis.stg_xom_1993_2024
[0m10:26:35.028465 [debug] [Thread-25 ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m10:26:35.028781 [debug] [Thread-27 ]: Finished running node model.stock_analysis.stg_jnj_1993_2024
[0m10:26:35.029076 [debug] [Thread-28 ]: Finished running node model.stock_analysis.stg_jpm_1993_2024
[0m10:26:35.029420 [debug] [Thread-29 ]: Finished running node model.stock_analysis.stg_ko_1993_2024
[0m10:26:35.029614 [debug] [Thread-12 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_aapl_1993_2024, now model.stock_analysis.stg_unh_1993_2024)
[0m10:26:35.029932 [debug] [Thread-31 ]: Finished running node model.stock_analysis.stg_ma_2006_2024
[0m10:26:35.030232 [debug] [Thread-30 ]: Finished running node model.stock_analysis.stg_lly_1993_2024
[0m10:26:35.030540 [debug] [Thread-32 ]: Finished running node model.stock_analysis.stg_meta_2012_2024
[0m10:26:35.030830 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_mrk_1993_2024
[0m10:26:35.031180 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_nasdaq_history_base
[0m10:26:35.031477 [debug] [Thread-10 ]: Finished running node model.stock_analysis.stg_msft_1993_2024
[0m10:26:35.031772 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_nflx_1993_2024
[0m10:26:35.032058 [debug] [Thread-4  ]: Finished running node model.stock_analysis.stg_nvda_1999_2024
[0m10:26:35.032391 [debug] [Thread-5  ]: Finished running node model.stock_analysis.stg_pep_1993_2024
[0m10:26:35.032684 [debug] [Thread-6  ]: Finished running node model.stock_analysis.stg_pg_1993_2024
[0m10:26:35.034751 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.stg_tsla_2010_2024"
[0m10:26:35.035102 [debug] [Thread-9  ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m10:26:35.035454 [debug] [Thread-7  ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m10:26:35.035879 [debug] [Thread-8  ]: Finished running node model.stock_analysis.stg_tmo_1993_2024
[0m10:26:35.036074 [debug] [Thread-14 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_abbv_2013_2024, now model.stock_analysis.stg_v_1993_2024)
[0m10:26:35.036388 [debug] [Thread-15 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_adbe_1993_2024, now model.stock_analysis.stg_wmt_1993_2024)
[0m10:26:35.036671 [debug] [Thread-13 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amd_1993_2024, now model.stock_analysis.stg_xom_1993_2024)
[0m10:26:35.037001 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.stg_unh_1993_2024
[0m10:26:35.037498 [debug] [Thread-10 ]: Began running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:26:35.037683 [debug] [Thread-16 ]: Began running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:26:35.037891 [debug] [Thread-17 ]: Began running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:26:35.038078 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:26:35.038528 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.stg_v_1993_2024
[0m10:26:35.038746 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.stg_wmt_1993_2024
[0m10:26:35.038924 [debug] [Thread-11 ]: Began executing node model.stock_analysis.stg_tsla_2010_2024
[0m10:26:35.039096 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.stg_xom_1993_2024
[0m10:26:35.041141 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.stg_unh_1993_2024"
[0m10:26:35.041396 [debug] [Thread-10 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_msft_1993_2024, now model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price)
[0m10:26:35.041625 [debug] [Thread-16 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_amzn_1997_2024, now model.stock_analysis.stg_nasdaq_monthly_price_movement)
[0m10:26:35.041831 [debug] [Thread-17 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_avgo_2009_2024, now model.stock_analysis.stg_nasdaq_weekly_price_movement)
[0m10:26:35.042031 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_nflx_1993_2024, now model.stock_analysis.stg_nasdaq_yearly_price_movement)
[0m10:26:35.044965 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.stg_v_1993_2024"
[0m10:26:35.046896 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.stg_wmt_1993_2024"
[0m10:26:35.047263 [debug] [Thread-11 ]: Finished running node model.stock_analysis.stg_tsla_2010_2024
[0m10:26:35.049199 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.stg_xom_1993_2024"
[0m10:26:35.049465 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:26:35.049675 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:26:35.049869 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:26:35.050040 [debug] [Thread-12 ]: Began executing node model.stock_analysis.stg_unh_1993_2024
[0m10:26:35.050206 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:26:35.052007 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price"
[0m10:26:35.053708 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_monthly_price_movement"
[0m10:26:35.053949 [debug] [Thread-15 ]: Began executing node model.stock_analysis.stg_wmt_1993_2024
[0m10:26:35.055676 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_weekly_price_movement"
[0m10:26:35.055882 [debug] [Thread-13 ]: Began executing node model.stock_analysis.stg_xom_1993_2024
[0m10:26:35.056218 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stg_unh_1993_2024
[0m10:26:35.056383 [debug] [Thread-14 ]: Began executing node model.stock_analysis.stg_v_1993_2024
[0m10:26:35.058009 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_yearly_price_movement"
[0m10:26:35.058444 [debug] [Thread-15 ]: Finished running node model.stock_analysis.stg_wmt_1993_2024
[0m10:26:35.058937 [debug] [Thread-13 ]: Finished running node model.stock_analysis.stg_xom_1993_2024
[0m10:26:35.059258 [debug] [Thread-10 ]: Began executing node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:26:35.059613 [debug] [Thread-14 ]: Finished running node model.stock_analysis.stg_v_1993_2024
[0m10:26:35.059799 [debug] [Thread-16 ]: Began executing node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:26:35.060052 [debug] [Thread-17 ]: Began executing node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:26:35.060589 [debug] [Thread-10 ]: Finished running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:26:35.060768 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:26:35.061154 [debug] [Thread-16 ]: Finished running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:26:35.061484 [debug] [Thread-17 ]: Finished running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:26:35.061866 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:26:35.062299 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:26:35.062523 [debug] [Thread-20 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cost_1993_2024, now model.stock_analysis.stg_all_nasdaq_stock_history)
[0m10:26:35.062734 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:26:35.065857 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m10:26:35.066591 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:26:35.066936 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:26:35.067270 [debug] [Thread-22 ]: Began running node model.stock_analysis.int_nasdaq
[0m10:26:35.067497 [debug] [Thread-21 ]: Began running node model.stock_analysis.int_stock_analysis
[0m10:26:35.067691 [debug] [Thread-22 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_crm_2004_2024, now model.stock_analysis.int_nasdaq)
[0m10:26:35.067869 [debug] [Thread-23 ]: Began running node model.stock_analysis.nasdaq
[0m10:26:35.068107 [debug] [Thread-21 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_cvx_1993_2024, now model.stock_analysis.int_stock_analysis)
[0m10:26:35.068288 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.int_nasdaq
[0m10:26:35.068490 [debug] [Thread-23 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_goog_2004_2024, now model.stock_analysis.nasdaq)
[0m10:26:35.068691 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m10:26:35.070292 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.int_nasdaq"
[0m10:26:35.070477 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.nasdaq
[0m10:26:35.072397 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m10:26:35.074083 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m10:26:35.074361 [debug] [Thread-22 ]: Began executing node model.stock_analysis.int_nasdaq
[0m10:26:35.074701 [debug] [Thread-22 ]: Finished running node model.stock_analysis.int_nasdaq
[0m10:26:35.074971 [debug] [Thread-23 ]: Began executing node model.stock_analysis.nasdaq
[0m10:26:35.075154 [debug] [Thread-21 ]: Began executing node model.stock_analysis.int_stock_analysis
[0m10:26:35.075464 [debug] [Thread-23 ]: Finished running node model.stock_analysis.nasdaq
[0m10:26:35.075769 [debug] [Thread-21 ]: Finished running node model.stock_analysis.int_stock_analysis
[0m10:26:35.076114 [debug] [Thread-26 ]: Began running node model.stock_analysis.stock_analysis
[0m10:26:35.076318 [debug] [Thread-26 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_hd_1993_2024, now model.stock_analysis.stock_analysis)
[0m10:26:35.076523 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.stock_analysis
[0m10:26:35.078218 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m10:26:35.078872 [debug] [Thread-26 ]: Began executing node model.stock_analysis.stock_analysis
[0m10:26:35.079186 [debug] [Thread-26 ]: Finished running node model.stock_analysis.stock_analysis
[0m10:26:35.079900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:35.080040 [debug] [MainThread]: Connection 'model.stock_analysis.stg_mrk_1993_2024' was properly closed.
[0m10:26:35.080160 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_base' was properly closed.
[0m10:26:35.080272 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_yearly_price_movement' was properly closed.
[0m10:26:35.080386 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nvda_1999_2024' was properly closed.
[0m10:26:35.080496 [debug] [MainThread]: Connection 'model.stock_analysis.stg_pep_1993_2024' was properly closed.
[0m10:26:35.080604 [debug] [MainThread]: Connection 'model.stock_analysis.stg_pg_1993_2024' was properly closed.
[0m10:26:35.080714 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spus_2019_2024' was properly closed.
[0m10:26:35.080823 [debug] [MainThread]: Connection 'model.stock_analysis.stg_tmo_1993_2024' was properly closed.
[0m10:26:35.080934 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_1993_2024' was properly closed.
[0m10:26:35.081044 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price' was properly closed.
[0m10:26:35.081154 [debug] [MainThread]: Connection 'model.stock_analysis.stg_tsla_2010_2024' was properly closed.
[0m10:26:35.081265 [debug] [MainThread]: Connection 'model.stock_analysis.stg_unh_1993_2024' was properly closed.
[0m10:26:35.081373 [debug] [MainThread]: Connection 'model.stock_analysis.stg_xom_1993_2024' was properly closed.
[0m10:26:35.081480 [debug] [MainThread]: Connection 'model.stock_analysis.stg_v_1993_2024' was properly closed.
[0m10:26:35.081590 [debug] [MainThread]: Connection 'model.stock_analysis.stg_wmt_1993_2024' was properly closed.
[0m10:26:35.081699 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_monthly_price_movement' was properly closed.
[0m10:26:35.081809 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement' was properly closed.
[0m10:26:35.081922 [debug] [MainThread]: Connection 'model.stock_analysis.stg_bac_1993_2024' was properly closed.
[0m10:26:35.082030 [debug] [MainThread]: Connection 'model.stock_analysis.stg_brk-b_1996_2024' was properly closed.
[0m10:26:35.082139 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m10:26:35.082247 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m10:26:35.082357 [debug] [MainThread]: Connection 'model.stock_analysis.int_nasdaq' was properly closed.
[0m10:26:35.082467 [debug] [MainThread]: Connection 'model.stock_analysis.nasdaq' was properly closed.
[0m10:26:35.082575 [debug] [MainThread]: Connection 'model.stock_analysis.stg_googl_2004_2024' was properly closed.
[0m10:26:35.082688 [debug] [MainThread]: Connection 'model.stock_analysis.stg_hlal_2019_2024' was properly closed.
[0m10:26:35.082795 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m10:26:35.082904 [debug] [MainThread]: Connection 'model.stock_analysis.stg_jnj_1993_2024' was properly closed.
[0m10:26:35.083014 [debug] [MainThread]: Connection 'model.stock_analysis.stg_jpm_1993_2024' was properly closed.
[0m10:26:35.083124 [debug] [MainThread]: Connection 'model.stock_analysis.stg_ko_1993_2024' was properly closed.
[0m10:26:35.083233 [debug] [MainThread]: Connection 'model.stock_analysis.stg_lly_1993_2024' was properly closed.
[0m10:26:35.083344 [debug] [MainThread]: Connection 'model.stock_analysis.stg_ma_2006_2024' was properly closed.
[0m10:26:35.083456 [debug] [MainThread]: Connection 'model.stock_analysis.stg_meta_2012_2024' was properly closed.
[0m10:26:35.088583 [debug] [MainThread]: Command end result
[0m10:26:35.192603 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m10:26:35.192842 [info ] [MainThread]: Building catalog
[0m10:26:35.204832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:35.802520 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m10:26:35.803788 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m10:26:35.834079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:35.837032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:35.965174 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards as (
                    
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock_analysis`.__TABLES__ tables
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'

                    where (upper(tables.dataset_id) = upper('stock_analysis'))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m10:26:35.965773 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards as (
                    
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock`.__TABLES__ tables
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'

                    where (upper(tables.dataset_id) = upper('stock'))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m10:26:36.697205 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:87ee21ca-befb-4a32-8e3f-ecae74ee37a4&page=queryresults
[0m10:26:36.739985 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:43be2742-69d7-4ed0-b1b8-5d2398b6baa1&page=queryresults
[0m10:26:41.825441 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/stock_analysis/target/catalog.json
[0m10:26:41.850304 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.4677105, "process_user_time": 4.897444, "process_kernel_time": 2.172591, "process_mem_max_rss": "269778944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:26:41.850750 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:26:41.850693 after 11.47 seconds
[0m10:26:41.850946 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:26:41.851086 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m10:26:41.851219 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m10:26:41.851378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dec2df0>]}
[0m10:26:41.851576 [debug] [MainThread]: Flushing usage events
[0m10:26:46.396827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd2e80>]}


============================== 10:26:46.399280 | 762c17dd-2664-464e-b697-c208ac9eb86d ==============================
[0m10:26:46.399280 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:26:46.399595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:46.871174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '762c17dd-2664-464e-b697-c208ac9eb86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139b37fa0>]}
[0m10:26:46.897046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '762c17dd-2664-464e-b697-c208ac9eb86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7f0d0>]}
[0m10:32:05.217437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af6b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105052d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105052f70>]}


============================== 10:32:05.219896 | c0c7b147-07b6-4386-a730-fde744297900 ==============================
[0m10:32:05.219896 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:32:05.220227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m10:32:05.717600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0c7b147-07b6-4386-a730-fde744297900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e2e130>]}
[0m10:32:05.743297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0c7b147-07b6-4386-a730-fde744297900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16aef8f40>]}
[0m10:32:05.870152 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m10:32:05.884041 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m10:32:05.885564 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.7152432, "process_user_time": 3.816285, "process_kernel_time": 0.167526, "process_mem_max_rss": "185253888", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:32:05.886176 [debug] [MainThread]: Command `dbt docs serve` failed at 10:32:05.886045 after 0.72 seconds
[0m10:32:05.886490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af6b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1760eaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1760f2490>]}
[0m10:32:05.886750 [debug] [MainThread]: Flushing usage events
[0m10:32:16.475815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b6b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e50e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e50280>]}


============================== 10:32:16.477929 | 906d4c92-4ebb-4196-9289-d09af17460c5 ==============================
[0m10:32:16.477929 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:32:16.478254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m10:32:16.920695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '906d4c92-4ebb-4196-9289-d09af17460c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0e8b0>]}
[0m10:32:16.946795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '906d4c92-4ebb-4196-9289-d09af17460c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ec2e20>]}
[0m10:32:16.947094 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m10:32:16.959187 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:32:17.076214 [debug] [MainThread]: Partial parsing enabled: 64 files deleted, 0 files added, 0 files changed.
[0m10:32:17.076646 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_lly_1993_2024.sql
[0m10:32:17.076810 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_amd_1993_2024.sql
[0m10:32:17.076952 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_jnj_1993_2024.sql
[0m10:32:17.077082 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_brk-b_1996_2024.sql
[0m10:32:17.077208 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_pep_1993_2024.sql
[0m10:32:17.077331 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_bac_1993_2024.sql
[0m10:32:17.077453 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_wmt_1993_2024.sql
[0m10:32:17.077573 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_meta_2012_2024.sql
[0m10:32:17.077691 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_v_1993_2024.sql
[0m10:32:17.077810 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nflx_1993_2024.sql
[0m10:32:17.077927 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_ma_2006_2024.sql
[0m10:32:17.078045 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_nflx_1993_2024.sql
[0m10:32:17.078161 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_crm_2004_2024.sql
[0m10:32:17.078276 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_crm_2004_2024.sql
[0m10:32:17.078392 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_nvda_1999_2024.sql
[0m10:32:17.078523 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_aapl_1993_2024.sql
[0m10:32:17.078652 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_cvx_1993_2024.sql
[0m10:32:17.078780 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_ko_1993_2024.sql
[0m10:32:17.078899 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_mrk_1993_2024.sql
[0m10:32:17.079017 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_amd_1993_2024.sql
[0m10:32:17.079134 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_jpm_1993_2024.sql
[0m10:32:17.079252 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_tsla_2010_2024.sql
[0m10:32:17.079372 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_hd_1993_2024.sql
[0m10:32:17.079489 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_cvx_1993_2024.sql
[0m10:32:17.079606 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_pg_1993_2024.sql
[0m10:32:17.079722 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_xom_1993_2024.sql
[0m10:32:17.079837 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_goog_2004_2024.sql
[0m10:32:17.079952 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_unh_1993_2024.sql
[0m10:32:17.080067 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_wmt_1993_2024.sql
[0m10:32:17.080180 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_adbe_1993_2024.sql
[0m10:32:17.080296 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_xom_1993_2024.sql
[0m10:32:17.080412 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_cost_1993_2024.sql
[0m10:32:17.080528 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_abbv_2013_2024.sql
[0m10:32:17.080644 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_goog_2004_2024.sql
[0m10:32:17.080759 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_unh_1993_2024.sql
[0m10:32:17.080875 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_avgo_2009_2024.sql
[0m10:32:17.080990 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_meta_2012_2024.sql
[0m10:32:17.081108 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_amzn_1997_2024.sql
[0m10:32:17.081224 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_ko_1993_2024.sql
[0m10:32:17.081345 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_pg_1993_2024.sql
[0m10:32:17.081460 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_brk-b_1996_2024.sql
[0m10:32:17.081579 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_hd_1993_2024.sql
[0m10:32:17.081698 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_amzn_1997_2024.sql
[0m10:32:17.081812 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_tmo_1993_2024.sql
[0m10:32:17.081930 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_jpm_1993_2024.sql
[0m10:32:17.082048 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_bac_1993_2024.sql
[0m10:32:17.082164 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nvda_1999_2024.sql
[0m10:32:17.082280 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_ma_2006_2024.sql
[0m10:32:17.082397 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_cost_1993_2024.sql
[0m10:32:17.082510 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_googl_2004_2024.sql
[0m10:32:17.082625 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_v_1993_2024.sql
[0m10:32:17.082742 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_tsla_2010_2024.sql
[0m10:32:17.082856 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_adbe_1993_2024.sql
[0m10:32:17.082973 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_lly_1993_2024.sql
[0m10:32:17.083087 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_mrk_1993_2024.sql
[0m10:32:17.083200 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_aapl_1993_2024.sql
[0m10:32:17.083315 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_jnj_1993_2024.sql
[0m10:32:17.083427 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_tmo_1993_2024.sql
[0m10:32:17.083540 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_msft_1993_2024.sql
[0m10:32:17.083654 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_abbv_2013_2024.sql
[0m10:32:17.083772 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_avgo_2009_2024.sql
[0m10:32:17.083888 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_googl_2004_2024.sql
[0m10:32:17.084002 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_pep_1993_2024.sql
[0m10:32:17.084114 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_msft_1993_2024.sql
[0m10:32:17.130311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '906d4c92-4ebb-4196-9289-d09af17460c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164efeb50>]}
[0m10:32:17.138866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '906d4c92-4ebb-4196-9289-d09af17460c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164e994c0>]}
[0m10:32:17.139111 [info ] [MainThread]: Found 23 models, 40 sources, 469 macros
[0m10:32:17.139298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '906d4c92-4ebb-4196-9289-d09af17460c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164dddaf0>]}
[0m10:32:17.140535 [info ] [MainThread]: 
[0m10:32:17.140806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:32:17.143646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_stock_analysis'
[0m10:32:17.143831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:17.654302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '906d4c92-4ebb-4196-9289-d09af17460c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f978e0>]}
[0m10:32:17.655087 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m10:32:17.655435 [info ] [MainThread]: 
[0m10:32:17.660918 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:32:17.661375 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:32:17.661735 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_calendar
[0m10:32:17.662108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m10:32:17.662535 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_hlal_2019_2024
[0m10:32:17.662890 [debug] [Thread-5  ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m10:32:17.663216 [debug] [Thread-6  ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m10:32:17.663680 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_nasdaq_stock_info'
[0m10:32:17.664192 [debug] [Thread-7  ]: Began running node model.stock_analysis.base_symbols_meta
[0m10:32:17.664911 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.base_calendar'
[0m10:32:17.665249 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:32:17.665787 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.stock_analysis.base_hlal_2019_2024'
[0m10:32:17.666239 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.base_spus_2019_2024'
[0m10:32:17.666723 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.base_spy_1993_2024'
[0m10:32:17.667064 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:32:17.667450 [debug] [Thread-7  ]: Acquiring new bigquery connection 'model.stock_analysis.base_symbols_meta'
[0m10:32:17.667767 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_calendar
[0m10:32:17.674014 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_hlal_2019_2024
[0m10:32:17.676048 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m10:32:17.678774 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m10:32:17.679142 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m10:32:17.681883 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m10:32:17.682217 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m10:32:17.684520 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m10:32:17.686635 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_hlal_2019_2024"
[0m10:32:17.688620 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m10:32:17.690722 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m10:32:17.692999 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m10:32:17.693484 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:32:17.693735 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:32:17.694044 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_calendar
[0m10:32:17.694416 [debug] [Thread-5  ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m10:32:17.694914 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:32:17.695129 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_hlal_2019_2024
[0m10:32:17.695589 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:32:17.695804 [debug] [Thread-6  ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m10:32:17.695994 [debug] [Thread-7  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m10:32:17.696356 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_calendar
[0m10:32:17.696734 [debug] [Thread-5  ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m10:32:17.697203 [debug] [Thread-4  ]: Finished running node model.stock_analysis.base_hlal_2019_2024
[0m10:32:17.697673 [debug] [Thread-6  ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m10:32:17.697906 [debug] [Thread-9  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:32:17.698314 [debug] [Thread-7  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m10:32:17.698650 [debug] [Thread-11 ]: Began running node model.stock_analysis.stg_calendar
[0m10:32:17.699080 [debug] [Thread-9  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_info'
[0m10:32:17.699441 [debug] [Thread-11 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_calendar'
[0m10:32:17.699657 [debug] [Thread-13 ]: Began running node model.stock_analysis.stg_symbols_meta
[0m10:32:17.699874 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:32:17.700081 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.stg_calendar
[0m10:32:17.700348 [debug] [Thread-13 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_symbols_meta'
[0m10:32:17.702927 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m10:32:17.705101 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m10:32:17.705343 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m10:32:17.707184 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m10:32:17.707531 [debug] [Thread-9  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:32:17.707728 [debug] [Thread-11 ]: Began executing node model.stock_analysis.stg_calendar
[0m10:32:17.708113 [debug] [Thread-9  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:32:17.708498 [debug] [Thread-11 ]: Finished running node model.stock_analysis.stg_calendar
[0m10:32:17.708693 [debug] [Thread-13 ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m10:32:17.709221 [debug] [Thread-13 ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m10:32:17.709434 [debug] [Thread-15 ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m10:32:17.709652 [debug] [Thread-16 ]: Began running node model.stock_analysis.stg_nasdaq_history_base
[0m10:32:17.709848 [debug] [Thread-17 ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m10:32:17.710054 [debug] [Thread-13 ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m10:32:17.710328 [debug] [Thread-15 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_hlal_2019_2024'
[0m10:32:17.710587 [debug] [Thread-16 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_history_base'
[0m10:32:17.710842 [debug] [Thread-17 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_spus_2019_2024'
[0m10:32:17.711061 [debug] [Thread-13 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_symbols_meta, now model.stock_analysis.stg_spy_1993_2024)
[0m10:32:17.711253 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m10:32:17.711433 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.stg_nasdaq_history_base
[0m10:32:17.711628 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m10:32:17.711810 [debug] [Thread-13 ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m10:32:17.713981 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m10:32:17.715808 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_base"
[0m10:32:17.717982 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m10:32:17.720007 [debug] [Thread-13 ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m10:32:17.720446 [debug] [Thread-15 ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m10:32:17.720647 [debug] [Thread-16 ]: Began executing node model.stock_analysis.stg_nasdaq_history_base
[0m10:32:17.721001 [debug] [Thread-15 ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m10:32:17.721171 [debug] [Thread-13 ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m10:32:17.721357 [debug] [Thread-17 ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m10:32:17.721714 [debug] [Thread-16 ]: Finished running node model.stock_analysis.stg_nasdaq_history_base
[0m10:32:17.722093 [debug] [Thread-13 ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m10:32:17.722430 [debug] [Thread-17 ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m10:32:17.722797 [debug] [Thread-19 ]: Began running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:32:17.723012 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:32:17.723205 [debug] [Thread-21 ]: Began running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:32:17.723402 [debug] [Thread-17 ]: Began running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:32:17.723666 [debug] [Thread-19 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price'
[0m10:32:17.723916 [debug] [Thread-20 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_monthly_price_movement'
[0m10:32:17.724150 [debug] [Thread-21 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement'
[0m10:32:17.724345 [debug] [Thread-17 ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spus_2019_2024, now model.stock_analysis.stg_nasdaq_yearly_price_movement)
[0m10:32:17.724528 [debug] [Thread-19 ]: Began compiling node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:32:17.724708 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:32:17.724881 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:32:17.725053 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:32:17.727400 [debug] [Thread-19 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price"
[0m10:32:17.729085 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_monthly_price_movement"
[0m10:32:17.730702 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_weekly_price_movement"
[0m10:32:17.732231 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_yearly_price_movement"
[0m10:32:17.732649 [debug] [Thread-19 ]: Began executing node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:32:17.732834 [debug] [Thread-21 ]: Began executing node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:32:17.733180 [debug] [Thread-19 ]: Finished running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:32:17.733536 [debug] [Thread-21 ]: Finished running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:32:17.733712 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:32:17.733883 [debug] [Thread-17 ]: Began executing node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:32:17.734269 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:32:17.734582 [debug] [Thread-17 ]: Finished running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:32:17.734934 [debug] [Thread-23 ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:32:17.735209 [debug] [Thread-23 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_history'
[0m10:32:17.735416 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:32:17.737396 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m10:32:17.737706 [debug] [Thread-23 ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:32:17.738025 [debug] [Thread-23 ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:32:17.738330 [debug] [Thread-25 ]: Began running node model.stock_analysis.int_nasdaq
[0m10:32:17.738550 [debug] [Thread-26 ]: Began running node model.stock_analysis.int_stock_analysis
[0m10:32:17.738783 [debug] [Thread-25 ]: Acquiring new bigquery connection 'model.stock_analysis.int_nasdaq'
[0m10:32:17.738958 [debug] [Thread-27 ]: Began running node model.stock_analysis.nasdaq
[0m10:32:17.739215 [debug] [Thread-26 ]: Acquiring new bigquery connection 'model.stock_analysis.int_stock_analysis'
[0m10:32:17.739378 [debug] [Thread-25 ]: Began compiling node model.stock_analysis.int_nasdaq
[0m10:32:17.739597 [debug] [Thread-27 ]: Acquiring new bigquery connection 'model.stock_analysis.nasdaq'
[0m10:32:17.739762 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m10:32:17.741425 [debug] [Thread-25 ]: Writing injected SQL for node "model.stock_analysis.int_nasdaq"
[0m10:32:17.741609 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.nasdaq
[0m10:32:17.743459 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m10:32:17.745795 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m10:32:17.746049 [debug] [Thread-25 ]: Began executing node model.stock_analysis.int_nasdaq
[0m10:32:17.746386 [debug] [Thread-25 ]: Finished running node model.stock_analysis.int_nasdaq
[0m10:32:17.746592 [debug] [Thread-26 ]: Began executing node model.stock_analysis.int_stock_analysis
[0m10:32:17.746902 [debug] [Thread-26 ]: Finished running node model.stock_analysis.int_stock_analysis
[0m10:32:17.747107 [debug] [Thread-27 ]: Began executing node model.stock_analysis.nasdaq
[0m10:32:17.747443 [debug] [Thread-27 ]: Finished running node model.stock_analysis.nasdaq
[0m10:32:17.747632 [debug] [Thread-29 ]: Began running node model.stock_analysis.stock_analysis
[0m10:32:17.747897 [debug] [Thread-29 ]: Acquiring new bigquery connection 'model.stock_analysis.stock_analysis'
[0m10:32:17.748060 [debug] [Thread-29 ]: Began compiling node model.stock_analysis.stock_analysis
[0m10:32:17.749768 [debug] [Thread-29 ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m10:32:17.750061 [debug] [Thread-29 ]: Began executing node model.stock_analysis.stock_analysis
[0m10:32:17.750379 [debug] [Thread-29 ]: Finished running node model.stock_analysis.stock_analysis
[0m10:32:17.751095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:17.751251 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m10:32:17.751379 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m10:32:17.751499 [debug] [MainThread]: Connection 'model.stock_analysis.base_calendar' was properly closed.
[0m10:32:17.751617 [debug] [MainThread]: Connection 'model.stock_analysis.base_hlal_2019_2024' was properly closed.
[0m10:32:17.751732 [debug] [MainThread]: Connection 'model.stock_analysis.base_spus_2019_2024' was properly closed.
[0m10:32:17.751847 [debug] [MainThread]: Connection 'model.stock_analysis.base_spy_1993_2024' was properly closed.
[0m10:32:17.751960 [debug] [MainThread]: Connection 'model.stock_analysis.base_symbols_meta' was properly closed.
[0m10:32:17.752075 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m10:32:17.752188 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m10:32:17.752301 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_1993_2024' was properly closed.
[0m10:32:17.752415 [debug] [MainThread]: Connection 'model.stock_analysis.stg_hlal_2019_2024' was properly closed.
[0m10:32:17.752527 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_base' was properly closed.
[0m10:32:17.752643 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_yearly_price_movement' was properly closed.
[0m10:32:17.752755 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price' was properly closed.
[0m10:32:17.752869 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_monthly_price_movement' was properly closed.
[0m10:32:17.752981 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement' was properly closed.
[0m10:32:17.753092 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m10:32:17.753203 [debug] [MainThread]: Connection 'model.stock_analysis.int_nasdaq' was properly closed.
[0m10:32:17.753317 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m10:32:17.753428 [debug] [MainThread]: Connection 'model.stock_analysis.nasdaq' was properly closed.
[0m10:32:17.753546 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m10:32:17.755092 [debug] [MainThread]: Command end result
[0m10:32:17.810964 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m10:32:17.811146 [info ] [MainThread]: Building catalog
[0m10:32:17.817809 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m10:32:17.829005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:17.829307 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m10:32:17.889017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:17.889579 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock_analysis`.__TABLES__ tables
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('int_nasdaq')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_all_nasdaq_stock_history')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_spy_1993_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_monthly_price_movement')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_weekly_price_movement')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_spus_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_history_weekly_monthly_yearly_price')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_yearly_price_movement')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('nasdaq')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_all_nasdaq_stock_history')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_symbols_meta')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_all_nasdaq_stock_info')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('int_stock_analysis')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_history_base')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_spy_1993_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_spus_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_hlal_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_symbols_meta')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_hlal_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stock_analysis')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_all_nasdaq_stock_info')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m10:32:17.950744 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock`.__TABLES__ tables
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('crm')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('wmt')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('adbe')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('amzn')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('meta')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('brk-b')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('msft')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('cvx')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('mrk')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('400_years_of_generated_dates_and_holidays')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('ma')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('lly')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('symbols_valid_meta')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('all_nasdaq_stock_info')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('jnj')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('hlal')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('amd')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('aapl')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('nvda')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spus_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('xom')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('abbv')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('nflx')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('tmo')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('bac')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('goog')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('googl')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('ko')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('all_nasdaq_stock_history')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('jpm')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('tsla')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spy_1993_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('pg')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('unh')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('hd')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('avgo')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('pep')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('v')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('cost')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m10:32:18.707792 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d15a56ff-7f22-4420-a720-bad71954409f&page=queryresults
[0m10:32:18.778149 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6ead32dc-326b-49ba-bd08-58ae661c3f5e&page=queryresults
[0m10:32:23.240812 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/stock_analysis/target/catalog.json
[0m10:32:23.243253 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.8130164, "process_user_time": 5.23013, "process_kernel_time": 0.191836, "process_mem_max_rss": "221855744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:32:23.243663 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:32:23.243610 after 6.81 seconds
[0m10:32:23.243872 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:32:23.244010 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m10:32:23.244134 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m10:32:23.244301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b6b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ec2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168619eb0>]}
[0m10:32:23.244507 [debug] [MainThread]: Flushing usage events
[0m10:32:32.684665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a7ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a7aee0>]}


============================== 10:32:32.687119 | 2ce35a71-1683-4ed9-b51e-4206ddfe7a6b ==============================
[0m10:32:32.687119 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:32:32.687436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:32:33.168711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce35a71-1683-4ed9-b51e-4206ddfe7a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10232b0d0>]}
[0m10:32:33.194595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce35a71-1683-4ed9-b51e-4206ddfe7a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a3bd30>]}
[0m10:32:33.318156 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m10:32:33.330928 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m10:32:33.332534 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.6948689, "process_user_time": 1.67345, "process_kernel_time": 2.442077, "process_mem_max_rss": "185171968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:32:33.333063 [debug] [MainThread]: Command `dbt docs serve` failed at 10:32:33.332999 after 0.70 seconds
[0m10:32:33.333320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c5ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c66460>]}
[0m10:32:33.333561 [debug] [MainThread]: Flushing usage events
[0m10:38:03.273512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a992cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a992eb0>]}


============================== 10:38:03.276234 | 49af3bef-29eb-4f23-abe0-d374e12f740a ==============================
[0m10:38:03.276234 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:38:03.276595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:03.809621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49af3bef-29eb-4f23-abe0-d374e12f740a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886e0a0>]}
[0m10:38:03.835361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49af3bef-29eb-4f23-abe0-d374e12f740a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1627a45b0>]}
[0m10:38:03.970435 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m10:38:03.982996 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m10:38:03.984528 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.75889367, "process_user_time": 3.807035, "process_kernel_time": 0.16559, "process_mem_max_rss": "182042624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:38:03.985035 [debug] [MainThread]: Command `dbt docs serve` failed at 10:38:03.984970 after 0.76 seconds
[0m10:38:03.985290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168a5ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168a66430>]}
[0m10:38:03.985511 [debug] [MainThread]: Flushing usage events
[0m10:39:30.472185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468eee0>]}


============================== 10:39:30.474599 | bd68c335-e6a7-48cd-a733-3b6ae8e7e346 ==============================
[0m10:39:30.474599 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:39:30.474917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:30.970621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd68c335-e6a7-48cd-a733-3b6ae8e7e346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2e0d0>]}
[0m10:39:30.996438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd68c335-e6a7-48cd-a733-3b6ae8e7e346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464fd30>]}
[0m10:39:31.132033 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m10:39:31.144281 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m10:39:31.145829 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.7201244, "process_user_time": 1.31537, "process_kernel_time": 2.686304, "process_mem_max_rss": "183189504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:39:31.146280 [debug] [MainThread]: Command `dbt docs serve` failed at 10:39:31.146218 after 0.72 seconds
[0m10:39:31.146539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028f6af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e1ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159e26460>]}
[0m10:39:31.146773 [debug] [MainThread]: Flushing usage events
[0m10:40:18.032407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108200e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108200280>]}


============================== 10:40:18.034837 | 0851f17f-a1e3-459e-896c-be29392ccff2 ==============================
[0m10:40:18.034837 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:40:18.035149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:18.542836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0851f17f-a1e3-459e-896c-be29392ccff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bf8b0>]}
[0m10:40:18.568998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0851f17f-a1e3-459e-896c-be29392ccff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135402e20>]}
[0m10:40:18.569292 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m10:40:18.581447 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:40:18.665661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:40:18.665931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:40:18.687268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0851f17f-a1e3-459e-896c-be29392ccff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c77130>]}
[0m10:40:18.733033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0851f17f-a1e3-459e-896c-be29392ccff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13545bfa0>]}
[0m10:40:18.733353 [info ] [MainThread]: Found 23 models, 40 sources, 469 macros
[0m10:40:18.733558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0851f17f-a1e3-459e-896c-be29392ccff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13543fb50>]}
[0m10:40:18.734883 [info ] [MainThread]: 
[0m10:40:18.735187 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:40:18.738168 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_stock_analysis'
[0m10:40:18.738370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:19.268086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0851f17f-a1e3-459e-896c-be29392ccff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13695af70>]}
[0m10:40:19.268794 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m10:40:19.269068 [info ] [MainThread]: 
[0m10:40:19.274062 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:40:19.274427 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:40:19.274718 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_calendar
[0m10:40:19.275045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m10:40:19.275467 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_hlal_2019_2024
[0m10:40:19.275799 [debug] [Thread-5  ]: Began running node model.stock_analysis.base_spus_2019_2024
[0m10:40:19.276307 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_nasdaq_stock_info'
[0m10:40:19.276633 [debug] [Thread-6  ]: Began running node model.stock_analysis.base_spy_1993_2024
[0m10:40:19.276944 [debug] [Thread-7  ]: Began running node model.stock_analysis.base_symbols_meta
[0m10:40:19.277310 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.base_calendar'
[0m10:40:19.277605 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:40:19.277934 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.stock_analysis.base_hlal_2019_2024'
[0m10:40:19.278334 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.base_spus_2019_2024'
[0m10:40:19.278723 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:40:19.279124 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.base_spy_1993_2024'
[0m10:40:19.279463 [debug] [Thread-7  ]: Acquiring new bigquery connection 'model.stock_analysis.base_symbols_meta'
[0m10:40:19.279739 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_calendar
[0m10:40:19.285714 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_hlal_2019_2024
[0m10:40:19.288283 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m10:40:19.288594 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.base_spus_2019_2024
[0m10:40:19.289799 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.base_spy_1993_2024
[0m10:40:19.290180 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m10:40:19.292756 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m10:40:19.294787 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m10:40:19.296725 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_hlal_2019_2024"
[0m10:40:19.298782 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.base_spus_2019_2024"
[0m10:40:19.300660 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.base_spy_1993_2024"
[0m10:40:19.302504 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m10:40:19.303190 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:40:19.303669 [debug] [Thread-5  ]: Began executing node model.stock_analysis.base_spus_2019_2024
[0m10:40:19.303896 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:40:19.304164 [debug] [Thread-6  ]: Began executing node model.stock_analysis.base_spy_1993_2024
[0m10:40:19.304635 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:40:19.304851 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_hlal_2019_2024
[0m10:40:19.305051 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_calendar
[0m10:40:19.305416 [debug] [Thread-5  ]: Finished running node model.stock_analysis.base_spus_2019_2024
[0m10:40:19.305593 [debug] [Thread-7  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m10:40:19.305954 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m10:40:19.306336 [debug] [Thread-6  ]: Finished running node model.stock_analysis.base_spy_1993_2024
[0m10:40:19.306775 [debug] [Thread-4  ]: Finished running node model.stock_analysis.base_hlal_2019_2024
[0m10:40:19.307131 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_calendar
[0m10:40:19.307539 [debug] [Thread-7  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m10:40:19.307902 [debug] [Thread-9  ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:40:19.308363 [debug] [Thread-9  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_info'
[0m10:40:19.308563 [debug] [Thread-9  ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:40:19.308756 [debug] [Thread-11 ]: Began running node model.stock_analysis.stg_calendar
[0m10:40:19.308953 [debug] [Thread-12 ]: Began running node model.stock_analysis.stg_symbols_meta
[0m10:40:19.310713 [debug] [Thread-9  ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m10:40:19.310997 [debug] [Thread-11 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_calendar'
[0m10:40:19.311308 [debug] [Thread-12 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_symbols_meta'
[0m10:40:19.311539 [debug] [Thread-11 ]: Began compiling node model.stock_analysis.stg_calendar
[0m10:40:19.311733 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m10:40:19.314421 [debug] [Thread-11 ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m10:40:19.316163 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m10:40:19.316367 [debug] [Thread-9  ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:40:19.316774 [debug] [Thread-9  ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m10:40:19.317089 [debug] [Thread-12 ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m10:40:19.317274 [debug] [Thread-11 ]: Began executing node model.stock_analysis.stg_calendar
[0m10:40:19.317607 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m10:40:19.317939 [debug] [Thread-11 ]: Finished running node model.stock_analysis.stg_calendar
[0m10:40:19.318334 [debug] [Thread-14 ]: Began running node model.stock_analysis.stg_hlal_2019_2024
[0m10:40:19.318530 [debug] [Thread-15 ]: Began running node model.stock_analysis.stg_nasdaq_history_base
[0m10:40:19.318753 [debug] [Thread-16 ]: Began running node model.stock_analysis.stg_spus_2019_2024
[0m10:40:19.318991 [debug] [Thread-14 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_hlal_2019_2024'
[0m10:40:19.319169 [debug] [Thread-17 ]: Began running node model.stock_analysis.stg_spy_1993_2024
[0m10:40:19.319456 [debug] [Thread-15 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_history_base'
[0m10:40:19.319692 [debug] [Thread-16 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_spus_2019_2024'
[0m10:40:19.319880 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.stg_hlal_2019_2024
[0m10:40:19.320107 [debug] [Thread-17 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_spy_1993_2024'
[0m10:40:19.320280 [debug] [Thread-15 ]: Began compiling node model.stock_analysis.stg_nasdaq_history_base
[0m10:40:19.320451 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.stg_spus_2019_2024
[0m10:40:19.322531 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.stg_hlal_2019_2024"
[0m10:40:19.322739 [debug] [Thread-17 ]: Began compiling node model.stock_analysis.stg_spy_1993_2024
[0m10:40:19.324479 [debug] [Thread-15 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_base"
[0m10:40:19.326585 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.stg_spus_2019_2024"
[0m10:40:19.328617 [debug] [Thread-17 ]: Writing injected SQL for node "model.stock_analysis.stg_spy_1993_2024"
[0m10:40:19.329037 [debug] [Thread-14 ]: Began executing node model.stock_analysis.stg_hlal_2019_2024
[0m10:40:19.329396 [debug] [Thread-14 ]: Finished running node model.stock_analysis.stg_hlal_2019_2024
[0m10:40:19.329703 [debug] [Thread-16 ]: Began executing node model.stock_analysis.stg_spus_2019_2024
[0m10:40:19.329890 [debug] [Thread-17 ]: Began executing node model.stock_analysis.stg_spy_1993_2024
[0m10:40:19.330055 [debug] [Thread-15 ]: Began executing node model.stock_analysis.stg_nasdaq_history_base
[0m10:40:19.330364 [debug] [Thread-16 ]: Finished running node model.stock_analysis.stg_spus_2019_2024
[0m10:40:19.330737 [debug] [Thread-17 ]: Finished running node model.stock_analysis.stg_spy_1993_2024
[0m10:40:19.331048 [debug] [Thread-15 ]: Finished running node model.stock_analysis.stg_nasdaq_history_base
[0m10:40:19.331421 [debug] [Thread-19 ]: Began running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:40:19.331645 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:40:19.331883 [debug] [Thread-19 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price'
[0m10:40:19.332068 [debug] [Thread-21 ]: Began running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:40:19.332294 [debug] [Thread-22 ]: Began running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:40:19.332520 [debug] [Thread-20 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_monthly_price_movement'
[0m10:40:19.332696 [debug] [Thread-19 ]: Began compiling node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:40:19.332920 [debug] [Thread-21 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement'
[0m10:40:19.333146 [debug] [Thread-22 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_nasdaq_yearly_price_movement'
[0m10:40:19.333320 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:40:19.334942 [debug] [Thread-19 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price"
[0m10:40:19.335135 [debug] [Thread-21 ]: Began compiling node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:40:19.335307 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:40:19.337539 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_monthly_price_movement"
[0m10:40:19.339179 [debug] [Thread-21 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_weekly_price_movement"
[0m10:40:19.340731 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.stg_nasdaq_yearly_price_movement"
[0m10:40:19.340965 [debug] [Thread-19 ]: Began executing node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:40:19.341382 [debug] [Thread-19 ]: Finished running node model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price
[0m10:40:19.341653 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:40:19.341830 [debug] [Thread-22 ]: Began executing node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:40:19.342001 [debug] [Thread-21 ]: Began executing node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:40:19.342305 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_nasdaq_monthly_price_movement
[0m10:40:19.342626 [debug] [Thread-22 ]: Finished running node model.stock_analysis.stg_nasdaq_yearly_price_movement
[0m10:40:19.342933 [debug] [Thread-21 ]: Finished running node model.stock_analysis.stg_nasdaq_weekly_price_movement
[0m10:40:19.343273 [debug] [Thread-24 ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:40:19.343538 [debug] [Thread-24 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_history'
[0m10:40:19.343747 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:40:19.345681 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_history"
[0m10:40:19.346298 [debug] [Thread-24 ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:40:19.346610 [debug] [Thread-24 ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_history
[0m10:40:19.346901 [debug] [Thread-26 ]: Began running node model.stock_analysis.int_nasdaq
[0m10:40:19.347108 [debug] [Thread-27 ]: Began running node model.stock_analysis.int_stock_analysis
[0m10:40:19.347321 [debug] [Thread-26 ]: Acquiring new bigquery connection 'model.stock_analysis.int_nasdaq'
[0m10:40:19.347484 [debug] [Thread-28 ]: Began running node model.stock_analysis.nasdaq
[0m10:40:19.347763 [debug] [Thread-27 ]: Acquiring new bigquery connection 'model.stock_analysis.int_stock_analysis'
[0m10:40:19.347938 [debug] [Thread-26 ]: Began compiling node model.stock_analysis.int_nasdaq
[0m10:40:19.348156 [debug] [Thread-28 ]: Acquiring new bigquery connection 'model.stock_analysis.nasdaq'
[0m10:40:19.348319 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.int_stock_analysis
[0m10:40:19.349944 [debug] [Thread-26 ]: Writing injected SQL for node "model.stock_analysis.int_nasdaq"
[0m10:40:19.350136 [debug] [Thread-28 ]: Began compiling node model.stock_analysis.nasdaq
[0m10:40:19.351945 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.int_stock_analysis"
[0m10:40:19.353612 [debug] [Thread-28 ]: Writing injected SQL for node "model.stock_analysis.nasdaq"
[0m10:40:19.353866 [debug] [Thread-26 ]: Began executing node model.stock_analysis.int_nasdaq
[0m10:40:19.354201 [debug] [Thread-26 ]: Finished running node model.stock_analysis.int_nasdaq
[0m10:40:19.354418 [debug] [Thread-28 ]: Began executing node model.stock_analysis.nasdaq
[0m10:40:19.354591 [debug] [Thread-27 ]: Began executing node model.stock_analysis.int_stock_analysis
[0m10:40:19.354904 [debug] [Thread-28 ]: Finished running node model.stock_analysis.nasdaq
[0m10:40:19.355206 [debug] [Thread-27 ]: Finished running node model.stock_analysis.int_stock_analysis
[0m10:40:19.355528 [debug] [Thread-30 ]: Began running node model.stock_analysis.stock_analysis
[0m10:40:19.355793 [debug] [Thread-30 ]: Acquiring new bigquery connection 'model.stock_analysis.stock_analysis'
[0m10:40:19.355961 [debug] [Thread-30 ]: Began compiling node model.stock_analysis.stock_analysis
[0m10:40:19.358354 [debug] [Thread-30 ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m10:40:19.358838 [debug] [Thread-30 ]: Began executing node model.stock_analysis.stock_analysis
[0m10:40:19.359141 [debug] [Thread-30 ]: Finished running node model.stock_analysis.stock_analysis
[0m10:40:19.359837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:19.359977 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m10:40:19.360104 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m10:40:19.360225 [debug] [MainThread]: Connection 'model.stock_analysis.base_calendar' was properly closed.
[0m10:40:19.360338 [debug] [MainThread]: Connection 'model.stock_analysis.base_hlal_2019_2024' was properly closed.
[0m10:40:19.360450 [debug] [MainThread]: Connection 'model.stock_analysis.base_spus_2019_2024' was properly closed.
[0m10:40:19.360560 [debug] [MainThread]: Connection 'model.stock_analysis.base_spy_1993_2024' was properly closed.
[0m10:40:19.360669 [debug] [MainThread]: Connection 'model.stock_analysis.base_symbols_meta' was properly closed.
[0m10:40:19.360779 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m10:40:19.360889 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m10:40:19.360998 [debug] [MainThread]: Connection 'model.stock_analysis.stg_symbols_meta' was properly closed.
[0m10:40:19.361109 [debug] [MainThread]: Connection 'model.stock_analysis.stg_hlal_2019_2024' was properly closed.
[0m10:40:19.361219 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_base' was properly closed.
[0m10:40:19.361330 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spus_2019_2024' was properly closed.
[0m10:40:19.361439 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_1993_2024' was properly closed.
[0m10:40:19.361549 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_history_weekly_monthly_yearly_price' was properly closed.
[0m10:40:19.361658 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_monthly_price_movement' was properly closed.
[0m10:40:19.361768 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_weekly_price_movement' was properly closed.
[0m10:40:19.361877 [debug] [MainThread]: Connection 'model.stock_analysis.stg_nasdaq_yearly_price_movement' was properly closed.
[0m10:40:19.361986 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_history' was properly closed.
[0m10:40:19.362095 [debug] [MainThread]: Connection 'model.stock_analysis.int_nasdaq' was properly closed.
[0m10:40:19.362204 [debug] [MainThread]: Connection 'model.stock_analysis.int_stock_analysis' was properly closed.
[0m10:40:19.362313 [debug] [MainThread]: Connection 'model.stock_analysis.nasdaq' was properly closed.
[0m10:40:19.362427 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m10:40:19.363975 [debug] [MainThread]: Command end result
[0m10:40:19.420765 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m10:40:19.420959 [info ] [MainThread]: Building catalog
[0m10:40:19.427670 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m10:40:19.428065 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m10:40:19.439537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:19.441116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:19.500297 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock`.__TABLES__ tables
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('tsla')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('lly')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('goog')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('msft')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('avgo')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('crm')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('unh')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spy_1993_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('ko')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('bac')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('all_nasdaq_stock_info')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('adbe')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('pep')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('hlal')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('nvda')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('hd')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('ma')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('mrk')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('jnj')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('meta')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('all_nasdaq_stock_history')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('amzn')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('symbols_valid_meta')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('amd')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('abbv')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('brk-b')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('tmo')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('cvx')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('400_years_of_generated_dates_and_holidays')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('nflx')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('aapl')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('wmt')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('pg')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('cost')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('jpm')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('xom')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('googl')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spus_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('v')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m10:40:19.561491 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock_analysis`.__TABLES__ tables
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_spus_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_history_base')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_spy_1993_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_spus_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_monthly_price_movement')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_all_nasdaq_stock_info')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_hlal_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_yearly_price_movement')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_all_nasdaq_stock_history')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stock_analysis')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_symbols_meta')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_weekly_price_movement')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_hlal_2019_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_all_nasdaq_stock_info')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_symbols_meta')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('nasdaq')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('int_nasdaq')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_nasdaq_history_weekly_monthly_yearly_price')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('int_stock_analysis')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_spy_1993_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_all_nasdaq_stock_history')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m10:40:20.189896 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b13aa8fe-d7da-499e-a717-3a037694d142&page=queryresults
[0m10:40:20.321229 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b134237d-7209-4569-b4e3-c0932d4a3f53&page=queryresults
[0m10:40:24.163726 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/stock_analysis/target/catalog.json
[0m10:40:24.166242 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.1824894, "process_user_time": 2.979531, "process_kernel_time": 2.252733, "process_mem_max_rss": "217153536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:40:24.166577 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:40:24.166530 after 6.18 seconds
[0m10:40:24.166747 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:40:24.166872 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m10:40:24.166989 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m10:40:24.167136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d450d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f075b0>]}
[0m10:40:24.167311 [debug] [MainThread]: Flushing usage events
[0m10:40:30.077407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105376b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107112d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107112f70>]}


============================== 10:40:30.079537 | cddcf65b-9c1b-458e-8a6a-41641419f187 ==============================
[0m10:40:30.079537 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:40:30.079872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:30.538518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cddcf65b-9c1b-458e-8a6a-41641419f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ae130>]}
[0m10:40:30.564823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cddcf65b-9c1b-458e-8a6a-41641419f187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe3cf40>]}
[0m10:56:03.028253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a71c0>]}


============================== 10:56:03.030772 | a008c7c2-d75a-495e-b522-429b03969dc1 ==============================
[0m10:56:03.030772 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:56:03.031096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:56:03.556472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a008c7c2-d75a-495e-b522-429b03969dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250e2d30>]}
[0m10:56:03.582316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a008c7c2-d75a-495e-b522-429b03969dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105860070>]}
[0m10:56:03.582604 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m10:56:03.594289 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:56:03.675913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:03.676169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:03.696910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a008c7c2-d75a-495e-b522-429b03969dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b1a130>]}
[0m10:56:03.792990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a008c7c2-d75a-495e-b522-429b03969dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125915070>]}
[0m10:56:03.793299 [info ] [MainThread]: Found 23 models, 40 sources, 469 macros
[0m10:56:03.793495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a008c7c2-d75a-495e-b522-429b03969dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105856c70>]}
[0m10:56:03.794221 [info ] [MainThread]: 
[0m10:56:03.794498 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:56:03.794956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m10:56:03.795170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:04.415039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m10:56:04.415723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:04.895202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a008c7c2-d75a-495e-b522-429b03969dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125afa130>]}
[0m10:56:04.895985 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m10:56:04.896343 [info ] [MainThread]: 
[0m10:56:04.900437 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:56:04.900990 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_nasdaq_stock_history ...... [RUN]
[0m10:56:04.901622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m10:56:04.902151 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:56:04.913172 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m10:56:04.914340 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:56:04.927490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:56:05.480160 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m10:56:05.482202 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , '2024-09-16' as etl_date
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m10:56:05.934744 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:05eb6a39-e115-410a-9aa4-2305ea8516b5&page=queryresults
[0m10:56:12.381255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a008c7c2-d75a-495e-b522-429b03969dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042975e0>]}
[0m10:56:12.382016 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.base_all_nasdaq_stock_history . [[32mCREATE TABLE (12.5m rows, 641.5 MiB processed)[0m in 7.48s]
[0m10:56:12.382590 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m10:56:12.384209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:12.384510 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m10:56:12.384780 [info ] [MainThread]: 
[0m10:56:12.385066 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m10:56:12.385641 [debug] [MainThread]: Command end result
[0m10:56:12.418805 [info ] [MainThread]: 
[0m10:56:12.419176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:56:12.419382 [info ] [MainThread]: 
[0m10:56:12.419594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:56:12.420906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.442098, "process_user_time": 2.298376, "process_kernel_time": 2.314795, "process_mem_max_rss": "192724992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:56:12.421246 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:12.421180 after 9.44 seconds
[0m10:56:12.421478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105860070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424b9d0>]}
[0m10:56:12.421694 [debug] [MainThread]: Flushing usage events
[0m16:36:07.591670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038b2b0>]}


============================== 16:36:07.594336 | b44dd38d-4a18-4c31-b076-56c982104f02 ==============================
[0m16:36:07.594336 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:36:07.594629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select base_all_others_stock_info base_all_others_stock_history', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:08.145013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e05ca30>]}
[0m16:36:08.170960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019ab50>]}
[0m16:36:08.171242 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:36:08.183459 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:36:08.264519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 1 files changed.
[0m16:36:08.264863 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_all_others_stock_info.sql
[0m16:36:08.265032 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m16:36:08.265178 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m16:36:08.265317 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m16:36:08.265453 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m16:36:08.265587 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/1_base/base_all_others_stock_history.sql
[0m16:36:08.265726 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m16:36:08.265868 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m16:36:08.266737 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m16:36:08.515869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f20b130>]}
[0m16:36:08.576219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e7d8160>]}
[0m16:36:08.576483 [info ] [MainThread]: Found 31 models, 42 sources, 469 macros
[0m16:36:08.576655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f20fac0>]}
[0m16:36:08.577501 [info ] [MainThread]: 
[0m16:36:08.577763 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:36:08.579861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:36:08.580054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:08.989307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:36:08.989838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:09.405112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110218dc0>]}
[0m16:36:09.405797 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m16:36:09.406039 [info ] [MainThread]: 
[0m16:36:09.410034 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_others_stock_history
[0m16:36:09.410314 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_all_others_stock_info
[0m16:36:09.410672 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_others_stock_history ...... [RUN]
[0m16:36:09.410980 [info ] [Thread-2  ]: 2 of 2 START sql table model stock_analysis.base_all_others_stock_info ......... [RUN]
[0m16:36:09.411266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_others_stock_history)
[0m16:36:09.411572 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_others_stock_info'
[0m16:36:09.411782 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_others_stock_history
[0m16:36:09.411978 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_all_others_stock_info
[0m16:36:09.418023 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_history"
[0m16:36:09.420181 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_info"
[0m16:36:09.420656 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_all_others_stock_info
[0m16:36:09.420867 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_others_stock_history
[0m16:36:09.454887 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_info"
[0m16:36:09.455718 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_history"
[0m16:36:09.456136 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:36:09.456335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:09.572066 [debug] [Thread-1  ]: On model.stock_analysis.base_all_others_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , ETL_Date as etl_date
from `first-project-262802`.`stock`.`all_others_stock_history`
    );
  
[0m16:36:09.572379 [debug] [Thread-2  ]: On model.stock_analysis.base_all_others_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    address1
    city
    state
    zip
    country
    phone
    fax
    website
    industry
    industryKey
    industryDisp
    sector
    sectorKey
    sectorDisp
    longBusinessSummary
    fullTimeEmployees
    companyOfficers
    auditRisk
    boardRisk
    compensationRisk
    shareHolderRightsRisk
    overallRisk
    governanceEpochDate
    compensationAsOfEpochDate
    irWebsite
    maxAge
    priceHint
    previousClose
    open
    dayLow
    dayHigh
    regularMarketPreviousClose
    regularMarketOpen
    regularMarketDayLow
    regularMarketDayHigh
    dividendRate
    dividendYield
    exDividendDate
    payoutRatio
    fiveYearAvgDividendYield
    beta
    trailingPE
    forwardPE
    volume
    regularMarketVolume
    averageVolume
    averageVolume10days
    averageDailyVolume10Day
    bid
    ask
    bidSize
    askSize
    marketCap
    fiftyTwoWeekLow
    fiftyTwoWeekHigh
    priceToSalesTrailing12Months
    fiftyDayAverage
    twoHundredDayAverage
    trailingAnnualDividendRate
    trailingAnnualDividendYield
    currency
    enterpriseValue
    profitMargins
    floatShares
    sharesOutstanding
    sharesShort
    sharesShortPriorMonth
    sharesShortPreviousMonthDate
    dateShortInterest
    sharesPercentSharesOut
    heldPercentInsiders
    heldPercentInstitutions
    shortRatio
    shortPercentOfFloat
    impliedSharesOutstanding
    bookValue
    priceToBook
    lastFiscalYearEnd
    nextFiscalYearEnd
    mostRecentQuarter
    earningsQuarterlyGrowth
    netIncomeToCommon
    trailingEps
    forwardEps
    pegRatio
    lastSplitFactor
    lastSplitDate
    enterpriseToRevenue
    enterpriseToEbitda
    -- 52WeekChange
    -- SandP52WeekChange
    lastDividendValue
    lastDividendDate
    exchange
    quoteType
    symbol
    underlyingSymbol
    shortName
    longName
    firstTradeDateEpochUtc
    timeZoneFullName
    timeZoneShortName
    uuid
    messageBoardId
    gmtOffSetMilliseconds
    currentPrice
    targetHighPrice
    targetLowPrice
    targetMeanPrice
    targetMedianPrice
    recommendationMean
    recommendationKey
    numberOfAnalystOpinions
    totalCash
    totalCashPerShare
    ebitda
    totalDebt
    quickRatio
    currentRatio
    totalRevenue
    debtToEquity
    revenuePerShare
    returnOnAssets
    returnOnEquity
    freeCashflow
    operatingCashflow
    earningsGrowth
    revenueGrowth
    grossMargins
    ebitdaMargins
    operatingMargins
    financialCurrency
    trailingPegRatio
    address2
    industrySymbol
    grossProfits
    ETL_Date
from `first-project-262802`.`stock`.`all_others_stock_info`
    );
  
[0m16:36:09.893500 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:614cc228-828e-45d6-bad1-46560e6e6304&page=queryresults
[0m16:36:09.895792 [debug] [Thread-2  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "city" at [17:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got identifier "city" at [17:5]')
[0m16:36:10.163740 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5e3662c5-0dc8-43bd-b860-c79d8bf2f468&page=queryresults
[0m16:36:10.913755 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b903a771-3f19-4597-ab92-faa76ff1df6f&page=queryresults
[0m16:36:10.916047 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b903a771-3f19-4597-ab92-faa76ff1df6f&page=queryresults
[0m16:36:10.955723 [debug] [Thread-2  ]: Database Error in model base_all_others_stock_info (models/1_base/base_all_others_stock_info.sql)
  Syntax error: Expected ")" but got identifier "city" at [17:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_others_stock_info.sql
[0m16:36:10.957011 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3e7520>]}
[0m16:36:10.957482 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model stock_analysis.base_all_others_stock_info  [[31mERROR[0m in 1.54s]
[0m16:36:10.957851 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_all_others_stock_info
[0m16:36:17.366168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44dd38d-4a18-4c31-b076-56c982104f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f344a30>]}
[0m16:36:17.368472 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.base_all_others_stock_history . [[32mCREATE TABLE (17.9m rows, 1.0 GiB processed)[0m in 7.95s]
[0m16:36:17.369241 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_others_stock_history
[0m16:36:17.371430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:17.371827 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_history' was properly closed.
[0m16:36:17.372126 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_info' was properly closed.
[0m16:36:17.372543 [info ] [MainThread]: 
[0m16:36:17.372897 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m16:36:17.373821 [debug] [MainThread]: Command end result
[0m16:36:17.411686 [info ] [MainThread]: 
[0m16:36:17.411935 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:17.412099 [info ] [MainThread]: 
[0m16:36:17.412309 [error] [MainThread]:   Database Error in model base_all_others_stock_info (models/1_base/base_all_others_stock_info.sql)
  Syntax error: Expected ")" but got identifier "city" at [17:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_others_stock_info.sql
[0m16:36:17.412475 [info ] [MainThread]: 
[0m16:36:17.412646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:36:17.414472 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.871285, "process_user_time": 2.309157, "process_kernel_time": 2.580943, "process_mem_max_rss": "202031104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:17.414814 [debug] [MainThread]: Command `dbt run` failed at 16:36:17.414756 after 9.87 seconds
[0m16:36:17.415038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3963a0>]}
[0m16:36:17.415248 [debug] [MainThread]: Flushing usage events
[0m16:37:36.958868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057103d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057101f0>]}


============================== 16:37:36.961339 | 0cb54a08-4ef3-403b-b445-c31b9c461d6b ==============================
[0m16:37:36.961339 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:37:36.961633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select base_all_others_stock_info', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:37.446665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb54a08-4ef3-403b-b445-c31b9c461d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fce6a0>]}
[0m16:37:37.472249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb54a08-4ef3-403b-b445-c31b9c461d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056eb310>]}
[0m16:37:37.472511 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:37:37.483370 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:37:37.561001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:37:37.561377 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_others_stock_info.sql
[0m16:37:37.711375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb54a08-4ef3-403b-b445-c31b9c461d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c848130>]}
[0m16:37:37.770546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb54a08-4ef3-403b-b445-c31b9c461d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fd130>]}
[0m16:37:37.770796 [info ] [MainThread]: Found 31 models, 42 sources, 469 macros
[0m16:37:37.770966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb54a08-4ef3-403b-b445-c31b9c461d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043af370>]}
[0m16:37:37.771723 [info ] [MainThread]: 
[0m16:37:37.771974 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:37.772382 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:37:37.772578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:38.214118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:37:38.214737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:38.686179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb54a08-4ef3-403b-b445-c31b9c461d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ad73910>]}
[0m16:37:38.687231 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m16:37:38.687557 [info ] [MainThread]: 
[0m16:37:38.692677 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_others_stock_info
[0m16:37:38.693234 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_others_stock_info ......... [RUN]
[0m16:37:38.693633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_others_stock_info)
[0m16:37:38.693928 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_others_stock_info
[0m16:37:38.702348 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_info"
[0m16:37:38.702913 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_others_stock_info
[0m16:37:38.731675 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_info"
[0m16:37:38.732079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:38.794832 [debug] [Thread-1  ]: On model.stock_analysis.base_all_others_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , city
    , state
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , dividendRate
    , dividendYield
    , exDividendDate
    , payoutRatio
    , fiveYearAvgDividendYield
    , beta
    , trailingPE
    , forwardPE
    , volume
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , bid
    , ask
    , bidSize
    , askSize
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , sharesPercentSharesOut
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , earningsQuarterlyGrowth
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , pegRatio
    , lastSplitFactor
    , lastSplitDate
    , enterpriseToRevenue
    , enterpriseToEbitda
    , -- 52WeekChange
    , -- SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , recommendationMean
    , recommendationKey
    , numberOfAnalystOpinions
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , freeCashflow
    , operatingCashflow
    , earningsGrowth
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , address2
    , industrySymbol
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_others_stock_info`
    );
  
[0m16:37:39.079381 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ff521728-bd7a-4ce1-a343-496dcbb75912&page=queryresults
[0m16:37:39.081659 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "," at [106:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "," at [106:5]')
[0m16:37:39.394873 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:39b57127-636a-4785-8f2e-82287de030c0&page=queryresults
[0m16:37:39.396485 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:39b57127-636a-4785-8f2e-82287de030c0&page=queryresults
[0m16:37:39.437544 [debug] [Thread-1  ]: Database Error in model base_all_others_stock_info (models/1_base/base_all_others_stock_info.sql)
  Syntax error: Expected ")" but got "," at [106:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_others_stock_info.sql
[0m16:37:39.438895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb54a08-4ef3-403b-b445-c31b9c461d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9ee9a0>]}
[0m16:37:39.439398 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.base_all_others_stock_info  [[31mERROR[0m in 0.74s]
[0m16:37:39.439826 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_others_stock_info
[0m16:37:39.441043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:39.441229 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_info' was properly closed.
[0m16:37:39.441414 [info ] [MainThread]: 
[0m16:37:39.441617 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m16:37:39.442029 [debug] [MainThread]: Command end result
[0m16:37:39.470939 [info ] [MainThread]: 
[0m16:37:39.471201 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:37:39.471356 [info ] [MainThread]: 
[0m16:37:39.471551 [error] [MainThread]:   Database Error in model base_all_others_stock_info (models/1_base/base_all_others_stock_info.sql)
  Syntax error: Expected ")" but got "," at [106:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_others_stock_info.sql
[0m16:37:39.471701 [info ] [MainThread]: 
[0m16:37:39.471861 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:37:39.473168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5637698, "process_user_time": 3.480892, "process_kernel_time": 1.115327, "process_mem_max_rss": "199983104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:39.473467 [debug] [MainThread]: Command `dbt run` failed at 16:37:39.473419 after 2.56 seconds
[0m16:37:39.473669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056eb310>]}
[0m16:37:39.473851 [debug] [MainThread]: Flushing usage events
[0m16:42:46.196614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107183bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107183d90>]}


============================== 16:42:46.199228 | 0950aa0b-ff5a-44eb-a99a-6529529cab65 ==============================
[0m16:42:46.199228 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:42:46.199523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select base_all_others_stock_info', 'send_anonymous_usage_stats': 'True'}
[0m16:42:46.681861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0950aa0b-ff5a-44eb-a99a-6529529cab65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b64f10>]}
[0m16:42:46.707396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0950aa0b-ff5a-44eb-a99a-6529529cab65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071076d0>]}
[0m16:42:46.707667 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:42:46.719223 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:42:46.798002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:42:46.798442 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_others_stock_info.sql
[0m16:42:46.951821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0950aa0b-ff5a-44eb-a99a-6529529cab65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154586130>]}
[0m16:42:47.012605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0950aa0b-ff5a-44eb-a99a-6529529cab65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153ef4370>]}
[0m16:42:47.012850 [info ] [MainThread]: Found 31 models, 42 sources, 469 macros
[0m16:42:47.013020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0950aa0b-ff5a-44eb-a99a-6529529cab65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154553160>]}
[0m16:42:47.013757 [info ] [MainThread]: 
[0m16:42:47.014006 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:42:47.014401 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:42:47.014585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.460881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:42:47.461424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:47.896813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0950aa0b-ff5a-44eb-a99a-6529529cab65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15411db80>]}
[0m16:42:47.897394 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m16:42:47.897623 [info ] [MainThread]: 
[0m16:42:47.901155 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_others_stock_info
[0m16:42:47.901500 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_others_stock_info ......... [RUN]
[0m16:42:47.901784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_others_stock_info)
[0m16:42:47.902011 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_others_stock_info
[0m16:42:47.908394 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_info"
[0m16:42:47.909068 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_others_stock_info
[0m16:42:47.934035 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_info"
[0m16:42:47.934438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:47.993998 [debug] [Thread-1  ]: On model.stock_analysis.base_all_others_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , city
    , state
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , dividendRate
    , dividendYield
    , exDividendDate
    , payoutRatio
    , fiveYearAvgDividendYield
    , beta
    , trailingPE
    , forwardPE
    , volume as volume_from_stock_info
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , bid
    , ask
    , bidSize
    , askSize
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , sharesPercentSharesOut
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , earningsQuarterlyGrowth
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , pegRatio
    , lastSplitFactor
    , lastSplitDate
    , enterpriseToRevenue
    , enterpriseToEbitda
    , -- 52WeekChange
    , -- SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , recommendationMean
    , recommendationKey
    , numberOfAnalystOpinions
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , freeCashflow
    , operatingCashflow
    , earningsGrowth
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , address2
    , industrySymbol
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_others_stock_info`
    );
  
[0m16:42:48.341002 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b45700e6-dfe6-44c8-b0fc-b8e86dff0777&page=queryresults
[0m16:42:48.343374 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "," at [106:5]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got "," at [106:5]')
[0m16:42:48.608625 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6307e563-9fec-4875-ac89-ad4e6716bde6&page=queryresults
[0m16:42:48.610719 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6307e563-9fec-4875-ac89-ad4e6716bde6&page=queryresults
[0m16:42:48.652315 [debug] [Thread-1  ]: Database Error in model base_all_others_stock_info (models/1_base/base_all_others_stock_info.sql)
  Syntax error: Expected ")" but got "," at [106:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_others_stock_info.sql
[0m16:42:48.653514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0950aa0b-ff5a-44eb-a99a-6529529cab65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1546af8e0>]}
[0m16:42:48.653966 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.base_all_others_stock_info  [[31mERROR[0m in 0.75s]
[0m16:42:48.654362 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_others_stock_info
[0m16:42:48.655439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:48.655614 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_info' was properly closed.
[0m16:42:48.655792 [info ] [MainThread]: 
[0m16:42:48.655987 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m16:42:48.656393 [debug] [MainThread]: Command end result
[0m16:42:48.684084 [info ] [MainThread]: 
[0m16:42:48.684344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:42:48.684511 [info ] [MainThread]: 
[0m16:42:48.684714 [error] [MainThread]:   Database Error in model base_all_others_stock_info (models/1_base/base_all_others_stock_info.sql)
  Syntax error: Expected ")" but got "," at [106:5]
  compiled Code at target/run/stock_analysis/models/1_base/base_all_others_stock_info.sql
[0m16:42:48.684872 [info ] [MainThread]: 
[0m16:42:48.685036 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:42:48.686298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.537044, "process_user_time": 2.863571, "process_kernel_time": 1.748015, "process_mem_max_rss": "201916416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:42:48.686583 [debug] [MainThread]: Command `dbt run` failed at 16:42:48.686535 after 2.54 seconds
[0m16:42:48.686779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071076d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648e1f0>]}
[0m16:42:48.686960 [debug] [MainThread]: Flushing usage events
[0m16:45:50.452425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104555940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed0250>]}


============================== 16:45:50.454810 | ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9 ==============================
[0m16:45:50.454810 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:45:50.455095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_all_others_stock_info', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:50.997645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ccd9d0>]}
[0m16:45:51.026818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea3250>]}
[0m16:45:51.027412 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:45:51.040145 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:45:51.125361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:45:51.125777 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_others_stock_info.sql
[0m16:45:51.292038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf06130>]}
[0m16:45:51.353742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb521f0>]}
[0m16:45:51.354029 [info ] [MainThread]: Found 31 models, 42 sources, 469 macros
[0m16:45:51.354204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf55160>]}
[0m16:45:51.355035 [info ] [MainThread]: 
[0m16:45:51.355319 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:45:51.355734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:45:51.355904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:51.787331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:45:51.788425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:52.216584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb525b0>]}
[0m16:45:52.217971 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m16:45:52.218429 [info ] [MainThread]: 
[0m16:45:52.225221 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_others_stock_info
[0m16:45:52.225939 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.base_all_others_stock_info ......... [RUN]
[0m16:45:52.226493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_others_stock_info)
[0m16:45:52.226901 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_others_stock_info
[0m16:45:52.237149 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_info"
[0m16:45:52.237896 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_others_stock_info
[0m16:45:52.269704 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_info"
[0m16:45:52.270170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:45:52.330117 [debug] [Thread-1  ]: On model.stock_analysis.base_all_others_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , city
    , state
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , dividendRate
    , dividendYield
    , exDividendDate
    , payoutRatio
    , fiveYearAvgDividendYield
    , beta
    , trailingPE
    , forwardPE
    , volume as volume_from_stock_info
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , bid
    , ask
    , bidSize
    , askSize
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , sharesPercentSharesOut
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , earningsQuarterlyGrowth
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , pegRatio
    , lastSplitFactor
    , lastSplitDate
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , recommendationMean
    , recommendationKey
    , numberOfAnalystOpinions
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , freeCashflow
    , operatingCashflow
    , earningsGrowth
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , address2
    , industrySymbol
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_others_stock_info`
    );
  
[0m16:45:52.976525 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1fa0264f-1b8b-44ee-8dd8-14dc2e037427&page=queryresults
[0m16:45:57.357696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9a7df3-a2c0-4d1c-bbb0-457fe3e8b5d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8aec40>]}
[0m16:45:57.358630 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.base_all_others_stock_info .... [[32mCREATE TABLE (19.9k rows, 45.0 MiB processed)[0m in 5.13s]
[0m16:45:57.359341 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_others_stock_info
[0m16:45:57.361177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:57.361535 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_info' was properly closed.
[0m16:45:57.361856 [info ] [MainThread]: 
[0m16:45:57.362204 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m16:45:57.362908 [debug] [MainThread]: Command end result
[0m16:45:57.398151 [info ] [MainThread]: 
[0m16:45:57.398456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:57.398651 [info ] [MainThread]: 
[0m16:45:57.398835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:45:57.400198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.998136, "process_user_time": 4.551628, "process_kernel_time": 0.208554, "process_mem_max_rss": "203374592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:57.400509 [debug] [MainThread]: Command `dbt run` succeeded at 16:45:57.400455 after 7.00 seconds
[0m16:45:57.400731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104555940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f44130>]}
[0m16:45:57.400936 [debug] [MainThread]: Flushing usage events
[0m16:46:48.425967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dcca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dce80>]}


============================== 16:46:48.427958 | 8823968f-ac34-41bf-bb9e-ec320333efba ==============================
[0m16:46:48.427958 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:46:48.428246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_others_history_base', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:46:48.888089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8823968f-ac34-41bf-bb9e-ec320333efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2d7100>]}
[0m16:46:48.913876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8823968f-ac34-41bf-bb9e-ec320333efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c85b0>]}
[0m16:46:48.914145 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:46:48.923828 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:46:48.996835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:48.997056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:49.017939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8823968f-ac34-41bf-bb9e-ec320333efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c113130>]}
[0m16:46:49.109772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8823968f-ac34-41bf-bb9e-ec320333efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b6e23d0>]}
[0m16:46:49.110056 [info ] [MainThread]: Found 31 models, 42 sources, 469 macros
[0m16:46:49.110231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8823968f-ac34-41bf-bb9e-ec320333efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037ca580>]}
[0m16:46:49.110971 [info ] [MainThread]: 
[0m16:46:49.111238 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:46:49.111678 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m16:46:49.111867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:49.533294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m16:46:49.533943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:49.918018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8823968f-ac34-41bf-bb9e-ec320333efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b5dadf0>]}
[0m16:46:49.918680 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m16:46:49.918947 [info ] [MainThread]: 
[0m16:46:49.922447 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_others_history_base
[0m16:46:49.922924 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_others_history_base ............ [RUN]
[0m16:46:49.923283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_others_history_base)
[0m16:46:49.923544 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_others_history_base
[0m16:46:49.932039 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_others_history_base"
[0m16:46:49.932571 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_others_history_base
[0m16:46:49.959943 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_others_history_base"
[0m16:46:49.960820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:46:50.022194 [debug] [Thread-1  ]: On model.stock_analysis.stg_others_history_base: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_others_history_base"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_others_history_base`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`base_all_others_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

select * from base
    );
  
[0m16:46:50.795783 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:84657e87-e1e4-4297-a0e9-36944f98d550&page=queryresults
[0m16:47:00.825502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8823968f-ac34-41bf-bb9e-ec320333efba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c132190>]}
[0m16:47:00.826016 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_others_history_base ....... [[32mCREATE TABLE (17.9m rows, 1.2 GiB processed)[0m in 10.90s]
[0m16:47:00.826418 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_others_history_base
[0m16:47:00.827545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:00.827753 [debug] [MainThread]: Connection 'model.stock_analysis.stg_others_history_base' was properly closed.
[0m16:47:00.827946 [info ] [MainThread]: 
[0m16:47:00.828147 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.72 seconds (11.72s).
[0m16:47:00.828555 [debug] [MainThread]: Command end result
[0m16:47:00.855592 [info ] [MainThread]: 
[0m16:47:00.855831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:00.855994 [info ] [MainThread]: 
[0m16:47:00.856165 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:47:00.857279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.477766, "process_user_time": 2.439942, "process_kernel_time": 2.10676, "process_mem_max_rss": "194756608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:47:00.857536 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:00.857492 after 12.48 seconds
[0m16:47:00.857706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ce1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b6e2f10>]}
[0m16:47:00.857873 [debug] [MainThread]: Flushing usage events
[0m17:11:55.431615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101eb98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c4c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c4c1f0>]}


============================== 17:11:55.434134 | 3bc3bc98-2f14-4620-93c1-51a247f3e469 ==============================
[0m17:11:55.434134 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:11:55.434427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_all_stock_history', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:55.965798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bc3bc98-2f14-4620-93c1-51a247f3e469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020f36a0>]}
[0m17:11:55.991940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bc3bc98-2f14-4620-93c1-51a247f3e469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c27310>]}
[0m17:11:55.992251 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:11:56.003691 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:11:56.083346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:11:56.083705 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history.sql
[0m17:11:56.083913 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:11:56.239736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bc3bc98-2f14-4620-93c1-51a247f3e469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e013e50>]}
[0m17:11:56.299953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bc3bc98-2f14-4620-93c1-51a247f3e469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ab4f280>]}
[0m17:11:56.300221 [info ] [MainThread]: Found 32 models, 42 sources, 469 macros
[0m17:11:56.300393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc3bc98-2f14-4620-93c1-51a247f3e469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e0114f0>]}
[0m17:11:56.301139 [info ] [MainThread]: 
[0m17:11:56.301396 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:11:56.301840 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m17:11:56.302035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:56.739044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m17:11:56.739702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:57.126167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc3bc98-2f14-4620-93c1-51a247f3e469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ab4f1f0>]}
[0m17:11:57.126917 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m17:11:57.127219 [info ] [MainThread]: 
[0m17:11:57.131890 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_stock_history
[0m17:11:57.132349 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_all_stock_history .............. [RUN]
[0m17:11:57.132704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_stock_history)
[0m17:11:57.132979 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_stock_history
[0m17:11:57.140586 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history"
[0m17:11:57.141098 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_stock_history
[0m17:11:57.170043 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history"
[0m17:11:57.170451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:57.232866 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history`
      
    
    

    OPTIONS()
    as (
      select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`

union all

select * from `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
    );
  
[0m17:11:57.846255 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9ff98d11-1438-471e-a891-5986fb72ffd1&page=queryresults
[0m17:11:57.961420 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column 9 in UNION ALL has incompatible types: STRING, TIMESTAMP at [17:1]; reason: invalidQuery, location: query, message: Column 9 in UNION ALL has incompatible types: STRING, TIMESTAMP at [17:1]')
[0m17:11:58.870521 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f8daa670-1131-462a-b841-1126247afb24&page=queryresults
[0m17:11:58.973857 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f8daa670-1131-462a-b841-1126247afb24&page=queryresults
[0m17:11:59.012875 [debug] [Thread-1  ]: Database Error in model stg_all_stock_history (models/2_staging/stg_all_stock_history.sql)
  Column 9 in UNION ALL has incompatible types: STRING, TIMESTAMP at [17:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_stock_history.sql
[0m17:11:59.013956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc3bc98-2f14-4620-93c1-51a247f3e469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e303ca0>]}
[0m17:11:59.014360 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_all_stock_history ..... [[31mERROR[0m in 1.88s]
[0m17:11:59.014692 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_stock_history
[0m17:11:59.015895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:59.016045 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history' was properly closed.
[0m17:11:59.016191 [info ] [MainThread]: 
[0m17:11:59.016354 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m17:11:59.016683 [debug] [MainThread]: Command end result
[0m17:11:59.042871 [info ] [MainThread]: 
[0m17:11:59.043172 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:11:59.043326 [info ] [MainThread]: 
[0m17:11:59.043520 [error] [MainThread]:   Database Error in model stg_all_stock_history (models/2_staging/stg_all_stock_history.sql)
  Column 9 in UNION ALL has incompatible types: STRING, TIMESTAMP at [17:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_stock_history.sql
[0m17:11:59.043668 [info ] [MainThread]: 
[0m17:11:59.043826 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:11:59.045042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6610038, "process_user_time": 4.421195, "process_kernel_time": 0.200718, "process_mem_max_rss": "202194944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:11:59.045317 [debug] [MainThread]: Command `dbt run` failed at 17:11:59.045267 after 3.66 seconds
[0m17:11:59.045518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101eb98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c27310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10353bf10>]}
[0m17:11:59.045701 [debug] [MainThread]: Flushing usage events
[0m17:13:01.449157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c73b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c73d60>]}


============================== 17:13:01.451576 | d81b3cce-0f2f-42e6-8b08-af9e9e8bee5a ==============================
[0m17:13:01.451576 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:13:01.451889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history stg_all_stock_history', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:01.925309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13219ba30>]}
[0m17:13:01.950752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794bb50>]}
[0m17:13:01.951020 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:13:01.962093 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:13:02.038701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:02.039066 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_nasdaq_stock_history.sql
[0m17:13:02.187696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132883eb0>]}
[0m17:13:02.246571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13272cee0>]}
[0m17:13:02.246818 [info ] [MainThread]: Found 32 models, 42 sources, 469 macros
[0m17:13:02.246987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132889a30>]}
[0m17:13:02.247840 [info ] [MainThread]: 
[0m17:13:02.248098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:13:02.250142 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m17:13:02.250338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:02.664208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m17:13:02.665064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:03.042554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13284d8e0>]}
[0m17:13:03.043276 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m17:13:03.043580 [info ] [MainThread]: 
[0m17:13:03.047843 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m17:13:03.048283 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_nasdaq_stock_history ...... [RUN]
[0m17:13:03.048632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m17:13:03.048905 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m17:13:03.056412 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m17:13:03.057604 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m17:13:03.069705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:13:03.491841 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m17:13:03.494050 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date('2024-09-16') as etl_date
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m17:13:03.895171 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:abf67c93-91bf-4167-befd-e5bff9a75aa4&page=queryresults
[0m17:13:10.069876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131983940>]}
[0m17:13:10.070661 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.base_all_nasdaq_stock_history . [[32mCREATE TABLE (12.5m rows, 641.5 MiB processed)[0m in 7.02s]
[0m17:13:10.071261 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m17:13:10.072029 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_stock_history
[0m17:13:10.072538 [info ] [Thread-3  ]: 2 of 2 START sql table model stock_analysis.stg_all_stock_history .............. [RUN]
[0m17:13:10.073025 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_history'
[0m17:13:10.073321 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_all_stock_history
[0m17:13:10.076383 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history"
[0m17:13:10.077138 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_all_stock_history
[0m17:13:10.080810 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history"
[0m17:13:10.081260 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:13:10.152134 [debug] [Thread-3  ]: On model.stock_analysis.stg_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history`
      
    
    

    OPTIONS()
    as (
      select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`

union all

select * from `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
    );
  
[0m17:13:10.654313 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:198230e6-2482-49ef-9d39-cc3d45d58a65&page=queryresults
[0m17:13:10.872051 [debug] [Thread-3  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/198230e6-2482-49ef-9d39-cc3d45d58a65?maxResults=0&location=US&prettyPrint=false: Column 9 in UNION ALL has incompatible types: DATE, TIMESTAMP at [17:1]')
[0m17:13:11.985919 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ae0cdb1c-aa72-4c86-bf7a-320eac7bdb45&page=queryresults
[0m17:13:12.101828 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ae0cdb1c-aa72-4c86-bf7a-320eac7bdb45&page=queryresults
[0m17:13:12.145343 [debug] [Thread-3  ]: Database Error in model stg_all_stock_history (models/2_staging/stg_all_stock_history.sql)
  Column 9 in UNION ALL has incompatible types: DATE, TIMESTAMP at [17:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_stock_history.sql
[0m17:13:12.145724 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81b3cce-0f2f-42e6-8b08-af9e9e8bee5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c38c40>]}
[0m17:13:12.146182 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model stock_analysis.stg_all_stock_history ..... [[31mERROR[0m in 2.07s]
[0m17:13:12.146582 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_stock_history
[0m17:13:12.147689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:12.147854 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m17:13:12.147999 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history' was properly closed.
[0m17:13:12.148196 [info ] [MainThread]: 
[0m17:13:12.148386 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.90 seconds (9.90s).
[0m17:13:12.148853 [debug] [MainThread]: Command end result
[0m17:13:12.175238 [info ] [MainThread]: 
[0m17:13:12.175485 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:13:12.175635 [info ] [MainThread]: 
[0m17:13:12.175828 [error] [MainThread]:   Database Error in model stg_all_stock_history (models/2_staging/stg_all_stock_history.sql)
  Column 9 in UNION ALL has incompatible types: DATE, TIMESTAMP at [17:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_stock_history.sql
[0m17:13:12.175978 [info ] [MainThread]: 
[0m17:13:12.176132 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:13:12.177350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.775842, "process_user_time": 4.570778, "process_kernel_time": 0.184962, "process_mem_max_rss": "198393856", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:13:12.177620 [debug] [MainThread]: Command `dbt run` failed at 17:13:12.177573 after 10.78 seconds
[0m17:13:12.177813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066460a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766bee0>]}
[0m17:13:12.177989 [debug] [MainThread]: Flushing usage events
[0m17:14:15.548428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ed8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e63c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e63e20>]}


============================== 17:14:15.550520 | ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526 ==============================
[0m17:14:15.550520 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:14:15.550821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select base_all_others_stock_history stg_all_stock_history', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:14:15.994110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3cb20>]}
[0m17:14:16.019865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d0e37c0>]}
[0m17:14:16.020157 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:14:16.030475 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:14:16.100490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:14:16.100917 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_all_others_stock_history.sql
[0m17:14:16.254893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e102e20>]}
[0m17:14:16.310858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d1683d0>]}
[0m17:14:16.311131 [info ] [MainThread]: Found 32 models, 42 sources, 469 macros
[0m17:14:16.311300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d3f71f0>]}
[0m17:14:16.312147 [info ] [MainThread]: 
[0m17:14:16.312413 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:14:16.314517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m17:14:16.314731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:16.681494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m17:14:16.682310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:17.081551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce8af0>]}
[0m17:14:17.082043 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m17:14:17.082264 [info ] [MainThread]: 
[0m17:14:17.085624 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_others_stock_history
[0m17:14:17.085992 [info ] [Thread-1  ]: 1 of 2 START sql table model stock_analysis.base_all_others_stock_history ...... [RUN]
[0m17:14:17.086299 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_others_stock_history)
[0m17:14:17.086532 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_others_stock_history
[0m17:14:17.094581 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_history"
[0m17:14:17.096467 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_others_stock_history
[0m17:14:17.109547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:14:17.517096 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_history"
[0m17:14:17.518346 [debug] [Thread-1  ]: On model.stock_analysis.base_all_others_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date(ETL_Date) as etl_date
from `first-project-262802`.`stock`.`all_others_stock_history`
    );
  
[0m17:14:18.035263 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8bab5ee6-05c5-4fc7-bc43-3a945208af0f&page=queryresults
[0m17:14:24.024046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e33b4c0>]}
[0m17:14:24.024515 [info ] [Thread-1  ]: 1 of 2 OK created sql table model stock_analysis.base_all_others_stock_history . [[32mCREATE TABLE (17.9m rows, 1.0 GiB processed)[0m in 6.94s]
[0m17:14:24.024888 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_others_stock_history
[0m17:14:24.025309 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_stock_history
[0m17:14:24.025689 [info ] [Thread-3  ]: 2 of 2 START sql table model stock_analysis.stg_all_stock_history .............. [RUN]
[0m17:14:24.026101 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_history'
[0m17:14:24.026304 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_all_stock_history
[0m17:14:24.028492 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history"
[0m17:14:24.029001 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_all_stock_history
[0m17:14:24.031757 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history"
[0m17:14:24.032131 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:14:24.095175 [debug] [Thread-3  ]: On model.stock_analysis.stg_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history`
      
    
    

    OPTIONS()
    as (
      select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`

union all

select * from `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
    );
  
[0m17:14:24.691443 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a4a623aa-b06d-4974-819c-7d9f7432e093&page=queryresults
[0m17:14:30.532837 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebdcbdc9-b9e3-4c22-90f6-f326d4ec4526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e383280>]}
[0m17:14:30.535124 [info ] [Thread-3  ]: 2 of 2 OK created sql table model stock_analysis.stg_all_stock_history ......... [[32mCREATE TABLE (30.4m rows, 2.1 GiB processed)[0m in 6.51s]
[0m17:14:30.537001 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_stock_history
[0m17:14:30.540366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:30.540816 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_history' was properly closed.
[0m17:14:30.541121 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history' was properly closed.
[0m17:14:30.541596 [info ] [MainThread]: 
[0m17:14:30.542215 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 14.23 seconds (14.23s).
[0m17:14:30.543817 [debug] [MainThread]: Command end result
[0m17:14:30.584943 [info ] [MainThread]: 
[0m17:14:30.585277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:30.585484 [info ] [MainThread]: 
[0m17:14:30.585683 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:14:30.586971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.084341, "process_user_time": 4.777415, "process_kernel_time": 0.176275, "process_mem_max_rss": "201588736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:14:30.587289 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:30.587232 after 15.08 seconds
[0m17:14:30.587505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ed8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3cb20>]}
[0m17:14:30.587725 [debug] [MainThread]: Flushing usage events
[0m17:29:00.761322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102919970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104294430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104294250>]}


============================== 17:29:00.763558 | ac1d7655-7733-40c9-8a65-54248ed4b8da ==============================
[0m17:29:00.763558 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:29:00.763884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_all_stock_history', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:01.257898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac1d7655-7733-40c9-8a65-54248ed4b8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c88b20>]}
[0m17:29:01.283384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac1d7655-7733-40c9-8a65-54248ed4b8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042488b0>]}
[0m17:29:01.283649 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:29:01.294474 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:29:01.373371 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 1 files changed.
[0m17:29:01.373761 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:29:01.373938 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:29:01.374087 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:29:01.374228 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:29:01.374364 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:29:01.374507 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:29:01.374644 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:29:01.374779 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:29:01.374895 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:29:01.375011 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:29:01.375122 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:29:01.375238 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:29:01.375348 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:29:01.375456 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:29:01.375563 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:29:01.375672 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:29:01.375780 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:29:01.375895 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:29:01.376096 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:29:01.376216 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:29:01.376324 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:29:01.376465 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:29:01.505183 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price' (models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql) depends on a node named 'stg_nasdaq_history_base' which was not found
[0m17:29:01.506470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7910031, "process_user_time": 3.435325, "process_kernel_time": 0.692308, "process_mem_max_rss": "189169664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:29:01.506737 [debug] [MainThread]: Command `dbt run` failed at 17:29:01.506692 after 0.79 seconds
[0m17:29:01.506920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102919970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152930e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152930640>]}
[0m17:29:01.507092 [debug] [MainThread]: Flushing usage events
[0m17:30:08.385589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020e98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a643d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a641f0>]}


============================== 17:30:08.388184 | 27f465cc-dab3-4080-a435-5027f98baddd ==============================
[0m17:30:08.388184 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:30:08.388469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_all_stock_history', 'send_anonymous_usage_stats': 'True'}
[0m17:30:08.923686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27f465cc-dab3-4080-a435-5027f98baddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102317910>]}
[0m17:30:08.949690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27f465cc-dab3-4080-a435-5027f98baddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140963820>]}
[0m17:30:08.949951 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:30:08.960235 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:30:09.039123 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 1 files changed.
[0m17:30:09.039440 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:30:09.039599 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:30:09.039743 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:30:09.039881 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:30:09.040021 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:30:09.040155 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:30:09.040286 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:30:09.040419 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:30:09.040535 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:30:09.040647 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:30:09.040850 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:30:09.040964 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:30:09.041074 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:30:09.041182 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:30:09.041290 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:30:09.041400 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:30:09.041509 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:30:09.041615 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:30:09.041719 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:30:09.041826 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:30:09.041931 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:30:09.042062 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:30:09.165538 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.stg_all_stock_monthly_price_movement' (models/2_staging/stg_all_stock_monthly_price_movement.sql) depends on a node named 'stg_nasdaq_history_base' which was not found
[0m17:30:09.166846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.82829964, "process_user_time": 1.659325, "process_kernel_time": 2.534522, "process_mem_max_rss": "187203584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:09.167124 [debug] [MainThread]: Command `dbt run` failed at 17:30:09.167077 after 0.83 seconds
[0m17:30:09.167304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020e98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e80760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e80220>]}
[0m17:30:09.167475 [debug] [MainThread]: Flushing usage events
[0m17:31:48.236563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045099a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e88ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e88e80>]}


============================== 17:31:48.239175 | ec99c810-2d18-43f3-8bf1-fb8976423fda ==============================
[0m17:31:48.239175 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:31:48.239478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_all_stock_history.sql', 'send_anonymous_usage_stats': 'True'}
[0m17:31:48.727663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec99c810-2d18-43f3-8bf1-fb8976423fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f45f100>]}
[0m17:31:48.753334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec99c810-2d18-43f3-8bf1-fb8976423fda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058743a0>]}
[0m17:31:48.753606 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:31:48.763715 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:31:48.840741 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 1 files changed.
[0m17:31:48.841106 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:31:48.841270 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:31:48.841411 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:31:48.841546 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:31:48.841684 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:31:48.841826 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:31:48.841958 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:31:48.842089 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:31:48.842212 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:31:48.842325 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:31:48.842436 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:31:48.842549 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:31:48.842661 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:31:48.842770 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:31:48.842881 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:31:48.842991 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:31:48.843103 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:31:48.843212 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:31:48.843320 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:31:48.843523 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:31:48.843645 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:31:48.843779 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:31:48.969664 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.int_stock_analysis' (models/3_intermediary/int_stock_analysis.sql) depends on a node named 'stg_all_nasdaq_stock_history' which was not found
[0m17:31:48.970968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7811955, "process_user_time": 3.128705, "process_kernel_time": 0.99301, "process_mem_max_rss": "189874176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:31:48.971245 [debug] [MainThread]: Command `dbt run` failed at 17:31:48.971200 after 0.78 seconds
[0m17:31:48.971429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045099a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a9e39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a9e3130>]}
[0m17:31:48.971593 [debug] [MainThread]: Flushing usage events
[0m17:32:27.110540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f36af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c7160>]}


============================== 17:32:27.112872 | d7c5f20c-ba79-4027-a6a5-9f71762b5f47 ==============================
[0m17:32:27.112872 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:32:27.113224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_all_stock_history.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:27.540934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7c5f20c-ba79-4027-a6a5-9f71762b5f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726e0d0>]}
[0m17:32:27.566648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7c5f20c-ba79-4027-a6a5-9f71762b5f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156b41e20>]}
[0m17:32:27.566949 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:32:27.578049 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:32:27.647704 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 1 files changed.
[0m17:32:27.648093 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:32:27.648284 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:32:27.648449 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:32:27.648601 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:32:27.648750 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:32:27.648898 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:32:27.649045 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:32:27.649189 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:32:27.649324 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:32:27.649448 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:32:27.649573 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:32:27.649694 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:32:27.649820 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:32:27.649941 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:32:27.650064 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:32:27.650283 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:32:27.650424 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:32:27.650549 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:32:27.650674 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:32:27.650792 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:32:27.650915 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:32:27.651058 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:32:27.777836 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.int_stock_analysis' (models/3_intermediary/int_stock_analysis.sql) depends on a node named 'stg_all_nasdaq_stock_history' which was not found
[0m17:32:27.779085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.717136, "process_user_time": 4.174297, "process_kernel_time": 0.141191, "process_mem_max_rss": "190332928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:32:27.779378 [debug] [MainThread]: Command `dbt run` failed at 17:32:27.779327 after 0.72 seconds
[0m17:32:27.779577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f36af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109476940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1578b9be0>]}
[0m17:32:27.779757 [debug] [MainThread]: Flushing usage events
[0m17:33:03.099895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d76af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ef340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ef160>]}


============================== 17:33:03.102013 | 2a788ec0-0f31-4d09-ac19-cb54f5c94575 ==============================
[0m17:33:03.102013 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:33:03.102338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_all_stock_history.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:33:03.544442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a788ec0-0f31-4d09-ac19-cb54f5c94575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101fab0d0>]}
[0m17:33:03.570324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a788ec0-0f31-4d09-ac19-cb54f5c94575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146d81e20>]}
[0m17:33:03.570624 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:33:03.581968 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:33:03.653768 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 2 files changed.
[0m17:33:03.654181 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:33:03.654369 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:33:03.654540 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:33:03.654702 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:33:03.654855 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:33:03.655011 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:33:03.655168 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:33:03.655322 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:33:03.655457 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:33:03.655582 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:33:03.655706 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:33:03.655831 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:33:03.655954 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:33:03.656085 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:33:03.656221 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:33:03.656355 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:33:03.656572 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:33:03.656742 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:33:03.656987 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:33:03.657136 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:33:03.657270 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:33:03.657427 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m17:33:03.657573 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:33:03.785208 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.int_stock_analysis' (models/3_intermediary/int_stock_analysis.sql) depends on a node named 'stg_all_nasdaq_stock_history' which was not found
[0m17:33:03.786452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.73186135, "process_user_time": 4.149386, "process_kernel_time": 0.137744, "process_mem_max_rss": "191774720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:33:03.786767 [debug] [MainThread]: Command `dbt run` failed at 17:33:03.786713 after 0.73 seconds
[0m17:33:03.786965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d76af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146dfbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103671ac0>]}
[0m17:33:03.787161 [debug] [MainThread]: Flushing usage events
[0m17:56:51.628361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105888400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105888220>]}


============================== 17:56:51.631122 | 262784df-3370-430a-b2a1-e5736ba108e3 ==============================
[0m17:56:51.631122 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:56:51.631448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history+', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:56:52.167226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '262784df-3370-430a-b2a1-e5736ba108e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041476a0>]}
[0m17:56:52.193855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '262784df-3370-430a-b2a1-e5736ba108e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058632e0>]}
[0m17:56:52.194250 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:56:52.205737 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:56:52.287927 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 2 files changed.
[0m17:56:52.288298 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:56:52.288467 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:56:52.288618 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:56:52.288759 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:56:52.288899 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:56:52.289036 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:56:52.289170 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:56:52.289305 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:56:52.289425 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:56:52.289536 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:56:52.289649 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:56:52.289760 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:56:52.289869 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:56:52.290064 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:56:52.290176 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:56:52.290287 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:56:52.290394 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:56:52.290502 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:56:52.290612 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:56:52.290721 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:56:52.290829 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:56:52.290960 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m17:56:52.291099 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:56:52.419775 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.int_stock_analysis' (models/3_intermediary/int_stock_analysis.sql) depends on a node named 'stg_all_nasdaq_stock_history' which was not found
[0m17:56:52.421097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.840306, "process_user_time": 3.936622, "process_kernel_time": 0.176194, "process_mem_max_rss": "192659456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:56:52.421375 [debug] [MainThread]: Command `dbt run` failed at 17:56:52.421329 after 0.84 seconds
[0m17:56:52.421576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1420f1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1419be610>]}
[0m17:56:52.421747 [debug] [MainThread]: Flushing usage events
[0m17:57:07.531302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107672c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107672e20>]}


============================== 17:57:07.533770 | 485f3e19-7de2-4f83-9611-00c61c04672d ==============================
[0m17:57:07.533770 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:57:07.534053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history+', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:08.032444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485f3e19-7de2-4f83-9611-00c61c04672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f336a0>]}
[0m17:57:08.058127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '485f3e19-7de2-4f83-9611-00c61c04672d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107653310>]}
[0m17:57:08.058409 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:57:08.069808 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:57:08.147818 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 3 files changed.
[0m17:57:08.148161 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:57:08.148328 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:57:08.148487 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:57:08.148640 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:57:08.148794 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:57:08.148939 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:57:08.149081 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:57:08.149221 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:57:08.149341 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:57:08.149459 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:57:08.149576 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:57:08.149687 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:57:08.149795 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:57:08.149988 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:57:08.150106 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:57:08.150214 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:57:08.150323 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:57:08.150429 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:57:08.150536 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:57:08.150640 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:57:08.150744 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:57:08.150887 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m17:57:08.151029 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/nasdaq.sql
[0m17:57:08.151166 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:57:08.275085 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.int_stock_analysis' (models/3_intermediary/int_stock_analysis.sql) depends on a node named 'stg_all_nasdaq_stock_history' which was not found
[0m17:57:08.276394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7938458, "process_user_time": 3.975103, "process_kernel_time": 0.174873, "process_mem_max_rss": "189579264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:57:08.276680 [debug] [MainThread]: Command `dbt run` failed at 17:57:08.276635 after 0.79 seconds
[0m17:57:08.276870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131cd3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131cdbdf0>]}
[0m17:57:08.277042 [debug] [MainThread]: Flushing usage events
[0m17:57:29.841597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068998b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820fe20>]}


============================== 17:57:29.843654 | f2395d40-b93c-4092-a3de-45ffbdbfb427 ==============================
[0m17:57:29.843654 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:57:29.843939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history+', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:57:30.283128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2395d40-b93c-4092-a3de-45ffbdbfb427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac6910>]}
[0m17:57:30.308631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2395d40-b93c-4092-a3de-45ffbdbfb427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135264820>]}
[0m17:57:30.308901 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:57:30.318814 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:57:30.388520 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 3 files changed.
[0m17:57:30.388853 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:57:30.389022 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:57:30.389168 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:57:30.389309 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:57:30.389443 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:57:30.389576 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:57:30.389710 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:57:30.389843 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:57:30.390050 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:57:30.390176 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:57:30.390288 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:57:30.390400 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:57:30.390507 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:57:30.390614 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:57:30.390723 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:57:30.390831 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:57:30.390938 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:57:30.391042 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:57:30.391148 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:57:30.391254 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:57:30.391357 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:57:30.391492 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:57:30.391625 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m17:57:30.391755 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/nasdaq.sql
[0m17:57:30.516223 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.int_stock_analysis' (models/3_intermediary/int_stock_analysis.sql) depends on a node named 'stg_all_nasdaq_stock_history' which was not found
[0m17:57:30.517425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.72172654, "process_user_time": 4.166278, "process_kernel_time": 0.147519, "process_mem_max_rss": "192413696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:57:30.517696 [debug] [MainThread]: Command `dbt run` failed at 17:57:30.517648 after 0.72 seconds
[0m17:57:30.517876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068998b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13539aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13539adc0>]}
[0m17:57:30.518048 [debug] [MainThread]: Flushing usage events
[0m17:58:04.583629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793f1f0>]}


============================== 17:58:04.586080 | fc365c2d-5d08-457d-bd5d-44fb216e5024 ==============================
[0m17:58:04.586080 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:58:04.586364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select base_all_nasdaq_stock_history+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:58:05.066478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc365c2d-5d08-457d-bd5d-44fb216e5024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3910>]}
[0m17:58:05.092055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc365c2d-5d08-457d-bd5d-44fb216e5024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076073d0>]}
[0m17:58:05.092324 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:58:05.103267 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:58:05.178525 [debug] [MainThread]: Partial parsing enabled: 13 files deleted, 8 files added, 3 files changed.
[0m17:58:05.178852 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m17:58:05.179017 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m17:58:05.179159 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m17:58:05.179301 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m17:58:05.179439 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m17:58:05.179573 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m17:58:05.179705 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m17:58:05.179836 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m17:58:05.180037 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m17:58:05.180153 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m17:58:05.180260 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m17:58:05.180368 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m17:58:05.180475 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m17:58:05.180582 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m17:58:05.180693 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m17:58:05.180799 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m17:58:05.180911 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m17:58:05.181021 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m17:58:05.181132 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m17:58:05.181239 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m17:58:05.181343 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m17:58:05.181475 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:58:05.181607 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/nasdaq.sql
[0m17:58:05.181738 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m17:58:05.307063 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.int_stock_analysis' (models/3_intermediary/int_stock_analysis.sql) depends on a node named 'stg_all_nasdaq_stock_history' which was not found
[0m17:58:05.308389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7714104, "process_user_time": 2.942769, "process_kernel_time": 1.180075, "process_mem_max_rss": "190103552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:58:05.308667 [debug] [MainThread]: Command `dbt run` failed at 17:58:05.308620 after 0.77 seconds
[0m17:58:05.308851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107612ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132ff13a0>]}
[0m17:58:05.309030 [debug] [MainThread]: Flushing usage events
[0m18:01:23.414446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765c1f0>]}


============================== 18:01:23.416932 | a10fcb25-7e8e-4f39-abb0-28ffd31ae746 ==============================
[0m18:01:23.416932 [info ] [MainThread]: Running with dbt=1.8.2
[0m18:01:23.417224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select +stock_analysis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:23.897429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0f910>]}
[0m18:01:23.923090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ca3820>]}
[0m18:01:23.923354 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m18:01:23.934372 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m18:01:24.010096 [debug] [MainThread]: Partial parsing enabled: 21 files deleted, 8 files added, 1 files changed.
[0m18:01:24.010440 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_base.sql
[0m18:01:24.010604 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_history_weekly_monthly_yearly_price.sql
[0m18:01:24.010749 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m18:01:24.010886 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m18:01:24.011027 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m18:01:24.011165 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m18:01:24.011300 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m18:01:24.011439 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m18:01:24.011556 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_hlal_2019_2024.sql
[0m18:01:24.011667 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_monthly_price_movement.sql
[0m18:01:24.011775 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_weekly_monthly_yearly_price.sql
[0m18:01:24.011885 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_weekly_price_movement.sql
[0m18:01:24.011994 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_history.sql
[0m18:01:24.012105 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_monthly_price_movement.sql
[0m18:01:24.012212 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_nasdaq.sql
[0m18:01:24.012321 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_yearly_price_movement.sql
[0m18:01:24.012429 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_weekly_price_movement.sql
[0m18:01:24.012535 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/4_final/nasdaq.sql
[0m18:01:24.012644 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_history.sql
[0m18:01:24.012785 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_intermediary/int_stock_analysis.sql
[0m18:01:24.012899 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_base.sql
[0m18:01:24.013006 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_spy_1993_2024.sql
[0m18:01:24.013112 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_spy_1993_2024.sql
[0m18:01:24.013215 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_spus_2019_2024.sql
[0m18:01:24.013319 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_hlal_2019_2024.sql
[0m18:01:24.013426 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_history_weekly_monthly_yearly_price.sql
[0m18:01:24.013532 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_nasdaq_yearly_price_movement.sql
[0m18:01:24.013636 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_others_history_base.sql
[0m18:01:24.013748 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_spus_2019_2024.sql
[0m18:01:24.013877 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m18:01:24.175701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c85130>]}
[0m18:01:24.233984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c85e80>]}
[0m18:01:24.234232 [info ] [MainThread]: Found 19 models, 42 sources, 469 macros
[0m18:01:24.234399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c84af0>]}
[0m18:01:24.236170 [info ] [MainThread]: 
[0m18:01:24.236427 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:01:24.239140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m18:01:24.239335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:24.770018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m18:01:24.770724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:25.173873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e0160>]}
[0m18:01:25.174460 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m18:01:25.174695 [info ] [MainThread]: 
[0m18:01:25.180025 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m18:01:25.180352 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m18:01:25.180770 [info ] [Thread-1  ]: 1 of 19 START sql table model stock_analysis.base_all_nasdaq_stock_history ..... [RUN]
[0m18:01:25.181080 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_all_others_stock_history
[0m18:01:25.181309 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_all_others_stock_info
[0m18:01:25.181610 [info ] [Thread-2  ]: 2 of 19 START sql table model stock_analysis.base_all_nasdaq_stock_info ........ [RUN]
[0m18:01:25.181918 [debug] [Thread-5  ]: Began running node model.stock_analysis.base_calendar
[0m18:01:25.182191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m18:01:25.182425 [debug] [Thread-6  ]: Began running node model.stock_analysis.base_symbols_meta
[0m18:01:25.182732 [info ] [Thread-3  ]: 3 of 19 START sql table model stock_analysis.base_all_others_stock_history ..... [RUN]
[0m18:01:25.183066 [info ] [Thread-4  ]: 4 of 19 START sql table model stock_analysis.base_all_others_stock_info ........ [RUN]
[0m18:01:25.183393 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_nasdaq_stock_info'
[0m18:01:25.183684 [info ] [Thread-5  ]: 5 of 19 START sql table model stock_analysis.base_calendar ..................... [RUN]
[0m18:01:25.183935 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m18:01:25.184214 [info ] [Thread-6  ]: 6 of 19 START sql table model stock_analysis.base_symbols_meta ................. [RUN]
[0m18:01:25.184539 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_others_stock_history'
[0m18:01:25.184833 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_others_stock_info'
[0m18:01:25.185060 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m18:01:25.185383 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.base_calendar'
[0m18:01:25.191461 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m18:01:25.191790 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.base_symbols_meta'
[0m18:01:25.192011 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_all_others_stock_history
[0m18:01:25.192215 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_all_others_stock_info
[0m18:01:25.194491 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m18:01:25.194718 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.base_calendar
[0m18:01:25.194961 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m18:01:25.196833 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_history"
[0m18:01:25.198965 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_info"
[0m18:01:25.199254 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m18:01:25.201175 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m18:01:25.203023 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m18:01:25.203313 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m18:01:25.213662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:25.214010 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_all_others_stock_history
[0m18:01:25.214222 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_all_others_stock_info
[0m18:01:25.216022 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:01:25.216243 [debug] [Thread-5  ]: Began executing node model.stock_analysis.base_calendar
[0m18:01:25.217902 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:01:25.278123 [debug] [Thread-6  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m18:01:25.282020 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:01:25.283631 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m18:01:25.344923 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m18:01:25.881608 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m18:01:25.882588 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m18:01:25.883941 [debug] [Thread-4  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_info"
[0m18:01:25.884723 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m18:01:25.885474 [debug] [Thread-4  ]: On model.stock_analysis.base_all_others_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , city
    , state
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , dividendRate
    , dividendYield
    , exDividendDate
    , payoutRatio
    , fiveYearAvgDividendYield
    , beta
    , trailingPE
    , forwardPE
    , volume as volume_from_stock_info
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , bid
    , ask
    , bidSize
    , askSize
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , sharesPercentSharesOut
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , earningsQuarterlyGrowth
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , pegRatio
    , lastSplitFactor
    , lastSplitDate
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , recommendationMean
    , recommendationKey
    , numberOfAnalystOpinions
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , freeCashflow
    , operatingCashflow
    , earningsGrowth
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , address2
    , industrySymbol
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_others_stock_info`
    );
  
[0m18:01:25.886736 [debug] [Thread-2  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume as volume_from_stock_info
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m18:01:25.887220 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date('2024-09-16') as etl_date
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m18:01:25.887547 [debug] [Thread-5  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m18:01:25.935341 [debug] [Thread-6  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m18:01:25.936317 [debug] [Thread-6  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_valid_meta`
    );
  
[0m18:01:25.941334 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_history"
[0m18:01:25.942156 [debug] [Thread-3  ]: On model.stock_analysis.base_all_others_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date(ETL_Date) as etl_date
from `first-project-262802`.`stock`.`all_others_stock_history`
    );
  
[0m18:01:26.300824 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:72e4b498-83b4-4d38-b132-e4b855f2fc38&page=queryresults
[0m18:01:26.310892 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c00e666d-7e57-40fb-8ba8-27a2d0f79895&page=queryresults
[0m18:01:26.339068 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:af7e3cd7-ceda-4259-98be-37019162298c&page=queryresults
[0m18:01:26.348963 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1be6279f-63d0-4922-8a69-502fc22f76d3&page=queryresults
[0m18:01:26.354974 [debug] [Thread-6  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9844cab7-fda6-4376-aa2c-5d931753ae1a&page=queryresults
[0m18:01:26.481508 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7e18f11f-efe9-4283-a0ff-c242e931a91a&page=queryresults
[0m18:01:28.889517 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dd67f0>]}
[0m18:01:28.890242 [info ] [Thread-6  ]: 6 of 19 OK created sql table model stock_analysis.base_symbols_meta ............ [[32mCREATE TABLE (8.0k rows, 0 processed)[0m in 3.70s]
[0m18:01:28.890777 [debug] [Thread-6  ]: Finished running node model.stock_analysis.base_symbols_meta
[0m18:01:28.891382 [debug] [Thread-8  ]: Began running node model.stock_analysis.stg_symbols_meta
[0m18:01:28.891848 [info ] [Thread-8  ]: 7 of 19 START sql table model stock_analysis.stg_symbols_meta .................. [RUN]
[0m18:01:28.892284 [debug] [Thread-8  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_symbols_meta'
[0m18:01:28.892559 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.stg_symbols_meta
[0m18:01:28.895524 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.stg_symbols_meta"
[0m18:01:28.896277 [debug] [Thread-8  ]: Began executing node model.stock_analysis.stg_symbols_meta
[0m18:01:28.898837 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m18:01:29.282552 [debug] [Thread-8  ]: Writing runtime sql for node "model.stock_analysis.stg_symbols_meta"
[0m18:01:29.285906 [debug] [Thread-8  ]: On model.stock_analysis.stg_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_symbols_meta`
      
    
    

    OPTIONS()
    as (
      with 

symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`base_symbols_meta` )

select 
    symbol
    , security_name
    , listing_exchange
    , market_category
    , is_ETF
from symbols_meta
    );
  
[0m18:01:29.679651 [debug] [Thread-8  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:94fa6b9d-28f4-47fa-bf60-9b97ae73466c&page=queryresults
[0m18:01:30.451365 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc7190>]}
[0m18:01:30.453220 [info ] [Thread-4  ]: 4 of 19 OK created sql table model stock_analysis.base_all_others_stock_info ... [[32mCREATE TABLE (19.9k rows, 45.0 MiB processed)[0m in 5.27s]
[0m18:01:30.454396 [debug] [Thread-4  ]: Finished running node model.stock_analysis.base_all_others_stock_info
[0m18:01:30.455688 [debug] [Thread-10 ]: Began running node model.stock_analysis.stg_all_others_stock_info
[0m18:01:30.456256 [info ] [Thread-10 ]: 8 of 19 START sql table model stock_analysis.stg_all_others_stock_info ......... [RUN]
[0m18:01:30.456986 [debug] [Thread-10 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_others_stock_info'
[0m18:01:30.457473 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.stg_all_others_stock_info
[0m18:01:30.461736 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.stg_all_others_stock_info"
[0m18:01:30.462664 [debug] [Thread-10 ]: Began executing node model.stock_analysis.stg_all_others_stock_info
[0m18:01:30.467366 [debug] [Thread-10 ]: Writing runtime sql for node "model.stock_analysis.stg_all_others_stock_info"
[0m18:01:30.468028 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m18:01:30.543734 [debug] [Thread-10 ]: On model.stock_analysis.stg_all_others_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_others_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_others_stock_info`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`base_all_others_stock_info` )

select
    distinct 
    *
from base
where index = 0
    );
  
[0m18:01:30.614168 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc7b50>]}
[0m18:01:30.614634 [info ] [Thread-5  ]: 5 of 19 OK created sql table model stock_analysis.base_calendar ................ [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 5.43s]
[0m18:01:30.615063 [debug] [Thread-5  ]: Finished running node model.stock_analysis.base_calendar
[0m18:01:30.615460 [debug] [Thread-12 ]: Began running node model.stock_analysis.stg_calendar
[0m18:01:30.615813 [info ] [Thread-12 ]: 9 of 19 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m18:01:30.616191 [debug] [Thread-12 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_calendar'
[0m18:01:30.616425 [debug] [Thread-12 ]: Began compiling node model.stock_analysis.stg_calendar
[0m18:01:30.619290 [debug] [Thread-12 ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m18:01:30.621145 [debug] [Thread-12 ]: Began executing node model.stock_analysis.stg_calendar
[0m18:01:30.623273 [debug] [Thread-12 ]: Opening a new connection, currently in state init
[0m18:01:31.116223 [debug] [Thread-12 ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m18:01:31.119667 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137919df0>]}
[0m18:01:31.120699 [info ] [Thread-2  ]: 2 of 19 OK created sql table model stock_analysis.base_all_nasdaq_stock_info ... [[32mCREATE TABLE (27.7k rows, 59.7 MiB processed)[0m in 5.94s]
[0m18:01:31.121921 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_info
[0m18:01:31.123097 [debug] [Thread-14 ]: Began running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m18:01:31.124193 [debug] [Thread-12 ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , concat(base.year_full,'-',base.week_number) as year_week
    , concat(base.year_full,'-',base.month_abbrev,'-',base.week_number) as year_month_week
    , concat(base.year_full,'-',base.month_abbrev) as year_month

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m18:01:31.125297 [info ] [Thread-14 ]: 10 of 19 START sql table model stock_analysis.stg_all_nasdaq_stock_info ........ [RUN]
[0m18:01:31.126442 [debug] [Thread-14 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_nasdaq_stock_info'
[0m18:01:31.127255 [debug] [Thread-14 ]: Began compiling node model.stock_analysis.stg_all_nasdaq_stock_info
[0m18:01:31.129842 [debug] [Thread-14 ]: Writing injected SQL for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m18:01:31.130589 [debug] [Thread-14 ]: Began executing node model.stock_analysis.stg_all_nasdaq_stock_info
[0m18:01:31.132310 [debug] [Thread-14 ]: Opening a new connection, currently in state init
[0m18:01:31.206789 [debug] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4de8a3d2-35b8-4abb-8c0d-39e0505288b6&page=queryresults
[0m18:01:31.520846 [debug] [Thread-14 ]: Writing runtime sql for node "model.stock_analysis.stg_all_nasdaq_stock_info"
[0m18:01:31.524765 [debug] [Thread-14 ]: On model.stock_analysis.stg_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info` )

select
    distinct 
    *
from base
where index = 0
    );
  
[0m18:01:31.581971 [debug] [Thread-12 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8c05652b-ac3b-49f2-87a5-8a318474e393&page=queryresults
[0m18:01:32.090314 [debug] [Thread-14 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f2712ec4-201c-43b7-bebf-2f79bbf4b831&page=queryresults
[0m18:01:32.299626 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dd61c0>]}
[0m18:01:32.301126 [info ] [Thread-8  ]: 7 of 19 OK created sql table model stock_analysis.stg_symbols_meta ............. [[32mCREATE TABLE (8.0k rows, 495.2 KiB processed)[0m in 3.41s]
[0m18:01:32.302096 [debug] [Thread-8  ]: Finished running node model.stock_analysis.stg_symbols_meta
[0m18:01:32.359390 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc76d0>]}
[0m18:01:32.360407 [info ] [Thread-1  ]: 1 of 19 OK created sql table model stock_analysis.base_all_nasdaq_stock_history  [[32mCREATE TABLE (12.5m rows, 641.5 MiB processed)[0m in 7.18s]
[0m18:01:32.361227 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m18:01:33.165249 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc7670>]}
[0m18:01:33.167537 [info ] [Thread-3  ]: 3 of 19 OK created sql table model stock_analysis.base_all_others_stock_history  [[32mCREATE TABLE (17.9m rows, 1.0 GiB processed)[0m in 7.98s]
[0m18:01:33.168857 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_all_others_stock_history
[0m18:01:33.169994 [debug] [Thread-16 ]: Began running node model.stock_analysis.stg_all_stock_history
[0m18:01:33.170638 [info ] [Thread-16 ]: 11 of 19 START sql table model stock_analysis.stg_all_stock_history ............ [RUN]
[0m18:01:33.171124 [debug] [Thread-16 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_history'
[0m18:01:33.171373 [debug] [Thread-16 ]: Began compiling node model.stock_analysis.stg_all_stock_history
[0m18:01:33.175304 [debug] [Thread-16 ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history"
[0m18:01:33.177016 [debug] [Thread-16 ]: Began executing node model.stock_analysis.stg_all_stock_history
[0m18:01:33.179004 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m18:01:33.572972 [debug] [Thread-16 ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history"
[0m18:01:33.576388 [debug] [Thread-16 ]: On model.stock_analysis.stg_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history`
      
    
    

    OPTIONS()
    as (
      select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`

union all

select * from `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
    );
  
[0m18:01:33.984443 [debug] [Thread-16 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0955a733-492b-4cd2-b3ea-c9119e701fcc&page=queryresults
[0m18:01:34.256668 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13796c4c0>]}
[0m18:01:34.258095 [info ] [Thread-10 ]: 8 of 19 OK created sql table model stock_analysis.stg_all_others_stock_info .... [[32mCREATE TABLE (2.5k rows, 45.0 MiB processed)[0m in 3.80s]
[0m18:01:34.258993 [debug] [Thread-10 ]: Finished running node model.stock_analysis.stg_all_others_stock_info
[0m18:01:35.157035 [debug] [Thread-14 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379dfeb0>]}
[0m18:01:35.159199 [info ] [Thread-14 ]: 10 of 19 OK created sql table model stock_analysis.stg_all_nasdaq_stock_info ... [[32mCREATE TABLE (3.9k rows, 59.7 MiB processed)[0m in 4.03s]
[0m18:01:35.161037 [debug] [Thread-14 ]: Finished running node model.stock_analysis.stg_all_nasdaq_stock_info
[0m18:01:35.162446 [debug] [Thread-18 ]: Began running node model.stock_analysis.stg_all_stock_info
[0m18:01:35.163273 [info ] [Thread-18 ]: 12 of 19 START sql table model stock_analysis.stg_all_stock_info ............... [RUN]
[0m18:01:35.164168 [debug] [Thread-18 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_info'
[0m18:01:35.164713 [debug] [Thread-18 ]: Began compiling node model.stock_analysis.stg_all_stock_info
[0m18:01:35.171779 [debug] [Thread-18 ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_info"
[0m18:01:35.173072 [debug] [Thread-18 ]: Began executing node model.stock_analysis.stg_all_stock_info
[0m18:01:35.177469 [debug] [Thread-18 ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_info"
[0m18:01:35.178154 [debug] [Thread-18 ]: Opening a new connection, currently in state init
[0m18:01:35.256221 [debug] [Thread-18 ]: On model.stock_analysis.stg_all_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_info`
      
    
    

    OPTIONS()
    as (
      select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`

union all

select * from `first-project-262802`.`stock_analysis`.`stg_all_others_stock_info`
    );
  
[0m18:01:35.823828 [debug] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2cb88b5b-11c5-40f6-b25a-645f91f757e9&page=queryresults
[0m18:01:35.959826 [debug] [Thread-18 ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Queries in UNION ALL have mismatched column count; query 1 has 135 columns, query 2 has 136 columns at [17:1]; reason: invalidQuery, location: query, message: Queries in UNION ALL have mismatched column count; query 1 has 135 columns, query 2 has 136 columns at [17:1]')
[0m18:01:37.156224 [debug] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d8b81925-5ee7-4347-86ab-22f720343c9a&page=queryresults
[0m18:01:37.361750 [error] [Thread-18 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d8b81925-5ee7-4347-86ab-22f720343c9a&page=queryresults
[0m18:01:37.401652 [debug] [Thread-18 ]: Database Error in model stg_all_stock_info (models/2_staging/stg_all_stock_info.sql)
  Queries in UNION ALL have mismatched column count; query 1 has 135 columns, query 2 has 136 columns at [17:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_stock_info.sql
[0m18:01:37.402007 [debug] [Thread-18 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c96f10>]}
[0m18:01:37.402457 [error] [Thread-18 ]: 12 of 19 ERROR creating sql table model stock_analysis.stg_all_stock_info ...... [[31mERROR[0m in 2.24s]
[0m18:01:37.402846 [debug] [Thread-18 ]: Finished running node model.stock_analysis.stg_all_stock_info
[0m18:01:37.461661 [debug] [Thread-12 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc7c10>]}
[0m18:01:37.462147 [info ] [Thread-12 ]: 9 of 19 OK created sql table model stock_analysis.stg_calendar ................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 6.85s]
[0m18:01:37.462471 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stg_calendar
[0m18:01:39.678894 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dc71c0>]}
[0m18:01:39.680895 [info ] [Thread-16 ]: 11 of 19 OK created sql table model stock_analysis.stg_all_stock_history ....... [[32mCREATE TABLE (30.4m rows, 2.1 GiB processed)[0m in 6.51s]
[0m18:01:39.681925 [debug] [Thread-16 ]: Finished running node model.stock_analysis.stg_all_stock_history
[0m18:01:39.683330 [debug] [Thread-20 ]: Began running node model.stock_analysis.stg_all_stock_history_base
[0m18:01:39.683861 [info ] [Thread-20 ]: 13 of 19 START sql table model stock_analysis.stg_all_stock_history_base ....... [RUN]
[0m18:01:39.684378 [debug] [Thread-20 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_history_base'
[0m18:01:39.684669 [debug] [Thread-20 ]: Began compiling node model.stock_analysis.stg_all_stock_history_base
[0m18:01:39.688389 [debug] [Thread-20 ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history_base"
[0m18:01:39.689154 [debug] [Thread-20 ]: Began executing node model.stock_analysis.stg_all_stock_history_base
[0m18:01:39.693138 [debug] [Thread-20 ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history_base"
[0m18:01:39.693649 [debug] [Thread-20 ]: Opening a new connection, currently in state init
[0m18:01:39.761246 [debug] [Thread-20 ]: On model.stock_analysis.stg_all_stock_history_base: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history_base"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

select * from base
    );
  
[0m18:01:40.329561 [debug] [Thread-20 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ca0b940e-96cc-4082-ad5d-ca5add0927bd&page=queryresults
[0m18:01:54.369591 [debug] [Thread-20 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137854dc0>]}
[0m18:01:54.371078 [info ] [Thread-20 ]: 13 of 19 OK created sql table model stock_analysis.stg_all_stock_history_base .. [[32mCREATE TABLE (30.4m rows, 2.1 GiB processed)[0m in 14.69s]
[0m18:01:54.371965 [debug] [Thread-20 ]: Finished running node model.stock_analysis.stg_all_stock_history_base
[0m18:01:54.373651 [debug] [Thread-22 ]: Began running node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m18:01:54.374569 [debug] [Thread-23 ]: Began running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m18:01:54.375320 [debug] [Thread-24 ]: Began running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m18:01:54.376507 [debug] [Thread-25 ]: Began running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m18:01:54.376050 [info ] [Thread-22 ]: 14 of 19 START sql table model stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price  [RUN]
[0m18:01:54.377633 [info ] [Thread-23 ]: 15 of 19 START sql table model stock_analysis.stg_all_stock_monthly_price_movement  [RUN]
[0m18:01:54.378278 [info ] [Thread-24 ]: 16 of 19 START sql table model stock_analysis.stg_all_stock_weekly_price_movement  [RUN]
[0m18:01:54.378923 [info ] [Thread-25 ]: 17 of 19 START sql table model stock_analysis.stg_all_stock_yearly_price_movement  [RUN]
[0m18:01:54.379591 [debug] [Thread-22 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price'
[0m18:01:54.380091 [debug] [Thread-23 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_monthly_price_movement'
[0m18:01:54.380562 [debug] [Thread-24 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_weekly_price_movement'
[0m18:01:54.381016 [debug] [Thread-25 ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_yearly_price_movement'
[0m18:01:54.381396 [debug] [Thread-22 ]: Began compiling node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m18:01:54.381739 [debug] [Thread-23 ]: Began compiling node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m18:01:54.382076 [debug] [Thread-24 ]: Began compiling node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m18:01:54.382407 [debug] [Thread-25 ]: Began compiling node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m18:01:54.386455 [debug] [Thread-22 ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price"
[0m18:01:54.389602 [debug] [Thread-23 ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_monthly_price_movement"
[0m18:01:54.392650 [debug] [Thread-24 ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_weekly_price_movement"
[0m18:01:54.395321 [debug] [Thread-25 ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_yearly_price_movement"
[0m18:01:54.396272 [debug] [Thread-23 ]: Began executing node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m18:01:54.399435 [debug] [Thread-23 ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_monthly_price_movement"
[0m18:01:54.399744 [debug] [Thread-25 ]: Began executing node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m18:01:54.400012 [debug] [Thread-22 ]: Began executing node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m18:01:54.400273 [debug] [Thread-24 ]: Began executing node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m18:01:54.402971 [debug] [Thread-25 ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_yearly_price_movement"
[0m18:01:54.406427 [debug] [Thread-22 ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price"
[0m18:01:54.409067 [debug] [Thread-24 ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_weekly_price_movement"
[0m18:01:54.409358 [debug] [Thread-23 ]: Opening a new connection, currently in state init
[0m18:01:54.409860 [debug] [Thread-25 ]: Opening a new connection, currently in state init
[0m18:01:54.474571 [debug] [Thread-25 ]: On model.stock_analysis.stg_all_stock_yearly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_yearly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)









-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_year using (year_full, symbol)

select * from daily_price_movement_in_year
    );
  
[0m18:01:54.532559 [debug] [Thread-22 ]: Opening a new connection, currently in state init
[0m18:01:54.535615 [debug] [Thread-23 ]: On model.stock_analysis.stg_all_stock_monthly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_monthly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_month using (year_full, month_number, symbol)

select * from daily_price_movement_in_month
    );
  
[0m18:01:54.535860 [debug] [Thread-24 ]: Opening a new connection, currently in state init
[0m18:01:54.593331 [debug] [Thread-22 ]: On model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)








select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
    );
  
[0m18:01:54.656249 [debug] [Thread-24 ]: On model.stock_analysis.stg_all_stock_weekly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_weekly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_week using (year_full, week_number, symbol)

select * from daily_price_movement_in_week
    );
  
[0m18:01:55.180331 [debug] [Thread-22 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2e94edd0-c516-4d86-9b2b-6470cca0c82b&page=queryresults
[0m18:01:55.181536 [debug] [Thread-24 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:964b71a3-91b7-476d-b5b8-33cc0bf1183b&page=queryresults
[0m18:01:55.182546 [debug] [Thread-25 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a8f11077-6f89-47ac-bd89-f3e5098e44c3&page=queryresults
[0m18:01:55.193626 [debug] [Thread-23 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:da1bd6de-fc2e-4d82-b3f6-5eefdecd1401&page=queryresults
[0m18:02:02.177439 [debug] [Thread-24 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c965e0>]}
[0m18:02:02.178392 [info ] [Thread-24 ]: 16 of 19 OK created sql table model stock_analysis.stg_all_stock_weekly_price_movement  [[32mCREATE TABLE (30.4m rows, 1.2 GiB processed)[0m in 7.80s]
[0m18:02:02.179099 [debug] [Thread-24 ]: Finished running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m18:02:02.435977 [debug] [Thread-25 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137807340>]}
[0m18:02:02.438087 [info ] [Thread-25 ]: 17 of 19 OK created sql table model stock_analysis.stg_all_stock_yearly_price_movement  [[32mCREATE TABLE (30.4m rows, 1.1 GiB processed)[0m in 8.05s]
[0m18:02:02.439251 [debug] [Thread-25 ]: Finished running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m18:02:05.524279 [debug] [Thread-23 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379e9160>]}
[0m18:02:05.526561 [info ] [Thread-23 ]: 15 of 19 OK created sql table model stock_analysis.stg_all_stock_monthly_price_movement  [[32mCREATE TABLE (30.4m rows, 1.3 GiB processed)[0m in 11.14s]
[0m18:02:05.527821 [debug] [Thread-23 ]: Finished running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m18:02:22.080265 [debug] [Thread-22 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dbfb50>]}
[0m18:02:22.081636 [info ] [Thread-22 ]: 14 of 19 OK created sql table model stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price  [[32mCREATE TABLE (30.4m rows, 10.6 GiB processed)[0m in 27.70s]
[0m18:02:22.082819 [debug] [Thread-22 ]: Finished running node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m18:02:22.084234 [debug] [Thread-27 ]: Began running node model.stock_analysis.int_all_stock_history
[0m18:02:22.085192 [info ] [Thread-27 ]: 18 of 19 START sql table model stock_analysis.int_all_stock_history ............ [RUN]
[0m18:02:22.086003 [debug] [Thread-27 ]: Acquiring new bigquery connection 'model.stock_analysis.int_all_stock_history'
[0m18:02:22.086481 [debug] [Thread-27 ]: Began compiling node model.stock_analysis.int_all_stock_history
[0m18:02:22.091989 [debug] [Thread-27 ]: Writing injected SQL for node "model.stock_analysis.int_all_stock_history"
[0m18:02:22.094126 [debug] [Thread-27 ]: Began executing node model.stock_analysis.int_all_stock_history
[0m18:02:22.097752 [debug] [Thread-27 ]: Writing runtime sql for node "model.stock_analysis.int_all_stock_history"
[0m18:02:22.098411 [debug] [Thread-27 ]: Opening a new connection, currently in state init
[0m18:02:22.174079 [debug] [Thread-27 ]: On model.stock_analysis.int_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_all_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

, all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

, all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

, all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



select
    distinct *
from all_stock_history_weekly_monthly_yearly_price
left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
left join all_stock_yearly_price_movement using (year_full, symbol)
    );
  
[0m18:02:22.878829 [debug] [Thread-27 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:53302c2f-fe83-4fd4-9518-573839d12180&page=queryresults
[0m18:26:39.089443 [debug] [Thread-27 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10fcb25-7e8e-4f39-abb0-28ffd31ae746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c8d7c0>]}
[0m18:26:39.094883 [info ] [Thread-27 ]: 18 of 19 OK created sql table model stock_analysis.int_all_stock_history ....... [[32mCREATE TABLE (30.4m rows, 14.3 GiB processed)[0m in 1457.00s]
[0m18:26:39.096556 [debug] [Thread-27 ]: Finished running node model.stock_analysis.int_all_stock_history
[0m18:26:39.099714 [debug] [Thread-29 ]: Began running node model.stock_analysis.stock_analysis
[0m18:26:39.100794 [info ] [Thread-29 ]: 19 of 19 SKIP relation stock_analysis.stock_analysis ........................... [[33mSKIP[0m]
[0m18:26:39.101530 [debug] [Thread-29 ]: Finished running node model.stock_analysis.stock_analysis
[0m18:26:39.105492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:39.106187 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m18:26:39.106670 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_info' was properly closed.
[0m18:26:39.106946 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_history' was properly closed.
[0m18:26:39.107184 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_info' was properly closed.
[0m18:26:39.107409 [debug] [MainThread]: Connection 'model.stock_analysis.base_calendar' was properly closed.
[0m18:26:39.107635 [debug] [MainThread]: Connection 'model.stock_analysis.base_symbols_meta' was properly closed.
[0m18:26:39.107842 [debug] [MainThread]: Connection 'model.stock_analysis.stg_symbols_meta' was properly closed.
[0m18:26:39.108051 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_others_stock_info' was properly closed.
[0m18:26:39.108270 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m18:26:39.108485 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_nasdaq_stock_info' was properly closed.
[0m18:26:39.108698 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history' was properly closed.
[0m18:26:39.108902 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_info' was properly closed.
[0m18:26:39.109130 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history_base' was properly closed.
[0m18:26:39.109342 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price' was properly closed.
[0m18:26:39.109547 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_monthly_price_movement' was properly closed.
[0m18:26:39.109786 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_weekly_price_movement' was properly closed.
[0m18:26:39.109988 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_yearly_price_movement' was properly closed.
[0m18:26:39.110198 [debug] [MainThread]: Connection 'model.stock_analysis.int_all_stock_history' was properly closed.
[0m18:26:39.110911 [info ] [MainThread]: 
[0m18:26:39.111272 [info ] [MainThread]: Finished running 19 table models in 0 hours 25 minutes and 14.87 seconds (1514.87s).
[0m18:26:39.115022 [debug] [MainThread]: Command end result
[0m18:26:39.279737 [info ] [MainThread]: 
[0m18:26:39.280180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:39.280344 [info ] [MainThread]: 
[0m18:26:39.280558 [error] [MainThread]:   Database Error in model stg_all_stock_info (models/2_staging/stg_all_stock_info.sql)
  Queries in UNION ALL have mismatched column count; query 1 has 135 columns, query 2 has 136 columns at [17:1]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_all_stock_info.sql
[0m18:26:39.280720 [info ] [MainThread]: 
[0m18:26:39.280888 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=1 SKIP=1 TOTAL=19
[0m18:26:39.282833 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1515.9048, "process_user_time": 8.550156, "process_kernel_time": 0.672347, "process_mem_max_rss": "205291520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:26:39.283165 [debug] [MainThread]: Command `dbt run` failed at 18:26:39.283115 after 1515.91 seconds
[0m18:26:39.283397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1358b45b0>]}
[0m18:26:39.283593 [debug] [MainThread]: Flushing usage events
[0m19:42:28.137716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106145910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac0250>]}


============================== 19:42:28.140265 | e59468b1-1a50-4a34-95d7-959acc9374bd ==============================
[0m19:42:28.140265 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:42:28.140548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_all_stock_info', 'send_anonymous_usage_stats': 'True'}
[0m19:42:28.674546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e59468b1-1a50-4a34-95d7-959acc9374bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637e6a0>]}
[0m19:42:28.700465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e59468b1-1a50-4a34-95d7-959acc9374bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2fd0a0>]}
[0m19:42:28.700736 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:42:28.710960 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:42:28.790941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:42:28.791293 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m19:42:28.943245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e59468b1-1a50-4a34-95d7-959acc9374bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150163130>]}
[0m19:42:29.002577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e59468b1-1a50-4a34-95d7-959acc9374bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15031f1f0>]}
[0m19:42:29.002839 [info ] [MainThread]: Found 19 models, 42 sources, 469 macros
[0m19:42:29.003007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e59468b1-1a50-4a34-95d7-959acc9374bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1503216d0>]}
[0m19:42:29.003687 [info ] [MainThread]: 
[0m19:42:29.003956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:42:29.004367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:42:29.004561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:29.463814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:42:29.464517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:29.863532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e59468b1-1a50-4a34-95d7-959acc9374bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15031faf0>]}
[0m19:42:29.863995 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:42:29.864194 [info ] [MainThread]: 
[0m19:42:29.867788 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_stock_info
[0m19:42:29.868155 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_all_stock_info ................. [RUN]
[0m19:42:29.868452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_stock_info)
[0m19:42:29.868671 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_stock_info
[0m19:42:29.891647 [debug] [Thread-1  ]: Compilation Error in model stg_all_stock_info (models/2_staging/stg_all_stock_info.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:42:29.892495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59468b1-1a50-4a34-95d7-959acc9374bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cfa5190>]}
[0m19:42:29.892828 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_all_stock_info ........ [[31mERROR[0m in 0.02s]
[0m19:42:29.893123 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_stock_info
[0m19:42:29.893931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:29.894088 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_info' was properly closed.
[0m19:42:29.894239 [info ] [MainThread]: 
[0m19:42:29.894402 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m19:42:29.894693 [debug] [MainThread]: Command end result
[0m19:42:29.917092 [info ] [MainThread]: 
[0m19:42:29.917293 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:42:29.917427 [info ] [MainThread]: 
[0m19:42:29.917600 [error] [MainThread]:   Compilation Error in model stg_all_stock_info (models/2_staging/stg_all_stock_info.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:42:29.917733 [info ] [MainThread]: 
[0m19:42:29.917872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:42:29.919229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8306466, "process_user_time": 2.448195, "process_kernel_time": 2.023059, "process_mem_max_rss": "196788224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:29.919483 [debug] [MainThread]: Command `dbt run` failed at 19:42:29.919441 after 1.83 seconds
[0m19:42:29.919657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106145910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cae07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c2fd0a0>]}
[0m19:42:29.919822 [debug] [MainThread]: Flushing usage events
[0m19:43:05.255537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf0df0>]}


============================== 19:43:05.257999 | 597a8a47-1af2-4eb9-8f20-ac388f2332e5 ==============================
[0m19:43:05.257999 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:43:05.258297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:43:05.309609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '597a8a47-1af2-4eb9-8f20-ac388f2332e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b2f5b0>]}
[0m19:43:05.319701 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:43:05.320061 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:43:05.320845 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11167412, "process_user_time": 0.630277, "process_kernel_time": 0.073613, "process_mem_max_rss": "87179264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:43:05.321116 [debug] [MainThread]: Command `dbt deps` succeeded at 19:43:05.321071 after 0.11 seconds
[0m19:43:05.321274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110411a00>]}
[0m19:43:05.321434 [debug] [MainThread]: Flushing usage events
[0m19:44:29.558340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044858b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df7ac0>]}


============================== 19:44:29.560816 | 356ca266-e602-4aa3-9f66-0c03a436750b ==============================
[0m19:44:29.560816 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:44:29.561105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:44:29.619329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '356ca266-e602-4aa3-9f66-0c03a436750b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dde5e0>]}
[0m19:44:29.629281 [debug] [MainThread]: Set downloads directory='/var/folders/t6/2qs1j7r1405979mb1k61h8fc0000gn/T/dbt-downloads-9u2z1k9l'
[0m19:44:29.629526 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:44:29.854946 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:44:29.856957 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:44:30.915391 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:44:30.933032 [info ] [MainThread]: Updating lock file in file path: /Users/ahmed/Desktop/dbt/stock_analysis/package-lock.yml
[0m19:44:30.935286 [debug] [MainThread]: Set downloads directory='/var/folders/t6/2qs1j7r1405979mb1k61h8fc0000gn/T/dbt-downloads-c_4cjwsv'
[0m19:44:30.938740 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:44:31.251098 [info ] [MainThread]: Installed from version 1.3.0
[0m19:44:31.251377 [info ] [MainThread]: Up to date!
[0m19:44:31.251597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '356ca266-e602-4aa3-9f66-0c03a436750b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7e310>]}
[0m19:44:31.252909 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.742722, "process_user_time": 0.697914, "process_kernel_time": 0.116456, "process_mem_max_rss": "90767360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:44:31.253259 [debug] [MainThread]: Command `dbt deps` succeeded at 19:44:31.253189 after 1.74 seconds
[0m19:44:31.253491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044858b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea1eb0>]}
[0m19:44:31.253711 [debug] [MainThread]: Flushing usage events
[0m19:44:41.359297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b604c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b602e0>]}


============================== 19:44:41.361323 | e955ed6b-833a-4a0e-92a2-c87e581b9136 ==============================
[0m19:44:41.361323 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:44:41.361613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_all_stock_info', 'send_anonymous_usage_stats': 'True'}
[0m19:44:41.880737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1548a4100>]}
[0m19:44:41.907923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b334c0>]}
[0m19:44:41.908198 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:44:41.921811 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:44:41.974603 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:44:41.974911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105590280>]}
[0m19:44:42.803104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1569c6130>]}
[0m19:44:42.865026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1569e8ac0>]}
[0m19:44:42.865274 [info ] [MainThread]: Found 19 models, 42 sources, 585 macros
[0m19:44:42.865446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156a60550>]}
[0m19:44:42.866117 [info ] [MainThread]: 
[0m19:44:42.866365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:42.866770 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:44:42.866970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:43.288428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:44:43.289095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:43.701601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154d1b610>]}
[0m19:44:43.702210 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:44:43.702452 [info ] [MainThread]: 
[0m19:44:43.706599 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_stock_info
[0m19:44:43.706987 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_all_stock_info ................. [RUN]
[0m19:44:43.707309 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_stock_info)
[0m19:44:43.707561 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_stock_info
[0m19:44:43.761204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:44.319148 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_info"
[0m19:44:44.321205 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_stock_info
[0m19:44:44.350196 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_info"
[0m19:44:44.351324 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_info`
      
    
    

    OPTIONS()
    as (
      -- select * from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`

-- union all

-- select * from `first-project-262802`.`stock_analysis`.`stg_all_others_stock_info`




    

        (
            select
                cast('''`first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`''' as string) as _dbt_source_relation,

                
                    cast(`index` as INT64) as `index` ,
                    cast(`address1` as STRING) as `address1` ,
                    cast(`address2` as STRING) as `address2` ,
                    cast(`city` as STRING) as `city` ,
                    cast(`zip` as STRING) as `zip` ,
                    cast(`country` as STRING) as `country` ,
                    cast(`phone` as STRING) as `phone` ,
                    cast(`fax` as STRING) as `fax` ,
                    cast(`website` as STRING) as `website` ,
                    cast(`industry` as STRING) as `industry` ,
                    cast(`industryKey` as STRING) as `industryKey` ,
                    cast(`industryDisp` as STRING) as `industryDisp` ,
                    cast(`sector` as STRING) as `sector` ,
                    cast(`sectorKey` as STRING) as `sectorKey` ,
                    cast(`sectorDisp` as STRING) as `sectorDisp` ,
                    cast(`longBusinessSummary` as STRING) as `longBusinessSummary` ,
                    cast(`fullTimeEmployees` as FLOAT64) as `fullTimeEmployees` ,
                    cast(`companyOfficers` as STRING) as `companyOfficers` ,
                    cast(`compensationAsOfEpochDate` as FLOAT64) as `compensationAsOfEpochDate` ,
                    cast(`irWebsite` as STRING) as `irWebsite` ,
                    cast(`maxAge` as INT64) as `maxAge` ,
                    cast(`priceHint` as INT64) as `priceHint` ,
                    cast(`previousClose` as FLOAT64) as `previousClose` ,
                    cast(`open_price_from_stock_info` as FLOAT64) as `open_price_from_stock_info` ,
                    cast(`dayLow` as FLOAT64) as `dayLow` ,
                    cast(`dayHigh` as FLOAT64) as `dayHigh` ,
                    cast(`regularMarketPreviousClose` as FLOAT64) as `regularMarketPreviousClose` ,
                    cast(`regularMarketOpen` as FLOAT64) as `regularMarketOpen` ,
                    cast(`regularMarketDayLow` as FLOAT64) as `regularMarketDayLow` ,
                    cast(`regularMarketDayHigh` as FLOAT64) as `regularMarketDayHigh` ,
                    cast(`exDividendDate` as FLOAT64) as `exDividendDate` ,
                    cast(`beta` as FLOAT64) as `beta` ,
                    cast(`forwardPE` as FLOAT64) as `forwardPE` ,
                    cast(`volume_from_stock_info` as FLOAT64) as `volume_from_stock_info` ,
                    cast(`regularMarketVolume` as FLOAT64) as `regularMarketVolume` ,
                    cast(`averageVolume` as FLOAT64) as `averageVolume` ,
                    cast(`averageVolume10days` as FLOAT64) as `averageVolume10days` ,
                    cast(`averageDailyVolume10Day` as FLOAT64) as `averageDailyVolume10Day` ,
                    cast(`marketCap` as FLOAT64) as `marketCap` ,
                    cast(`fiftyTwoWeekLow` as FLOAT64) as `fiftyTwoWeekLow` ,
                    cast(`fiftyTwoWeekHigh` as FLOAT64) as `fiftyTwoWeekHigh` ,
                    cast(`priceToSalesTrailing12Months` as FLOAT64) as `priceToSalesTrailing12Months` ,
                    cast(`fiftyDayAverage` as FLOAT64) as `fiftyDayAverage` ,
                    cast(`twoHundredDayAverage` as FLOAT64) as `twoHundredDayAverage` ,
                    cast(`currency` as STRING) as `currency` ,
                    cast(`enterpriseValue` as FLOAT64) as `enterpriseValue` ,
                    cast(`profitMargins` as FLOAT64) as `profitMargins` ,
                    cast(`floatShares` as FLOAT64) as `floatShares` ,
                    cast(`sharesOutstanding` as FLOAT64) as `sharesOutstanding` ,
                    cast(`sharesShort` as FLOAT64) as `sharesShort` ,
                    cast(`sharesShortPriorMonth` as FLOAT64) as `sharesShortPriorMonth` ,
                    cast(`sharesShortPreviousMonthDate` as FLOAT64) as `sharesShortPreviousMonthDate` ,
                    cast(`dateShortInterest` as FLOAT64) as `dateShortInterest` ,
                    cast(`heldPercentInsiders` as FLOAT64) as `heldPercentInsiders` ,
                    cast(`heldPercentInstitutions` as FLOAT64) as `heldPercentInstitutions` ,
                    cast(`shortRatio` as FLOAT64) as `shortRatio` ,
                    cast(`shortPercentOfFloat` as FLOAT64) as `shortPercentOfFloat` ,
                    cast(`impliedSharesOutstanding` as FLOAT64) as `impliedSharesOutstanding` ,
                    cast(`bookValue` as FLOAT64) as `bookValue` ,
                    cast(`priceToBook` as FLOAT64) as `priceToBook` ,
                    cast(`lastFiscalYearEnd` as FLOAT64) as `lastFiscalYearEnd` ,
                    cast(`nextFiscalYearEnd` as FLOAT64) as `nextFiscalYearEnd` ,
                    cast(`mostRecentQuarter` as FLOAT64) as `mostRecentQuarter` ,
                    cast(`netIncomeToCommon` as FLOAT64) as `netIncomeToCommon` ,
                    cast(`trailingEps` as FLOAT64) as `trailingEps` ,
                    cast(`forwardEps` as FLOAT64) as `forwardEps` ,
                    cast(`enterpriseToRevenue` as FLOAT64) as `enterpriseToRevenue` ,
                    cast(`enterpriseToEbitda` as FLOAT64) as `enterpriseToEbitda` ,
                    cast(`lastDividendValue` as FLOAT64) as `lastDividendValue` ,
                    cast(`lastDividendDate` as FLOAT64) as `lastDividendDate` ,
                    cast(`exchange` as STRING) as `exchange` ,
                    cast(`quoteType` as STRING) as `quoteType` ,
                    cast(`symbol` as STRING) as `symbol` ,
                    cast(`underlyingSymbol` as STRING) as `underlyingSymbol` ,
                    cast(`shortName` as STRING) as `shortName` ,
                    cast(`longName` as STRING) as `longName` ,
                    cast(`firstTradeDateEpochUtc` as FLOAT64) as `firstTradeDateEpochUtc` ,
                    cast(`timeZoneFullName` as STRING) as `timeZoneFullName` ,
                    cast(`timeZoneShortName` as STRING) as `timeZoneShortName` ,
                    cast(`uuid` as STRING) as `uuid` ,
                    cast(`messageBoardId` as STRING) as `messageBoardId` ,
                    cast(`gmtOffSetMilliseconds` as INT64) as `gmtOffSetMilliseconds` ,
                    cast(`currentPrice` as FLOAT64) as `currentPrice` ,
                    cast(`recommendationMean` as FLOAT64) as `recommendationMean` ,
                    cast(`recommendationKey` as STRING) as `recommendationKey` ,
                    cast(`totalCash` as FLOAT64) as `totalCash` ,
                    cast(`totalCashPerShare` as FLOAT64) as `totalCashPerShare` ,
                    cast(`ebitda` as FLOAT64) as `ebitda` ,
                    cast(`totalDebt` as FLOAT64) as `totalDebt` ,
                    cast(`quickRatio` as FLOAT64) as `quickRatio` ,
                    cast(`currentRatio` as FLOAT64) as `currentRatio` ,
                    cast(`totalRevenue` as FLOAT64) as `totalRevenue` ,
                    cast(`debtToEquity` as FLOAT64) as `debtToEquity` ,
                    cast(`revenuePerShare` as FLOAT64) as `revenuePerShare` ,
                    cast(`returnOnAssets` as FLOAT64) as `returnOnAssets` ,
                    cast(`returnOnEquity` as FLOAT64) as `returnOnEquity` ,
                    cast(`revenueGrowth` as FLOAT64) as `revenueGrowth` ,
                    cast(`grossMargins` as FLOAT64) as `grossMargins` ,
                    cast(`ebitdaMargins` as FLOAT64) as `ebitdaMargins` ,
                    cast(`operatingMargins` as FLOAT64) as `operatingMargins` ,
                    cast(`financialCurrency` as STRING) as `financialCurrency` ,
                    cast(`trailingPegRatio` as FLOAT64) as `trailingPegRatio` ,
                    cast(`state` as STRING) as `state` ,
                    cast(`auditRisk` as FLOAT64) as `auditRisk` ,
                    cast(`boardRisk` as FLOAT64) as `boardRisk` ,
                    cast(`compensationRisk` as FLOAT64) as `compensationRisk` ,
                    cast(`shareHolderRightsRisk` as FLOAT64) as `shareHolderRightsRisk` ,
                    cast(`overallRisk` as FLOAT64) as `overallRisk` ,
                    cast(`governanceEpochDate` as FLOAT64) as `governanceEpochDate` ,
                    cast(`bid` as FLOAT64) as `bid` ,
                    cast(`ask` as FLOAT64) as `ask` ,
                    cast(`bidSize` as FLOAT64) as `bidSize` ,
                    cast(`askSize` as FLOAT64) as `askSize` ,
                    cast(`sharesPercentSharesOut` as FLOAT64) as `sharesPercentSharesOut` ,
                    cast(`lastSplitFactor` as STRING) as `lastSplitFactor` ,
                    cast(`lastSplitDate` as FLOAT64) as `lastSplitDate` ,
                    cast(`targetHighPrice` as FLOAT64) as `targetHighPrice` ,
                    cast(`targetLowPrice` as FLOAT64) as `targetLowPrice` ,
                    cast(`targetMeanPrice` as FLOAT64) as `targetMeanPrice` ,
                    cast(`targetMedianPrice` as FLOAT64) as `targetMedianPrice` ,
                    cast(`numberOfAnalystOpinions` as FLOAT64) as `numberOfAnalystOpinions` ,
                    cast(`freeCashflow` as FLOAT64) as `freeCashflow` ,
                    cast(`operatingCashflow` as FLOAT64) as `operatingCashflow` ,
                    cast(`fiveYearAvgDividendYield` as FLOAT64) as `fiveYearAvgDividendYield` ,
                    cast(`earningsQuarterlyGrowth` as FLOAT64) as `earningsQuarterlyGrowth` ,
                    cast(`pegRatio` as FLOAT64) as `pegRatio` ,
                    cast(`earningsGrowth` as FLOAT64) as `earningsGrowth` ,
                    cast(`dividendRate` as FLOAT64) as `dividendRate` ,
                    cast(`dividendYield` as FLOAT64) as `dividendYield` ,
                    cast(`payoutRatio` as FLOAT64) as `payoutRatio` ,
                    cast(`trailingAnnualDividendRate` as FLOAT64) as `trailingAnnualDividendRate` ,
                    cast(`trailingAnnualDividendYield` as FLOAT64) as `trailingAnnualDividendYield` ,
                    cast(`trailingPE` as FLOAT64) as `trailingPE` ,
                    cast(`grossProfits` as STRING) as `grossProfits` ,
                    cast(`ETL_Date` as DATE) as `ETL_Date` ,
                    cast(null as STRING) as `industrySymbol` 

            from `first-project-262802`.`stock_analysis`.`stg_all_nasdaq_stock_info`

            
        )

        union all
        

        (
            select
                cast('''`first-project-262802`.`stock_analysis`.`stg_all_others_stock_info`''' as string) as _dbt_source_relation,

                
                    cast(`index` as INT64) as `index` ,
                    cast(`address1` as STRING) as `address1` ,
                    cast(`address2` as STRING) as `address2` ,
                    cast(`city` as STRING) as `city` ,
                    cast(`zip` as STRING) as `zip` ,
                    cast(`country` as STRING) as `country` ,
                    cast(`phone` as STRING) as `phone` ,
                    cast(`fax` as STRING) as `fax` ,
                    cast(`website` as STRING) as `website` ,
                    cast(`industry` as STRING) as `industry` ,
                    cast(`industryKey` as STRING) as `industryKey` ,
                    cast(`industryDisp` as STRING) as `industryDisp` ,
                    cast(`sector` as STRING) as `sector` ,
                    cast(`sectorKey` as STRING) as `sectorKey` ,
                    cast(`sectorDisp` as STRING) as `sectorDisp` ,
                    cast(`longBusinessSummary` as STRING) as `longBusinessSummary` ,
                    cast(`fullTimeEmployees` as FLOAT64) as `fullTimeEmployees` ,
                    cast(`companyOfficers` as STRING) as `companyOfficers` ,
                    cast(`compensationAsOfEpochDate` as FLOAT64) as `compensationAsOfEpochDate` ,
                    cast(`irWebsite` as STRING) as `irWebsite` ,
                    cast(`maxAge` as INT64) as `maxAge` ,
                    cast(`priceHint` as INT64) as `priceHint` ,
                    cast(`previousClose` as FLOAT64) as `previousClose` ,
                    cast(`open_price_from_stock_info` as FLOAT64) as `open_price_from_stock_info` ,
                    cast(`dayLow` as FLOAT64) as `dayLow` ,
                    cast(`dayHigh` as FLOAT64) as `dayHigh` ,
                    cast(`regularMarketPreviousClose` as FLOAT64) as `regularMarketPreviousClose` ,
                    cast(`regularMarketOpen` as FLOAT64) as `regularMarketOpen` ,
                    cast(`regularMarketDayLow` as FLOAT64) as `regularMarketDayLow` ,
                    cast(`regularMarketDayHigh` as FLOAT64) as `regularMarketDayHigh` ,
                    cast(`exDividendDate` as FLOAT64) as `exDividendDate` ,
                    cast(`beta` as FLOAT64) as `beta` ,
                    cast(`forwardPE` as FLOAT64) as `forwardPE` ,
                    cast(`volume_from_stock_info` as FLOAT64) as `volume_from_stock_info` ,
                    cast(`regularMarketVolume` as FLOAT64) as `regularMarketVolume` ,
                    cast(`averageVolume` as FLOAT64) as `averageVolume` ,
                    cast(`averageVolume10days` as FLOAT64) as `averageVolume10days` ,
                    cast(`averageDailyVolume10Day` as FLOAT64) as `averageDailyVolume10Day` ,
                    cast(`marketCap` as FLOAT64) as `marketCap` ,
                    cast(`fiftyTwoWeekLow` as FLOAT64) as `fiftyTwoWeekLow` ,
                    cast(`fiftyTwoWeekHigh` as FLOAT64) as `fiftyTwoWeekHigh` ,
                    cast(`priceToSalesTrailing12Months` as FLOAT64) as `priceToSalesTrailing12Months` ,
                    cast(`fiftyDayAverage` as FLOAT64) as `fiftyDayAverage` ,
                    cast(`twoHundredDayAverage` as FLOAT64) as `twoHundredDayAverage` ,
                    cast(`currency` as STRING) as `currency` ,
                    cast(`enterpriseValue` as FLOAT64) as `enterpriseValue` ,
                    cast(`profitMargins` as FLOAT64) as `profitMargins` ,
                    cast(`floatShares` as FLOAT64) as `floatShares` ,
                    cast(`sharesOutstanding` as FLOAT64) as `sharesOutstanding` ,
                    cast(`sharesShort` as FLOAT64) as `sharesShort` ,
                    cast(`sharesShortPriorMonth` as FLOAT64) as `sharesShortPriorMonth` ,
                    cast(`sharesShortPreviousMonthDate` as FLOAT64) as `sharesShortPreviousMonthDate` ,
                    cast(`dateShortInterest` as FLOAT64) as `dateShortInterest` ,
                    cast(`heldPercentInsiders` as FLOAT64) as `heldPercentInsiders` ,
                    cast(`heldPercentInstitutions` as FLOAT64) as `heldPercentInstitutions` ,
                    cast(`shortRatio` as FLOAT64) as `shortRatio` ,
                    cast(`shortPercentOfFloat` as FLOAT64) as `shortPercentOfFloat` ,
                    cast(`impliedSharesOutstanding` as FLOAT64) as `impliedSharesOutstanding` ,
                    cast(`bookValue` as FLOAT64) as `bookValue` ,
                    cast(`priceToBook` as FLOAT64) as `priceToBook` ,
                    cast(`lastFiscalYearEnd` as FLOAT64) as `lastFiscalYearEnd` ,
                    cast(`nextFiscalYearEnd` as FLOAT64) as `nextFiscalYearEnd` ,
                    cast(`mostRecentQuarter` as FLOAT64) as `mostRecentQuarter` ,
                    cast(`netIncomeToCommon` as FLOAT64) as `netIncomeToCommon` ,
                    cast(`trailingEps` as FLOAT64) as `trailingEps` ,
                    cast(`forwardEps` as FLOAT64) as `forwardEps` ,
                    cast(`enterpriseToRevenue` as FLOAT64) as `enterpriseToRevenue` ,
                    cast(`enterpriseToEbitda` as FLOAT64) as `enterpriseToEbitda` ,
                    cast(`lastDividendValue` as FLOAT64) as `lastDividendValue` ,
                    cast(`lastDividendDate` as FLOAT64) as `lastDividendDate` ,
                    cast(`exchange` as STRING) as `exchange` ,
                    cast(`quoteType` as STRING) as `quoteType` ,
                    cast(`symbol` as STRING) as `symbol` ,
                    cast(`underlyingSymbol` as STRING) as `underlyingSymbol` ,
                    cast(`shortName` as STRING) as `shortName` ,
                    cast(`longName` as STRING) as `longName` ,
                    cast(`firstTradeDateEpochUtc` as FLOAT64) as `firstTradeDateEpochUtc` ,
                    cast(`timeZoneFullName` as STRING) as `timeZoneFullName` ,
                    cast(`timeZoneShortName` as STRING) as `timeZoneShortName` ,
                    cast(`uuid` as STRING) as `uuid` ,
                    cast(`messageBoardId` as STRING) as `messageBoardId` ,
                    cast(`gmtOffSetMilliseconds` as INT64) as `gmtOffSetMilliseconds` ,
                    cast(`currentPrice` as FLOAT64) as `currentPrice` ,
                    cast(`recommendationMean` as FLOAT64) as `recommendationMean` ,
                    cast(`recommendationKey` as STRING) as `recommendationKey` ,
                    cast(`totalCash` as FLOAT64) as `totalCash` ,
                    cast(`totalCashPerShare` as FLOAT64) as `totalCashPerShare` ,
                    cast(`ebitda` as FLOAT64) as `ebitda` ,
                    cast(`totalDebt` as FLOAT64) as `totalDebt` ,
                    cast(`quickRatio` as FLOAT64) as `quickRatio` ,
                    cast(`currentRatio` as FLOAT64) as `currentRatio` ,
                    cast(`totalRevenue` as FLOAT64) as `totalRevenue` ,
                    cast(`debtToEquity` as FLOAT64) as `debtToEquity` ,
                    cast(`revenuePerShare` as FLOAT64) as `revenuePerShare` ,
                    cast(`returnOnAssets` as FLOAT64) as `returnOnAssets` ,
                    cast(`returnOnEquity` as FLOAT64) as `returnOnEquity` ,
                    cast(`revenueGrowth` as FLOAT64) as `revenueGrowth` ,
                    cast(`grossMargins` as FLOAT64) as `grossMargins` ,
                    cast(`ebitdaMargins` as FLOAT64) as `ebitdaMargins` ,
                    cast(`operatingMargins` as FLOAT64) as `operatingMargins` ,
                    cast(`financialCurrency` as STRING) as `financialCurrency` ,
                    cast(`trailingPegRatio` as FLOAT64) as `trailingPegRatio` ,
                    cast(`state` as STRING) as `state` ,
                    cast(`auditRisk` as FLOAT64) as `auditRisk` ,
                    cast(`boardRisk` as FLOAT64) as `boardRisk` ,
                    cast(`compensationRisk` as FLOAT64) as `compensationRisk` ,
                    cast(`shareHolderRightsRisk` as FLOAT64) as `shareHolderRightsRisk` ,
                    cast(`overallRisk` as FLOAT64) as `overallRisk` ,
                    cast(`governanceEpochDate` as FLOAT64) as `governanceEpochDate` ,
                    cast(`bid` as FLOAT64) as `bid` ,
                    cast(`ask` as FLOAT64) as `ask` ,
                    cast(`bidSize` as FLOAT64) as `bidSize` ,
                    cast(`askSize` as FLOAT64) as `askSize` ,
                    cast(`sharesPercentSharesOut` as FLOAT64) as `sharesPercentSharesOut` ,
                    cast(`lastSplitFactor` as STRING) as `lastSplitFactor` ,
                    cast(`lastSplitDate` as FLOAT64) as `lastSplitDate` ,
                    cast(`targetHighPrice` as FLOAT64) as `targetHighPrice` ,
                    cast(`targetLowPrice` as FLOAT64) as `targetLowPrice` ,
                    cast(`targetMeanPrice` as FLOAT64) as `targetMeanPrice` ,
                    cast(`targetMedianPrice` as FLOAT64) as `targetMedianPrice` ,
                    cast(`numberOfAnalystOpinions` as FLOAT64) as `numberOfAnalystOpinions` ,
                    cast(`freeCashflow` as FLOAT64) as `freeCashflow` ,
                    cast(`operatingCashflow` as FLOAT64) as `operatingCashflow` ,
                    cast(`fiveYearAvgDividendYield` as FLOAT64) as `fiveYearAvgDividendYield` ,
                    cast(`earningsQuarterlyGrowth` as FLOAT64) as `earningsQuarterlyGrowth` ,
                    cast(`pegRatio` as FLOAT64) as `pegRatio` ,
                    cast(`earningsGrowth` as FLOAT64) as `earningsGrowth` ,
                    cast(`dividendRate` as FLOAT64) as `dividendRate` ,
                    cast(`dividendYield` as FLOAT64) as `dividendYield` ,
                    cast(`payoutRatio` as FLOAT64) as `payoutRatio` ,
                    cast(`trailingAnnualDividendRate` as FLOAT64) as `trailingAnnualDividendRate` ,
                    cast(`trailingAnnualDividendYield` as FLOAT64) as `trailingAnnualDividendYield` ,
                    cast(`trailingPE` as FLOAT64) as `trailingPE` ,
                    cast(`grossProfits` as STRING) as `grossProfits` ,
                    cast(`ETL_Date` as DATE) as `ETL_Date` ,
                    cast(`industrySymbol` as STRING) as `industrySymbol` 

            from `first-project-262802`.`stock_analysis`.`stg_all_others_stock_info`

            
        )

        
    );
  
[0m19:44:45.019553 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1d74fb28-2888-49e8-a91f-b38d85840eaa&page=queryresults
[0m19:44:48.095152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e955ed6b-833a-4a0e-92a2-c87e581b9136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156bb29a0>]}
[0m19:44:48.095873 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_all_stock_info ............ [[32mCREATE TABLE (6.4k rows, 13.5 MiB processed)[0m in 4.39s]
[0m19:44:48.096408 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_stock_info
[0m19:44:48.097852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:48.098122 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_info' was properly closed.
[0m19:44:48.098361 [info ] [MainThread]: 
[0m19:44:48.098614 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m19:44:48.099138 [debug] [MainThread]: Command end result
[0m19:44:48.133101 [info ] [MainThread]: 
[0m19:44:48.133366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:44:48.133531 [info ] [MainThread]: 
[0m19:44:48.133699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:44:48.135002 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.822863, "process_user_time": 5.129143, "process_kernel_time": 0.196511, "process_mem_max_rss": "205602816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:44:48.135291 [debug] [MainThread]: Command `dbt run` succeeded at 19:44:48.135241 after 6.82 seconds
[0m19:44:48.135488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1568865e0>]}
[0m19:44:48.135669 [debug] [MainThread]: Flushing usage events
[0m19:45:35.851880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106218430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106218250>]}


============================== 19:45:35.854317 | e1122850-1cb8-41d8-a883-aff54871911c ==============================
[0m19:45:35.854317 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:45:35.854600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:45:36.369235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1122850-1cb8-41d8-a883-aff54871911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306c94c0>]}
[0m19:45:36.396162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1122850-1cb8-41d8-a883-aff54871911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dc7f0>]}
[0m19:45:36.396455 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:45:36.409881 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:45:36.493367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:45:36.493711 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m19:45:36.657739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1122850-1cb8-41d8-a883-aff54871911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316a2fd0>]}
[0m19:45:36.721537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1122850-1cb8-41d8-a883-aff54871911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316a2490>]}
[0m19:45:36.721799 [info ] [MainThread]: Found 19 models, 42 sources, 585 macros
[0m19:45:36.721968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1122850-1cb8-41d8-a883-aff54871911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316abac0>]}
[0m19:45:36.722839 [info ] [MainThread]: 
[0m19:45:36.723099 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:45:36.725806 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:45:36.726001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:37.146697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:45:37.147691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:37.548297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1122850-1cb8-41d8-a883-aff54871911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131072880>]}
[0m19:45:37.548914 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:45:37.549211 [info ] [MainThread]: 
[0m19:45:37.553806 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:45:37.554163 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:45:37.554933 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_all_others_stock_history
[0m19:45:37.554656 [info ] [Thread-1  ]: 1 of 19 START sql table model stock_analysis.base_all_nasdaq_stock_history ..... [RUN]
[0m19:45:37.555312 [debug] [Thread-4  ]: Began running node model.stock_analysis.base_all_others_stock_info
[0m19:45:37.555663 [info ] [Thread-2  ]: 2 of 19 START sql table model stock_analysis.base_all_nasdaq_stock_info ........ [RUN]
[0m19:45:37.555994 [debug] [Thread-5  ]: Began running node model.stock_analysis.base_calendar
[0m19:45:37.556265 [debug] [Thread-6  ]: Began running node model.stock_analysis.base_symbols_meta
[0m19:45:37.556643 [info ] [Thread-3  ]: 3 of 19 START sql table model stock_analysis.base_all_others_stock_history ..... [RUN]
[0m19:45:37.556998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m19:45:37.557363 [info ] [Thread-4  ]: 4 of 19 START sql table model stock_analysis.base_all_others_stock_info ........ [RUN]
[0m19:45:37.557767 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_nasdaq_stock_info'
[0m19:45:37.558121 [info ] [Thread-5  ]: 5 of 19 START sql table model stock_analysis.base_calendar ..................... [RUN]
[0m19:45:37.558494 [info ] [Thread-6  ]: 6 of 19 START sql table model stock_analysis.base_symbols_meta ................. [RUN]
[0m19:45:37.558864 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_others_stock_history'
[0m19:45:37.559131 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:45:37.559465 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_others_stock_info'
[0m19:45:37.559728 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:45:37.560041 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.base_calendar'
[0m19:45:37.560337 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.base_symbols_meta'
[0m19:45:37.560567 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_all_others_stock_history
[0m19:45:37.566252 [debug] [Thread-4  ]: Began compiling node model.stock_analysis.base_all_others_stock_info
[0m19:45:37.569262 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m19:45:37.569589 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.base_calendar
[0m19:45:37.571607 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:45:37.571843 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.base_symbols_meta
[0m19:45:37.574110 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_history"
[0m19:45:37.576612 [debug] [Thread-4  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_info"
[0m19:45:37.579006 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m19:45:37.581339 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.base_symbols_meta"
[0m19:45:37.581617 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_info
[0m19:45:37.581974 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:45:37.588517 [debug] [Thread-5  ]: Began executing node model.stock_analysis.base_calendar
[0m19:45:37.588760 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_all_others_stock_history
[0m19:45:37.588954 [debug] [Thread-4  ]: Began executing node model.stock_analysis.base_all_others_stock_info
[0m19:45:37.593758 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:45:37.595697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:37.597618 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m19:45:37.597829 [debug] [Thread-6  ]: Began executing node model.stock_analysis.base_symbols_meta
[0m19:45:37.599692 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:45:37.601459 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:45:37.780881 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m19:45:38.313150 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m19:45:38.314338 [debug] [Thread-4  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_info"
[0m19:45:38.315276 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_info"
[0m19:45:38.316158 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:45:38.316756 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_history"
[0m19:45:38.317348 [debug] [Thread-4  ]: On model.stock_analysis.base_all_others_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , city
    , state
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , dividendRate
    , dividendYield
    , exDividendDate
    , payoutRatio
    , fiveYearAvgDividendYield
    , beta
    , trailingPE
    , forwardPE
    , volume as volume_from_stock_info
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , bid
    , ask
    , bidSize
    , askSize
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , sharesPercentSharesOut
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , earningsQuarterlyGrowth
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , pegRatio
    , lastSplitFactor
    , lastSplitDate
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , recommendationMean
    , recommendationKey
    , numberOfAnalystOpinions
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , freeCashflow
    , operatingCashflow
    , earningsGrowth
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , address2
    , industrySymbol
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_others_stock_info`
    );
  
[0m19:45:38.317791 [debug] [Thread-5  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m19:45:38.318576 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date('2024-09-16') as etl_date
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m19:45:38.319581 [debug] [Thread-3  ]: On model.stock_analysis.base_all_others_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date(ETL_Date) as etl_date
from `first-project-262802`.`stock`.`all_others_stock_history`
    );
  
[0m19:45:38.319977 [debug] [Thread-2  ]: On model.stock_analysis.base_all_nasdaq_stock_info: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_info"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_info`
      
    
    

    OPTIONS()
    as (
      select
    -- int64_field_0
    index
    , address1
    , address2
    , city
    , zip
    , country
    , phone
    , fax
    , website
    , industry
    , industryKey
    , industryDisp
    , sector
    , sectorKey
    , sectorDisp
    , longBusinessSummary
    , fullTimeEmployees
    , companyOfficers
    , compensationAsOfEpochDate
    , irWebsite
    , maxAge
    , priceHint
    , previousClose
    , open as open_price_from_stock_info
    , dayLow
    , dayHigh
    , regularMarketPreviousClose
    , regularMarketOpen
    , regularMarketDayLow
    , regularMarketDayHigh
    , exDividendDate
    , beta
    , forwardPE
    , volume as volume_from_stock_info
    , regularMarketVolume
    , averageVolume
    , averageVolume10days
    , averageDailyVolume10Day
    , marketCap
    , fiftyTwoWeekLow
    , fiftyTwoWeekHigh
    , priceToSalesTrailing12Months
    , fiftyDayAverage
    , twoHundredDayAverage
    , currency
    , enterpriseValue
    , profitMargins
    , floatShares
    , sharesOutstanding
    , sharesShort
    , sharesShortPriorMonth
    , sharesShortPreviousMonthDate
    , dateShortInterest
    , heldPercentInsiders
    , heldPercentInstitutions
    , shortRatio
    , shortPercentOfFloat
    , impliedSharesOutstanding
    , bookValue
    , priceToBook
    , lastFiscalYearEnd
    , nextFiscalYearEnd
    , mostRecentQuarter
    , netIncomeToCommon
    , trailingEps
    , forwardEps
    , enterpriseToRevenue
    , enterpriseToEbitda
    -- , 52WeekChange
    -- , SandP52WeekChange
    , lastDividendValue
    , lastDividendDate
    , exchange
    , quoteType
    , symbol
    , underlyingSymbol
    , shortName
    , longName
    , firstTradeDateEpochUtc
    , timeZoneFullName
    , timeZoneShortName
    , uuid
    , messageBoardId
    , gmtOffSetMilliseconds
    , currentPrice
    , recommendationMean
    , recommendationKey
    , totalCash
    , totalCashPerShare
    , ebitda
    , totalDebt
    , quickRatio
    , currentRatio
    , totalRevenue
    , debtToEquity
    , revenuePerShare
    , returnOnAssets
    , returnOnEquity
    , revenueGrowth
    , grossMargins
    , ebitdaMargins
    , operatingMargins
    , financialCurrency
    , trailingPegRatio
    , state
    , auditRisk
    , boardRisk
    , compensationRisk
    , shareHolderRightsRisk
    , overallRisk
    , governanceEpochDate
    , bid
    , ask
    , bidSize
    , askSize
    , sharesPercentSharesOut
    , lastSplitFactor
    , lastSplitDate
    , targetHighPrice
    , targetLowPrice
    , targetMeanPrice
    , targetMedianPrice
    , numberOfAnalystOpinions
    , freeCashflow
    , operatingCashflow
    , fiveYearAvgDividendYield
    , earningsQuarterlyGrowth
    , pegRatio
    , earningsGrowth
    , dividendRate
    , dividendYield
    , payoutRatio
    , trailingAnnualDividendRate
    , trailingAnnualDividendYield
    , trailingPE
    , grossProfits
    , ETL_Date
from `first-project-262802`.`stock`.`all_nasdaq_stock_info`
    );
  
[0m19:45:38.341802 [debug] [Thread-6  ]: Writing runtime sql for node "model.stock_analysis.base_symbols_meta"
[0m19:45:38.342267 [debug] [Thread-6  ]: On model.stock_analysis.base_symbols_meta: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_symbols_meta"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_symbols_meta`
      
    
    

    OPTIONS()
    as (
      select 
    'Nasdaq Traded' as is_nasdaq_traded
    , 'Symbol' as symbol
    , 'Security Name' as security_name
    , 'Listing Exchange' as listing_exchange
    , 'Market Category' as market_category
    , 'ETF' as is_ETF
    , 'Round Lot Size' as round_lot_size
    , 'Test Issue' as is_test_issue
    , 'Financial Status' as financial_status
    , 'CQS Symbol' as cqs_symbol
    , 'NASDAQ Symbol' as nasdaq_symbol
    , 'NextShares' as nextshares
from `first-project-262802`.`stock`.`symbols_valid_meta`
    );
  
[0m19:45:38.679305 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6ba12ba4-f9f8-4117-bc9f-8643fb027f16&page=queryresults
[0m19:45:38.706559 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:db8e340b-6d83-4260-8372-47a159bf0e3f&page=queryresults
[0m19:45:38.707387 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:13a929e9-ed18-4af7-ba3e-cdb3d5eef580&page=queryresults
[0m19:45:38.720515 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:41ba7f2b-f1c6-4672-aa53-3c0654227978&page=queryresults
[0m19:45:38.726503 [debug] [Thread-6  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:28458cb6-df6f-482b-b272-256fdf6b2399&page=queryresults
[0m19:45:39.041451 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3474525e-304b-4081-b4d0-95805bc72e6b&page=queryresults
[0m19:46:19.344970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe81f0>]}


============================== 19:46:19.347542 | 82a3c59f-d3c6-4be3-abdd-8fda3fe81c87 ==============================
[0m19:46:19.347542 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:46:19.347832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stock_analysis.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:46:19.831103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82a3c59f-d3c6-4be3-abdd-8fda3fe81c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131301130>]}
[0m19:46:19.857758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82a3c59f-d3c6-4be3-abdd-8fda3fe81c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c42970>]}
[0m19:46:19.858020 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:46:19.872688 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:46:19.955767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:19.956007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:20.014989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a3c59f-d3c6-4be3-abdd-8fda3fe81c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1319176d0>]}
[0m19:46:20.077079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a3c59f-d3c6-4be3-abdd-8fda3fe81c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132823610>]}
[0m19:46:20.077342 [info ] [MainThread]: Found 19 models, 42 sources, 585 macros
[0m19:46:20.077519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a3c59f-d3c6-4be3-abdd-8fda3fe81c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131bdc0d0>]}
[0m19:46:20.078579 [info ] [MainThread]: 
[0m19:46:20.078840 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:20.079273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:46:20.079464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:20.509990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:46:20.510686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:20.904801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a3c59f-d3c6-4be3-abdd-8fda3fe81c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c182e0>]}
[0m19:46:20.905580 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:46:20.905864 [info ] [MainThread]: 
[0m19:46:20.910486 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m19:46:20.910954 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m19:46:20.911340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m19:46:20.911601 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m19:46:20.920302 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m19:46:20.921621 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m19:46:20.933981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:21.394961 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m19:46:21.396819 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- , symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

, symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_info` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m19:46:21.799373 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:55e32a0b-ab1e-4a4e-a6b3-5cd12f0998c8&page=queryresults
[0m19:46:22.080006 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/55e32a0b-ab1e-4a4e-a6b3-5cd12f0998c8?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name ETL_Date at [13:7]')
[0m19:46:23.327802 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2b4a9097-a15e-4332-ada8-1fae407bd258&page=queryresults
[0m19:46:23.434177 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2b4a9097-a15e-4332-ada8-1fae407bd258&page=queryresults
[0m19:46:23.478628 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  CREATE TABLE has columns with duplicate name ETL_Date at [13:7]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m19:46:23.479916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a3c59f-d3c6-4be3-abdd-8fda3fe81c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d1c400>]}
[0m19:46:23.480366 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 2.57s]
[0m19:46:23.480757 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m19:46:23.481911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:23.482114 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m19:46:23.482300 [info ] [MainThread]: 
[0m19:46:23.482514 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m19:46:23.482923 [debug] [MainThread]: Command end result
[0m19:46:23.511980 [info ] [MainThread]: 
[0m19:46:23.512203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:23.512345 [info ] [MainThread]: 
[0m19:46:23.512530 [error] [MainThread]:   Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  CREATE TABLE has columns with duplicate name ETL_Date at [13:7]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m19:46:23.512669 [info ] [MainThread]: 
[0m19:46:23.512817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:46:23.514063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.216663, "process_user_time": 4.346849, "process_kernel_time": 0.172512, "process_mem_max_rss": "194134016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:23.514365 [debug] [MainThread]: Command `dbt run` failed at 19:46:23.514312 after 4.22 seconds
[0m19:46:23.514570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131301130>]}
[0m19:46:23.514749 [debug] [MainThread]: Flushing usage events
[0m19:47:40.461654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026c5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403edc0>]}


============================== 19:47:40.463723 | 7c39fa3f-09da-45c9-8a2d-123b87385722 ==============================
[0m19:47:40.463723 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:47:40.464017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stock_analysis.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:40.912657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c39fa3f-09da-45c9-8a2d-123b87385722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14920d4c0>]}
[0m19:47:40.939749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c39fa3f-09da-45c9-8a2d-123b87385722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040057f0>]}
[0m19:47:40.940027 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:47:40.953768 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:47:41.038197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:47:41.038599 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m19:47:41.194091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c39fa3f-09da-45c9-8a2d-123b87385722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aa62130>]}
[0m19:47:41.260647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c39fa3f-09da-45c9-8a2d-123b87385722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a8011c0>]}
[0m19:47:41.260949 [info ] [MainThread]: Found 19 models, 42 sources, 585 macros
[0m19:47:41.261125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c39fa3f-09da-45c9-8a2d-123b87385722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aa63640>]}
[0m19:47:41.262250 [info ] [MainThread]: 
[0m19:47:41.262558 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:41.262995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:47:41.263200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:41.712400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:47:41.712964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:42.118049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c39fa3f-09da-45c9-8a2d-123b87385722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a8cadf0>]}
[0m19:47:42.118784 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:47:42.119087 [info ] [MainThread]: 
[0m19:47:42.123574 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m19:47:42.124071 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m19:47:42.124441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m19:47:42.124729 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m19:47:42.132762 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m19:47:42.133292 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m19:47:42.145525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:42.564989 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m19:47:42.565909 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * except (etl_date, ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- , symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

, symbols_meta as ( select * except (etl_date, ETL_Date) from `first-project-262802`.`stock_analysis`.`stg_all_stock_info` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m19:47:43.100046 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8edc843f-d979-49b1-9dbc-7db4adee4927&page=queryresults
[0m19:47:43.299355 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/8edc843f-d979-49b1-9dbc-7db4adee4927?maxResults=0&location=US&prettyPrint=false: Duplicate column ETL_Date in SELECT * EXCEPT list at [15:48]')
[0m19:47:43.816195 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1d5d3d85-bbc5-4b68-8ca3-45ff75820dba&page=queryresults
[0m19:47:43.934628 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1d5d3d85-bbc5-4b68-8ca3-45ff75820dba&page=queryresults
[0m19:47:43.977001 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  Duplicate column ETL_Date in SELECT * EXCEPT list at [15:48]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m19:47:43.978268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c39fa3f-09da-45c9-8a2d-123b87385722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14abf04f0>]}
[0m19:47:43.978717 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 1.85s]
[0m19:47:43.979103 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m19:47:43.980246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:43.980453 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m19:47:43.980635 [info ] [MainThread]: 
[0m19:47:43.980830 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m19:47:43.981224 [debug] [MainThread]: Command end result
[0m19:47:44.007405 [info ] [MainThread]: 
[0m19:47:44.007662 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:47:44.007805 [info ] [MainThread]: 
[0m19:47:44.007996 [error] [MainThread]:   Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  Duplicate column ETL_Date in SELECT * EXCEPT list at [15:48]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m19:47:44.008134 [info ] [MainThread]: 
[0m19:47:44.008278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:47:44.009406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5927942, "process_user_time": 4.670899, "process_kernel_time": 0.176163, "process_mem_max_rss": "201949184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:47:44.009663 [debug] [MainThread]: Command `dbt run` failed at 19:47:44.009619 after 3.59 seconds
[0m19:47:44.009842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026c5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029f1a90>]}
[0m19:47:44.010014 [debug] [MainThread]: Flushing usage events
[0m19:48:34.460046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b443d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b441f0>]}


============================== 19:48:34.462622 | 347a6e3e-8922-431d-bbc8-87121381ffe4 ==============================
[0m19:48:34.462622 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:48:34.462924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:48:34.948180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '347a6e3e-8922-431d-bbc8-87121381ffe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12733d130>]}
[0m19:48:34.974796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '347a6e3e-8922-431d-bbc8-87121381ffe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a7a970>]}
[0m19:48:34.975061 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:48:34.988774 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:48:35.069644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:48:35.069979 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m19:48:35.222463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '347a6e3e-8922-431d-bbc8-87121381ffe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f5b130>]}
[0m19:48:35.283060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '347a6e3e-8922-431d-bbc8-87121381ffe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e7bd90>]}
[0m19:48:35.283316 [info ] [MainThread]: Found 19 models, 42 sources, 585 macros
[0m19:48:35.283489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347a6e3e-8922-431d-bbc8-87121381ffe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f53a90>]}
[0m19:48:35.284516 [info ] [MainThread]: 
[0m19:48:35.284770 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:48:35.285193 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:48:35.285389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:35.698274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:48:35.699072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:36.091676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347a6e3e-8922-431d-bbc8-87121381ffe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127bb4460>]}
[0m19:48:36.092295 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:48:36.092559 [info ] [MainThread]: 
[0m19:48:36.096022 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m19:48:36.096460 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m19:48:36.096789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m19:48:36.097034 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m19:48:36.104274 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m19:48:36.104757 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m19:48:36.116093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:48:36.503260 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m19:48:36.504003 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      with

stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- , symbols_meta as ( select * from `first-project-262802`.`stock_analysis`.`stg_symbols_meta` )

, symbols_meta as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`stg_all_stock_info` )

select
    *
from stock_analysis
left join symbols_meta using (symbol)
    );
  
[0m19:48:36.986344 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:70029fd6-f2a4-41cd-938c-2ba58a72a812&page=queryresults
[0m19:48:50.502521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '347a6e3e-8922-431d-bbc8-87121381ffe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127337910>]}
[0m19:48:50.503108 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 12.6 GiB processed)[0m in 14.41s]
[0m19:48:50.503558 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m19:48:50.504795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:50.505033 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m19:48:50.505241 [info ] [MainThread]: 
[0m19:48:50.505464 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.22 seconds (15.22s).
[0m19:48:50.505919 [debug] [MainThread]: Command end result
[0m19:48:50.536422 [info ] [MainThread]: 
[0m19:48:50.536672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:50.536842 [info ] [MainThread]: 
[0m19:48:50.537016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:48:50.538460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.12466, "process_user_time": 4.430191, "process_kernel_time": 0.183817, "process_mem_max_rss": "201277440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:48:50.538754 [debug] [MainThread]: Command `dbt run` succeeded at 19:48:50.538706 after 16.12 seconds
[0m19:48:50.538941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107537f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12733d130>]}
[0m19:48:50.539117 [debug] [MainThread]: Flushing usage events
[0m20:21:02.811898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10245d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd8250>]}


============================== 20:21:02.814482 | 78398c2c-64ba-4a8b-ab5f-50c125c8da09 ==============================
[0m20:21:02.814482 [info ] [MainThread]: Running with dbt=1.8.2
[0m20:21:02.814784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_all_stock_weekly_price_movement stg_all_stock_monthly_price_movement stg_all_stock_yearly_price_movement int_all_stock_history', 'send_anonymous_usage_stats': 'True'}
[0m20:21:03.344319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f4494c0>]}
[0m20:21:03.371509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9e7f0>]}
[0m20:21:03.371793 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m20:21:03.385671 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m20:21:03.469261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:21:03.469606 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_stock_monthly_price_movement.sql
[0m20:21:03.469799 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_stock_weekly_price_movement.sql
[0m20:21:03.469976 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_all_stock_yearly_price_movement.sql
[0m20:21:03.625836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12832b130>]}
[0m20:21:03.688332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128313070>]}
[0m20:21:03.688591 [info ] [MainThread]: Found 19 models, 42 sources, 585 macros
[0m20:21:03.688766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12832c5e0>]}
[0m20:21:03.689684 [info ] [MainThread]: 
[0m20:21:03.689954 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:21:03.692160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m20:21:03.692360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:04.125090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m20:21:04.126275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:04.621372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026da640>]}
[0m20:21:04.622233 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m20:21:04.622516 [info ] [MainThread]: 
[0m20:21:04.627359 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m20:21:04.627691 [debug] [Thread-2  ]: Began running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m20:21:04.628101 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.stg_all_stock_monthly_price_movement  [RUN]
[0m20:21:04.628434 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m20:21:04.628785 [info ] [Thread-2  ]: 2 of 4 START sql table model stock_analysis.stg_all_stock_weekly_price_movement  [RUN]
[0m20:21:04.629125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_stock_monthly_price_movement)
[0m20:21:04.629431 [info ] [Thread-3  ]: 3 of 4 START sql table model stock_analysis.stg_all_stock_yearly_price_movement  [RUN]
[0m20:21:04.629762 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_weekly_price_movement'
[0m20:21:04.629988 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m20:21:04.630272 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_yearly_price_movement'
[0m20:21:04.630493 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m20:21:04.637333 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_monthly_price_movement"
[0m20:21:04.637549 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m20:21:04.639772 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_weekly_price_movement"
[0m20:21:04.641118 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m20:21:04.641422 [debug] [Thread-2  ]: Began executing node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m20:21:04.649878 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_yearly_price_movement"
[0m20:21:04.654188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:21:04.656107 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:21:04.778279 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m20:21:04.783160 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:21:05.276534 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_weekly_price_movement"
[0m20:21:05.278327 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_monthly_price_movement"
[0m20:21:05.279231 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_stock_monthly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_monthly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_month using (year_full, month_number, symbol)

select distinct * from daily_price_movement_in_month
    );
  
[0m20:21:05.279685 [debug] [Thread-2  ]: On model.stock_analysis.stg_all_stock_weekly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_weekly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_week using (year_full, week_number, symbol)

select distinct * from daily_price_movement_in_week
    );
  
[0m20:21:05.359185 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_yearly_price_movement"
[0m20:21:05.360023 [debug] [Thread-3  ]: On model.stock_analysis.stg_all_stock_yearly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_yearly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)









-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_year using (year_full, symbol)

select distinct * from daily_price_movement_in_year
    );
  
[0m20:21:05.687404 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1af9d267-26db-4d4f-b0f6-cdab7568e3be&page=queryresults
[0m20:21:05.698564 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:403193de-cda3-4ff2-b7a7-60e56a329a5d&page=queryresults
[0m20:21:05.792806 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:de74070e-dbf0-4472-b436-8033be036299&page=queryresults
[0m20:21:12.558074 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284886d0>]}
[0m20:21:12.558837 [info ] [Thread-3  ]: 3 of 4 OK created sql table model stock_analysis.stg_all_stock_yearly_price_movement  [[32mCREATE TABLE (128.5k rows, 1.1 GiB processed)[0m in 7.93s]
[0m20:21:12.559370 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m20:21:13.538216 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12847cd00>]}
[0m20:21:13.540528 [info ] [Thread-2  ]: 2 of 4 OK created sql table model stock_analysis.stg_all_stock_weekly_price_movement  [[32mCREATE TABLE (6.4m rows, 1.2 GiB processed)[0m in 8.91s]
[0m20:21:13.541752 [debug] [Thread-2  ]: Finished running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m20:21:16.236034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12847ce20>]}
[0m20:21:16.237904 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.stg_all_stock_monthly_price_movement  [[32mCREATE TABLE (1.5m rows, 1.3 GiB processed)[0m in 11.61s]
[0m20:21:16.239064 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m20:21:16.240277 [debug] [Thread-5  ]: Began running node model.stock_analysis.int_all_stock_history
[0m20:21:16.240987 [info ] [Thread-5  ]: 4 of 4 START sql table model stock_analysis.int_all_stock_history .............. [RUN]
[0m20:21:16.241573 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.int_all_stock_history'
[0m20:21:16.241903 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.int_all_stock_history
[0m20:21:16.247879 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.int_all_stock_history"
[0m20:21:16.249926 [debug] [Thread-5  ]: Began executing node model.stock_analysis.int_all_stock_history
[0m20:21:16.252839 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m20:21:16.626936 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.int_all_stock_history"
[0m20:21:16.630286 [debug] [Thread-5  ]: On model.stock_analysis.int_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_all_stock_history`
      
    
    

    OPTIONS()
    as (
      with 

all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

, all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

, all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

, all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



select
    distinct *
from all_stock_history_weekly_monthly_yearly_price
left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
left join all_stock_yearly_price_movement using (year_full, symbol)
    );
  
[0m20:21:17.051652 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:32857c68-6c3d-4f09-b3c2-ccde9bd8d3c8&page=queryresults
[0m20:21:37.098236 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78398c2c-64ba-4a8b-ab5f-50c125c8da09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12847cb50>]}
[0m20:21:37.099700 [info ] [Thread-5  ]: 4 of 4 OK created sql table model stock_analysis.int_all_stock_history ......... [[32mCREATE TABLE (30.4m rows, 11.7 GiB processed)[0m in 20.86s]
[0m20:21:37.100627 [debug] [Thread-5  ]: Finished running node model.stock_analysis.int_all_stock_history
[0m20:21:37.103185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:37.103582 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_monthly_price_movement' was properly closed.
[0m20:21:37.103871 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_weekly_price_movement' was properly closed.
[0m20:21:37.104132 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_yearly_price_movement' was properly closed.
[0m20:21:37.104389 [debug] [MainThread]: Connection 'model.stock_analysis.int_all_stock_history' was properly closed.
[0m20:21:37.104789 [info ] [MainThread]: 
[0m20:21:37.105156 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 33.41 seconds (33.41s).
[0m20:21:37.106399 [debug] [MainThread]: Command end result
[0m20:21:37.146124 [info ] [MainThread]: 
[0m20:21:37.146439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:21:37.146631 [info ] [MainThread]: 
[0m20:21:37.146821 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:21:37.148568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 34.387344, "process_user_time": 3.664809, "process_kernel_time": 1.394868, "process_mem_max_rss": "205504512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:21:37.148906 [debug] [MainThread]: Command `dbt run` succeeded at 20:21:37.148850 after 34.39 seconds
[0m20:21:37.149128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10245d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284477c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9e7f0>]}
[0m20:21:37.149344 [debug] [MainThread]: Flushing usage events
[0m19:43:06.932316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105943ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105943e80>]}


============================== 19:43:06.935676 | 08ca309e-44db-46de-a356-f3467d4cedf6 ==============================
[0m19:43:06.935676 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:43:06.936008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:07.706297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f30a0>]}
[0m19:43:07.733445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f78c400>]}
[0m19:43:07.733763 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:43:07.748630 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:43:07.836987 [debug] [MainThread]: Partial parsing enabled: 7 files deleted, 0 files added, 3 files changed.
[0m19:43:07.837873 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/sources.yml
[0m19:43:07.838033 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_symbols_meta.sql
[0m19:43:07.838167 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_stock_info.sql
[0m19:43:07.838300 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_nasdaq_stock_info.sql
[0m19:43:07.838435 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/2_staging/stg_all_others_stock_info.sql
[0m19:43:07.838560 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_all_others_stock_info.sql
[0m19:43:07.838688 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_symbols_meta.sql
[0m19:43:07.838813 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/1_base/base_all_nasdaq_stock_info.sql
[0m19:43:07.838964 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/3_intermediary/int_all_stock_history.sql
[0m19:43:07.839115 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m19:43:08.056645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12887eeb0>]}
[0m19:43:08.115185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043172b0>]}
[0m19:43:08.115456 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m19:43:08.115641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12876a8e0>]}
[0m19:43:08.116456 [info ] [MainThread]: 
[0m19:43:08.116728 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:43:08.119205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:43:08.119410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:08.571899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:43:08.573102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:08.996452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1281c7a30>]}
[0m19:43:08.997183 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:43:08.997450 [info ] [MainThread]: 
[0m19:43:09.002022 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:43:09.002340 [debug] [Thread-2  ]: Began running node model.stock_analysis.base_all_others_stock_history
[0m19:43:09.002774 [info ] [Thread-1  ]: 1 of 12 START sql table model stock_analysis.base_all_nasdaq_stock_history ..... [RUN]
[0m19:43:09.003114 [debug] [Thread-3  ]: Began running node model.stock_analysis.base_calendar
[0m19:43:09.003482 [info ] [Thread-2  ]: 2 of 12 START sql table model stock_analysis.base_all_others_stock_history ..... [RUN]
[0m19:43:09.003899 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_all_nasdaq_stock_history)
[0m19:43:09.004282 [info ] [Thread-3  ]: 3 of 12 START sql table model stock_analysis.base_calendar ..................... [RUN]
[0m19:43:09.004656 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.stock_analysis.base_all_others_stock_history'
[0m19:43:09.004921 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:43:09.005218 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.base_calendar'
[0m19:43:09.005454 [debug] [Thread-2  ]: Began compiling node model.stock_analysis.base_all_others_stock_history
[0m19:43:09.012462 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:43:09.012733 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.base_calendar
[0m19:43:09.015065 [debug] [Thread-2  ]: Writing injected SQL for node "model.stock_analysis.base_all_others_stock_history"
[0m19:43:09.019052 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m19:43:09.019507 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:43:09.019767 [debug] [Thread-2  ]: Began executing node model.stock_analysis.base_all_others_stock_history
[0m19:43:09.037305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:43:09.037623 [debug] [Thread-3  ]: Began executing node model.stock_analysis.base_calendar
[0m19:43:09.038037 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:43:09.039710 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:43:09.547008 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_all_nasdaq_stock_history"
[0m19:43:09.547374 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m19:43:09.549279 [debug] [Thread-2  ]: Writing runtime sql for node "model.stock_analysis.base_all_others_stock_history"
[0m19:43:09.551736 [debug] [Thread-1  ]: On model.stock_analysis.base_all_nasdaq_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date('2024-09-16') as etl_date
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m19:43:09.552139 [debug] [Thread-3  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m19:43:09.553152 [debug] [Thread-2  ]: On model.stock_analysis.base_all_others_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date(ETL_Date) as etl_date
from `first-project-262802`.`stock`.`all_others_stock_history`
    );
  
[0m19:43:09.875801 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7354d71d-cb3c-4c5f-9fa6-67b31936fc77&page=queryresults
[0m19:43:09.877742 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_nasdaq_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date('2024-09-16') as etl_date
from `first-project-262802`.`stock`.`all_nasdaq_stock_history`
    );
  
[0m19:43:09.879614 [debug] [Thread-1  ]: BigQuery adapter: 404 Not found: Table first-project-262802:stock.all_nasdaq_stock_history was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.all_nasdaq_stock_history was not found in location US

Location: US
Job ID: 7354d71d-cb3c-4c5f-9fa6-67b31936fc77

[0m19:43:09.887763 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:090e85aa-8078-4a47-a687-ffdc5f2c0251&page=queryresults
[0m19:43:09.888302 [debug] [Thread-2  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_all_others_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
      
    
    

    OPTIONS()
    as (
      select	
    -- int64_field_0
    Date as date
    , Open as open
    , High as high
    , Low as low
    , Close as close_last
    , 'Adj Close' as adj_close
    , Volume as volume
    , Symbol as symbol
    , date(ETL_Date) as etl_date
from `first-project-262802`.`stock`.`all_others_stock_history`
    );
  
[0m19:43:09.888737 [debug] [Thread-2  ]: BigQuery adapter: 404 Not found: Table first-project-262802:stock.all_others_stock_history was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.all_others_stock_history was not found in location US

Location: US
Job ID: 090e85aa-8078-4a47-a687-ffdc5f2c0251

[0m19:43:09.940896 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5a5ee899-6cad-4d1d-9175-e51059b39252&page=queryresults
[0m19:43:09.942129 [debug] [Thread-1  ]: Runtime Error in model base_all_nasdaq_stock_history (models/1_base/base_all_nasdaq_stock_history.sql)
  404 Not found: Table first-project-262802:stock.all_nasdaq_stock_history was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.all_nasdaq_stock_history was not found in location US
  
  Location: US
  Job ID: 7354d71d-cb3c-4c5f-9fa6-67b31936fc77
  
[0m19:43:09.943160 [debug] [Thread-2  ]: Runtime Error in model base_all_others_stock_history (models/1_base/base_all_others_stock_history.sql)
  404 Not found: Table first-project-262802:stock.all_others_stock_history was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.all_others_stock_history was not found in location US
  
  Location: US
  Job ID: 090e85aa-8078-4a47-a687-ffdc5f2c0251
  
[0m19:43:09.943848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12897fa90>]}
[0m19:43:09.944086 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12898a6d0>]}
[0m19:43:09.944683 [error] [Thread-1  ]: 1 of 12 ERROR creating sql table model stock_analysis.base_all_nasdaq_stock_history  [[31mERROR[0m in 0.94s]
[0m19:43:09.945485 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_all_nasdaq_stock_history
[0m19:43:09.945066 [error] [Thread-2  ]: 2 of 12 ERROR creating sql table model stock_analysis.base_all_others_stock_history  [[31mERROR[0m in 0.94s]
[0m19:43:09.945937 [debug] [Thread-2  ]: Finished running node model.stock_analysis.base_all_others_stock_history
[0m19:43:09.946255 [debug] [Thread-5  ]: Began running node model.stock_analysis.stg_all_stock_history
[0m19:43:09.946497 [info ] [Thread-5  ]: 4 of 12 SKIP relation stock_analysis.stg_all_stock_history ..................... [[33mSKIP[0m]
[0m19:43:09.946728 [debug] [Thread-5  ]: Finished running node model.stock_analysis.stg_all_stock_history
[0m19:43:13.258524 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12897ffa0>]}
[0m19:43:13.259468 [info ] [Thread-3  ]: 3 of 12 OK created sql table model stock_analysis.base_calendar ................ [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.25s]
[0m19:43:13.260040 [debug] [Thread-3  ]: Finished running node model.stock_analysis.base_calendar
[0m19:43:13.260764 [debug] [Thread-7  ]: Began running node model.stock_analysis.stg_calendar
[0m19:43:13.261343 [info ] [Thread-7  ]: 5 of 12 START sql table model stock_analysis.stg_calendar ...................... [RUN]
[0m19:43:13.261816 [debug] [Thread-7  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_calendar'
[0m19:43:13.262372 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.stg_calendar
[0m19:43:13.266161 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m19:43:13.267872 [debug] [Thread-7  ]: Began executing node model.stock_analysis.stg_calendar
[0m19:43:13.270794 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m19:43:13.652398 [debug] [Thread-7  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m19:43:13.655705 [debug] [Thread-7  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , concat(base.year_full,'-',base.week_number) as year_week
    , concat(base.year_full,'-',base.month_abbrev,'-',base.week_number) as year_month_week
    , concat(base.year_full,'-',base.month_abbrev) as year_month

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m19:43:14.035477 [debug] [Thread-7  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5656291f-0f7f-4a76-921e-7f32150ae501&page=queryresults
[0m19:43:18.948138 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08ca309e-44db-46de-a356-f3467d4cedf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12897fac0>]}
[0m19:43:18.949966 [info ] [Thread-7  ]: 5 of 12 OK created sql table model stock_analysis.stg_calendar ................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 5.69s]
[0m19:43:18.951520 [debug] [Thread-7  ]: Finished running node model.stock_analysis.stg_calendar
[0m19:43:18.953000 [debug] [Thread-9  ]: Began running node model.stock_analysis.stg_all_stock_history_base
[0m19:43:18.953878 [info ] [Thread-9  ]: 6 of 12 SKIP relation stock_analysis.stg_all_stock_history_base ................ [[33mSKIP[0m]
[0m19:43:18.954647 [debug] [Thread-9  ]: Finished running node model.stock_analysis.stg_all_stock_history_base
[0m19:43:18.955822 [debug] [Thread-11 ]: Began running node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m19:43:18.956364 [debug] [Thread-12 ]: Began running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m19:43:18.956868 [info ] [Thread-11 ]: 7 of 12 SKIP relation stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price  [[33mSKIP[0m]
[0m19:43:18.957385 [debug] [Thread-13 ]: Began running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m19:43:18.957843 [info ] [Thread-12 ]: 8 of 12 SKIP relation stock_analysis.stg_all_stock_monthly_price_movement ...... [[33mSKIP[0m]
[0m19:43:18.958418 [debug] [Thread-14 ]: Began running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m19:43:18.958927 [debug] [Thread-11 ]: Finished running node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m19:43:18.959426 [info ] [Thread-13 ]: 9 of 12 SKIP relation stock_analysis.stg_all_stock_weekly_price_movement ....... [[33mSKIP[0m]
[0m19:43:18.959960 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m19:43:18.960430 [info ] [Thread-14 ]: 10 of 12 SKIP relation stock_analysis.stg_all_stock_yearly_price_movement ...... [[33mSKIP[0m]
[0m19:43:18.961040 [debug] [Thread-13 ]: Finished running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m19:43:18.961631 [debug] [Thread-14 ]: Finished running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m19:43:18.962510 [debug] [Thread-16 ]: Began running node model.stock_analysis.int_all_stock_history
[0m19:43:18.963013 [info ] [Thread-16 ]: 11 of 12 SKIP relation stock_analysis.int_all_stock_history .................... [[33mSKIP[0m]
[0m19:43:18.963539 [debug] [Thread-16 ]: Finished running node model.stock_analysis.int_all_stock_history
[0m19:43:18.964257 [debug] [Thread-18 ]: Began running node model.stock_analysis.stock_analysis
[0m19:43:18.964642 [info ] [Thread-18 ]: 12 of 12 SKIP relation stock_analysis.stock_analysis ........................... [[33mSKIP[0m]
[0m19:43:18.965019 [debug] [Thread-18 ]: Finished running node model.stock_analysis.stock_analysis
[0m19:43:18.967264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:18.967598 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_nasdaq_stock_history' was properly closed.
[0m19:43:18.967854 [debug] [MainThread]: Connection 'model.stock_analysis.base_all_others_stock_history' was properly closed.
[0m19:43:18.968097 [debug] [MainThread]: Connection 'model.stock_analysis.base_calendar' was properly closed.
[0m19:43:18.968337 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m19:43:18.968718 [info ] [MainThread]: 
[0m19:43:18.969283 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 10.85 seconds (10.85s).
[0m19:43:18.970521 [debug] [MainThread]: Command end result
[0m19:43:19.006094 [info ] [MainThread]: 
[0m19:43:19.006449 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:43:19.006652 [info ] [MainThread]: 
[0m19:43:19.006903 [error] [MainThread]:   Runtime Error in model base_all_nasdaq_stock_history (models/1_base/base_all_nasdaq_stock_history.sql)
  404 Not found: Table first-project-262802:stock.all_nasdaq_stock_history was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.all_nasdaq_stock_history was not found in location US
  
  Location: US
  Job ID: 7354d71d-cb3c-4c5f-9fa6-67b31936fc77
  
[0m19:43:19.007107 [info ] [MainThread]: 
[0m19:43:19.007334 [error] [MainThread]:   Runtime Error in model base_all_others_stock_history (models/1_base/base_all_others_stock_history.sql)
  404 Not found: Table first-project-262802:stock.all_others_stock_history was not found in location US; reason: notFound, message: Not found: Table first-project-262802:stock.all_others_stock_history was not found in location US
  
  Location: US
  Job ID: 090e85aa-8078-4a47-a687-ffdc5f2c0251
  
[0m19:43:19.007524 [info ] [MainThread]: 
[0m19:43:19.007724 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=8 TOTAL=12
[0m19:43:19.009763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.136846, "process_user_time": 4.940985, "process_kernel_time": 0.352581, "process_mem_max_rss": "200114176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:43:19.010139 [debug] [MainThread]: Command `dbt run` failed at 19:43:19.010074 after 12.14 seconds
[0m19:43:19.010402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053257c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128b0cd90>]}
[0m19:43:19.010639 [debug] [MainThread]: Flushing usage events
[0m19:44:12.824190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107336b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cbf70>]}


============================== 19:44:12.826766 | 17e43f80-7add-484e-8676-80aec6472efc ==============================
[0m19:44:12.826766 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:44:12.827090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_all_stock_history+', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:44:13.571303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107666550>]}
[0m19:44:13.598337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155dfcca0>]}
[0m19:44:13.598641 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:44:13.613251 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:44:13.693461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:13.693716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:13.713989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156b66f10>]}
[0m19:44:13.808429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156a00a00>]}
[0m19:44:13.808736 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m19:44:13.808930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10987f910>]}
[0m19:44:13.809732 [info ] [MainThread]: 
[0m19:44:13.810035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:13.812429 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:44:13.812632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:14.255688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:44:14.256827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:14.620913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109888280>]}
[0m19:44:14.621994 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:44:14.622391 [info ] [MainThread]: 
[0m19:44:14.628139 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_all_stock_history
[0m19:44:14.628635 [info ] [Thread-1  ]: 1 of 8 START sql table model stock_analysis.stg_all_stock_history .............. [RUN]
[0m19:44:14.629047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_all_stock_history)
[0m19:44:14.629448 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_all_stock_history
[0m19:44:14.640594 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history"
[0m19:44:14.642132 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_all_stock_history
[0m19:44:14.654988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:44:15.115329 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history"
[0m19:44:15.116338 [debug] [Thread-1  ]: On model.stock_analysis.stg_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history`
      
    
    

    OPTIONS()
    as (
      select * from `first-project-262802`.`stock_analysis`.`base_all_nasdaq_stock_history`

union all

select * from `first-project-262802`.`stock_analysis`.`base_all_others_stock_history`
    );
  
[0m19:44:15.541294 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:88172ca4-bed1-4203-88e9-0959344259f2&page=queryresults
[0m19:44:21.226801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155dfcb80>]}
[0m19:44:21.227377 [info ] [Thread-1  ]: 1 of 8 OK created sql table model stock_analysis.stg_all_stock_history ......... [[32mCREATE TABLE (30.4m rows, 2.1 GiB processed)[0m in 6.60s]
[0m19:44:21.227786 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_all_stock_history
[0m19:44:21.228284 [debug] [Thread-3  ]: Began running node model.stock_analysis.stg_all_stock_history_base
[0m19:44:21.228656 [info ] [Thread-3  ]: 2 of 8 START sql table model stock_analysis.stg_all_stock_history_base ......... [RUN]
[0m19:44:21.229014 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_history_base'
[0m19:44:21.229238 [debug] [Thread-3  ]: Began compiling node model.stock_analysis.stg_all_stock_history_base
[0m19:44:21.231531 [debug] [Thread-3  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history_base"
[0m19:44:21.232394 [debug] [Thread-3  ]: Began executing node model.stock_analysis.stg_all_stock_history_base
[0m19:44:21.234311 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:44:21.632070 [debug] [Thread-3  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history_base"
[0m19:44:21.633845 [debug] [Thread-3  ]: On model.stock_analysis.stg_all_stock_history_base: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history_base"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base`
      
    
    

    OPTIONS()
    as (
      with 

stock as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from stock
    left join calendar using (date)
)

select * from base
    );
  
[0m19:44:21.975863 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4ddccc54-98bf-4e26-91b4-138693a059e5&page=queryresults
[0m19:44:35.186463 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156ed0eb0>]}
[0m19:44:35.188744 [info ] [Thread-3  ]: 2 of 8 OK created sql table model stock_analysis.stg_all_stock_history_base .... [[32mCREATE TABLE (30.4m rows, 2.1 GiB processed)[0m in 13.96s]
[0m19:44:35.190061 [debug] [Thread-3  ]: Finished running node model.stock_analysis.stg_all_stock_history_base
[0m19:44:35.191555 [debug] [Thread-5  ]: Began running node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m19:44:35.192237 [debug] [Thread-6  ]: Began running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m19:44:35.193387 [debug] [Thread-7  ]: Began running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m19:44:35.192984 [info ] [Thread-5  ]: 3 of 8 START sql table model stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price  [RUN]
[0m19:44:35.194019 [debug] [Thread-8  ]: Began running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m19:44:35.194576 [info ] [Thread-6  ]: 4 of 8 START sql table model stock_analysis.stg_all_stock_monthly_price_movement  [RUN]
[0m19:44:35.195236 [info ] [Thread-7  ]: 5 of 8 START sql table model stock_analysis.stg_all_stock_weekly_price_movement  [RUN]
[0m19:44:35.196042 [debug] [Thread-5  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price'
[0m19:44:35.196609 [info ] [Thread-8  ]: 6 of 8 START sql table model stock_analysis.stg_all_stock_yearly_price_movement  [RUN]
[0m19:44:35.197209 [debug] [Thread-6  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_monthly_price_movement'
[0m19:44:35.197742 [debug] [Thread-7  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_weekly_price_movement'
[0m19:44:35.198181 [debug] [Thread-5  ]: Began compiling node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m19:44:35.198687 [debug] [Thread-8  ]: Acquiring new bigquery connection 'model.stock_analysis.stg_all_stock_yearly_price_movement'
[0m19:44:35.199066 [debug] [Thread-6  ]: Began compiling node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m19:44:35.199401 [debug] [Thread-7  ]: Began compiling node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m19:44:35.203858 [debug] [Thread-5  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price"
[0m19:44:35.204393 [debug] [Thread-8  ]: Began compiling node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m19:44:35.208143 [debug] [Thread-6  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_monthly_price_movement"
[0m19:44:35.211255 [debug] [Thread-7  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_weekly_price_movement"
[0m19:44:35.214844 [debug] [Thread-8  ]: Writing injected SQL for node "model.stock_analysis.stg_all_stock_yearly_price_movement"
[0m19:44:35.215733 [debug] [Thread-5  ]: Began executing node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m19:44:35.218511 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m19:44:35.219054 [debug] [Thread-6  ]: Began executing node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m19:44:35.293096 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m19:44:35.293619 [debug] [Thread-7  ]: Began executing node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m19:44:35.296799 [debug] [Thread-8  ]: Began executing node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m19:44:35.298735 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m19:44:35.300837 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m19:44:35.788006 [debug] [Thread-5  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price"
[0m19:44:35.789782 [debug] [Thread-5  ]: On model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, weekly_price as 
(
    select 
        year_full
        , week_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_weekly_price
        , round(sum(nullif(volume,0))/7) as avg_weekly_volume
    from base
    group by 1,2,3
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , symbol
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2,3
)

, yearly_price as 
(
    select 
        year_full
        , symbol
        , round(avg(avg_daily_price),2) as avg_yearly_price
    from base
    group by 1,2
)








select
    distinct *
from base
left join weekly_price using (year_full, week_number, symbol)
left join monthly_price using (year_full, month_number, symbol)
left join yearly_price using (year_full, symbol)
    );
  
[0m19:44:35.797957 [debug] [Thread-7  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_weekly_price_movement"
[0m19:44:35.799139 [debug] [Thread-7  ]: On model.stock_analysis.stg_all_stock_weekly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_weekly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , symbol
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , symbol
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((nullif(avg_daily_price_week_end,0)/nullif(avg_daily_price_week_start,0))-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full, week_number, symbol)
    left join last_avg_daily_price_per_week using (year_full, week_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_week using (year_full, week_number, symbol)

select distinct * from daily_price_movement_in_week
    );
  
[0m19:44:35.806627 [debug] [Thread-8  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_yearly_price_movement"
[0m19:44:35.807452 [debug] [Thread-8  ]: On model.stock_analysis.stg_all_stock_yearly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_yearly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , symbol
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , symbol
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((nullif(avg_daily_price_year_end,0)/nullif(avg_daily_price_year_start,0))-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full, symbol)
    left join last_avg_daily_price_per_year using (year_full, symbol)
)









-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_year using (year_full, symbol)

select distinct * from daily_price_movement_in_year
    );
  
[0m19:44:35.825130 [debug] [Thread-6  ]: Writing runtime sql for node "model.stock_analysis.stg_all_stock_monthly_price_movement"
[0m19:44:35.826398 [debug] [Thread-6  ]: On model.stock_analysis.stg_all_stock_monthly_price_movement: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_all_stock_monthly_price_movement"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement`
      
    
    

    OPTIONS()
    as (
      with 

base as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_base` )

, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , symbol
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number, symbol ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , symbol
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((nullif(avg_daily_price_month_end,0)/nullif(avg_daily_price_month_start,0))-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full, month_number, symbol)
    left join last_avg_daily_price_per_month using (year_full, month_number, symbol)
)






-- select
--     distinct *
-- from base
-- left join daily_price_movement_in_month using (year_full, month_number, symbol)

select distinct * from daily_price_movement_in_month
    );
  
[0m19:44:36.262943 [debug] [Thread-5  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:89f0c276-bef8-4571-a374-7b4d96af7edf&page=queryresults
[0m19:44:36.384784 [debug] [Thread-8  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1e342efb-8876-472b-b6ee-b6a463549da0&page=queryresults
[0m19:44:36.385948 [debug] [Thread-6  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3546da31-b954-42e5-a455-31e7ccabcf0d&page=queryresults
[0m19:44:36.540807 [debug] [Thread-7  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b221e4d4-2658-40d0-94ba-43e34c6e5adc&page=queryresults
[0m19:44:42.744964 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156e57850>]}
[0m19:44:42.746005 [info ] [Thread-8  ]: 6 of 8 OK created sql table model stock_analysis.stg_all_stock_yearly_price_movement  [[32mCREATE TABLE (128.5k rows, 1.1 GiB processed)[0m in 7.55s]
[0m19:44:42.746786 [debug] [Thread-8  ]: Finished running node model.stock_analysis.stg_all_stock_yearly_price_movement
[0m19:44:43.916396 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156e78490>]}
[0m19:44:43.917509 [info ] [Thread-7  ]: 5 of 8 OK created sql table model stock_analysis.stg_all_stock_weekly_price_movement  [[32mCREATE TABLE (6.4m rows, 1.2 GiB processed)[0m in 8.72s]
[0m19:44:43.918409 [debug] [Thread-7  ]: Finished running node model.stock_analysis.stg_all_stock_weekly_price_movement
[0m19:44:46.764041 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156eafbb0>]}
[0m19:44:46.765427 [info ] [Thread-6  ]: 4 of 8 OK created sql table model stock_analysis.stg_all_stock_monthly_price_movement  [[32mCREATE TABLE (1.5m rows, 1.3 GiB processed)[0m in 11.57s]
[0m19:44:46.766407 [debug] [Thread-6  ]: Finished running node model.stock_analysis.stg_all_stock_monthly_price_movement
[0m19:45:02.239167 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156eafa30>]}
[0m19:45:02.242124 [info ] [Thread-5  ]: 3 of 8 OK created sql table model stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price  [[32mCREATE TABLE (30.4m rows, 10.6 GiB processed)[0m in 27.04s]
[0m19:45:02.243411 [debug] [Thread-5  ]: Finished running node model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price
[0m19:45:02.244777 [debug] [Thread-10 ]: Began running node model.stock_analysis.int_all_stock_history
[0m19:45:02.245581 [info ] [Thread-10 ]: 7 of 8 START sql table model stock_analysis.int_all_stock_history .............. [RUN]
[0m19:45:02.246730 [debug] [Thread-10 ]: Acquiring new bigquery connection 'model.stock_analysis.int_all_stock_history'
[0m19:45:02.247172 [debug] [Thread-10 ]: Began compiling node model.stock_analysis.int_all_stock_history
[0m19:45:02.253477 [debug] [Thread-10 ]: Writing injected SQL for node "model.stock_analysis.int_all_stock_history"
[0m19:45:02.254726 [debug] [Thread-10 ]: Began executing node model.stock_analysis.int_all_stock_history
[0m19:45:02.260065 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m19:45:02.642273 [debug] [Thread-10 ]: Writing runtime sql for node "model.stock_analysis.int_all_stock_history"
[0m19:45:02.644158 [debug] [Thread-10 ]: On model.stock_analysis.int_all_stock_history: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.int_all_stock_history"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`int_all_stock_history`
      
    
    

    OPTIONS()
    as (
      -- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)
    );
  
[0m19:45:02.781341 [debug] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:296170b0-e206-4f47-a4f3-da6bb0e9002a&page=queryresults
[0m19:45:02.782584 [debug] [Thread-10 ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [31:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [31:5]')
[0m19:45:03.882930 [debug] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06811503-f84c-4c41-a060-96d8e87be6ee&page=queryresults
[0m19:45:03.884254 [error] [Thread-10 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06811503-f84c-4c41-a060-96d8e87be6ee&page=queryresults
[0m19:45:03.919495 [debug] [Thread-10 ]: Database Error in model int_all_stock_history (models/3_intermediary/int_all_stock_history.sql)
  Syntax error: Unexpected ")" at [31:5]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_all_stock_history.sql
[0m19:45:03.919995 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17e43f80-7add-484e-8676-80aec6472efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156f45430>]}
[0m19:45:03.920503 [error] [Thread-10 ]: 7 of 8 ERROR creating sql table model stock_analysis.int_all_stock_history ..... [[31mERROR[0m in 1.67s]
[0m19:45:03.920925 [debug] [Thread-10 ]: Finished running node model.stock_analysis.int_all_stock_history
[0m19:45:03.921486 [debug] [Thread-12 ]: Began running node model.stock_analysis.stock_analysis
[0m19:45:03.921862 [info ] [Thread-12 ]: 8 of 8 SKIP relation stock_analysis.stock_analysis ............................. [[33mSKIP[0m]
[0m19:45:03.922142 [debug] [Thread-12 ]: Finished running node model.stock_analysis.stock_analysis
[0m19:45:03.923501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:03.923707 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history' was properly closed.
[0m19:45:03.923877 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history_base' was properly closed.
[0m19:45:03.924053 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_history_weekly_monthly_yearly_price' was properly closed.
[0m19:45:03.924208 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_monthly_price_movement' was properly closed.
[0m19:45:03.924372 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_weekly_price_movement' was properly closed.
[0m19:45:03.924526 [debug] [MainThread]: Connection 'model.stock_analysis.stg_all_stock_yearly_price_movement' was properly closed.
[0m19:45:03.924678 [debug] [MainThread]: Connection 'model.stock_analysis.int_all_stock_history' was properly closed.
[0m19:45:03.924922 [info ] [MainThread]: 
[0m19:45:03.925140 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 50.11 seconds (50.11s).
[0m19:45:03.926244 [debug] [MainThread]: Command end result
[0m19:45:03.955328 [info ] [MainThread]: 
[0m19:45:03.955627 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:45:03.955817 [info ] [MainThread]: 
[0m19:45:03.956049 [error] [MainThread]:   Database Error in model int_all_stock_history (models/3_intermediary/int_all_stock_history.sql)
  Syntax error: Unexpected ")" at [31:5]
  compiled Code at target/run/stock_analysis/models/3_intermediary/int_all_stock_history.sql
[0m19:45:03.956229 [info ] [MainThread]: 
[0m19:45:03.956414 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m19:45:03.958522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 51.18351, "process_user_time": 4.542831, "process_kernel_time": 0.906071, "process_mem_max_rss": "193740800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:45:03.958858 [debug] [MainThread]: Command `dbt run` failed at 19:45:03.958810 after 51.18 seconds
[0m19:45:03.959097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107336b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156a00d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1567b6820>]}
[0m19:45:03.959310 [debug] [MainThread]: Flushing usage events
[0m19:46:03.597508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068beaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108237340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108237160>]}


============================== 19:46:03.600249 | f9957f8b-3d08-4bc4-bb88-0633f655efe2 ==============================
[0m19:46:03.600249 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:46:03.600599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:46:04.369414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9957f8b-3d08-4bc4-bb88-0633f655efe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af60d0>]}
[0m19:46:04.397172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9957f8b-3d08-4bc4-bb88-0633f655efe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1507adb50>]}
[0m19:46:04.397486 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:46:04.411633 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:46:04.498735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:04.499035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:04.520323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9957f8b-3d08-4bc4-bb88-0633f655efe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1573a5a00>]}
[0m19:46:04.619499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9957f8b-3d08-4bc4-bb88-0633f655efe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1572c3220>]}
[0m19:46:04.619812 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m19:46:04.620005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9957f8b-3d08-4bc4-bb88-0633f655efe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bad30>]}
[0m19:46:04.620747 [info ] [MainThread]: 
[0m19:46:04.621034 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:04.621502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:46:04.621713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:05.030258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:46:05.030847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:05.476532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9957f8b-3d08-4bc4-bb88-0633f655efe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bf970>]}
[0m19:46:05.477798 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:46:05.478277 [info ] [MainThread]: 
[0m19:46:05.484773 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m19:46:05.485455 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m19:46:05.485978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m19:46:05.486364 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m19:46:05.499626 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m19:46:05.501537 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m19:46:05.515884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:14.393189 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m19:46:14.395343 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- with

-- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- select
--     *
-- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

with 

all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

, all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

, all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

, all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



select
    distinct *
from all_stock_history_weekly_monthly_yearly_price
left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
left join all_stock_yearly_price_movement using (year_full, symbol)
    );
  
[0m19:46:14.701628 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:119e4b06-7a27-4e75-9d46-d712504df518&page=queryresults
[0m19:46:35.279967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9957f8b-3d08-4bc4-bb88-0633f655efe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107639d30>]}
[0m19:46:35.281790 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 11.7 GiB processed)[0m in 29.79s]
[0m19:46:35.282529 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m19:46:35.284805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:35.285111 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m19:46:35.285421 [info ] [MainThread]: 
[0m19:46:35.285714 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 30.66 seconds (30.66s).
[0m19:46:35.286457 [debug] [MainThread]: Command end result
[0m19:46:35.318922 [info ] [MainThread]: 
[0m19:46:35.319240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:35.319432 [info ] [MainThread]: 
[0m19:46:35.319634 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:46:35.321574 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.775187, "process_user_time": 4.430734, "process_kernel_time": 0.309352, "process_mem_max_rss": "191381504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:35.321942 [debug] [MainThread]: Command `dbt run` succeeded at 19:46:35.321891 after 31.78 seconds
[0m19:46:35.322177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068beaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1507adb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1574e92e0>]}
[0m19:46:35.322407 [debug] [MainThread]: Flushing usage events
[0m11:18:13.298756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103336af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc3160>]}


============================== 11:18:13.301327 | 8d9b09bf-6a15-4cf0-aa97-59fbd920f52c ==============================
[0m11:18:13.301327 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:18:13.301628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:18:14.085527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d9b09bf-6a15-4cf0-aa97-59fbd920f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10356e0d0>]}
[0m11:18:14.112410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d9b09bf-6a15-4cf0-aa97-59fbd920f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161b2db50>]}
[0m11:18:14.112694 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:18:14.127998 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:18:14.214757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:14.215116 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m11:18:14.370339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d9b09bf-6a15-4cf0-aa97-59fbd920f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162c5f130>]}
[0m11:18:14.428948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d9b09bf-6a15-4cf0-aa97-59fbd920f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161b983a0>]}
[0m11:18:14.429214 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m11:18:14.429396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9b09bf-6a15-4cf0-aa97-59fbd920f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161de6ac0>]}
[0m11:18:14.430098 [info ] [MainThread]: 
[0m11:18:14.430374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:18:14.430800 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:18:14.431006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:15.083989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m11:18:15.084842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:15.591174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9b09bf-6a15-4cf0-aa97-59fbd920f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10309ca90>]}
[0m11:18:15.592019 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m11:18:15.592483 [info ] [MainThread]: 
[0m11:18:15.597446 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m11:18:15.598163 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m11:18:15.598774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m11:18:15.599142 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m11:18:15.609000 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m11:18:15.610020 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m11:18:15.623612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:18:16.132174 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m11:18:16.134241 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


select * from stock_analysis.stock_analysis
left join stock.symbols_meta_data using (symbol)
    );
  
[0m11:18:16.529267 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:49d8bafc-7ea5-42f3-9c17-3e03a8fae980&page=queryresults
[0m11:18:23.324819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9b09bf-6a15-4cf0-aa97-59fbd920f52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162d43550>]}
[0m11:18:23.325581 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 12.9 GiB processed)[0m in 7.73s]
[0m11:18:23.326161 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m11:18:23.327779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:23.328076 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m11:18:23.328344 [info ] [MainThread]: 
[0m11:18:23.328636 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.90 seconds (8.90s).
[0m11:18:23.329214 [debug] [MainThread]: Command end result
[0m11:18:23.360397 [info ] [MainThread]: 
[0m11:18:23.360841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:23.361077 [info ] [MainThread]: 
[0m11:18:23.361288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:23.363280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.115498, "process_user_time": 4.578558, "process_kernel_time": 0.319876, "process_mem_max_rss": "197328896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:23.363627 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:23.363572 after 10.12 seconds
[0m11:18:23.363861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103336af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16126fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162d75220>]}
[0m11:18:23.364085 [debug] [MainThread]: Flushing usage events
[0m11:19:02.149714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023aeb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d272b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d270d0>]}


============================== 11:19:02.152676 | c2faf6e3-715d-45cf-adfb-469099e81ea6 ==============================
[0m11:19:02.152676 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:19:02.153005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stock_analysis.sqlclear', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:19:02.883052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2faf6e3-715d-45cf-adfb-469099e81ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cd3940>]}
[0m11:19:02.910308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2faf6e3-715d-45cf-adfb-469099e81ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12448ca60>]}
[0m11:19:02.910605 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:19:02.930915 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:19:03.017827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:03.018290 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m11:19:03.177894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2faf6e3-715d-45cf-adfb-469099e81ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12742b130>]}
[0m11:19:03.235705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2faf6e3-715d-45cf-adfb-469099e81ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271b39a0>]}
[0m11:19:03.235982 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m11:19:03.236178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2faf6e3-715d-45cf-adfb-469099e81ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273dcbe0>]}
[0m11:19:03.236491 [warn ] [MainThread]: The selection criterion 'stock_analysis.sqlclear' does not match any enabled nodes
[0m11:19:03.236898 [info ] [MainThread]: 
[0m11:19:03.237067 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:19:03.237309 [debug] [MainThread]: Command end result
[0m11:19:03.257710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1597954, "process_user_time": 4.159159, "process_kernel_time": 0.272661, "process_mem_max_rss": "195592192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:19:03.258045 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:03.257995 after 1.16 seconds
[0m11:19:03.258258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023aeb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124494460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10371c3a0>]}
[0m11:19:03.258448 [debug] [MainThread]: Flushing usage events
[0m19:46:36.792159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aeba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107087370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107087190>]}


============================== 19:46:36.794824 | 9e428039-8796-4c5b-b37d-8430617f4ae3 ==============================
[0m19:46:36.794824 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:46:36.795162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stock_analysis.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:46:40.050719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e428039-8796-4c5b-b37d-8430617f4ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2b7f0>]}
[0m19:46:40.077660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e428039-8796-4c5b-b37d-8430617f4ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14da2d760>]}
[0m19:46:40.077946 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:46:40.117668 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:46:40.203812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:46:40.204181 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m19:46:40.356251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e428039-8796-4c5b-b37d-8430617f4ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e22b130>]}
[0m19:46:40.414857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e428039-8796-4c5b-b37d-8430617f4ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dff83a0>]}
[0m19:46:40.415125 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m19:46:40.415310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e428039-8796-4c5b-b37d-8430617f4ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d1ae220>]}
[0m19:46:40.416030 [info ] [MainThread]: 
[0m19:46:40.416295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:40.416703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:46:40.416905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:41.159258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:46:41.160011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:41.746428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e428039-8796-4c5b-b37d-8430617f4ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d152fa0>]}
[0m19:46:41.747261 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m19:46:41.747705 [info ] [MainThread]: 
[0m19:46:41.754180 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m19:46:41.754815 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m19:46:41.755409 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m19:46:41.755801 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m19:46:41.766572 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m19:46:41.768514 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m19:46:41.783407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:42.352681 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m19:46:42.353764 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * 
    except (year_month)
    , left(cast(date as string),7) as year_month
from stock_analysis.stock_analysis
-- left join stock.symbols_meta_data using (symbol)
    );
  
[0m19:46:42.719720 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c6759041-e80e-46a9-b15a-78d035a0f962&page=queryresults
[0m19:46:49.673919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e428039-8796-4c5b-b37d-8430617f4ae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e3481c0>]}
[0m19:46:49.674657 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 13.4 GiB processed)[0m in 7.92s]
[0m19:46:49.675255 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m19:46:49.676830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:49.677132 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m19:46:49.677397 [info ] [MainThread]: 
[0m19:46:49.677696 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.26 seconds (9.26s).
[0m19:46:49.678285 [debug] [MainThread]: Command end result
[0m19:46:49.714206 [info ] [MainThread]: 
[0m19:46:49.714753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:49.715249 [info ] [MainThread]: 
[0m19:46:49.715545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:46:49.736093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.995838, "process_user_time": 4.913635, "process_kernel_time": 0.284799, "process_mem_max_rss": "198737920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:49.736569 [debug] [MainThread]: Command `dbt run` succeeded at 19:46:49.736508 after 13.00 seconds
[0m19:46:49.736805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aeba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14da2d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627ea60>]}
[0m19:46:49.737030 [debug] [MainThread]: Flushing usage events
[0m11:18:05.567052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102893a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104643370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104643190>]}


============================== 11:18:05.569691 | f68f7481-dc45-45f1-bbb3-61c337c71124 ==============================
[0m11:18:05.569691 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:18:05.569996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stock_analysis.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:18:08.759143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f68f7481-dc45-45f1-bbb3-61c337c71124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102beb7f0>]}
[0m11:18:08.786300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f68f7481-dc45-45f1-bbb3-61c337c71124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378ad760>]}
[0m11:18:08.786580 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:18:08.823377 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:18:08.907669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:08.907987 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m11:18:09.060018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f68f7481-dc45-45f1-bbb3-61c337c71124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137fab130>]}
[0m11:18:09.118741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f68f7481-dc45-45f1-bbb3-61c337c71124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d783a0>]}
[0m11:18:09.119007 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m11:18:09.119191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f68f7481-dc45-45f1-bbb3-61c337c71124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137047220>]}
[0m11:18:09.119903 [info ] [MainThread]: 
[0m11:18:09.120167 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:18:09.120572 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:18:09.120772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:09.655741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m11:18:09.656551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:10.102009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f68f7481-dc45-45f1-bbb3-61c337c71124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137908610>]}
[0m11:18:10.103472 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m11:18:10.103996 [info ] [MainThread]: 
[0m11:18:10.111768 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m11:18:10.112669 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m11:18:10.113319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m11:18:10.113744 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m11:18:10.126004 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m11:18:10.127818 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m11:18:10.143047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:18:10.594417 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m11:18:10.595524 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * 
    except (day_of_week)
    , day_of_week - 1 as day_of_week
from stock_analysis.stock_analysis
-- left join stock.symbols_meta_data using (symbol)
    );
  
[0m11:18:11.087748 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:88b59d42-f7ab-4cc9-8db8-b3f8e797d758&page=queryresults
[0m11:18:18.553716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f68f7481-dc45-45f1-bbb3-61c337c71124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1548c45b0>]}
[0m11:18:18.555544 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 13.6 GiB processed)[0m in 8.44s]
[0m11:18:18.556144 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m11:18:18.558024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:18.558304 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m11:18:18.558577 [info ] [MainThread]: 
[0m11:18:18.558864 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m11:18:18.559461 [debug] [MainThread]: Command end result
[0m11:18:18.594592 [info ] [MainThread]: 
[0m11:18:18.594953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:18.595145 [info ] [MainThread]: 
[0m11:18:18.595338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:18.619422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.109266, "process_user_time": 4.883668, "process_kernel_time": 0.295454, "process_mem_max_rss": "200622080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:18.620018 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:18.619935 after 13.11 seconds
[0m11:18:18.620385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102893a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13715fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403edc0>]}
[0m11:18:18.620685 [debug] [MainThread]: Flushing usage events
[0m11:20:12.909408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106716b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102072b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102070d0>]}


============================== 11:20:12.912196 | 580e9ce5-9a06-448e-8827-c1c2227f60a6 ==============================
[0m11:20:12.912196 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:20:12.912515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stock_analysis.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:13.696693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '580e9ce5-9a06-448e-8827-c1c2227f60a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b3940>]}
[0m11:20:13.723640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '580e9ce5-9a06-448e-8827-c1c2227f60a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1576cba60>]}
[0m11:20:13.723927 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:20:13.738551 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:20:13.822974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:13.823352 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m11:20:13.980614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '580e9ce5-9a06-448e-8827-c1c2227f60a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157c9f130>]}
[0m11:20:14.040535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '580e9ce5-9a06-448e-8827-c1c2227f60a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1578f69a0>]}
[0m11:20:14.040818 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m11:20:14.041004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '580e9ce5-9a06-448e-8827-c1c2227f60a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157c1dbe0>]}
[0m11:20:14.041732 [info ] [MainThread]: 
[0m11:20:14.042007 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:20:14.042442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:20:14.042661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:14.524614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m11:20:14.525445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:14.937484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '580e9ce5-9a06-448e-8827-c1c2227f60a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110255550>]}
[0m11:20:14.938870 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m11:20:14.939474 [info ] [MainThread]: 
[0m11:20:14.946778 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m11:20:14.947607 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m11:20:14.948351 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m11:20:14.948882 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m11:20:14.960501 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m11:20:14.961926 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m11:20:14.977741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:20:15.409072 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m11:20:15.410207 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , concat(day_of_week, ' - ', day_abbrev) as day_of_week_and_name
from stock_analysis.stock_analysis
-- left join stock.symbols_meta_data using (symbol)
    );
  
[0m11:20:15.800673 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5004ef4e-fb4f-4390-8188-19f5701de5d4&page=queryresults
[0m11:20:23.700007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '580e9ce5-9a06-448e-8827-c1c2227f60a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157d84520>]}
[0m11:20:23.701944 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 13.6 GiB processed)[0m in 8.75s]
[0m11:20:23.702558 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m11:20:23.704260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:23.704568 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m11:20:23.704847 [info ] [MainThread]: 
[0m11:20:23.705147 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.66 seconds (9.66s).
[0m11:20:23.705745 [debug] [MainThread]: Command end result
[0m11:20:23.736892 [info ] [MainThread]: 
[0m11:20:23.737247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:23.737447 [info ] [MainThread]: 
[0m11:20:23.737652 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:20:23.738945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.8832245, "process_user_time": 2.641159, "process_kernel_time": 2.286256, "process_mem_max_rss": "197885952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:20:23.739276 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:23.739220 after 10.88 seconds
[0m11:20:23.739507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106716b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a87130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b3940>]}
[0m11:20:23.739728 [debug] [MainThread]: Flushing usage events
[0m08:29:14.552217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104744a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bef10>]}


============================== 08:29:14.555242 | 2f8f1562-e2fd-49d9-ab7a-2f4219a61783 ==============================
[0m08:29:14.555242 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:29:14.555547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stock_analysis.sql', 'send_anonymous_usage_stats': 'True'}
[0m08:29:16.299274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f8f1562-e2fd-49d9-ab7a-2f4219a61783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104979640>]}
[0m08:29:16.326094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f8f1562-e2fd-49d9-ab7a-2f4219a61783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab9a90>]}
[0m08:29:16.326376 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m08:29:16.342238 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:29:16.431163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:29:16.431515 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m08:29:16.586196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f8f1562-e2fd-49d9-ab7a-2f4219a61783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14201f130>]}
[0m08:29:16.647050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f8f1562-e2fd-49d9-ab7a-2f4219a61783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f9ca90>]}
[0m08:29:16.647315 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m08:29:16.647503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8f1562-e2fd-49d9-ab7a-2f4219a61783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14201fac0>]}
[0m08:29:16.648249 [info ] [MainThread]: 
[0m08:29:16.648542 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:29:16.648975 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m08:29:16.649177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:17.292867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m08:29:17.293655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:29:17.743764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8f1562-e2fd-49d9-ab7a-2f4219a61783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f46760>]}
[0m08:29:17.744918 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m08:29:17.745501 [info ] [MainThread]: 
[0m08:29:17.754837 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m08:29:17.755727 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m08:29:17.756339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m08:29:17.756770 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m08:29:17.768633 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m08:29:17.769959 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m08:29:17.786609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:29:18.263839 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m08:29:18.265087 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , round( ( ( avg_daily_price / LAG(avg_daily_price) OVER (PARTITION BY symbol ORDER BY date ASC) ) - 1 ) * 100.00 ,2) as avg_daily_price_movement_day_over_day
from stock_analysis.stock_analysis
    );
  
[0m08:29:18.764962 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fb08b12a-5019-4227-ac18-4f76bf02859d&page=queryresults
[0m08:29:23.461445 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/fb08b12a-5019-4227-ac18-4f76bf02859d?maxResults=0&location=US&prettyPrint=false: division by zero: 0.01 / 0')
[0m08:29:24.485753 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e8796baf-9531-4dce-bb9d-b8567999ae77&page=queryresults
[0m08:29:32.083432 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e8796baf-9531-4dce-bb9d-b8567999ae77&page=queryresults
[0m08:29:32.133625 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  division by zero: 0.01 / 0
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m08:29:32.135031 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8f1562-e2fd-49d9-ab7a-2f4219a61783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ddf10>]}
[0m08:29:32.135529 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 14.38s]
[0m08:29:32.135941 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m08:29:32.137275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:32.137506 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m08:29:32.137718 [info ] [MainThread]: 
[0m08:29:32.137929 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.49 seconds (15.49s).
[0m08:29:32.138335 [debug] [MainThread]: Command end result
[0m08:29:32.165232 [info ] [MainThread]: 
[0m08:29:32.165552 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:29:32.165718 [info ] [MainThread]: 
[0m08:29:32.165930 [error] [MainThread]:   Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  division by zero: 0.01 / 0
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m08:29:32.166089 [info ] [MainThread]: 
[0m08:29:32.166255 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:29:32.168070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.670952, "process_user_time": 2.208975, "process_kernel_time": 2.882412, "process_mem_max_rss": "198967296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:29:32.168379 [debug] [MainThread]: Command `dbt run` failed at 08:29:32.168330 after 17.67 seconds
[0m08:29:32.168588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104744a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ddf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab9a90>]}
[0m08:29:32.168778 [debug] [MainThread]: Flushing usage events
[0m08:32:08.038137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cf8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518ff10>]}


============================== 08:32:08.041058 | e1efc674-4715-4290-90c0-1d2c8ea80664 ==============================
[0m08:32:08.041058 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:32:08.041399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stock_analysis.sql', 'send_anonymous_usage_stats': 'True'}
[0m08:32:08.833147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1efc674-4715-4290-90c0-1d2c8ea80664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f2d0a0>]}
[0m08:32:08.861036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1efc674-4715-4290-90c0-1d2c8ea80664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035d0f70>]}
[0m08:32:08.861364 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m08:32:08.876169 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:32:08.961681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:32:08.962088 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m08:32:09.119212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1efc674-4715-4290-90c0-1d2c8ea80664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f69d130>]}
[0m08:32:09.177238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1efc674-4715-4290-90c0-1d2c8ea80664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f61cb80>]}
[0m08:32:09.177506 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m08:32:09.177692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1efc674-4715-4290-90c0-1d2c8ea80664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f69d280>]}
[0m08:32:09.178407 [info ] [MainThread]: 
[0m08:32:09.178687 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:32:09.179103 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m08:32:09.179332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:32:09.690541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m08:32:09.691383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:32:10.140597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1efc674-4715-4290-90c0-1d2c8ea80664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f204b50>]}
[0m08:32:10.141711 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m08:32:10.142237 [info ] [MainThread]: 
[0m08:32:10.148547 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m08:32:10.149225 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m08:32:10.149852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m08:32:10.150254 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m08:32:10.161574 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m08:32:10.162335 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m08:32:10.177850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:32:10.668534 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m08:32:10.669653 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , round( ( safe_divide( avg_daily_price , LAG(avg_daily_price) OVER (PARTITION BY symbol ORDER BY date ASC) ) - 1 ) * 100.00 ,2) as avg_daily_price_movement_day_over_day
from stock_analysis.stock_analysis
    );
  
[0m08:32:11.192072 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:68cf52fe-ef8e-4e6d-bae4-4ce8824d6d1d&page=queryresults
[0m08:32:23.845540 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1efc674-4715-4290-90c0-1d2c8ea80664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f7895b0>]}
[0m08:32:23.846156 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 13.9 GiB processed)[0m in 13.70s]
[0m08:32:23.846664 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m08:32:23.848051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:32:23.848313 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m08:32:23.848550 [info ] [MainThread]: 
[0m08:32:23.848799 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.67 seconds (14.67s).
[0m08:32:23.849294 [debug] [MainThread]: Command end result
[0m08:32:23.878272 [info ] [MainThread]: 
[0m08:32:23.878632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:32:23.878819 [info ] [MainThread]: 
[0m08:32:23.879104 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:32:23.880477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.897184, "process_user_time": 2.481046, "process_kernel_time": 2.429901, "process_mem_max_rss": "200065024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:32:23.880816 [debug] [MainThread]: Command `dbt run` succeeded at 08:32:23.880765 after 15.90 seconds
[0m08:32:23.881038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cf8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035d0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043737c0>]}
[0m08:32:23.881256 [debug] [MainThread]: Flushing usage events
[0m17:22:28.784248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e522e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e52100>]}


============================== 17:22:28.786932 | d052ec06-bc89-495a-ae52-5cb17ae60cf4 ==============================
[0m17:22:28.786932 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:22:28.787245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:22:31.962238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd052ec06-bc89-495a-ae52-5cb17ae60cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e28040>]}
[0m17:22:31.989183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd052ec06-bc89-495a-ae52-5cb17ae60cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140842e20>]}
[0m17:22:31.989466 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:22:32.028528 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:22:32.114032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:32.114350 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:22:32.265780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd052ec06-bc89-495a-ae52-5cb17ae60cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416dd130>]}
[0m17:22:32.324327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd052ec06-bc89-495a-ae52-5cb17ae60cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1411ec5b0>]}
[0m17:22:32.324591 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m17:22:32.324772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd052ec06-bc89-495a-ae52-5cb17ae60cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d6c40>]}
[0m17:22:32.325481 [info ] [MainThread]: 
[0m17:22:32.325748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:22:32.326165 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m17:22:32.326363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:33.080880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m17:22:33.081721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:33.703665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd052ec06-bc89-495a-ae52-5cb17ae60cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e1c550>]}
[0m17:22:33.705009 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m17:22:33.705553 [info ] [MainThread]: 
[0m17:22:33.712736 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m17:22:33.713675 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m17:22:33.714376 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m17:22:33.714812 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m17:22:33.727090 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m17:22:33.728267 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m17:22:33.744104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:34.360858 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m17:22:34.363183 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , volume as volume_per_day
    , round(volume/390.0) as volume_per_minute
from stock_analysis.stock_analysis
    );
  
[0m17:22:34.960221 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a895c77c-b1a5-45cd-ad6f-612b57e20ef1&page=queryresults
[0m17:22:41.728669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd052ec06-bc89-495a-ae52-5cb17ae60cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1417c8640>]}
[0m17:22:41.730544 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 14.1 GiB processed)[0m in 8.01s]
[0m17:22:41.731156 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m17:22:41.732735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:41.733011 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m17:22:41.733279 [info ] [MainThread]: 
[0m17:22:41.733558 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m17:22:41.734133 [debug] [MainThread]: Command end result
[0m17:22:41.766114 [info ] [MainThread]: 
[0m17:22:41.766484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:41.766687 [info ] [MainThread]: 
[0m17:22:41.766893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:22:41.788583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.064343, "process_user_time": 2.513479, "process_kernel_time": 2.739948, "process_mem_max_rss": "201523200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:22:41.789124 [debug] [MainThread]: Command `dbt run` succeeded at 17:22:41.789048 after 13.06 seconds
[0m17:22:41.789426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140842e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1417f91f0>]}
[0m17:22:41.789686 [debug] [MainThread]: Flushing usage events
[0m17:29:36.855138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102734a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ae2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ae100>]}


============================== 17:29:36.857856 | 2f6d51c0-4f91-4b5e-9feb-020044a829cd ==============================
[0m17:29:36.857856 [info ] [MainThread]: Running with dbt=1.8.2
[0m17:29:36.858201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:29:37.605629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f6d51c0-4f91-4b5e-9feb-020044a829cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124391310>]}
[0m17:29:37.632414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f6d51c0-4f91-4b5e-9feb-020044a829cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104031b50>]}
[0m17:29:37.632698 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m17:29:37.647495 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m17:29:37.733552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:37.733958 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m17:29:37.893288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f6d51c0-4f91-4b5e-9feb-020044a829cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12559e130>]}
[0m17:29:37.965703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f6d51c0-4f91-4b5e-9feb-020044a829cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125041e20>]}
[0m17:29:37.966028 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m17:29:37.966221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f6d51c0-4f91-4b5e-9feb-020044a829cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12559e940>]}
[0m17:29:37.966988 [info ] [MainThread]: 
[0m17:29:37.967294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:29:37.967735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m17:29:37.967956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:38.590052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m17:29:38.590570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:39.116576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f6d51c0-4f91-4b5e-9feb-020044a829cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d3c670>]}
[0m17:29:39.118517 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m17:29:39.119296 [info ] [MainThread]: 
[0m17:29:39.126507 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m17:29:39.127424 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m17:29:39.128178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m17:29:39.128727 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m17:29:39.140754 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m17:29:39.142322 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m17:29:39.157476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:39.810619 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m17:29:39.812330 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , close_last as close
    , close_last as last
from stock_analysis.stock_analysis
    );
  
[0m17:29:40.308779 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2f0af72e-e2d9-4bd5-b135-b504d90ddeea&page=queryresults
[0m17:29:46.912482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f6d51c0-4f91-4b5e-9feb-020044a829cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125687670>]}
[0m17:29:46.913168 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 14.6 GiB processed)[0m in 7.78s]
[0m17:29:46.913701 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m17:29:46.915082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:46.915349 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m17:29:46.915592 [info ] [MainThread]: 
[0m17:29:46.915852 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m17:29:46.916345 [debug] [MainThread]: Command end result
[0m17:29:46.944312 [info ] [MainThread]: 
[0m17:29:46.944611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:46.944792 [info ] [MainThread]: 
[0m17:29:46.944981 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:29:46.946217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.141067, "process_user_time": 2.299735, "process_kernel_time": 2.561262, "process_mem_max_rss": "199311360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:29:46.946539 [debug] [MainThread]: Command `dbt run` succeeded at 17:29:46.946486 after 10.14 seconds
[0m17:29:46.946750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102734a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1250412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125041a00>]}
[0m17:29:46.946953 [debug] [MainThread]: Flushing usage events
[0m23:55:14.901820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107862d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107862f40>]}


============================== 23:55:14.904412 | 143635ce-aeb5-40d4-8b07-542b0c0d9bd7 ==============================
[0m23:55:14.904412 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:55:14.904717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stock_analysis.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:55:15.644873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '143635ce-aeb5-40d4-8b07-542b0c0d9bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782b040>]}
[0m23:55:15.673158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '143635ce-aeb5-40d4-8b07-542b0c0d9bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315ea4c0>]}
[0m23:55:15.673518 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m23:55:15.689807 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:55:15.775333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:55:15.775721 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m23:55:15.933740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '143635ce-aeb5-40d4-8b07-542b0c0d9bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13479d130>]}
[0m23:55:15.992322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '143635ce-aeb5-40d4-8b07-542b0c0d9bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1345ca8b0>]}
[0m23:55:15.992588 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m23:55:15.992771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '143635ce-aeb5-40d4-8b07-542b0c0d9bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649fd90>]}
[0m23:55:15.993518 [info ] [MainThread]: 
[0m23:55:15.993786 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:55:15.994219 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m23:55:15.994421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:16.466394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m23:55:16.467045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:16.905641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '143635ce-aeb5-40d4-8b07-542b0c0d9bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3b2b0>]}
[0m23:55:16.906865 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m23:55:16.907382 [info ] [MainThread]: 
[0m23:55:16.915481 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m23:55:16.916343 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m23:55:16.916998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m23:55:16.917462 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m23:55:16.929153 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m23:55:16.930081 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m23:55:16.945651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:55:17.380341 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m23:55:17.382355 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , abs(high - low) as daily_price_movement
from stock_analysis.stock_analysis
    );
  
[0m23:55:17.947845 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fcd871e3-81da-456a-a270-c6e080aa21c4&page=queryresults
[0m23:55:25.135795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '143635ce-aeb5-40d4-8b07-542b0c0d9bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d02b50>]}
[0m23:55:25.136278 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 15.0 GiB processed)[0m in 8.22s]
[0m23:55:25.136680 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m23:55:25.137738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:25.137911 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m23:55:25.138087 [info ] [MainThread]: 
[0m23:55:25.138285 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.14 seconds (9.14s).
[0m23:55:25.138678 [debug] [MainThread]: Command end result
[0m23:55:25.164994 [info ] [MainThread]: 
[0m23:55:25.165340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:55:25.165515 [info ] [MainThread]: 
[0m23:55:25.165690 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:55:25.167546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.315836, "process_user_time": 4.381694, "process_kernel_time": 0.465677, "process_mem_max_rss": "199000064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:55:25.167888 [debug] [MainThread]: Command `dbt run` succeeded at 23:55:25.167834 after 10.32 seconds
[0m23:55:25.168096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315ea4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1345ca3a0>]}
[0m23:55:25.168294 [debug] [MainThread]: Flushing usage events
[0m00:01:50.601099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022ada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c2bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c2bf10>]}


============================== 00:01:50.603681 | 076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf ==============================
[0m00:01:50.603681 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:01:50.603995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stock_analysis.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:51.295702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138351310>]}
[0m00:01:51.322730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba9b50>]}
[0m00:01:51.323006 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:01:51.337108 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:01:51.419287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:01:51.419661 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m00:01:51.575852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13935d130>]}
[0m00:01:51.633816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138701e20>]}
[0m00:01:51.634085 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m00:01:51.634277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13935d940>]}
[0m00:01:51.635046 [info ] [MainThread]: 
[0m00:01:51.635314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:01:51.635748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:01:51.635948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:52.106789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:01:52.107581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:52.474450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fcfc670>]}
[0m00:01:52.476375 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:01:52.477247 [info ] [MainThread]: 
[0m00:01:52.484148 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m00:01:52.485022 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m00:01:52.485577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m00:01:52.485948 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m00:01:52.496822 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m00:01:52.497650 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m00:01:52.512867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:52.930455 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m00:01:52.931456 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , round(daily_price_movement,2) as daily_price_movement
from stock_analysis.stock_analysis
    );
  
[0m00:01:53.424436 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d17ea9b0-4b4f-48f6-8b71-e6d406317000&page=queryresults
[0m00:01:53.560873 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name daily_price_movement at [56:1]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name daily_price_movement at [56:1]')
[0m00:01:54.754369 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:88bb3a7f-19ce-4c82-a26e-4ffd38d86b74&page=queryresults
[0m00:01:54.873924 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:88bb3a7f-19ce-4c82-a26e-4ffd38d86b74&page=queryresults
[0m00:01:54.917261 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  CREATE TABLE has columns with duplicate name daily_price_movement at [56:1]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m00:01:54.918639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '076ce873-80b7-4dbc-b7f0-a6f25ea6c1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1394a2c70>]}
[0m00:01:54.919143 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 2.43s]
[0m00:01:54.919579 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m00:01:54.920695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:54.920886 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m00:01:54.921080 [info ] [MainThread]: 
[0m00:01:54.921305 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m00:01:54.921710 [debug] [MainThread]: Command end result
[0m00:01:54.948501 [info ] [MainThread]: 
[0m00:01:54.948833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:01:54.949006 [info ] [MainThread]: 
[0m00:01:54.949224 [error] [MainThread]:   Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  CREATE TABLE has columns with duplicate name daily_price_movement at [56:1]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m00:01:54.949395 [info ] [MainThread]: 
[0m00:01:54.949568 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:01:54.950938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.397336, "process_user_time": 4.42105, "process_kernel_time": 0.395292, "process_mem_max_rss": "200491008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:01:54.951269 [debug] [MainThread]: Command `dbt run` failed at 00:01:54.951215 after 4.40 seconds
[0m00:01:54.951499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022ada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13931d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba9b50>]}
[0m00:01:54.951712 [debug] [MainThread]: Flushing usage events
[0m00:02:24.200960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021e8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f862e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f86100>]}


============================== 00:02:24.203604 | e6af4254-57f2-495a-9a0f-a5db0735048c ==============================
[0m00:02:24.203604 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:02:24.203903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:02:24.932285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6af4254-57f2-495a-9a0f-a5db0735048c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb86f70>]}
[0m00:02:24.959323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6af4254-57f2-495a-9a0f-a5db0735048c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc1a00>]}
[0m00:02:24.959605 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:02:24.974384 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:02:25.057188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:02:25.057591 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m00:02:25.213389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6af4254-57f2-495a-9a0f-a5db0735048c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e5e130>]}
[0m00:02:25.271055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6af4254-57f2-495a-9a0f-a5db0735048c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e5e580>]}
[0m00:02:25.271314 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m00:02:25.271494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6af4254-57f2-495a-9a0f-a5db0735048c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a12700>]}
[0m00:02:25.272204 [info ] [MainThread]: 
[0m00:02:25.272471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:02:25.272888 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:02:25.273090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:25.703655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:02:25.704455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:02:26.077778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6af4254-57f2-495a-9a0f-a5db0735048c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c793d0>]}
[0m00:02:26.079406 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:02:26.080041 [info ] [MainThread]: 
[0m00:02:26.087992 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m00:02:26.088895 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m00:02:26.089572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m00:02:26.090361 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m00:02:26.101630 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m00:02:26.102440 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m00:02:26.117620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:02:26.543794 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m00:02:26.544852 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * except (daily_price_movement)
    , round(daily_price_movement,2) as daily_price_movement
from stock_analysis.stock_analysis
    );
  
[0m00:02:27.012554 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:77359be3-b139-4bd8-bb0d-2159225396f3&page=queryresults
[0m00:02:33.488942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6af4254-57f2-495a-9a0f-a5db0735048c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c046730>]}
[0m00:02:33.489727 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 15.2 GiB processed)[0m in 7.40s]
[0m00:02:33.490294 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m00:02:33.491980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:33.492274 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m00:02:33.492544 [info ] [MainThread]: 
[0m00:02:33.492842 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m00:02:33.493437 [debug] [MainThread]: Command end result
[0m00:02:33.524848 [info ] [MainThread]: 
[0m00:02:33.525229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:02:33.525428 [info ] [MainThread]: 
[0m00:02:33.525630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:02:33.527010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.374038, "process_user_time": 4.562572, "process_kernel_time": 0.261074, "process_mem_max_rss": "199131136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:02:33.527366 [debug] [MainThread]: Command `dbt run` succeeded at 00:02:33.527301 after 9.37 seconds
[0m00:02:33.527613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021e8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137e1a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10204ea90>]}
[0m00:02:33.527835 [debug] [MainThread]: Flushing usage events
[0m00:04:40.132981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f08b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103886d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103886f70>]}


============================== 00:04:40.136466 | 80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4 ==============================
[0m00:04:40.136466 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:04:40.136923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:04:40.861331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10213d130>]}
[0m00:04:40.889466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10370aee0>]}
[0m00:04:40.889863 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:04:40.904781 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:04:40.986725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:04:40.987070 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m00:04:41.142510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15451f130>]}
[0m00:04:41.200477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102206c40>]}
[0m00:04:41.200736 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m00:04:41.200919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10382e370>]}
[0m00:04:41.201647 [info ] [MainThread]: 
[0m00:04:41.201910 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:04:41.202328 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:04:41.202530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:41.630470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:04:41.631236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:41.995523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103710580>]}
[0m00:04:41.996749 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:04:41.997326 [info ] [MainThread]: 
[0m00:04:42.004499 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m00:04:42.005599 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m00:04:42.006222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m00:04:42.006643 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m00:04:42.017524 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m00:04:42.018513 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m00:04:42.034864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:04:42.422258 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m00:04:42.423389 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * 
    , round( ( ( daily_price_movement ) / ( LAG(avg_daily_price) OVER (PARTITION BY symbol ORDER BY date ASC) ) ) *100.0,2) as daily_price_movement_as_pct_of_previous_day_avg_daily_price
from stock_analysis.stock_analysis
    );
  
[0m00:04:42.900872 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f1b328ba-915d-44fc-a372-539835198f7a&page=queryresults
[0m00:04:48.987565 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/first-project-262802/queries/f1b328ba-915d-44fc-a372-539835198f7a?maxResults=0&location=US&prettyPrint=false: division by zero: 0 / 0')
[0m00:04:49.460974 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a314cc10-77e3-46bc-85f7-fac37a675a52&page=queryresults
[0m00:04:55.204583 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a314cc10-77e3-46bc-85f7-fac37a675a52&page=queryresults
[0m00:04:55.253302 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  division by zero: 0 / 0
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m00:04:55.254808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e4bf37-7b4b-4bd0-b78b-3b4c4dd93ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154605490>]}
[0m00:04:55.255319 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 13.25s]
[0m00:04:55.255657 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m00:04:55.256675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:55.256906 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m00:04:55.257115 [info ] [MainThread]: 
[0m00:04:55.257340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.06 seconds (14.06s).
[0m00:04:55.257777 [debug] [MainThread]: Command end result
[0m00:04:55.285476 [info ] [MainThread]: 
[0m00:04:55.285791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:04:55.285965 [info ] [MainThread]: 
[0m00:04:55.286173 [error] [MainThread]:   Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  division by zero: 0 / 0
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m00:04:55.286331 [info ] [MainThread]: 
[0m00:04:55.286504 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:04:55.287856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.20988, "process_user_time": 3.267061, "process_kernel_time": 1.581522, "process_mem_max_rss": "201015296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:04:55.288202 [debug] [MainThread]: Command `dbt run` failed at 00:04:55.288146 after 15.21 seconds
[0m00:04:55.288443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f08b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147e5ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10370aee0>]}
[0m00:04:55.288668 [debug] [MainThread]: Flushing usage events
[0m00:05:57.309470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e8faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10380fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10380ff10>]}


============================== 00:05:57.312126 | 34bc8705-ac5b-402f-934c-ca8d33690da3 ==============================
[0m00:05:57.312126 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:05:57.312448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stock_analysis.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:05:58.049745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34bc8705-ac5b-402f-934c-ca8d33690da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037e0040>]}
[0m00:05:58.076848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34bc8705-ac5b-402f-934c-ca8d33690da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135002e20>]}
[0m00:05:58.077135 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:05:58.092898 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:05:58.179672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:05:58.180066 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m00:05:58.333164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34bc8705-ac5b-402f-934c-ca8d33690da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135d9d130>]}
[0m00:05:58.391637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34bc8705-ac5b-402f-934c-ca8d33690da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1359ac5b0>]}
[0m00:05:58.391908 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m00:05:58.392098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34bc8705-ac5b-402f-934c-ca8d33690da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10218ec40>]}
[0m00:05:58.392812 [info ] [MainThread]: 
[0m00:05:58.393083 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:05:58.393507 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:05:58.393705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:58.816301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:05:58.817040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:05:59.221727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34bc8705-ac5b-402f-934c-ca8d33690da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cf6a90>]}
[0m00:05:59.222861 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:05:59.223756 [info ] [MainThread]: 
[0m00:05:59.230804 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m00:05:59.231695 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m00:05:59.232321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m00:05:59.232744 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m00:05:59.243826 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m00:05:59.244818 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m00:05:59.260798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:05:59.698638 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m00:05:59.699348 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * 
    , round( SAFE_DIVIDE( ( daily_price_movement ) , ( LAG(avg_daily_price) OVER (PARTITION BY symbol ORDER BY date ASC) ) ) *100.0,2) as daily_price_movement_as_pct_of_previous_day_avg_daily_price
from stock_analysis.stock_analysis
    );
  
[0m00:06:00.214434 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6a1b39ed-a0ca-4f9f-8c50-52007d32ed5f&page=queryresults
[0m00:06:14.166333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34bc8705-ac5b-402f-934c-ca8d33690da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136986730>]}
[0m00:06:14.167163 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 15.2 GiB processed)[0m in 14.93s]
[0m00:06:14.167777 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m00:06:14.169926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:14.170238 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m00:06:14.170517 [info ] [MainThread]: 
[0m00:06:14.170816 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.78 seconds (15.78s).
[0m00:06:14.171417 [debug] [MainThread]: Command end result
[0m00:06:14.202441 [info ] [MainThread]: 
[0m00:06:14.202836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:14.203049 [info ] [MainThread]: 
[0m00:06:14.203253 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:06:14.204986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.943928, "process_user_time": 3.464761, "process_kernel_time": 1.389349, "process_mem_max_rss": "198918144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:06:14.205338 [debug] [MainThread]: Command `dbt run` succeeded at 00:06:14.205280 after 16.94 seconds
[0m00:06:14.205602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e8faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135002e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1369ba1f0>]}
[0m00:06:14.205853 [debug] [MainThread]: Flushing usage events
[0m00:28:01.087637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106555a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed11f0>]}


============================== 00:28:01.090235 | 9427963c-965b-41cc-b0d3-364f5fb77709 ==============================
[0m00:28:01.090235 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:28:01.090549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:28:01.861927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9427963c-965b-41cc-b0d3-364f5fb77709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cf520>]}
[0m00:28:01.888983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9427963c-965b-41cc-b0d3-364f5fb77709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7d820>]}
[0m00:28:01.889256 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:28:01.903485 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:28:01.990468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:01.990825 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m00:28:02.146131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9427963c-965b-41cc-b0d3-364f5fb77709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aa20130>]}
[0m00:28:02.208024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9427963c-965b-41cc-b0d3-364f5fb77709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a99ddf0>]}
[0m00:28:02.208334 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m00:28:02.208515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9427963c-965b-41cc-b0d3-364f5fb77709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aa20820>]}
[0m00:28:02.209251 [info ] [MainThread]: 
[0m00:28:02.209551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:28:02.210017 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:28:02.210220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:02.713725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:28:02.714547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:03.075393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9427963c-965b-41cc-b0d3-364f5fb77709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a99d0>]}
[0m00:28:03.076719 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:28:03.077356 [info ] [MainThread]: 
[0m00:28:03.085931 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m00:28:03.086847 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m00:28:03.087548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m00:28:03.088066 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m00:28:03.100508 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m00:28:03.101759 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m00:28:03.117054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:28:03.499134 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m00:28:03.500194 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * except (daily_price_movement_as_pct_of_previous_day_avg_daily_price)
    , round( SAFE_DIVIDE( ( high - low ) / ( LAG(avg_daily_price) OVER (PARTITION BY symbol ORDER BY date ASC) ) ) *100.0,2) as daily_price_movement_as_pct_of_previous_day_avg_daily_price
from stock_analysis.stock_analysis
    );
  
[0m00:28:04.134000 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:94213bd4-d8fd-4b02-80a4-fadf2c5a158d&page=queryresults
[0m00:28:04.338584 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function SAFE_DIVIDE\n  Argument types: FLOAT64\n  Signature: SAFE_DIVIDE(FLOAT64, FLOAT64)\n    Signature requires at least 2 arguments, found 1 argument\n  Signature: SAFE_DIVIDE(NUMERIC, NUMERIC)\n    Signature requires at least 2 arguments, found 1 argument\n  Signature: SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC)\n    Signature requires at least 2 arguments, found 1 argument at [58:14]; reason: invalidQuery, location: query, message: No matching signature for function SAFE_DIVIDE\n  Argument types: FLOAT64\n  Signature: SAFE_DIVIDE(FLOAT64, FLOAT64)\n    Signature requires at least 2 arguments, found 1 argument\n  Signature: SAFE_DIVIDE(NUMERIC, NUMERIC)\n    Signature requires at least 2 arguments, found 1 argument\n  Signature: SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC)\n    Signature requires at least 2 arguments, found 1 argument at [58:14]')
[0m00:28:05.671533 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6d9f7208-21fe-4195-9475-e304fefdce7b&page=queryresults
[0m00:28:05.789915 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6d9f7208-21fe-4195-9475-e304fefdce7b&page=queryresults
[0m00:28:05.837860 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  No matching signature for function SAFE_DIVIDE
    Argument types: FLOAT64
    Signature: SAFE_DIVIDE(FLOAT64, FLOAT64)
      Signature requires at least 2 arguments, found 1 argument
    Signature: SAFE_DIVIDE(NUMERIC, NUMERIC)
      Signature requires at least 2 arguments, found 1 argument
    Signature: SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC)
      Signature requires at least 2 arguments, found 1 argument at [58:14]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m00:28:05.839356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9427963c-965b-41cc-b0d3-364f5fb77709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ad0c0a0>]}
[0m00:28:05.839908 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 2.75s]
[0m00:28:05.840356 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m00:28:05.841604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:05.841840 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m00:28:05.842050 [info ] [MainThread]: 
[0m00:28:05.842281 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m00:28:05.842716 [debug] [MainThread]: Command end result
[0m00:28:05.869569 [info ] [MainThread]: 
[0m00:28:05.870036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:28:05.870229 [info ] [MainThread]: 
[0m00:28:05.870467 [error] [MainThread]:   Database Error in model stock_analysis (models/4_final/stock_analysis.sql)
  No matching signature for function SAFE_DIVIDE
    Argument types: FLOAT64
    Signature: SAFE_DIVIDE(FLOAT64, FLOAT64)
      Signature requires at least 2 arguments, found 1 argument
    Signature: SAFE_DIVIDE(NUMERIC, NUMERIC)
      Signature requires at least 2 arguments, found 1 argument
    Signature: SAFE_DIVIDE(BIGNUMERIC, BIGNUMERIC)
      Signature requires at least 2 arguments, found 1 argument at [58:14]
  compiled Code at target/run/stock_analysis/models/4_final/stock_analysis.sql
[0m00:28:05.870647 [info ] [MainThread]: 
[0m00:28:05.870816 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:28:05.872286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.8342247, "process_user_time": 4.525494, "process_kernel_time": 0.300398, "process_mem_max_rss": "200622080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:28:05.872603 [debug] [MainThread]: Command `dbt run` failed at 00:28:05.872552 after 4.83 seconds
[0m00:28:05.872842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106555a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cf520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129c42370>]}
[0m00:28:05.873071 [debug] [MainThread]: Flushing usage events
[0m00:31:36.810950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102644af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc2f10>]}


============================== 00:31:36.813554 | 7615b9b8-866b-4a99-8eeb-8b8a4b8fe112 ==============================
[0m00:31:36.813554 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:31:36.813866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stock_analysis.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:37.535117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7615b9b8-866b-4a99-8eeb-8b8a4b8fe112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f94040>]}
[0m00:31:37.562357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7615b9b8-866b-4a99-8eeb-8b8a4b8fe112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c982e20>]}
[0m00:31:37.562649 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:31:37.577069 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:31:37.660064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:31:37.660481 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m00:31:37.818074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7615b9b8-866b-4a99-8eeb-8b8a4b8fe112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12df1e130>]}
[0m00:31:37.876669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7615b9b8-866b-4a99-8eeb-8b8a4b8fe112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d32d5b0>]}
[0m00:31:37.876927 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m00:31:37.877126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7615b9b8-866b-4a99-8eeb-8b8a4b8fe112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102942c40>]}
[0m00:31:37.877842 [info ] [MainThread]: 
[0m00:31:37.878101 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:31:37.878504 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:31:37.878692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:38.345302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:31:38.346170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:38.728117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7615b9b8-866b-4a99-8eeb-8b8a4b8fe112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e416a0>]}
[0m00:31:38.730003 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m00:31:38.731049 [info ] [MainThread]: 
[0m00:31:38.739251 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m00:31:38.740407 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m00:31:38.741352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m00:31:38.741807 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m00:31:38.754244 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m00:31:38.755496 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m00:31:38.771966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:31:39.172786 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m00:31:39.173851 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * except (daily_price_movement_as_pct_of_previous_day_avg_daily_price)
    , round( SAFE_DIVIDE( ( high - low ) , ( LAG(avg_daily_price) OVER (PARTITION BY symbol ORDER BY date ASC) ) ) *100.0,2) as daily_price_movement_as_pct_of_previous_day_avg_daily_price
from stock_analysis.stock_analysis
    );
  
[0m00:31:39.601409 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8b671cbf-040b-4d59-87a0-dd386f134572&page=queryresults
[0m00:31:53.537427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7615b9b8-866b-4a99-8eeb-8b8a4b8fe112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e808580>]}
[0m00:31:53.539208 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 15.2 GiB processed)[0m in 14.80s]
[0m00:31:53.539776 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m00:31:53.541557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:53.541861 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m00:31:53.542147 [info ] [MainThread]: 
[0m00:31:53.542438 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.66 seconds (15.66s).
[0m00:31:53.543060 [debug] [MainThread]: Command end result
[0m00:31:53.573826 [info ] [MainThread]: 
[0m00:31:53.574190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:53.574394 [info ] [MainThread]: 
[0m00:31:53.574599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:31:53.576287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.812979, "process_user_time": 3.262799, "process_kernel_time": 1.560856, "process_mem_max_rss": "197836800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:31:53.576622 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:53.576565 after 16.81 seconds
[0m00:31:53.576858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102644af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c982e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce5b550>]}
[0m00:31:53.577072 [debug] [MainThread]: Flushing usage events
[0m08:19:34.377265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104639a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb6f10>]}


============================== 08:19:34.379897 | da21f679-daa1-4e10-afeb-6b12b4ac8783 ==============================
[0m08:19:34.379897 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:19:34.380231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stock_analysis.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:19:35.207674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da21f679-daa1-4e10-afeb-6b12b4ac8783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a2d1310>]}
[0m08:19:35.235333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da21f679-daa1-4e10-afeb-6b12b4ac8783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f36b50>]}
[0m08:19:35.235641 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m08:19:35.261475 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:19:35.350247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:19:35.350593 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m08:19:35.509634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da21f679-daa1-4e10-afeb-6b12b4ac8783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7dd130>]}
[0m08:19:35.567977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da21f679-daa1-4e10-afeb-6b12b4ac8783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a5811f0>]}
[0m08:19:35.568234 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m08:19:35.568428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da21f679-daa1-4e10-afeb-6b12b4ac8783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7dd940>]}
[0m08:19:35.569150 [info ] [MainThread]: 
[0m08:19:35.569415 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:19:35.569836 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m08:19:35.570040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:36.033162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m08:19:36.034074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:19:36.410908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da21f679-daa1-4e10-afeb-6b12b4ac8783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449e880>]}
[0m08:19:36.411587 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m08:19:36.411905 [info ] [MainThread]: 
[0m08:19:36.416158 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m08:19:36.416556 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m08:19:36.416874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m08:19:36.417119 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m08:19:36.425099 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m08:19:36.425795 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m08:19:36.438870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:19:36.860307 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m08:19:36.862468 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    * except (daily_price_movement, daily_price_movement_as_pct_of_previous_day_avg_daily_price)
    , daily_price_movement as daily_price_range
    , daily_price_movement_as_pct_of_previous_day_avg_daily_price as daily_price_range_as_pct_of_previous_day_avg_daily_price
from stock_analysis.stock_analysis
    );
  
[0m08:19:37.370488 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6ad43899-375f-411a-813c-9cfc19689621&page=queryresults
[0m08:19:45.785598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da21f679-daa1-4e10-afeb-6b12b4ac8783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a8c8580>]}
[0m08:19:45.786048 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 15.5 GiB processed)[0m in 9.37s]
[0m08:19:45.786407 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m08:19:45.787571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:19:45.787761 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m08:19:45.787935 [info ] [MainThread]: 
[0m08:19:45.788125 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m08:19:45.788507 [debug] [MainThread]: Command end result
[0m08:19:45.812187 [info ] [MainThread]: 
[0m08:19:45.812457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:19:45.812617 [info ] [MainThread]: 
[0m08:19:45.812780 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:19:45.814403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.48693, "process_user_time": 4.488726, "process_kernel_time": 0.313696, "process_mem_max_rss": "200556544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:19:45.814721 [debug] [MainThread]: Command `dbt run` succeeded at 08:19:45.814671 after 11.49 seconds
[0m08:19:45.814929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104639a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a8debe0>]}
[0m08:19:45.815120 [debug] [MainThread]: Flushing usage events
[0m08:22:16.281151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c86280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c860a0>]}


============================== 08:22:16.283768 | 685e9479-5b8d-4aec-be21-df71f5412995 ==============================
[0m08:22:16.283768 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:22:16.284105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stock_analysis.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:22:17.042756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '685e9479-5b8d-4aec-be21-df71f5412995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa54a60>]}
[0m08:22:17.070765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '685e9479-5b8d-4aec-be21-df71f5412995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa66e80>]}
[0m08:22:17.071079 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m08:22:17.086785 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:22:17.169926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:22:17.170365 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/4_final/stock_analysis.sql
[0m08:22:17.331404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '685e9479-5b8d-4aec-be21-df71f5412995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a19d130>]}
[0m08:22:17.389646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '685e9479-5b8d-4aec-be21-df71f5412995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a03a5e0>]}
[0m08:22:17.389929 [info ] [MainThread]: Found 12 models, 3 sources, 585 macros
[0m08:22:17.390113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685e9479-5b8d-4aec-be21-df71f5412995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a19d910>]}
[0m08:22:17.390836 [info ] [MainThread]: 
[0m08:22:17.391124 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:22:17.391547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m08:22:17.391742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:17.801003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m08:22:17.801512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:18.187949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685e9479-5b8d-4aec-be21-df71f5412995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f2891f0>]}
[0m08:22:18.189232 [info ] [MainThread]: Concurrency: 32 threads (target='prod')
[0m08:22:18.189739 [info ] [MainThread]: 
[0m08:22:18.197193 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m08:22:18.198244 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m08:22:18.199009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stock_analysis)
[0m08:22:18.199479 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m08:22:18.212200 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m08:22:18.213257 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m08:22:18.229481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:22:18.624460 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m08:22:18.625472 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- -- with

-- -- stock_analysis as ( select * except (ETL_Date) from `first-project-262802`.`stock_analysis`.`int_all_stock_history` )

-- -- select
-- --     *
-- -- from stock_analysis




-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- from int_all_stock_history -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

-- with 

-- all_stock_history_weekly_monthly_yearly_price as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_history_weekly_monthly_yearly_price` )

-- , all_stock_weekly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_weekly_price_movement` )

-- , all_stock_monthly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_monthly_price_movement` )

-- , all_stock_yearly_price_movement as ( select * from `first-project-262802`.`stock_analysis`.`stg_all_stock_yearly_price_movement` )



-- select
--     distinct *
-- from all_stock_history_weekly_monthly_yearly_price
-- left join all_stock_weekly_price_movement using (year_full, week_number, symbol)
-- left join all_stock_monthly_price_movement using (year_full, month_number, symbol)
-- left join all_stock_yearly_price_movement using (year_full, symbol)


-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
-- -- -- -- -- --   used for adhoc creation  -- -- -- -- --
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 

select 
    *
    , close - open as daily_price_movement
    , round( SAFE_DIVIDE( abs( close - open ) , ( LAG(avg_daily_price) OVER (PARTITION BY symbol ORDER BY date ASC) ) ) *100.0,2) as daily_price_movement_as_pct_of_previous_day_avg_daily_price
from stock_analysis.stock_analysis
    );
  
[0m08:22:19.059306 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:21374aa1-9d4e-4b80-ad00-c3a6163edfb3&page=queryresults
[0m08:22:32.904920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '685e9479-5b8d-4aec-be21-df71f5412995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a288640>]}
[0m08:22:32.905555 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stock_analysis ................ [[32mCREATE TABLE (30.4m rows, 15.5 GiB processed)[0m in 14.71s]
[0m08:22:32.906051 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m08:22:32.907349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:32.907605 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m08:22:32.907833 [info ] [MainThread]: 
[0m08:22:32.908082 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.52 seconds (15.52s).
[0m08:22:32.908580 [debug] [MainThread]: Command end result
[0m08:22:32.937920 [info ] [MainThread]: 
[0m08:22:32.938273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:22:32.938454 [info ] [MainThread]: 
[0m08:22:32.938625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:22:32.940032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.707758, "process_user_time": 4.531361, "process_kernel_time": 0.289922, "process_mem_max_rss": "200982528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:22:32.940393 [debug] [MainThread]: Command `dbt run` succeeded at 08:22:32.940334 after 16.71 seconds
[0m08:22:32.940642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa54a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104706880>]}
[0m08:22:32.940887 [debug] [MainThread]: Flushing usage events
