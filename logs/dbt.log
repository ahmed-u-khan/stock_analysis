[0m10:14:32.857986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d58c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d58df0>]}


============================== 10:14:32.860538 | e7936a34-163f-4b1b-9927-ea3729ab9904 ==============================
[0m10:14:32.860538 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:14:32.860817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:14:33.580472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123feac10>]}
[0m10:14:33.606404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3c340>]}
[0m10:14:33.606673 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m10:14:33.617966 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:14:33.618468 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:14:33.618674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249682b0>]}
[0m10:14:34.416147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125547130>]}
[0m10:14:34.483825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253d5d90>]}
[0m10:14:34.484137 [info ] [MainThread]: Found 2 models, 6 seeds, 4 data tests, 469 macros
[0m10:14:34.484308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255800a0>]}
[0m10:14:34.485156 [info ] [MainThread]: 
[0m10:14:34.485445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:14:34.487957 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m10:14:34.488220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:35.098131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m10:14:35.099225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:35.588401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125494640>]}
[0m10:14:35.589861 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m10:14:35.590535 [info ] [MainThread]: 
[0m10:14:35.596030 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_category_map
[0m10:14:35.596945 [info ] [Thread-1  ]: 1 of 6 START seed file ruggable.rugs_usa_category_map .......................... [RUN]
[0m10:14:35.597639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now seed.ruggable.rugs_usa_category_map)
[0m10:14:35.598121 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_category_map
[0m10:14:35.598560 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_category_map
[0m10:14:35.858987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:40.413262 [debug] [Thread-1  ]: On seed.ruggable.rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "seed.ruggable.rugs_usa_category_map"} */

    alter table `first-project-262802`.`ruggable`.`rugs_usa_category_map` set OPTIONS()
  
[0m10:14:40.796720 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5116c8d4-5558-4d7d-bacf-ffc132ea412c&page=queryresults
[0m10:14:41.320865 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ruggable.rugs_usa_category_map"
[0m10:14:41.352561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a6e880>]}
[0m10:14:41.353266 [info ] [Thread-1  ]: 1 of 6 OK loaded seed file ruggable.rugs_usa_category_map ...................... [[32mINSERT 51265[0m in 5.75s]
[0m10:14:41.353942 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_category_map
[0m10:14:41.354402 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_color_map
[0m10:14:41.355070 [info ] [Thread-1  ]: 2 of 6 START seed file ruggable.rugs_usa_color_map ............................. [RUN]
[0m10:14:41.355643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_category_map, now seed.ruggable.rugs_usa_color_map)
[0m10:14:41.355990 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_color_map
[0m10:14:41.356306 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_color_map
[0m10:14:41.422079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:45.480718 [debug] [Thread-1  ]: On seed.ruggable.rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "seed.ruggable.rugs_usa_color_map"} */

    alter table `first-project-262802`.`ruggable`.`rugs_usa_color_map` set OPTIONS()
  
[0m10:14:45.930739 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dfabca0b-cab4-47f0-ad23-7fd135bd3a78&page=queryresults
[0m10:14:46.510461 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ruggable.rugs_usa_color_map"
[0m10:14:46.520373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12553e1f0>]}
[0m10:14:46.521779 [info ] [Thread-1  ]: 2 of 6 OK loaded seed file ruggable.rugs_usa_color_map ......................... [[32mINSERT 17232[0m in 5.16s]
[0m10:14:46.523408 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_color_map
[0m10:14:46.524325 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_links
[0m10:14:46.525489 [info ] [Thread-1  ]: 3 of 6 START seed file ruggable.rugs_usa_links ................................. [RUN]
[0m10:14:46.526356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_color_map, now seed.ruggable.rugs_usa_links)
[0m10:14:46.526952 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_links
[0m10:14:46.527471 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_links
[0m10:14:46.628857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:50.721656 [debug] [Thread-1  ]: On seed.ruggable.rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "seed.ruggable.rugs_usa_links"} */

    alter table `first-project-262802`.`ruggable`.`rugs_usa_links` set OPTIONS()
  
[0m10:14:51.090521 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:41b4d859-bbc3-4f0e-a4db-4c3d44e2a11b&page=queryresults
[0m10:14:51.656164 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.ruggable.rugs_usa_links"
[0m10:14:51.666045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12549df10>]}
[0m10:14:51.667371 [info ] [Thread-1  ]: 3 of 6 OK loaded seed file ruggable.rugs_usa_links ............................. [[32mINSERT 5565[0m in 5.14s]
[0m10:14:51.668957 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_links
[0m10:14:51.670212 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:51.671168 [info ] [Thread-1  ]: 4 of 6 START seed file ruggable.rugs_usa_pads_upsell ........................... [RUN]
[0m10:14:51.672361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_links, now seed.ruggable.rugs_usa_pads_upsell)
[0m10:14:51.673240 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:51.674476 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:54.405209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:59.477881 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m10:14:59.479449 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 154; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 154; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 86 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 295 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 403 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 614 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 721 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 905 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1005 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1205 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1313 column_index: 6 column_name: "stock" column_type: INT64 value: "222.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1516 column_index: 6 column_name: "stock" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 1709 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 1809 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2011 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2118 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2303 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2403 column_index: 6 column_name: "stock" column_type: INT64 value: "980.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 2609 column_index: 6 column_name: "stock" column_type: INT64 value: "1849.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 2715 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 2915 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3024 column_index: 6 column_name: "stock" column_type: INT64 value: "105.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3235 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 3343 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 3545 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 3653 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 3838 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 3938 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 4162 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 4270 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 4472 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 4581 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 4767 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 4955 column_index: 6 column_name: "stock" column_type: INT64 value: "133.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 5056 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 5260 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 5368 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 5592 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 5700 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 5924 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 6032 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 6233 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 6342 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 6528 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 6628 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 6831 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 6939 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 7125 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 7313 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 7412 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 7621 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 7734 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 7945 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 8057 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 8268 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 8383 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 8579 column_index: 6 column_name: "stock" column_type: INT64 value: "6.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 8782 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 8883 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 9094 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 9206 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 9419 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 9533 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 9754 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 9871 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 10092 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 10209 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 102 byte_offset_to_start_of_line: 10429 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 103 byte_offset_to_start_of_line: 10546 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 105 byte_offset_to_start_of_line: 10766 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 106 byte_offset_to_start_of_line: 10883 column_index: 6 column_name: "stock" column_type: INT64 value: "1585.0"
  Error while reading data, error message: Unable to parse; line_number: 108 byte_offset_to_start_of_line: 11078 column_index: 6 column_name: "stock" column_type: INT64 value: "525.0"
  Error while reading data, error message: Unable to parse; line_number: 109 byte_offset_to_start_of_line: 11182 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 111 byte_offset_to_start_of_line: 11378 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 112 byte_offset_to_start_of_line: 11483 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 114 byte_offset_to_start_of_line: 11677 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 115 byte_offset_to_start_of_line: 11783 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 117 byte_offset_to_start_of_line: 11962 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 119 byte_offset_to_start_of_line: 12143 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 120 byte_offset_to_start_of_line: 12241 column_index: 6 column_name: "stock" column_type: INT64 value: "218.0"
  Error while reading data, error message: Unable to parse; line_number: 122 byte_offset_to_start_of_line: 12438 column_index: 6 column_name: "stock" column_type: INT64 value: "1157.0"
  Error while reading data, error message: Unable to parse; line_number: 123 byte_offset_to_start_of_line: 12542 column_index: 6 column_name: "stock" column_type: INT64 value: "979.0"
  Error while reading data, error message: Unable to parse; line_number: 125 byte_offset_to_start_of_line: 12743 column_index: 6 column_name: "stock" column_type: INT64 value: "1837.0"
  Error while reading data, error message: Unable to parse; line_number: 127 byte_offset_to_start_of_line: 12931 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 128 byte_offset_to_start_of_line: 13029 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 130 byte_offset_to_start_of_line: 13226 column_index: 6 column_name: "stock" column_type: INT64 value: "1875.0"
  Error while reading data, error message: Unable to parse; line_number: 131 byte_offset_to_start_of_line: 13332 column_index: 6 column_name: "stock" column_type: INT64 value: "103.0"
  Error while reading data, error message: Unable to parse; line_number: 133 byte_offset_to_start_of_line: 13538 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 134 byte_offset_to_start_of_line: 13644 column_index: 6 column_name: "stock" column_type: INT64 value: "288.0"
  Error while reading data, error message: Unable to parse; line_number: 136 byte_offset_to_start_of_line: 13864 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 137 byte_offset_to_start_of_line: 13970 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 139 byte_offset_to_start_of_line: 14150 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 141 byte_offset_to_start_of_line: 14332 column_index: 6 column_name: "stock" column_type: INT64 value: "131.0"
  Error while reading data, error message: Unable to parse; line_number: 142 byte_offset_to_start_of_line: 14431 column_index: 6 column_name: "stock" column_type: INT64 value: "1814.0"
  Error while reading data, error message: Unable to parse; line_number: 144 byte_offset_to_start_of_line: 14629 column_index: 6 column_name: "stock" column_type: INT64 value: "2136.0"
  Error while reading data, error message: Unable to parse; line_number: 145 byte_offset_to_start_of_line: 14735 column_index: 6 column_name: "stock" column_type: INT64 value: "226.0"
  Error while reading data, error message: Unable to parse; line_number: 147 byte_offset_to_start_of_line: 14932 column_index: 6 column_name: "stock" column_type: INT64 value: "4657.0"
  Error while reading data, error message: Unable to parse; line_number: 148 byte_offset_to_start_of_line: 15038 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 150 byte_offset_to_start_of_line: 15218 column_index: 6 column_name: "stock" column_type: INT64 value: "197.0"
  Error while reading data, error message: Unable to parse; line_number: 152 byte_offset_to_start_of_line: 15400 column_index: 6 column_name: "stock" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 153 byte_offset_to_start_of_line: 15497 column_index: 6 column_name: "stock" column_type: INT64 value: "2015.0"
  Error while reading data, error message: Unable to parse; line_number: 155 byte_offset_to_start_of_line: 15702 column_index: 6 column_name: "stock" column_type: INT64 value: "8586.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:14:59.511580 [debug] [Thread-1  ]: Runtime Error in seed rugs_usa_pads_upsell (seeds/rugs_usa_pads_upsell.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 154; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 154; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 86 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 295 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 403 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 614 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 721 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 905 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1005 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1205 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1313 column_index: 6 column_name: "stock" column_type: INT64 value: "222.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1516 column_index: 6 column_name: "stock" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 1709 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 1809 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2011 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2118 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2303 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2403 column_index: 6 column_name: "stock" column_type: INT64 value: "980.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 2609 column_index: 6 column_name: "stock" column_type: INT64 value: "1849.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 2715 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 2915 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3024 column_index: 6 column_name: "stock" column_type: INT64 value: "105.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3235 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 3343 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 3545 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 3653 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 3838 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 3938 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 4162 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 4270 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 4472 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 4581 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 4767 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 4955 column_index: 6 column_name: "stock" column_type: INT64 value: "133.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 5056 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 5260 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 5368 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 5592 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 5700 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 5924 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 6032 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 6233 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 6342 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 6528 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 6628 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 6831 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 6939 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 7125 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 7313 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 7412 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 7621 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 7734 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 7945 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 8057 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 8268 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 8383 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 8579 column_index: 6 column_name: "stock" column_type: INT64 value: "6.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 8782 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 8883 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 9094 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 9206 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 9419 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 9533 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 9754 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 9871 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 10092 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 10209 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 102 byte_offset_to_start_of_line: 10429 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 103 byte_offset_to_start_of_line: 10546 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 105 byte_offset_to_start_of_line: 10766 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 106 byte_offset_to_start_of_line: 10883 column_index: 6 column_name: "stock" column_type: INT64 value: "1585.0"
  Error while reading data, error message: Unable to parse; line_number: 108 byte_offset_to_start_of_line: 11078 column_index: 6 column_name: "stock" column_type: INT64 value: "525.0"
  Error while reading data, error message: Unable to parse; line_number: 109 byte_offset_to_start_of_line: 11182 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 111 byte_offset_to_start_of_line: 11378 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 112 byte_offset_to_start_of_line: 11483 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 114 byte_offset_to_start_of_line: 11677 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 115 byte_offset_to_start_of_line: 11783 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 117 byte_offset_to_start_of_line: 11962 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 119 byte_offset_to_start_of_line: 12143 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 120 byte_offset_to_start_of_line: 12241 column_index: 6 column_name: "stock" column_type: INT64 value: "218.0"
  Error while reading data, error message: Unable to parse; line_number: 122 byte_offset_to_start_of_line: 12438 column_index: 6 column_name: "stock" column_type: INT64 value: "1157.0"
  Error while reading data, error message: Unable to parse; line_number: 123 byte_offset_to_start_of_line: 12542 column_index: 6 column_name: "stock" column_type: INT64 value: "979.0"
  Error while reading data, error message: Unable to parse; line_number: 125 byte_offset_to_start_of_line: 12743 column_index: 6 column_name: "stock" column_type: INT64 value: "1837.0"
  Error while reading data, error message: Unable to parse; line_number: 127 byte_offset_to_start_of_line: 12931 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 128 byte_offset_to_start_of_line: 13029 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 130 byte_offset_to_start_of_line: 13226 column_index: 6 column_name: "stock" column_type: INT64 value: "1875.0"
  Error while reading data, error message: Unable to parse; line_number: 131 byte_offset_to_start_of_line: 13332 column_index: 6 column_name: "stock" column_type: INT64 value: "103.0"
  Error while reading data, error message: Unable to parse; line_number: 133 byte_offset_to_start_of_line: 13538 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 134 byte_offset_to_start_of_line: 13644 column_index: 6 column_name: "stock" column_type: INT64 value: "288.0"
  Error while reading data, error message: Unable to parse; line_number: 136 byte_offset_to_start_of_line: 13864 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 137 byte_offset_to_start_of_line: 13970 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 139 byte_offset_to_start_of_line: 14150 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 141 byte_offset_to_start_of_line: 14332 column_index: 6 column_name: "stock" column_type: INT64 value: "131.0"
  Error while reading data, error message: Unable to parse; line_number: 142 byte_offset_to_start_of_line: 14431 column_index: 6 column_name: "stock" column_type: INT64 value: "1814.0"
  Error while reading data, error message: Unable to parse; line_number: 144 byte_offset_to_start_of_line: 14629 column_index: 6 column_name: "stock" column_type: INT64 value: "2136.0"
  Error while reading data, error message: Unable to parse; line_number: 145 byte_offset_to_start_of_line: 14735 column_index: 6 column_name: "stock" column_type: INT64 value: "226.0"
  Error while reading data, error message: Unable to parse; line_number: 147 byte_offset_to_start_of_line: 14932 column_index: 6 column_name: "stock" column_type: INT64 value: "4657.0"
  Error while reading data, error message: Unable to parse; line_number: 148 byte_offset_to_start_of_line: 15038 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 150 byte_offset_to_start_of_line: 15218 column_index: 6 column_name: "stock" column_type: INT64 value: "197.0"
  Error while reading data, error message: Unable to parse; line_number: 152 byte_offset_to_start_of_line: 15400 column_index: 6 column_name: "stock" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 153 byte_offset_to_start_of_line: 15497 column_index: 6 column_name: "stock" column_type: INT64 value: "2015.0"
  Error while reading data, error message: Unable to parse; line_number: 155 byte_offset_to_start_of_line: 15702 column_index: 6 column_name: "stock" column_type: INT64 value: "8586.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:14:59.512702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12553e1f0>]}
[0m10:14:59.513797 [error] [Thread-1  ]: 4 of 6 ERROR loading seed file ruggable.rugs_usa_pads_upsell ................... [[31mERROR[0m in 7.84s]
[0m10:14:59.514923 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_pads_upsell
[0m10:14:59.515193 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_parent
[0m10:14:59.515552 [info ] [Thread-1  ]: 5 of 6 START seed file ruggable.rugs_usa_parent ................................ [RUN]
[0m10:14:59.515820 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_pads_upsell, now seed.ruggable.rugs_usa_parent)
[0m10:14:59.516022 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_parent
[0m10:14:59.516211 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_parent
[0m10:14:59.686079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:15:03.692899 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m10:15:03.696817 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 5538; errors: 61; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 626 byte_offset_to_start_of_line: 515979 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 682 byte_offset_to_start_of_line: 562755 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 744 byte_offset_to_start_of_line: 614606 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 805 byte_offset_to_start_of_line: 665135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1105 byte_offset_to_start_of_line: 925918 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1137 byte_offset_to_start_of_line: 950170 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1180 byte_offset_to_start_of_line: 985105 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1283 byte_offset_to_start_of_line: 1075556 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1304 byte_offset_to_start_of_line: 1091943 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1357 byte_offset_to_start_of_line: 1135173 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1373 byte_offset_to_start_of_line: 1148625 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1417 byte_offset_to_start_of_line: 1186756 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1533 byte_offset_to_start_of_line: 1285319 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1635 byte_offset_to_start_of_line: 1370267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1760 byte_offset_to_start_of_line: 1475910 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1833 byte_offset_to_start_of_line: 1534713 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1878 byte_offset_to_start_of_line: 1574149 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2156 byte_offset_to_start_of_line: 1798610 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2268 byte_offset_to_start_of_line: 1887585 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2386 byte_offset_to_start_of_line: 1981363 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2397 byte_offset_to_start_of_line: 1989582 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2497 byte_offset_to_start_of_line: 2074495 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2572 byte_offset_to_start_of_line: 2133458 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 3250 byte_offset_to_start_of_line: 2668226 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 627 byte_offset_to_start_of_line: 517051 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 683 byte_offset_to_start_of_line: 563848 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 745 byte_offset_to_start_of_line: 615684 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1106 byte_offset_to_start_of_line: 926974 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1181 byte_offset_to_start_of_line: 986153 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1358 byte_offset_to_start_of_line: 1136232 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1418 byte_offset_to_start_of_line: 1187833 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1420 byte_offset_to_start_of_line: 1188645 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1636 byte_offset_to_start_of_line: 1371306 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1761 byte_offset_to_start_of_line: 1476984 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1834 byte_offset_to_start_of_line: 1535772 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2157 byte_offset_to_start_of_line: 1799664 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2387 byte_offset_to_start_of_line: 1982160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2398 byte_offset_to_start_of_line: 1990375 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2498 byte_offset_to_start_of_line: 2075267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 628 byte_offset_to_start_of_line: 517058 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 684 byte_offset_to_start_of_line: 563855 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 746 byte_offset_to_start_of_line: 615691 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1107 byte_offset_to_start_of_line: 926981 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1182 byte_offset_to_start_of_line: 986160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1359 byte_offset_to_start_of_line: 1136239 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1421 byte_offset_to_start_of_line: 1188646 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1637 byte_offset_to_start_of_line: 1371313 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1762 byte_offset_to_start_of_line: 1476991 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1835 byte_offset_to_start_of_line: 1535779 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1879 byte_offset_to_start_of_line: 1574884 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 2158 byte_offset_to_start_of_line: 1799671 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 806 byte_offset_to_start_of_line: 665886 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 1419 byte_offset_to_start_of_line: 1187840 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 8 columns.; line_number: 1138 byte_offset_to_start_of_line: 950795 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1284 byte_offset_to_start_of_line: 1076335 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1305 byte_offset_to_start_of_line: 1092562 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1374 byte_offset_to_start_of_line: 1149300 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1534 byte_offset_to_start_of_line: 1285994 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2269 byte_offset_to_start_of_line: 1888347 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2573 byte_offset_to_start_of_line: 2134135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 3251 byte_offset_to_start_of_line: 2668988 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:03.725380 [debug] [Thread-1  ]: Runtime Error in seed rugs_usa_parent (seeds/rugs_usa_parent.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 5538; errors: 61; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 626 byte_offset_to_start_of_line: 515979 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 682 byte_offset_to_start_of_line: 562755 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 744 byte_offset_to_start_of_line: 614606 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 805 byte_offset_to_start_of_line: 665135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1105 byte_offset_to_start_of_line: 925918 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1137 byte_offset_to_start_of_line: 950170 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1180 byte_offset_to_start_of_line: 985105 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1283 byte_offset_to_start_of_line: 1075556 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1304 byte_offset_to_start_of_line: 1091943 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1357 byte_offset_to_start_of_line: 1135173 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1373 byte_offset_to_start_of_line: 1148625 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1417 byte_offset_to_start_of_line: 1186756 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1533 byte_offset_to_start_of_line: 1285319 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1635 byte_offset_to_start_of_line: 1370267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1760 byte_offset_to_start_of_line: 1475910 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1833 byte_offset_to_start_of_line: 1534713 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1878 byte_offset_to_start_of_line: 1574149 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2156 byte_offset_to_start_of_line: 1798610 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2268 byte_offset_to_start_of_line: 1887585 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2386 byte_offset_to_start_of_line: 1981363 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2397 byte_offset_to_start_of_line: 1989582 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2497 byte_offset_to_start_of_line: 2074495 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2572 byte_offset_to_start_of_line: 2133458 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 3250 byte_offset_to_start_of_line: 2668226 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 627 byte_offset_to_start_of_line: 517051 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 683 byte_offset_to_start_of_line: 563848 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 745 byte_offset_to_start_of_line: 615684 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1106 byte_offset_to_start_of_line: 926974 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1181 byte_offset_to_start_of_line: 986153 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1358 byte_offset_to_start_of_line: 1136232 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1418 byte_offset_to_start_of_line: 1187833 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1420 byte_offset_to_start_of_line: 1188645 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1636 byte_offset_to_start_of_line: 1371306 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1761 byte_offset_to_start_of_line: 1476984 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1834 byte_offset_to_start_of_line: 1535772 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2157 byte_offset_to_start_of_line: 1799664 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2387 byte_offset_to_start_of_line: 1982160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2398 byte_offset_to_start_of_line: 1990375 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2498 byte_offset_to_start_of_line: 2075267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 628 byte_offset_to_start_of_line: 517058 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 684 byte_offset_to_start_of_line: 563855 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 746 byte_offset_to_start_of_line: 615691 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1107 byte_offset_to_start_of_line: 926981 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1182 byte_offset_to_start_of_line: 986160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1359 byte_offset_to_start_of_line: 1136239 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1421 byte_offset_to_start_of_line: 1188646 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1637 byte_offset_to_start_of_line: 1371313 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1762 byte_offset_to_start_of_line: 1476991 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1835 byte_offset_to_start_of_line: 1535779 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1879 byte_offset_to_start_of_line: 1574884 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 2158 byte_offset_to_start_of_line: 1799671 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 806 byte_offset_to_start_of_line: 665886 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 1419 byte_offset_to_start_of_line: 1187840 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 8 columns.; line_number: 1138 byte_offset_to_start_of_line: 950795 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1284 byte_offset_to_start_of_line: 1076335 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1305 byte_offset_to_start_of_line: 1092562 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1374 byte_offset_to_start_of_line: 1149300 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1534 byte_offset_to_start_of_line: 1285994 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2269 byte_offset_to_start_of_line: 1888347 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2573 byte_offset_to_start_of_line: 2134135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 3251 byte_offset_to_start_of_line: 2668988 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:03.727418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12553ecd0>]}
[0m10:15:03.729029 [error] [Thread-1  ]: 5 of 6 ERROR loading seed file ruggable.rugs_usa_parent ........................ [[31mERROR[0m in 4.21s]
[0m10:15:03.730642 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_parent
[0m10:15:03.731081 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_variant
[0m10:15:03.731732 [info ] [Thread-1  ]: 6 of 6 START seed file ruggable.rugs_usa_variant ............................... [RUN]
[0m10:15:03.732243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_parent, now seed.ruggable.rugs_usa_variant)
[0m10:15:03.732576 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_variant
[0m10:15:03.732884 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_variant
[0m10:15:05.314895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:15:10.131844 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
LOAD TABLE
[0m10:15:10.134160 [debug] [Thread-1  ]: BigQuery adapter: Runtime Error
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 276 column_index: 11 column_name: "stock_level" column_type: INT64 value: "279.0"
  Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 432 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1299.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 593 column_index: 11 column_name: "stock_level" column_type: INT64 value: "509.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 736 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3186.0"
  Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 888 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1594.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1049 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1193 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2763.0"
  Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1348 column_index: 11 column_name: "stock_level" column_type: INT64 value: "11293.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1495 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1821.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1657 column_index: 11 column_name: "stock_level" column_type: INT64 value: "462.0"
  Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1808 column_index: 11 column_name: "stock_level" column_type: INT64 value: "882.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1970 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2856.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2126 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2270 column_index: 11 column_name: "stock_level" column_type: INT64 value: "514.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2435 column_index: 11 column_name: "stock_level" column_type: INT64 value: "73.0"
  Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2585 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4542.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2732 column_index: 11 column_name: "stock_level" column_type: INT64 value: "799.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2878 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13534.0"
  Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "78.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3197 column_index: 11 column_name: "stock_level" column_type: INT64 value: "70.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3358 column_index: 11 column_name: "stock_level" column_type: INT64 value: "68.0"
  Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3508 column_index: 11 column_name: "stock_level" column_type: INT64 value: "427.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3653 column_index: 11 column_name: "stock_level" column_type: INT64 value: "16175.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3811 column_index: 11 column_name: "stock_level" column_type: INT64 value: "718.0"
  Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3957 column_index: 11 column_name: "stock_level" column_type: INT64 value: "581.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4103 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4257 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2611.0"
  Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4417 column_index: 11 column_name: "stock_level" column_type: INT64 value: "41.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4572 column_index: 11 column_name: "stock_level" column_type: INT64 value: "83.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4723 column_index: 11 column_name: "stock_level" column_type: INT64 value: "140.0"
  Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 4876 column_index: 11 column_name: "stock_level" column_type: INT64 value: "238.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1221.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5199 column_index: 11 column_name: "stock_level" column_type: INT64 value: "185.0"
  Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5364 column_index: 11 column_name: "stock_level" column_type: INT64 value: "428.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5529 column_index: 11 column_name: "stock_level" column_type: INT64 value: "249.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5698 column_index: 11 column_name: "stock_level" column_type: INT64 value: "79.0"
  Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 5864 column_index: 11 column_name: "stock_level" column_type: INT64 value: "121.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6015 column_index: 11 column_name: "stock_level" column_type: INT64 value: "96.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6166 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6311 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6451 column_index: 11 column_name: "stock_level" column_type: INT64 value: "72.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6591 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3.0"
  Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 6746 column_index: 11 column_name: "stock_level" column_type: INT64 value: "61.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 6906 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7046 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7201 column_index: 11 column_name: "stock_level" column_type: INT64 value: "29.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7360 column_index: 11 column_name: "stock_level" column_type: INT64 value: "-17.0"
  Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7675 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 7823 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 7966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "112.0"
  Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 8112 column_index: 11 column_name: "stock_level" column_type: INT64 value: "717.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 8267 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 8422 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13.0"
  Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 8564 column_index: 11 column_name: "stock_level" column_type: INT64 value: "71.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 8710 column_index: 11 column_name: "stock_level" column_type: INT64 value: "556.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 8869 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2.0"
  Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 9021 column_index: 11 column_name: "stock_level" column_type: INT64 value: "25.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 9171 column_index: 11 column_name: "stock_level" column_type: INT64 value: "156.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 9330 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 9643 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 9803 column_index: 11 column_name: "stock_level" column_type: INT64 value: "151.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 9966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 10131 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 10286 column_index: 11 column_name: "stock_level" column_type: INT64 value: "63.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 10447 column_index: 11 column_name: "stock_level" column_type: INT64 value: "378.0"
  Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 10603 column_index: 11 column_name: "stock_level" column_type: INT64 value: "43.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 10747 column_index: 11 column_name: "stock_level" column_type: INT64 value: "393.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 10909 column_index: 11 column_name: "stock_level" column_type: INT64 value: "605.0"
  Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 11071 column_index: 11 column_name: "stock_level" column_type: INT64 value: "101.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 11236 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 11394 column_index: 11 column_name: "stock_level" column_type: INT64 value: "147.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 11559 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 11707 column_index: 11 column_name: "stock_level" column_type: INT64 value: "110.0"
  Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 11854 column_index: 11 column_name: "stock_level" column_type: INT64 value: "696.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 12012 column_index: 11 column_name: "stock_level" column_type: INT64 value: "931.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 12170 column_index: 11 column_name: "stock_level" column_type: INT64 value: "400.0"
  Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 12321 column_index: 11 column_name: "stock_level" column_type: INT64 value: "127.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 12470 column_index: 11 column_name: "stock_level" column_type: INT64 value: "603.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 12641 column_index: 11 column_name: "stock_level" column_type: INT64 value: "810.0"
  Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 12805 column_index: 11 column_name: "stock_level" column_type: INT64 value: "255.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 12973 column_index: 11 column_name: "stock_level" column_type: INT64 value: "32.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 13143 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3242.0"
  Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 13303 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2086.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 13463 column_index: 11 column_name: "stock_level" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 13618 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 13767 column_index: 11 column_name: "stock_level" column_type: INT64 value: "206.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 13917 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1573.0"
  Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 14078 column_index: 11 column_name: "stock_level" column_type: INT64 value: "5112.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 14245 column_index: 11 column_name: "stock_level" column_type: INT64 value: "371.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 14413 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 14568 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1095.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 14720 column_index: 11 column_name: "stock_level" column_type: INT64 value: "172.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 14871 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3149.0"
  Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 15032 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1709.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 15203 column_index: 11 column_name: "stock_level" column_type: INT64 value: "104.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 15371 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 15521 column_index: 11 column_name: "stock_level" column_type: INT64 value: "48.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 15676 column_index: 11 column_name: "stock_level" column_type: INT64 value: "306.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 15827 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4000.0"
  Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 15996 column_index: 11 column_name: "stock_level" column_type: INT64 value: "69.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.170640 [debug] [Thread-1  ]: Runtime Error in seed rugs_usa_variant (seeds/rugs_usa_variant.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 276 column_index: 11 column_name: "stock_level" column_type: INT64 value: "279.0"
  Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 432 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1299.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 593 column_index: 11 column_name: "stock_level" column_type: INT64 value: "509.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 736 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3186.0"
  Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 888 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1594.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1049 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1193 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2763.0"
  Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1348 column_index: 11 column_name: "stock_level" column_type: INT64 value: "11293.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1495 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1821.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1657 column_index: 11 column_name: "stock_level" column_type: INT64 value: "462.0"
  Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1808 column_index: 11 column_name: "stock_level" column_type: INT64 value: "882.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1970 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2856.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2126 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2270 column_index: 11 column_name: "stock_level" column_type: INT64 value: "514.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2435 column_index: 11 column_name: "stock_level" column_type: INT64 value: "73.0"
  Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2585 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4542.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2732 column_index: 11 column_name: "stock_level" column_type: INT64 value: "799.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2878 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13534.0"
  Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "78.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3197 column_index: 11 column_name: "stock_level" column_type: INT64 value: "70.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3358 column_index: 11 column_name: "stock_level" column_type: INT64 value: "68.0"
  Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3508 column_index: 11 column_name: "stock_level" column_type: INT64 value: "427.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3653 column_index: 11 column_name: "stock_level" column_type: INT64 value: "16175.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3811 column_index: 11 column_name: "stock_level" column_type: INT64 value: "718.0"
  Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3957 column_index: 11 column_name: "stock_level" column_type: INT64 value: "581.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4103 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4257 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2611.0"
  Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4417 column_index: 11 column_name: "stock_level" column_type: INT64 value: "41.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4572 column_index: 11 column_name: "stock_level" column_type: INT64 value: "83.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4723 column_index: 11 column_name: "stock_level" column_type: INT64 value: "140.0"
  Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 4876 column_index: 11 column_name: "stock_level" column_type: INT64 value: "238.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1221.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5199 column_index: 11 column_name: "stock_level" column_type: INT64 value: "185.0"
  Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5364 column_index: 11 column_name: "stock_level" column_type: INT64 value: "428.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5529 column_index: 11 column_name: "stock_level" column_type: INT64 value: "249.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5698 column_index: 11 column_name: "stock_level" column_type: INT64 value: "79.0"
  Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 5864 column_index: 11 column_name: "stock_level" column_type: INT64 value: "121.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6015 column_index: 11 column_name: "stock_level" column_type: INT64 value: "96.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6166 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6311 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6451 column_index: 11 column_name: "stock_level" column_type: INT64 value: "72.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6591 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3.0"
  Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 6746 column_index: 11 column_name: "stock_level" column_type: INT64 value: "61.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 6906 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7046 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7201 column_index: 11 column_name: "stock_level" column_type: INT64 value: "29.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7360 column_index: 11 column_name: "stock_level" column_type: INT64 value: "-17.0"
  Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7675 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 7823 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 7966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "112.0"
  Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 8112 column_index: 11 column_name: "stock_level" column_type: INT64 value: "717.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 8267 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 8422 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13.0"
  Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 8564 column_index: 11 column_name: "stock_level" column_type: INT64 value: "71.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 8710 column_index: 11 column_name: "stock_level" column_type: INT64 value: "556.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 8869 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2.0"
  Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 9021 column_index: 11 column_name: "stock_level" column_type: INT64 value: "25.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 9171 column_index: 11 column_name: "stock_level" column_type: INT64 value: "156.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 9330 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 9643 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 9803 column_index: 11 column_name: "stock_level" column_type: INT64 value: "151.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 9966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 10131 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 10286 column_index: 11 column_name: "stock_level" column_type: INT64 value: "63.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 10447 column_index: 11 column_name: "stock_level" column_type: INT64 value: "378.0"
  Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 10603 column_index: 11 column_name: "stock_level" column_type: INT64 value: "43.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 10747 column_index: 11 column_name: "stock_level" column_type: INT64 value: "393.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 10909 column_index: 11 column_name: "stock_level" column_type: INT64 value: "605.0"
  Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 11071 column_index: 11 column_name: "stock_level" column_type: INT64 value: "101.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 11236 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 11394 column_index: 11 column_name: "stock_level" column_type: INT64 value: "147.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 11559 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 11707 column_index: 11 column_name: "stock_level" column_type: INT64 value: "110.0"
  Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 11854 column_index: 11 column_name: "stock_level" column_type: INT64 value: "696.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 12012 column_index: 11 column_name: "stock_level" column_type: INT64 value: "931.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 12170 column_index: 11 column_name: "stock_level" column_type: INT64 value: "400.0"
  Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 12321 column_index: 11 column_name: "stock_level" column_type: INT64 value: "127.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 12470 column_index: 11 column_name: "stock_level" column_type: INT64 value: "603.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 12641 column_index: 11 column_name: "stock_level" column_type: INT64 value: "810.0"
  Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 12805 column_index: 11 column_name: "stock_level" column_type: INT64 value: "255.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 12973 column_index: 11 column_name: "stock_level" column_type: INT64 value: "32.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 13143 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3242.0"
  Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 13303 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2086.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 13463 column_index: 11 column_name: "stock_level" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 13618 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 13767 column_index: 11 column_name: "stock_level" column_type: INT64 value: "206.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 13917 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1573.0"
  Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 14078 column_index: 11 column_name: "stock_level" column_type: INT64 value: "5112.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 14245 column_index: 11 column_name: "stock_level" column_type: INT64 value: "371.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 14413 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 14568 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1095.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 14720 column_index: 11 column_name: "stock_level" column_type: INT64 value: "172.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 14871 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3149.0"
  Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 15032 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1709.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 15203 column_index: 11 column_name: "stock_level" column_type: INT64 value: "104.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 15371 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 15521 column_index: 11 column_name: "stock_level" column_type: INT64 value: "48.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 15676 column_index: 11 column_name: "stock_level" column_type: INT64 value: "306.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 15827 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4000.0"
  Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 15996 column_index: 11 column_name: "stock_level" column_type: INT64 value: "69.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.173020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7936a34-163f-4b1b-9927-ea3729ab9904', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102713d30>]}
[0m10:15:10.174739 [error] [Thread-1  ]: 6 of 6 ERROR loading seed file ruggable.rugs_usa_variant ....................... [[31mERROR[0m in 6.44s]
[0m10:15:10.176370 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_variant
[0m10:15:10.177795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:10.178063 [debug] [MainThread]: Connection 'seed.ruggable.rugs_usa_variant' was properly closed.
[0m10:15:10.178331 [info ] [MainThread]: 
[0m10:15:10.178587 [info ] [MainThread]: Finished running 6 seeds in 0 hours 0 minutes and 35.69 seconds (35.69s).
[0m10:15:10.182189 [debug] [MainThread]: Command end result
[0m10:15:10.210380 [info ] [MainThread]: 
[0m10:15:10.210665 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:15:10.210826 [info ] [MainThread]: 
[0m10:15:10.211644 [error] [MainThread]:   Runtime Error in seed rugs_usa_pads_upsell (seeds/rugs_usa_pads_upsell.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 154; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 154; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 86 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 295 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 403 column_index: 6 column_name: "stock" column_type: INT64 value: "1586.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 614 column_index: 6 column_name: "stock" column_type: INT64 value: "527.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 721 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 905 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1005 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1205 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 1313 column_index: 6 column_name: "stock" column_type: INT64 value: "222.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 1516 column_index: 6 column_name: "stock" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 1709 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 1809 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 2011 column_index: 6 column_name: "stock" column_type: INT64 value: "889.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 2118 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 2303 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 2403 column_index: 6 column_name: "stock" column_type: INT64 value: "980.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 2609 column_index: 6 column_name: "stock" column_type: INT64 value: "1849.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 2715 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 2915 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 3024 column_index: 6 column_name: "stock" column_type: INT64 value: "105.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 3235 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 3343 column_index: 6 column_name: "stock" column_type: INT64 value: "1365.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 3545 column_index: 6 column_name: "stock" column_type: INT64 value: "1876.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 3653 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 3838 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 3938 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 4162 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 4270 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 4472 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 4581 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 4767 column_index: 6 column_name: "stock" column_type: INT64 value: "210.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 4955 column_index: 6 column_name: "stock" column_type: INT64 value: "133.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 5056 column_index: 6 column_name: "stock" column_type: INT64 value: "1819.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 5260 column_index: 6 column_name: "stock" column_type: INT64 value: "2144.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 5368 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 5592 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 5700 column_index: 6 column_name: "stock" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 5924 column_index: 6 column_name: "stock" column_type: INT64 value: "60.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 6032 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 6233 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 6342 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 6528 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 6628 column_index: 6 column_name: "stock" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 6831 column_index: 6 column_name: "stock" column_type: INT64 value: "4577.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 6939 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 7125 column_index: 6 column_name: "stock" column_type: INT64 value: "199.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 7313 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 7412 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 7621 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 7734 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 7945 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 8057 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 8268 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 8383 column_index: 6 column_name: "stock" column_type: INT64 value: "95.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 8579 column_index: 6 column_name: "stock" column_type: INT64 value: "6.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 8782 column_index: 6 column_name: "stock" column_type: INT64 value: "8.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 8883 column_index: 6 column_name: "stock" column_type: INT64 value: "2016.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 9094 column_index: 6 column_name: "stock" column_type: INT64 value: "8579.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 9206 column_index: 6 column_name: "stock" column_type: INT64 value: "661.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 9419 column_index: 6 column_name: "stock" column_type: INT64 value: "3535.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 9533 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 9754 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 9871 column_index: 6 column_name: "stock" column_type: INT64 value: "111.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 10092 column_index: 6 column_name: "stock" column_type: INT64 value: "932.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 10209 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 102 byte_offset_to_start_of_line: 10429 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 103 byte_offset_to_start_of_line: 10546 column_index: 6 column_name: "stock" column_type: INT64 value: "102.0"
  Error while reading data, error message: Unable to parse; line_number: 105 byte_offset_to_start_of_line: 10766 column_index: 6 column_name: "stock" column_type: INT64 value: "261.0"
  Error while reading data, error message: Unable to parse; line_number: 106 byte_offset_to_start_of_line: 10883 column_index: 6 column_name: "stock" column_type: INT64 value: "1585.0"
  Error while reading data, error message: Unable to parse; line_number: 108 byte_offset_to_start_of_line: 11078 column_index: 6 column_name: "stock" column_type: INT64 value: "525.0"
  Error while reading data, error message: Unable to parse; line_number: 109 byte_offset_to_start_of_line: 11182 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 111 byte_offset_to_start_of_line: 11378 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 112 byte_offset_to_start_of_line: 11483 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 114 byte_offset_to_start_of_line: 11677 column_index: 6 column_name: "stock" column_type: INT64 value: "887.0"
  Error while reading data, error message: Unable to parse; line_number: 115 byte_offset_to_start_of_line: 11783 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 117 byte_offset_to_start_of_line: 11962 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 119 byte_offset_to_start_of_line: 12143 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 120 byte_offset_to_start_of_line: 12241 column_index: 6 column_name: "stock" column_type: INT64 value: "218.0"
  Error while reading data, error message: Unable to parse; line_number: 122 byte_offset_to_start_of_line: 12438 column_index: 6 column_name: "stock" column_type: INT64 value: "1157.0"
  Error while reading data, error message: Unable to parse; line_number: 123 byte_offset_to_start_of_line: 12542 column_index: 6 column_name: "stock" column_type: INT64 value: "979.0"
  Error while reading data, error message: Unable to parse; line_number: 125 byte_offset_to_start_of_line: 12743 column_index: 6 column_name: "stock" column_type: INT64 value: "1837.0"
  Error while reading data, error message: Unable to parse; line_number: 127 byte_offset_to_start_of_line: 12931 column_index: 6 column_name: "stock" column_type: INT64 value: "67.0"
  Error while reading data, error message: Unable to parse; line_number: 128 byte_offset_to_start_of_line: 13029 column_index: 6 column_name: "stock" column_type: INT64 value: "1360.0"
  Error while reading data, error message: Unable to parse; line_number: 130 byte_offset_to_start_of_line: 13226 column_index: 6 column_name: "stock" column_type: INT64 value: "1875.0"
  Error while reading data, error message: Unable to parse; line_number: 131 byte_offset_to_start_of_line: 13332 column_index: 6 column_name: "stock" column_type: INT64 value: "103.0"
  Error while reading data, error message: Unable to parse; line_number: 133 byte_offset_to_start_of_line: 13538 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 134 byte_offset_to_start_of_line: 13644 column_index: 6 column_name: "stock" column_type: INT64 value: "288.0"
  Error while reading data, error message: Unable to parse; line_number: 136 byte_offset_to_start_of_line: 13864 column_index: 6 column_name: "stock" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 137 byte_offset_to_start_of_line: 13970 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 139 byte_offset_to_start_of_line: 14150 column_index: 6 column_name: "stock" column_type: INT64 value: "209.0"
  Error while reading data, error message: Unable to parse; line_number: 141 byte_offset_to_start_of_line: 14332 column_index: 6 column_name: "stock" column_type: INT64 value: "131.0"
  Error while reading data, error message: Unable to parse; line_number: 142 byte_offset_to_start_of_line: 14431 column_index: 6 column_name: "stock" column_type: INT64 value: "1814.0"
  Error while reading data, error message: Unable to parse; line_number: 144 byte_offset_to_start_of_line: 14629 column_index: 6 column_name: "stock" column_type: INT64 value: "2136.0"
  Error while reading data, error message: Unable to parse; line_number: 145 byte_offset_to_start_of_line: 14735 column_index: 6 column_name: "stock" column_type: INT64 value: "226.0"
  Error while reading data, error message: Unable to parse; line_number: 147 byte_offset_to_start_of_line: 14932 column_index: 6 column_name: "stock" column_type: INT64 value: "4657.0"
  Error while reading data, error message: Unable to parse; line_number: 148 byte_offset_to_start_of_line: 15038 column_index: 6 column_name: "stock" column_type: INT64 value: "91.0"
  Error while reading data, error message: Unable to parse; line_number: 150 byte_offset_to_start_of_line: 15218 column_index: 6 column_name: "stock" column_type: INT64 value: "197.0"
  Error while reading data, error message: Unable to parse; line_number: 152 byte_offset_to_start_of_line: 15400 column_index: 6 column_name: "stock" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 153 byte_offset_to_start_of_line: 15497 column_index: 6 column_name: "stock" column_type: INT64 value: "2015.0"
  Error while reading data, error message: Unable to parse; line_number: 155 byte_offset_to_start_of_line: 15702 column_index: 6 column_name: "stock" column_type: INT64 value: "8586.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.212937 [info ] [MainThread]: 
[0m10:15:10.213653 [error] [MainThread]:   Runtime Error in seed rugs_usa_parent (seeds/rugs_usa_parent.csv)
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 5538; errors: 61; max bad: 0; error percent: 0
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 626 byte_offset_to_start_of_line: 515979 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 682 byte_offset_to_start_of_line: 562755 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 744 byte_offset_to_start_of_line: 614606 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 805 byte_offset_to_start_of_line: 665135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1105 byte_offset_to_start_of_line: 925918 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1137 byte_offset_to_start_of_line: 950170 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1180 byte_offset_to_start_of_line: 985105 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1283 byte_offset_to_start_of_line: 1075556 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1304 byte_offset_to_start_of_line: 1091943 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1357 byte_offset_to_start_of_line: 1135173 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1373 byte_offset_to_start_of_line: 1148625 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1417 byte_offset_to_start_of_line: 1186756 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1533 byte_offset_to_start_of_line: 1285319 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1635 byte_offset_to_start_of_line: 1370267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1760 byte_offset_to_start_of_line: 1475910 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1833 byte_offset_to_start_of_line: 1534713 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 1878 byte_offset_to_start_of_line: 1574149 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2156 byte_offset_to_start_of_line: 1798610 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2268 byte_offset_to_start_of_line: 1887585 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2386 byte_offset_to_start_of_line: 1981363 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2397 byte_offset_to_start_of_line: 1989582 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2497 byte_offset_to_start_of_line: 2074495 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 2572 byte_offset_to_start_of_line: 2133458 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 21 columns.; line_number: 3250 byte_offset_to_start_of_line: 2668226 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 627 byte_offset_to_start_of_line: 517051 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 683 byte_offset_to_start_of_line: 563848 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 745 byte_offset_to_start_of_line: 615684 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1106 byte_offset_to_start_of_line: 926974 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1181 byte_offset_to_start_of_line: 986153 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1358 byte_offset_to_start_of_line: 1136232 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1418 byte_offset_to_start_of_line: 1187833 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1420 byte_offset_to_start_of_line: 1188645 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1636 byte_offset_to_start_of_line: 1371306 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1761 byte_offset_to_start_of_line: 1476984 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 1834 byte_offset_to_start_of_line: 1535772 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2157 byte_offset_to_start_of_line: 1799664 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2387 byte_offset_to_start_of_line: 1982160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2398 byte_offset_to_start_of_line: 1990375 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 1 columns.; line_number: 2498 byte_offset_to_start_of_line: 2075267 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 628 byte_offset_to_start_of_line: 517058 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 684 byte_offset_to_start_of_line: 563855 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 746 byte_offset_to_start_of_line: 615691 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1107 byte_offset_to_start_of_line: 926981 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1182 byte_offset_to_start_of_line: 986160 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1359 byte_offset_to_start_of_line: 1136239 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1421 byte_offset_to_start_of_line: 1188646 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1637 byte_offset_to_start_of_line: 1371313 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1762 byte_offset_to_start_of_line: 1476991 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1835 byte_offset_to_start_of_line: 1535779 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 1879 byte_offset_to_start_of_line: 1574884 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 7 columns.; line_number: 2158 byte_offset_to_start_of_line: 1799671 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 806 byte_offset_to_start_of_line: 665886 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 5 columns.; line_number: 1419 byte_offset_to_start_of_line: 1187840 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 8 columns.; line_number: 1138 byte_offset_to_start_of_line: 950795 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1284 byte_offset_to_start_of_line: 1076335 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1305 byte_offset_to_start_of_line: 1092562 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1374 byte_offset_to_start_of_line: 1149300 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 1534 byte_offset_to_start_of_line: 1285994 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2269 byte_offset_to_start_of_line: 1888347 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 2573 byte_offset_to_start_of_line: 2134135 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  Error while reading data, error message: CSV table references column position 22, but line contains only 6 columns.; line_number: 3251 byte_offset_to_start_of_line: 2668988 column_index: 22 column_name: "dw_insert_timestamp" column_type: STRING
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.214477 [info ] [MainThread]: 
[0m10:15:10.215283 [error] [MainThread]:   Runtime Error in seed rugs_usa_variant (seeds/rugs_usa_variant.csv)
  Error while reading data, error message: CSV table encountered too many errors, giving up. Rows: 100; errors: 100. Please look into the errors[] collection for more details.
  Error while reading data, error message: CSV processing encountered too many errors, giving up. Rows: 100; errors: 100; max bad: 0; error percent: 0
  Error while reading data, error message: Unable to parse; line_number: 2 byte_offset_to_start_of_line: 276 column_index: 11 column_name: "stock_level" column_type: INT64 value: "279.0"
  Error while reading data, error message: Unable to parse; line_number: 3 byte_offset_to_start_of_line: 432 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1299.0"
  Error while reading data, error message: Unable to parse; line_number: 4 byte_offset_to_start_of_line: 593 column_index: 11 column_name: "stock_level" column_type: INT64 value: "509.0"
  Error while reading data, error message: Unable to parse; line_number: 5 byte_offset_to_start_of_line: 736 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3186.0"
  Error while reading data, error message: Unable to parse; line_number: 6 byte_offset_to_start_of_line: 888 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1594.0"
  Error while reading data, error message: Unable to parse; line_number: 7 byte_offset_to_start_of_line: 1049 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 8 byte_offset_to_start_of_line: 1193 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2763.0"
  Error while reading data, error message: Unable to parse; line_number: 9 byte_offset_to_start_of_line: 1348 column_index: 11 column_name: "stock_level" column_type: INT64 value: "11293.0"
  Error while reading data, error message: Unable to parse; line_number: 10 byte_offset_to_start_of_line: 1495 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1821.0"
  Error while reading data, error message: Unable to parse; line_number: 11 byte_offset_to_start_of_line: 1657 column_index: 11 column_name: "stock_level" column_type: INT64 value: "462.0"
  Error while reading data, error message: Unable to parse; line_number: 12 byte_offset_to_start_of_line: 1808 column_index: 11 column_name: "stock_level" column_type: INT64 value: "882.0"
  Error while reading data, error message: Unable to parse; line_number: 13 byte_offset_to_start_of_line: 1970 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2856.0"
  Error while reading data, error message: Unable to parse; line_number: 14 byte_offset_to_start_of_line: 2126 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1152.0"
  Error while reading data, error message: Unable to parse; line_number: 15 byte_offset_to_start_of_line: 2270 column_index: 11 column_name: "stock_level" column_type: INT64 value: "514.0"
  Error while reading data, error message: Unable to parse; line_number: 16 byte_offset_to_start_of_line: 2435 column_index: 11 column_name: "stock_level" column_type: INT64 value: "73.0"
  Error while reading data, error message: Unable to parse; line_number: 17 byte_offset_to_start_of_line: 2585 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4542.0"
  Error while reading data, error message: Unable to parse; line_number: 18 byte_offset_to_start_of_line: 2732 column_index: 11 column_name: "stock_level" column_type: INT64 value: "799.0"
  Error while reading data, error message: Unable to parse; line_number: 19 byte_offset_to_start_of_line: 2878 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13534.0"
  Error while reading data, error message: Unable to parse; line_number: 20 byte_offset_to_start_of_line: 3036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "78.0"
  Error while reading data, error message: Unable to parse; line_number: 21 byte_offset_to_start_of_line: 3197 column_index: 11 column_name: "stock_level" column_type: INT64 value: "70.0"
  Error while reading data, error message: Unable to parse; line_number: 22 byte_offset_to_start_of_line: 3358 column_index: 11 column_name: "stock_level" column_type: INT64 value: "68.0"
  Error while reading data, error message: Unable to parse; line_number: 23 byte_offset_to_start_of_line: 3508 column_index: 11 column_name: "stock_level" column_type: INT64 value: "427.0"
  Error while reading data, error message: Unable to parse; line_number: 24 byte_offset_to_start_of_line: 3653 column_index: 11 column_name: "stock_level" column_type: INT64 value: "16175.0"
  Error while reading data, error message: Unable to parse; line_number: 25 byte_offset_to_start_of_line: 3811 column_index: 11 column_name: "stock_level" column_type: INT64 value: "718.0"
  Error while reading data, error message: Unable to parse; line_number: 26 byte_offset_to_start_of_line: 3957 column_index: 11 column_name: "stock_level" column_type: INT64 value: "581.0"
  Error while reading data, error message: Unable to parse; line_number: 27 byte_offset_to_start_of_line: 4103 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 28 byte_offset_to_start_of_line: 4257 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2611.0"
  Error while reading data, error message: Unable to parse; line_number: 29 byte_offset_to_start_of_line: 4417 column_index: 11 column_name: "stock_level" column_type: INT64 value: "41.0"
  Error while reading data, error message: Unable to parse; line_number: 30 byte_offset_to_start_of_line: 4572 column_index: 11 column_name: "stock_level" column_type: INT64 value: "83.0"
  Error while reading data, error message: Unable to parse; line_number: 31 byte_offset_to_start_of_line: 4723 column_index: 11 column_name: "stock_level" column_type: INT64 value: "140.0"
  Error while reading data, error message: Unable to parse; line_number: 32 byte_offset_to_start_of_line: 4876 column_index: 11 column_name: "stock_level" column_type: INT64 value: "238.0"
  Error while reading data, error message: Unable to parse; line_number: 33 byte_offset_to_start_of_line: 5036 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1221.0"
  Error while reading data, error message: Unable to parse; line_number: 34 byte_offset_to_start_of_line: 5199 column_index: 11 column_name: "stock_level" column_type: INT64 value: "185.0"
  Error while reading data, error message: Unable to parse; line_number: 35 byte_offset_to_start_of_line: 5364 column_index: 11 column_name: "stock_level" column_type: INT64 value: "428.0"
  Error while reading data, error message: Unable to parse; line_number: 36 byte_offset_to_start_of_line: 5529 column_index: 11 column_name: "stock_level" column_type: INT64 value: "249.0"
  Error while reading data, error message: Unable to parse; line_number: 37 byte_offset_to_start_of_line: 5698 column_index: 11 column_name: "stock_level" column_type: INT64 value: "79.0"
  Error while reading data, error message: Unable to parse; line_number: 38 byte_offset_to_start_of_line: 5864 column_index: 11 column_name: "stock_level" column_type: INT64 value: "121.0"
  Error while reading data, error message: Unable to parse; line_number: 39 byte_offset_to_start_of_line: 6015 column_index: 11 column_name: "stock_level" column_type: INT64 value: "96.0"
  Error while reading data, error message: Unable to parse; line_number: 40 byte_offset_to_start_of_line: 6166 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 41 byte_offset_to_start_of_line: 6311 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 42 byte_offset_to_start_of_line: 6451 column_index: 11 column_name: "stock_level" column_type: INT64 value: "72.0"
  Error while reading data, error message: Unable to parse; line_number: 43 byte_offset_to_start_of_line: 6591 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3.0"
  Error while reading data, error message: Unable to parse; line_number: 44 byte_offset_to_start_of_line: 6746 column_index: 11 column_name: "stock_level" column_type: INT64 value: "61.0"
  Error while reading data, error message: Unable to parse; line_number: 45 byte_offset_to_start_of_line: 6906 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1.0"
  Error while reading data, error message: Unable to parse; line_number: 46 byte_offset_to_start_of_line: 7046 column_index: 11 column_name: "stock_level" column_type: INT64 value: "100.0"
  Error while reading data, error message: Unable to parse; line_number: 47 byte_offset_to_start_of_line: 7201 column_index: 11 column_name: "stock_level" column_type: INT64 value: "29.0"
  Error while reading data, error message: Unable to parse; line_number: 48 byte_offset_to_start_of_line: 7360 column_index: 11 column_name: "stock_level" column_type: INT64 value: "-17.0"
  Error while reading data, error message: Unable to parse; line_number: 49 byte_offset_to_start_of_line: 7675 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 50 byte_offset_to_start_of_line: 7823 column_index: 11 column_name: "stock_level" column_type: INT64 value: "14.0"
  Error while reading data, error message: Unable to parse; line_number: 51 byte_offset_to_start_of_line: 7966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "112.0"
  Error while reading data, error message: Unable to parse; line_number: 52 byte_offset_to_start_of_line: 8112 column_index: 11 column_name: "stock_level" column_type: INT64 value: "717.0"
  Error while reading data, error message: Unable to parse; line_number: 53 byte_offset_to_start_of_line: 8267 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 54 byte_offset_to_start_of_line: 8422 column_index: 11 column_name: "stock_level" column_type: INT64 value: "13.0"
  Error while reading data, error message: Unable to parse; line_number: 55 byte_offset_to_start_of_line: 8564 column_index: 11 column_name: "stock_level" column_type: INT64 value: "71.0"
  Error while reading data, error message: Unable to parse; line_number: 56 byte_offset_to_start_of_line: 8710 column_index: 11 column_name: "stock_level" column_type: INT64 value: "556.0"
  Error while reading data, error message: Unable to parse; line_number: 57 byte_offset_to_start_of_line: 8869 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2.0"
  Error while reading data, error message: Unable to parse; line_number: 58 byte_offset_to_start_of_line: 9021 column_index: 11 column_name: "stock_level" column_type: INT64 value: "25.0"
  Error while reading data, error message: Unable to parse; line_number: 59 byte_offset_to_start_of_line: 9171 column_index: 11 column_name: "stock_level" column_type: INT64 value: "156.0"
  Error while reading data, error message: Unable to parse; line_number: 60 byte_offset_to_start_of_line: 9330 column_index: 11 column_name: "stock_level" column_type: INT64 value: "0.0"
  Error while reading data, error message: Unable to parse; line_number: 61 byte_offset_to_start_of_line: 9643 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4.0"
  Error while reading data, error message: Unable to parse; line_number: 62 byte_offset_to_start_of_line: 9803 column_index: 11 column_name: "stock_level" column_type: INT64 value: "151.0"
  Error while reading data, error message: Unable to parse; line_number: 63 byte_offset_to_start_of_line: 9966 column_index: 11 column_name: "stock_level" column_type: INT64 value: "52.0"
  Error while reading data, error message: Unable to parse; line_number: 64 byte_offset_to_start_of_line: 10131 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 65 byte_offset_to_start_of_line: 10286 column_index: 11 column_name: "stock_level" column_type: INT64 value: "63.0"
  Error while reading data, error message: Unable to parse; line_number: 66 byte_offset_to_start_of_line: 10447 column_index: 11 column_name: "stock_level" column_type: INT64 value: "378.0"
  Error while reading data, error message: Unable to parse; line_number: 67 byte_offset_to_start_of_line: 10603 column_index: 11 column_name: "stock_level" column_type: INT64 value: "43.0"
  Error while reading data, error message: Unable to parse; line_number: 68 byte_offset_to_start_of_line: 10747 column_index: 11 column_name: "stock_level" column_type: INT64 value: "393.0"
  Error while reading data, error message: Unable to parse; line_number: 69 byte_offset_to_start_of_line: 10909 column_index: 11 column_name: "stock_level" column_type: INT64 value: "605.0"
  Error while reading data, error message: Unable to parse; line_number: 70 byte_offset_to_start_of_line: 11071 column_index: 11 column_name: "stock_level" column_type: INT64 value: "101.0"
  Error while reading data, error message: Unable to parse; line_number: 71 byte_offset_to_start_of_line: 11236 column_index: 11 column_name: "stock_level" column_type: INT64 value: "291.0"
  Error while reading data, error message: Unable to parse; line_number: 72 byte_offset_to_start_of_line: 11394 column_index: 11 column_name: "stock_level" column_type: INT64 value: "147.0"
  Error while reading data, error message: Unable to parse; line_number: 73 byte_offset_to_start_of_line: 11559 column_index: 11 column_name: "stock_level" column_type: INT64 value: "168.0"
  Error while reading data, error message: Unable to parse; line_number: 74 byte_offset_to_start_of_line: 11707 column_index: 11 column_name: "stock_level" column_type: INT64 value: "110.0"
  Error while reading data, error message: Unable to parse; line_number: 75 byte_offset_to_start_of_line: 11854 column_index: 11 column_name: "stock_level" column_type: INT64 value: "696.0"
  Error while reading data, error message: Unable to parse; line_number: 76 byte_offset_to_start_of_line: 12012 column_index: 11 column_name: "stock_level" column_type: INT64 value: "931.0"
  Error while reading data, error message: Unable to parse; line_number: 77 byte_offset_to_start_of_line: 12170 column_index: 11 column_name: "stock_level" column_type: INT64 value: "400.0"
  Error while reading data, error message: Unable to parse; line_number: 78 byte_offset_to_start_of_line: 12321 column_index: 11 column_name: "stock_level" column_type: INT64 value: "127.0"
  Error while reading data, error message: Unable to parse; line_number: 79 byte_offset_to_start_of_line: 12470 column_index: 11 column_name: "stock_level" column_type: INT64 value: "603.0"
  Error while reading data, error message: Unable to parse; line_number: 80 byte_offset_to_start_of_line: 12641 column_index: 11 column_name: "stock_level" column_type: INT64 value: "810.0"
  Error while reading data, error message: Unable to parse; line_number: 81 byte_offset_to_start_of_line: 12805 column_index: 11 column_name: "stock_level" column_type: INT64 value: "255.0"
  Error while reading data, error message: Unable to parse; line_number: 82 byte_offset_to_start_of_line: 12973 column_index: 11 column_name: "stock_level" column_type: INT64 value: "32.0"
  Error while reading data, error message: Unable to parse; line_number: 83 byte_offset_to_start_of_line: 13143 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3242.0"
  Error while reading data, error message: Unable to parse; line_number: 84 byte_offset_to_start_of_line: 13303 column_index: 11 column_name: "stock_level" column_type: INT64 value: "2086.0"
  Error while reading data, error message: Unable to parse; line_number: 85 byte_offset_to_start_of_line: 13463 column_index: 11 column_name: "stock_level" column_type: INT64 value: "234.0"
  Error while reading data, error message: Unable to parse; line_number: 86 byte_offset_to_start_of_line: 13618 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 87 byte_offset_to_start_of_line: 13767 column_index: 11 column_name: "stock_level" column_type: INT64 value: "206.0"
  Error while reading data, error message: Unable to parse; line_number: 88 byte_offset_to_start_of_line: 13917 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1573.0"
  Error while reading data, error message: Unable to parse; line_number: 89 byte_offset_to_start_of_line: 14078 column_index: 11 column_name: "stock_level" column_type: INT64 value: "5112.0"
  Error while reading data, error message: Unable to parse; line_number: 90 byte_offset_to_start_of_line: 14245 column_index: 11 column_name: "stock_level" column_type: INT64 value: "371.0"
  Error while reading data, error message: Unable to parse; line_number: 91 byte_offset_to_start_of_line: 14413 column_index: 11 column_name: "stock_level" column_type: INT64 value: "486.0"
  Error while reading data, error message: Unable to parse; line_number: 92 byte_offset_to_start_of_line: 14568 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1095.0"
  Error while reading data, error message: Unable to parse; line_number: 93 byte_offset_to_start_of_line: 14720 column_index: 11 column_name: "stock_level" column_type: INT64 value: "172.0"
  Error while reading data, error message: Unable to parse; line_number: 94 byte_offset_to_start_of_line: 14871 column_index: 11 column_name: "stock_level" column_type: INT64 value: "3149.0"
  Error while reading data, error message: Unable to parse; line_number: 95 byte_offset_to_start_of_line: 15032 column_index: 11 column_name: "stock_level" column_type: INT64 value: "1709.0"
  Error while reading data, error message: Unable to parse; line_number: 96 byte_offset_to_start_of_line: 15203 column_index: 11 column_name: "stock_level" column_type: INT64 value: "104.0"
  Error while reading data, error message: Unable to parse; line_number: 97 byte_offset_to_start_of_line: 15371 column_index: 11 column_name: "stock_level" column_type: INT64 value: "145.0"
  Error while reading data, error message: Unable to parse; line_number: 98 byte_offset_to_start_of_line: 15521 column_index: 11 column_name: "stock_level" column_type: INT64 value: "48.0"
  Error while reading data, error message: Unable to parse; line_number: 99 byte_offset_to_start_of_line: 15676 column_index: 11 column_name: "stock_level" column_type: INT64 value: "306.0"
  Error while reading data, error message: Unable to parse; line_number: 100 byte_offset_to_start_of_line: 15827 column_index: 11 column_name: "stock_level" column_type: INT64 value: "4000.0"
  Error while reading data, error message: Unable to parse; line_number: 101 byte_offset_to_start_of_line: 15996 column_index: 11 column_name: "stock_level" column_type: INT64 value: "69.0"
  You are loading data without specifying data format, data will be treated as CSV format by default. If this is not what you mean, please specify data format by --source_format.
[0m10:15:10.216455 [info ] [MainThread]: 
[0m10:15:10.216630 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m10:15:10.218011 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 37.40876, "process_user_time": 9.711935, "process_kernel_time": 1.627989, "process_mem_max_rss": "624394240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:15:10.218323 [debug] [MainThread]: Command `dbt seed` failed at 10:15:10.218274 after 37.41 seconds
[0m10:15:10.218549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253d5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d12490>]}
[0m10:15:10.218756 [debug] [MainThread]: Flushing usage events
[0m11:03:52.604242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812de50>]}


============================== 11:03:52.606974 | 7e9b4545-3b76-4736-a9b6-39bba2c2e881 ==============================
[0m11:03:52.606974 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:03:52.607298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:03:53.321678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e9b4545-3b76-4736-a9b6-39bba2c2e881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1470ce1f0>]}
[0m11:03:53.347421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e9b4545-3b76-4736-a9b6-39bba2c2e881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080df9d0>]}
[0m11:03:53.347703 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:03:53.358946 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:03:53.449267 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 6 files added, 0 files changed.
[0m11:03:53.449619 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_category_map.sql
[0m11:03:53.449797 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m11:03:53.449950 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m11:03:53.450098 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:03:53.450250 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_color_map.sql
[0m11:03:53.450399 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_links.sql
[0m11:03:53.450584 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_first_dbt_model.sql
[0m11:03:53.450713 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_second_dbt_model.sql
[0m11:03:53.572002 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ruggable.base_rugs_usa_category_map' (models/1_base/base_rugs_usa_category_map.sql) depends on a source named 'ruggable.raw_rugs_usa_category_map' which was not found
[0m11:03:53.573611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.016891, "process_user_time": 4.057981, "process_kernel_time": 0.23496, "process_mem_max_rss": "191512576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:03:53.573913 [debug] [MainThread]: Command `dbt run` failed at 11:03:53.573866 after 1.02 seconds
[0m11:03:53.574115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa6bb0>]}
[0m11:03:53.574302 [debug] [MainThread]: Flushing usage events
[0m11:08:41.663183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af9ee0>]}


============================== 11:08:41.665837 | 51c57809-3dd4-4599-b9df-29de47208360 ==============================
[0m11:08:41.665837 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:08:41.666148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:08:42.420918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108922a00>]}
[0m11:08:42.447668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b26cc70>]}
[0m11:08:42.447993 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:08:42.460460 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:08:42.547075 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 7 files added, 0 files changed.
[0m11:08:42.547442 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_color_map.sql
[0m11:08:42.547628 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_links.sql
[0m11:08:42.547794 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:08:42.547982 [debug] [MainThread]: Partial parsing: added file: ruggable://models/sources.yml
[0m11:08:42.548138 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m11:08:42.548281 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m11:08:42.548427 [debug] [MainThread]: Partial parsing: added file: ruggable://models/1_base/base_rugs_usa_category_map.sql
[0m11:08:42.548614 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_first_dbt_model.sql
[0m11:08:42.548746 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/example/my_second_dbt_model.sql
[0m11:08:42.777680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1580c5130>]}
[0m11:08:42.845601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b6929a0>]}
[0m11:08:42.845969 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:08:42.846163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b688d30>]}
[0m11:08:42.847084 [info ] [MainThread]: 
[0m11:08:42.847439 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:08:42.850074 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:08:42.850353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:43.423925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:08:43.424796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:08:43.910122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b65c5b0>]}
[0m11:08:43.911204 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:08:43.911683 [info ] [MainThread]: 
[0m11:08:43.915902 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m11:08:43.916636 [info ] [Thread-1  ]: 1 of 6 START sql table model ruggable.base_rugs_usa_category_map ............... [RUN]
[0m11:08:43.917253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m11:08:43.917838 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m11:08:43.929290 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m11:08:43.930170 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m11:08:43.961402 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m11:08:43.962172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:44.025779 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m11:08:44.791896 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:02d17261-6c2b-422e-b082-9f95af2a760b&page=queryresults
[0m11:08:46.790755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1582c28b0>]}
[0m11:08:46.791474 [info ] [Thread-1  ]: 1 of 6 OK created sql table model ruggable.base_rugs_usa_category_map .......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 2.87s]
[0m11:08:46.792029 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m11:08:46.792394 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m11:08:46.792900 [info ] [Thread-1  ]: 2 of 6 START sql table model ruggable.base_rugs_usa_color_map .................. [RUN]
[0m11:08:46.793492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m11:08:46.794080 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m11:08:46.797418 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m11:08:46.798215 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m11:08:46.800878 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m11:08:46.801361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:46.872521 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m11:08:47.761571 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0fb56f63-81b7-4795-ae7b-8e6020e1b5a1&page=queryresults
[0m11:08:50.101074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1582c2400>]}
[0m11:08:50.102432 [info ] [Thread-1  ]: 2 of 6 OK created sql table model ruggable.base_rugs_usa_color_map ............. [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.31s]
[0m11:08:50.103834 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m11:08:50.104501 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m11:08:50.105338 [info ] [Thread-1  ]: 3 of 6 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m11:08:50.106104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m11:08:50.106623 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m11:08:50.111559 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m11:08:50.112781 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m11:08:50.118009 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m11:08:50.118873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:50.195713 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m11:08:50.934524 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f40537ad-070d-40bd-aa22-75dcf64f0e72&page=queryresults
[0m11:08:53.007033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15837f790>]}
[0m11:08:53.009509 [info ] [Thread-1  ]: 3 of 6 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 2.90s]
[0m11:08:53.010809 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m11:08:53.011422 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:53.012624 [info ] [Thread-1  ]: 4 of 6 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:08:53.013240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:08:53.014347 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:53.018057 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:08:53.019271 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:53.022385 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:08:53.023149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:53.096600 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:08:53.908311 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:52270266-c665-4376-93de-5455ad2c3e5a&page=queryresults
[0m11:08:57.008585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158348a00>]}
[0m11:08:57.010220 [info ] [Thread-1  ]: 4 of 6 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.00s]
[0m11:08:57.011410 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:08:57.012018 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m11:08:57.012679 [info ] [Thread-1  ]: 5 of 6 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m11:08:57.013325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m11:08:57.013749 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m11:08:57.018074 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m11:08:57.019343 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m11:08:57.022878 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m11:08:57.023753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:08:57.100216 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m11:08:57.797405 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c98bd599-4eff-41fd-9394-22508058d6b6&page=queryresults
[0m11:09:00.099542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158348a00>]}
[0m11:09:00.101049 [info ] [Thread-1  ]: 5 of 6 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.09s]
[0m11:09:00.102000 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m11:09:00.103221 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m11:09:00.104248 [info ] [Thread-1  ]: 6 of 6 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m11:09:00.105065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m11:09:00.105592 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m11:09:00.110484 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:00.111842 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m11:09:00.117852 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:00.118622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:00.194885 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m11:09:00.869604 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:25154525-d415-496e-a529-b79ffcc930a1&page=queryresults
[0m11:09:01.025202 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: variant at [15:7]; reason: invalidQuery, location: query, message: Unrecognized name: variant at [15:7]')
[0m11:09:01.685327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:59a0cd33-4fa6-40de-a161-0e277c832854&page=queryresults
[0m11:09:01.892381 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:59a0cd33-4fa6-40de-a161-0e277c832854&page=queryresults
[0m11:09:01.935807 [debug] [Thread-1  ]: Database Error in model base_rugs_usa_variant (models/1_base/base_rugs_usa_variant.sql)
  Unrecognized name: variant at [15:7]
  compiled Code at target/run/ruggable/models/1_base/base_rugs_usa_variant.sql
[0m11:09:01.936251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51c57809-3dd4-4599-b9df-29de47208360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1582f9b20>]}
[0m11:09:01.936754 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model ruggable.base_rugs_usa_variant ........... [[31mERROR[0m in 1.83s]
[0m11:09:01.937182 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m11:09:01.938014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:01.938216 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_variant' was properly closed.
[0m11:09:01.938471 [info ] [MainThread]: 
[0m11:09:01.938690 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.09 seconds (19.09s).
[0m11:09:01.939583 [debug] [MainThread]: Command end result
[0m11:09:01.963965 [info ] [MainThread]: 
[0m11:09:01.964344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:01.964527 [info ] [MainThread]: 
[0m11:09:01.964753 [error] [MainThread]:   Database Error in model base_rugs_usa_variant (models/1_base/base_rugs_usa_variant.sql)
  Unrecognized name: variant at [15:7]
  compiled Code at target/run/ruggable/models/1_base/base_rugs_usa_variant.sql
[0m11:09:01.964937 [info ] [MainThread]: 
[0m11:09:01.965132 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m11:09:01.966571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 20.352846, "process_user_time": 5.321499, "process_kernel_time": 0.258307, "process_mem_max_rss": "201834496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:09:01.966909 [debug] [MainThread]: Command `dbt run` failed at 11:09:01.966853 after 20.35 seconds
[0m11:09:01.967150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b26cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083dba60>]}
[0m11:09:01.967365 [debug] [MainThread]: Flushing usage events
[0m11:09:47.314060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a01340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a01160>]}


============================== 11:09:47.316809 | dbb89884-05fe-40cd-b6b4-6785ab041628 ==============================
[0m11:09:47.316809 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:09:47.317154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select base_rugs_usa_variant', 'send_anonymous_usage_stats': 'True'}
[0m11:09:47.788036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e2580>]}
[0m11:09:47.814681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167e39190>]}
[0m11:09:47.815005 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:09:47.825552 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:09:47.904968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:09:47.905387 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m11:09:48.070044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168478100>]}
[0m11:09:48.130426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168269be0>]}
[0m11:09:48.130756 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:09:48.130950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16825b8b0>]}
[0m11:09:48.131547 [info ] [MainThread]: 
[0m11:09:48.131850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:09:48.132312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:09:48.132526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:48.683690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:09:48.685135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:49.197833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16844ff70>]}
[0m11:09:49.198999 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:09:49.199489 [info ] [MainThread]: 
[0m11:09:49.202263 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m11:09:49.202969 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m11:09:49.203516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_variant)
[0m11:09:49.203900 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m11:09:49.215097 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:49.216243 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m11:09:49.252160 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m11:09:49.252849 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:49.317759 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m11:09:50.022778 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f69af36b-e47e-4d0c-88f1-31d355576845&page=queryresults
[0m11:09:52.659215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb89884-05fe-40cd-b6b4-6785ab041628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168546be0>]}
[0m11:09:52.659984 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.45s]
[0m11:09:52.660588 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m11:09:52.661672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:52.661971 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_variant' was properly closed.
[0m11:09:52.662246 [info ] [MainThread]: 
[0m11:09:52.662543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m11:09:52.663121 [debug] [MainThread]: Command end result
[0m11:09:52.691748 [info ] [MainThread]: 
[0m11:09:52.692162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:52.692393 [info ] [MainThread]: 
[0m11:09:52.692610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:09:52.693995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.432384, "process_user_time": 4.631961, "process_kernel_time": 0.160312, "process_mem_max_rss": "199016448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:09:52.694427 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:52.694338 after 5.43 seconds
[0m11:09:52.694718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092efa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168268310>]}
[0m11:09:52.694978 [debug] [MainThread]: Flushing usage events
[0m11:51:23.443631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a412e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a41100>]}


============================== 11:51:23.446402 | f81c69ad-fb8d-4d3b-9445-3ba20fdc3941 ==============================
[0m11:51:23.446402 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:51:23.446753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_rugs_usa_pads_upsell', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:51:24.158173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088caa30>]}
[0m11:51:24.183939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f0dc0>]}
[0m11:51:24.184235 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:51:24.195735 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:51:24.281451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:51:24.281768 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_rugs_usa_parent.sql
[0m11:51:24.281985 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:51:24.442073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7ce130>]}
[0m11:51:24.503448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f2d5c40>]}
[0m11:51:24.503722 [info ] [MainThread]: Found 6 seeds, 7 models, 6 sources, 469 macros
[0m11:51:24.503901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f6877f0>]}
[0m11:51:24.504463 [info ] [MainThread]: 
[0m11:51:24.504724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:24.505143 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:51:24.505344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:25.090520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:51:25.091324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:25.630128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f6e66a0>]}
[0m11:51:25.631287 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:51:25.632305 [info ] [MainThread]: 
[0m11:51:25.637112 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:25.637976 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:51:25.638794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:51:25.639257 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:25.649422 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:51:25.650901 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:25.665413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:26.226151 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:51:26.227056 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:51:26.838921 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ddee4b16-a4c1-473f-bdbe-746fc011d7d9&page=queryresults
[0m11:51:29.499554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f81c69ad-fb8d-4d3b-9445-3ba20fdc3941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ea496a0>]}
[0m11:51:29.500083 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.86s]
[0m11:51:29.500526 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:51:29.501299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:29.501510 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_pads_upsell' was properly closed.
[0m11:51:29.501694 [info ] [MainThread]: 
[0m11:51:29.501911 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m11:51:29.502322 [debug] [MainThread]: Command end result
[0m11:51:29.525129 [info ] [MainThread]: 
[0m11:51:29.525438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:29.525608 [info ] [MainThread]: 
[0m11:51:29.525782 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:29.527278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.133024, "process_user_time": 2.908499, "process_kernel_time": 1.963486, "process_mem_max_rss": "198885376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:51:29.527569 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:29.527519 after 6.13 seconds
[0m11:51:29.527778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7be250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f6e3850>]}
[0m11:51:29.527969 [debug] [MainThread]: Flushing usage events
[0m11:52:53.249128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f9ee0>]}


============================== 11:52:53.251456 | 551a9bb2-455f-4ca1-adce-adba241f1d11 ==============================
[0m11:52:53.251456 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:52:53.251797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:52:53.716592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef2a00>]}
[0m11:52:53.742724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137cacc70>]}
[0m11:52:53.743010 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:52:53.753806 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:52:53.832914 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m11:52:53.833237 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/2_staging/stg_rugs_usa_parent.sql
[0m11:52:53.833482 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m11:52:53.999468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14622fd90>]}
[0m11:52:54.059343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14611fd00>]}
[0m11:52:54.059668 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:52:54.059868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14612b070>]}
[0m11:52:54.060671 [info ] [MainThread]: 
[0m11:52:54.060964 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:54.063422 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:52:54.063628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:54.553307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:52:54.553819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:55.099117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d61b50>]}
[0m11:52:55.100119 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:52:55.100802 [info ] [MainThread]: 
[0m11:52:55.104150 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m11:52:55.104857 [info ] [Thread-1  ]: 1 of 6 START sql table model ruggable.base_rugs_usa_category_map ............... [RUN]
[0m11:52:55.105646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m11:52:55.106289 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m11:52:55.116690 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m11:52:55.117458 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m11:52:55.131947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:55.636818 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m11:52:55.637563 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m11:52:56.234944 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c88ec0e3-d2c8-4369-b420-f93bc4daa75e&page=queryresults
[0m11:52:58.718429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137502670>]}
[0m11:52:58.719274 [info ] [Thread-1  ]: 1 of 6 OK created sql table model ruggable.base_rugs_usa_category_map .......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.61s]
[0m11:52:58.719900 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m11:52:58.720318 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m11:52:58.720825 [info ] [Thread-1  ]: 2 of 6 START sql table model ruggable.base_rugs_usa_color_map .................. [RUN]
[0m11:52:58.721269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m11:52:58.721584 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m11:52:58.724492 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m11:52:58.725304 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m11:52:58.727580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:52:59.268617 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m11:52:59.271847 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m11:52:59.713248 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5f681502-13bb-4104-93b5-52581d9f5611&page=queryresults
[0m11:53:02.035556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146504a60>]}
[0m11:53:02.037736 [info ] [Thread-1  ]: 2 of 6 OK created sql table model ruggable.base_rugs_usa_color_map ............. [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.31s]
[0m11:53:02.038678 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m11:53:02.039222 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m11:53:02.039828 [info ] [Thread-1  ]: 3 of 6 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m11:53:02.040401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m11:53:02.040785 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m11:53:02.044815 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m11:53:02.045738 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m11:53:02.048652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:02.565097 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m11:53:02.567387 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m11:53:03.095150 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cb6f075a-be51-47a8-b3f5-0fb65dcd37fd&page=queryresults
[0m11:53:05.238369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:05.239360 [info ] [Thread-1  ]: 3 of 6 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.20s]
[0m11:53:05.240122 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m11:53:05.240651 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:05.241301 [info ] [Thread-1  ]: 4 of 6 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:53:05.241846 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:53:05.242224 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:05.248172 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:53:05.249331 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:05.251806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:05.776602 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:53:05.779056 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:53:06.373680 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b80ec534-2fb2-4249-a621-6b8d62b2fa43&page=queryresults
[0m11:53:09.007895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:09.009131 [info ] [Thread-1  ]: 4 of 6 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.77s]
[0m11:53:09.010039 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:53:09.010610 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m11:53:09.011327 [info ] [Thread-1  ]: 5 of 6 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m11:53:09.012270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m11:53:09.013004 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m11:53:09.017795 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m11:53:09.018721 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m11:53:09.022143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:09.541917 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m11:53:09.543919 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m11:53:09.992327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:200e0dc1-d7be-4ca9-a296-08cacaea90f7&page=queryresults
[0m11:53:12.440168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:12.441698 [info ] [Thread-1  ]: 5 of 6 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.43s]
[0m11:53:12.442686 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m11:53:12.443380 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m11:53:12.444809 [info ] [Thread-1  ]: 6 of 6 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m11:53:12.445709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m11:53:12.446273 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m11:53:12.451514 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m11:53:12.453207 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m11:53:12.456839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:53:12.969686 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m11:53:12.972147 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m11:53:13.418081 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dcb2e481-b11e-4ed2-8f71-513fd8151845&page=queryresults
[0m11:53:15.772140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a9bb2-455f-4ca1-adce-adba241f1d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1465b9310>]}
[0m11:53:15.773461 [info ] [Thread-1  ]: 6 of 6 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.33s]
[0m11:53:15.774338 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m11:53:15.776298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:15.776809 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_variant' was properly closed.
[0m11:53:15.777198 [info ] [MainThread]: 
[0m11:53:15.777515 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.72 seconds (21.72s).
[0m11:53:15.778665 [debug] [MainThread]: Command end result
[0m11:53:15.808994 [info ] [MainThread]: 
[0m11:53:15.809358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:15.809561 [info ] [MainThread]: 
[0m11:53:15.809755 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:53:15.811154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.614563, "process_user_time": 5.224697, "process_kernel_time": 0.195066, "process_mem_max_rss": "201228288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:15.811485 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:15.811432 after 22.61 seconds
[0m11:53:15.811713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14654dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bee340>]}
[0m11:53:15.811934 [debug] [MainThread]: Flushing usage events
[0m11:55:07.772390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e3da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b5190>]}


============================== 11:55:07.775454 | cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8 ==============================
[0m11:55:07.775454 [info ] [MainThread]: Running with dbt=1.8.2
[0m11:55:07.775829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select base_rugs_usa_pads_upsell', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:55:08.521154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10363a7c0>]}
[0m11:55:08.548678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b530a30>]}
[0m11:55:08.549054 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m11:55:08.560454 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m11:55:08.642433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:08.642781 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m11:55:08.804846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba8d100>]}
[0m11:55:08.864516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba8df70>]}
[0m11:55:08.864802 [info ] [MainThread]: Found 6 seeds, 6 models, 6 sources, 469 macros
[0m11:55:08.864988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b946ee0>]}
[0m11:55:08.865547 [info ] [MainThread]: 
[0m11:55:08.865813 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:08.866230 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m11:55:08.866426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:09.392840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m11:55:09.393241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:09.878191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ba7a100>]}
[0m11:55:09.878986 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:55:09.879395 [info ] [MainThread]: 
[0m11:55:09.882800 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:09.883408 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m11:55:09.884063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_pads_upsell)
[0m11:55:09.884811 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:09.894950 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:55:09.895712 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:09.908046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:10.478398 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m11:55:10.479286 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m11:55:10.924447 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:af7f416e-9ef2-4164-9bd3-81c3f2aa4574&page=queryresults
[0m11:55:13.809708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc505dbc-cfe2-4af8-9b78-1af1fbc3a9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ad39610>]}
[0m11:55:13.810653 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.92s]
[0m11:55:13.811412 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m11:55:13.812884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:13.813234 [debug] [MainThread]: Connection 'model.ruggable.base_rugs_usa_pads_upsell' was properly closed.
[0m11:55:13.813532 [info ] [MainThread]: 
[0m11:55:13.813850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m11:55:13.814517 [debug] [MainThread]: Command end result
[0m11:55:13.864153 [info ] [MainThread]: 
[0m11:55:13.864654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:13.864880 [info ] [MainThread]: 
[0m11:55:13.865085 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:55:13.868964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1503725, "process_user_time": 3.531666, "process_kernel_time": 1.207687, "process_mem_max_rss": "200507392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:13.871548 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:13.871401 after 6.15 seconds
[0m11:55:13.871950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e3da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ca3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bbc5be0>]}
[0m11:55:13.872232 [debug] [MainThread]: Flushing usage events
[0m12:03:36.173045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107735310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107735130>]}


============================== 12:03:36.175675 | 65094216-0644-4300-ab0f-cc8eb28cf7ad ==============================
[0m12:03:36.175675 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:03:36.175997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_category_map stg_color_map', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:03:36.904652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff40d0>]}
[0m12:03:36.933696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd700>]}
[0m12:03:36.934119 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:03:36.946677 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:03:37.036127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:03:37.036521 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_color_map.sql
[0m12:03:37.036706 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_category_map.sql
[0m12:03:37.216796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee4e130>]}
[0m12:03:37.285455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ede98e0>]}
[0m12:03:37.285793 [info ] [MainThread]: Found 6 seeds, 8 models, 6 sources, 469 macros
[0m12:03:37.285980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee3e070>]}
[0m12:03:37.286680 [info ] [MainThread]: 
[0m12:03:37.286986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:03:37.289266 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:03:37.289480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:37.855867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:03:37.856791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:38.388846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d9a30>]}
[0m12:03:38.390278 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:03:38.390901 [info ] [MainThread]: 
[0m12:03:38.394558 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m12:03:38.395283 [info ] [Thread-1  ]: 1 of 2 START sql table model ruggable.stg_category_map ......................... [RUN]
[0m12:03:38.395829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_category_map)
[0m12:03:38.396399 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m12:03:38.406900 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m12:03:38.408411 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m12:03:38.442293 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m12:03:38.442903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:03:38.507651 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m12:03:39.183942 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ab5e3e51-d783-4107-933d-1f46fceea27c&page=queryresults
[0m12:03:41.275127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef0df10>]}
[0m12:03:41.275974 [info ] [Thread-1  ]: 1 of 2 OK created sql table model ruggable.stg_category_map .................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 2.88s]
[0m12:03:41.276641 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m12:03:41.277088 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m12:03:41.277676 [info ] [Thread-1  ]: 2 of 2 START sql table model ruggable.stg_color_map ............................ [RUN]
[0m12:03:41.278194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m12:03:41.278561 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m12:03:41.281632 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m12:03:41.282652 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m12:03:41.285652 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m12:03:41.286342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:03:41.358593 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m12:03:42.095802 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2c1bbb1e-8ec5-41fa-bfcf-1d38ab8c355d&page=queryresults
[0m12:03:44.222876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65094216-0644-4300-ab0f-cc8eb28cf7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef0d880>]}
[0m12:03:44.223808 [info ] [Thread-1  ]: 2 of 2 OK created sql table model ruggable.stg_color_map ....................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 2.94s]
[0m12:03:44.224724 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m12:03:44.225804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:44.226096 [debug] [MainThread]: Connection 'model.ruggable.stg_color_map' was properly closed.
[0m12:03:44.226394 [info ] [MainThread]: 
[0m12:03:44.226993 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.94 seconds (6.94s).
[0m12:03:44.227809 [debug] [MainThread]: Command end result
[0m12:03:44.260330 [info ] [MainThread]: 
[0m12:03:44.260671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:44.260917 [info ] [MainThread]: 
[0m12:03:44.261172 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:03:44.262929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.136831, "process_user_time": 4.678226, "process_kernel_time": 0.230401, "process_mem_max_rss": "199098368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:03:44.263332 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:44.263265 after 8.14 seconds
[0m12:03:44.263609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071247c0>]}
[0m12:03:44.263857 [debug] [MainThread]: Flushing usage events
[0m12:16:31.863237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076803a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076801c0>]}


============================== 12:16:31.866096 | 3314d1e3-97b3-42b7-a79e-682deca5233f ==============================
[0m12:16:31.866096 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:16:31.866479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_links', 'send_anonymous_usage_stats': 'True'}
[0m12:16:32.408213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c1da430>]}
[0m12:16:32.436920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bcac0>]}
[0m12:16:32.437379 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:16:32.447958 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:16:32.534769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:16:32.535161 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_links.sql
[0m12:16:32.535388 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m12:16:32.699044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d097eb0>]}
[0m12:16:32.760124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10620c430>]}
[0m12:16:32.760404 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:16:32.760595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c6af9d0>]}
[0m12:16:32.761195 [info ] [MainThread]: 
[0m12:16:32.761464 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:32.761900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:16:32.762116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:33.398281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:16:33.398982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:33.900411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574aa90>]}
[0m12:16:33.901714 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:16:33.902239 [info ] [MainThread]: 
[0m12:16:33.905883 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:16:33.906752 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:16:33.907356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_links)
[0m12:16:33.907958 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:16:33.918794 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:16:33.919708 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:16:33.953362 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:16:33.953970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:34.018550 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as (select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent`

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:16:34.601556 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a9807078-71cf-40e8-9982-c1ad942cb1af&page=queryresults
[0m12:16:34.602872 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [17:17]; reason: invalidQuery, location: query, message: Syntax error: Unexpected "(" at [17:17]')
[0m12:16:35.830925 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:53f0bb93-557b-4b7d-9eef-a5bc70d7bb70&page=queryresults
[0m12:16:35.833295 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:53f0bb93-557b-4b7d-9eef-a5bc70d7bb70&page=queryresults
[0m12:16:35.877152 [debug] [Thread-1  ]: Database Error in model stg_links (models/2_staging/stg_links.sql)
  Syntax error: Unexpected "(" at [17:17]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:35.878514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3314d1e3-97b3-42b7-a79e-682deca5233f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d3aeee0>]}
[0m12:16:35.879008 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_links ....................... [[31mERROR[0m in 1.97s]
[0m12:16:35.879403 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:16:35.880219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:35.880445 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:16:35.880669 [info ] [MainThread]: 
[0m12:16:35.880907 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m12:16:35.881332 [debug] [MainThread]: Command end result
[0m12:16:35.906269 [info ] [MainThread]: 
[0m12:16:35.906601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:35.906779 [info ] [MainThread]: 
[0m12:16:35.906998 [error] [MainThread]:   Database Error in model stg_links (models/2_staging/stg_links.sql)
  Syntax error: Unexpected "(" at [17:17]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:35.907164 [info ] [MainThread]: 
[0m12:16:35.907338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:16:35.908678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0934305, "process_user_time": 4.415043, "process_kernel_time": 0.184434, "process_mem_max_rss": "199245824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:35.909005 [debug] [MainThread]: Command `dbt run` failed at 12:16:35.908955 after 4.09 seconds
[0m12:16:35.909254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d39e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bcac0>]}
[0m12:16:35.909461 [debug] [MainThread]: Flushing usage events
[0m12:16:55.559034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81160>]}


============================== 12:16:55.561217 | 6b50f5cb-c63c-4867-8a13-05037e95923d ==============================
[0m12:16:55.561217 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:16:55.561618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_links', 'send_anonymous_usage_stats': 'True'}
[0m12:16:56.004870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f62580>]}
[0m12:16:56.030775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fdba2b0>]}
[0m12:16:56.031074 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:16:56.041510 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:16:56.125013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:56.125401 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_links.sql
[0m12:16:56.283982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157518e50>]}
[0m12:16:56.343140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1570e32b0>]}
[0m12:16:56.343404 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:16:56.343594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15702e580>]}
[0m12:16:56.344179 [info ] [MainThread]: 
[0m12:16:56.344452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:16:56.344883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:16:56.345080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:56.905413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:16:56.906165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:57.413280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15711ef70>]}
[0m12:16:57.414245 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:16:57.414662 [info ] [MainThread]: 
[0m12:16:57.418190 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:16:57.418793 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:16:57.419275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_links)
[0m12:16:57.419626 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:16:57.429022 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:16:57.429873 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:16:57.462108 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:16:57.462689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:57.525795 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:16:58.254923 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e7e08b99-379a-4de4-a858-a0c5f423327c&page=queryresults
[0m12:16:58.419937 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column internal_name in USING clause not found on right side of join at [37:30]; reason: invalidQuery, location: query, message: Column internal_name in USING clause not found on right side of join at [37:30]')
[0m12:16:58.986657 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3855fbb9-08df-417d-a4bf-e8b7a7e71261&page=queryresults
[0m12:16:59.133115 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3855fbb9-08df-417d-a4bf-e8b7a7e71261&page=queryresults
[0m12:16:59.180446 [debug] [Thread-1  ]: Database Error in model stg_links (models/2_staging/stg_links.sql)
  Column internal_name in USING clause not found on right side of join at [37:30]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:59.181804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b50f5cb-c63c-4867-8a13-05037e95923d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157632040>]}
[0m12:16:59.182292 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_links ....................... [[31mERROR[0m in 1.76s]
[0m12:16:59.182696 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:16:59.183481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:59.183671 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:16:59.183862 [info ] [MainThread]: 
[0m12:16:59.184064 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m12:16:59.184469 [debug] [MainThread]: Command end result
[0m12:16:59.208985 [info ] [MainThread]: 
[0m12:16:59.209402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:16:59.209587 [info ] [MainThread]: 
[0m12:16:59.209859 [error] [MainThread]:   Database Error in model stg_links (models/2_staging/stg_links.sql)
  Column internal_name in USING clause not found on right side of join at [37:30]
  compiled Code at target/run/ruggable/models/2_staging/stg_links.sql
[0m12:16:59.210061 [info ] [MainThread]: 
[0m12:16:59.210266 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:16:59.211694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.702446, "process_user_time": 4.664231, "process_kernel_time": 0.153331, "process_mem_max_rss": "198934528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:59.212043 [debug] [MainThread]: Command `dbt run` failed at 12:16:59.211990 after 3.70 seconds
[0m12:16:59.212287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f62580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1570e32b0>]}
[0m12:16:59.212514 [debug] [MainThread]: Flushing usage events
[0m12:17:17.479797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102280a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf91c0>]}


============================== 12:17:17.481934 | 99a1bb8e-3916-4918-b737-06a456183ad4 ==============================
[0m12:17:17.481934 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:17.482277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_links', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:17.914726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb8580>]}
[0m12:17:17.940549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a879160>]}
[0m12:17:17.940870 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:17:17.951272 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:17:18.028909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:18.029163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:18.055333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abd5130>]}
[0m12:17:18.147371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abc29a0>]}
[0m12:17:18.147693 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:17:18.147888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abf42b0>]}
[0m12:17:18.148577 [info ] [MainThread]: 
[0m12:17:18.148863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:17:18.151036 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:17:18.151257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:18.692270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:17:18.693143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:19.244662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020e6cd0>]}
[0m12:17:19.246132 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:17:19.246826 [info ] [MainThread]: 
[0m12:17:19.251198 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m12:17:19.251857 [info ] [Thread-1  ]: 1 of 3 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m12:17:19.252467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_links)
[0m12:17:19.252986 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m12:17:19.264702 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m12:17:19.265585 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m12:17:19.280535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:17:19.842449 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m12:17:19.843256 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m12:17:20.329376 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9a2e2ad4-e199-4b33-91ba-ddf4ae5f5796&page=queryresults
[0m12:17:22.703870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a97cca0>]}
[0m12:17:22.704435 [info ] [Thread-1  ]: 1 of 3 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.45s]
[0m12:17:22.704851 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m12:17:22.705124 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m12:17:22.705407 [info ] [Thread-1  ]: 2 of 3 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m12:17:22.705691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_parent)
[0m12:17:22.705915 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m12:17:22.708236 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m12:17:22.708813 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m12:17:22.710419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:17:23.212852 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m12:17:23.215180 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m12:17:23.647371 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6f030ae9-59e7-4411-98c1-2ee5e11114fc&page=queryresults
[0m12:17:26.224119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae2f610>]}
[0m12:17:26.225672 [info ] [Thread-1  ]: 2 of 3 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.52s]
[0m12:17:26.226319 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m12:17:26.227341 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:17:26.228036 [info ] [Thread-1  ]: 3 of 3 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:17:26.228491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.stg_links)
[0m12:17:26.228831 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:17:26.232551 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:17:26.233152 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:17:26.235873 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:17:26.236351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:17:26.310835 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:17:26.925010 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5d0211b6-3a03-467a-87f4-295da212ea68&page=queryresults
[0m12:17:29.568240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a1bb8e-3916-4918-b737-06a456183ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae09940>]}
[0m12:17:29.568867 [info ] [Thread-1  ]: 3 of 3 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (45.1k rows, 1.6 MiB processed)[0m in 3.34s]
[0m12:17:29.569396 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:17:29.570212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:29.570424 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:17:29.570674 [info ] [MainThread]: 
[0m12:17:29.570917 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.42 seconds (11.42s).
[0m12:17:29.571581 [debug] [MainThread]: Command end result
[0m12:17:29.598493 [info ] [MainThread]: 
[0m12:17:29.598849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:29.599045 [info ] [MainThread]: 
[0m12:17:29.599230 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:17:29.600585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.170541, "process_user_time": 4.714351, "process_kernel_time": 0.156514, "process_mem_max_rss": "194248704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:17:29.600939 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:29.600885 after 12.17 seconds
[0m12:17:29.601185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102280a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15abc24f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ab6fca0>]}
[0m12:17:29.601421 [debug] [MainThread]: Flushing usage events
[0m12:18:12.931243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022b4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45160>]}


============================== 12:18:12.933935 | e83d237f-999b-4628-92f6-035ac03804cd ==============================
[0m12:18:12.933935 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:18:12.934266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_links', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:13.547864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c26580>]}
[0m12:18:13.576870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c7a2b0>]}
[0m12:18:13.577343 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:18:13.590582 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:18:13.696072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:13.696494 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m12:18:13.863671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270d9eb0>]}
[0m12:18:13.925754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270f1fa0>]}
[0m12:18:13.926040 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:18:13.926230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126fa33d0>]}
[0m12:18:13.926921 [info ] [MainThread]: 
[0m12:18:13.927193 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:13.929429 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:18:13.929632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:14.546343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:18:14.546956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:15.162138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025e7b80>]}
[0m12:18:15.163218 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:18:15.163644 [info ] [MainThread]: 
[0m12:18:15.167770 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m12:18:15.168329 [info ] [Thread-1  ]: 1 of 3 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m12:18:15.168759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_links)
[0m12:18:15.169112 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m12:18:15.178610 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m12:18:15.179408 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m12:18:15.194106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:15.765195 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m12:18:15.766193 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m12:18:16.284355 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f078a885-49eb-4d1d-9435-b20a5dc7b78c&page=queryresults
[0m12:18:18.387560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271a51c0>]}
[0m12:18:18.388438 [info ] [Thread-1  ]: 1 of 3 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.22s]
[0m12:18:18.389350 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m12:18:18.389802 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m12:18:18.390406 [info ] [Thread-1  ]: 2 of 3 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m12:18:18.390976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_parent)
[0m12:18:18.391343 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m12:18:18.394656 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m12:18:18.395540 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m12:18:18.397852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:19.047968 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m12:18:19.049485 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m12:18:19.561633 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8cb90049-3133-4ae3-be86-da0065220367&page=queryresults
[0m12:18:21.607469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127190ca0>]}
[0m12:18:21.608685 [info ] [Thread-1  ]: 2 of 3 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.22s]
[0m12:18:21.609416 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m12:18:21.610219 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:18:21.610711 [info ] [Thread-1  ]: 3 of 3 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:18:21.611175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.stg_links)
[0m12:18:21.611994 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:18:21.617305 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:18:21.618424 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:18:21.621182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:18:22.140309 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:18:22.142763 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:18:22.632482 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2fd766b8-c0f4-465d-b341-5004c2f90654&page=queryresults
[0m12:18:25.408238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e83d237f-999b-4628-92f6-035ac03804cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12727dfd0>]}
[0m12:18:25.409319 [info ] [Thread-1  ]: 3 of 3 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (45.1k rows, 1.6 MiB processed)[0m in 3.80s]
[0m12:18:25.410119 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:18:25.411538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:25.411953 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:18:25.412401 [info ] [MainThread]: 
[0m12:18:25.412806 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.49 seconds (11.49s).
[0m12:18:25.413917 [debug] [MainThread]: Command end result
[0m12:18:25.446225 [info ] [MainThread]: 
[0m12:18:25.446621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:25.446845 [info ] [MainThread]: 
[0m12:18:25.447129 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:18:25.448796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.573102, "process_user_time": 3.672658, "process_kernel_time": 1.27354, "process_mem_max_rss": "201392128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:25.449219 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:25.449152 after 12.57 seconds
[0m12:18:25.449487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022b4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c7a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651b7c0>]}
[0m12:18:25.449743 [debug] [MainThread]: Flushing usage events
[0m12:19:24.781580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104549c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104549e50>]}


============================== 12:19:24.783830 | 9a5df956-7d22-4f20-944e-893dfd194c68 ==============================
[0m12:19:24.783830 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:19:24.784180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:19:25.290987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c32d040>]}
[0m12:19:25.317180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103948130>]}
[0m12:19:25.317579 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:19:25.330203 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:19:25.416479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:25.416908 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m12:19:25.581373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c8d8dc0>]}
[0m12:19:25.641855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3e93d0>]}
[0m12:19:25.642150 [info ] [MainThread]: Found 6 seeds, 9 models, 6 sources, 469 macros
[0m12:19:25.642343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c6a3490>]}
[0m12:19:25.643222 [info ] [MainThread]: 
[0m12:19:25.643508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:19:25.645875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:19:25.646076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:26.204136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m12:19:26.204503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:26.700624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3d3e50>]}
[0m12:19:26.701817 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:19:26.702370 [info ] [MainThread]: 
[0m12:19:26.705398 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m12:19:26.705842 [info ] [Thread-1  ]: 1 of 9 START sql table model ruggable.base_rugs_usa_category_map ............... [RUN]
[0m12:19:26.706244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m12:19:26.706531 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m12:19:26.713307 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m12:19:26.714063 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m12:19:26.727580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:27.273608 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m12:19:27.274304 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m12:19:27.734184 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6c1a415f-6f5c-445d-abab-4f46107bad75&page=queryresults
[0m12:19:30.356420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9a2910>]}
[0m12:19:30.357283 [info ] [Thread-1  ]: 1 of 9 OK created sql table model ruggable.base_rugs_usa_category_map .......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.65s]
[0m12:19:30.357901 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m12:19:30.358347 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m12:19:30.358881 [info ] [Thread-1  ]: 2 of 9 START sql table model ruggable.base_rugs_usa_color_map .................. [RUN]
[0m12:19:30.359472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m12:19:30.359812 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m12:19:30.363043 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m12:19:30.363935 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m12:19:30.366157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:30.927636 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m12:19:30.929818 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m12:19:31.435769 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1ed96c71-200f-4525-a1b2-192b4eac9ef5&page=queryresults
[0m12:19:34.030467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c991c70>]}
[0m12:19:34.031581 [info ] [Thread-1  ]: 2 of 9 OK created sql table model ruggable.base_rugs_usa_color_map ............. [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.67s]
[0m12:19:34.032406 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m12:19:34.032998 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m12:19:34.033728 [info ] [Thread-1  ]: 3 of 9 START sql table model ruggable.base_rugs_usa_links ...................... [RUN]
[0m12:19:34.034427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m12:19:34.034886 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m12:19:34.038342 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m12:19:34.039102 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m12:19:34.041777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:34.571491 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m12:19:34.573016 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m12:19:34.904773 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:24c38324-7e3e-43b7-933c-aba8d272c6a9&page=queryresults
[0m12:19:37.175767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c991ca0>]}
[0m12:19:37.177182 [info ] [Thread-1  ]: 3 of 9 OK created sql table model ruggable.base_rugs_usa_links ................. [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.14s]
[0m12:19:37.178014 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m12:19:37.178573 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:37.179411 [info ] [Thread-1  ]: 4 of 9 START sql table model ruggable.base_rugs_usa_pads_upsell ................ [RUN]
[0m12:19:37.179940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m12:19:37.180250 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:37.182937 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m12:19:37.183603 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:37.185702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:37.676260 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m12:19:37.677658 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m12:19:38.207498 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a0c937c6-f9cc-47e4-89e5-b580018b22f1&page=queryresults
[0m12:19:40.711277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb7ae50>]}
[0m12:19:40.712331 [info ] [Thread-1  ]: 4 of 9 OK created sql table model ruggable.base_rugs_usa_pads_upsell ........... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.53s]
[0m12:19:40.713102 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m12:19:40.713631 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m12:19:40.714245 [info ] [Thread-1  ]: 5 of 9 START sql table model ruggable.base_rugs_usa_parent ..................... [RUN]
[0m12:19:40.714807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m12:19:40.715217 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m12:19:40.718105 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m12:19:40.718799 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m12:19:40.720739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:41.240785 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m12:19:41.242272 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m12:19:41.814602 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a0a69f18-d170-43f1-90bd-5b5c33eecf06&page=queryresults
[0m12:19:44.350216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb30ee0>]}
[0m12:19:44.351213 [info ] [Thread-1  ]: 5 of 9 OK created sql table model ruggable.base_rugs_usa_parent ................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.64s]
[0m12:19:44.352072 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m12:19:44.352619 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m12:19:44.353289 [info ] [Thread-1  ]: 6 of 9 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m12:19:44.353962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m12:19:44.354412 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m12:19:44.358140 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m12:19:44.358714 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m12:19:44.360389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:44.897638 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m12:19:44.899387 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m12:19:45.432810 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3e1815b1-e7c2-47da-a94f-38e74759abee&page=queryresults
[0m12:19:47.704814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb945b0>]}
[0m12:19:47.705756 [info ] [Thread-1  ]: 6 of 9 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.35s]
[0m12:19:47.706666 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m12:19:47.707257 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m12:19:47.707895 [info ] [Thread-1  ]: 7 of 9 START sql table model ruggable.stg_category_map ......................... [RUN]
[0m12:19:47.708448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_category_map)
[0m12:19:47.708854 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m12:19:47.712104 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m12:19:47.712738 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m12:19:47.714287 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:48.209814 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m12:19:48.211256 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m12:19:48.638709 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:15e94698-7fd2-49b4-94d3-0561854931e2&page=queryresults
[0m12:19:50.825570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb90e50>]}
[0m12:19:50.826256 [info ] [Thread-1  ]: 7 of 9 OK created sql table model ruggable.stg_category_map .................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.12s]
[0m12:19:50.826815 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m12:19:50.827200 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m12:19:50.827712 [info ] [Thread-1  ]: 8 of 9 START sql table model ruggable.stg_color_map ............................ [RUN]
[0m12:19:50.828199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m12:19:50.828601 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m12:19:50.833410 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m12:19:50.834593 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m12:19:50.837837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:51.423230 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m12:19:51.424543 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m12:19:51.926878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7f953070-80ab-49b1-8c31-05f875b1bd2e&page=queryresults
[0m12:19:53.922628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9a24c0>]}
[0m12:19:53.923717 [info ] [Thread-1  ]: 8 of 9 OK created sql table model ruggable.stg_color_map ....................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.09s]
[0m12:19:53.924623 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m12:19:53.925203 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m12:19:53.925906 [info ] [Thread-1  ]: 9 of 9 START sql table model ruggable.stg_links ................................ [RUN]
[0m12:19:53.926470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m12:19:53.926891 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m12:19:53.931200 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m12:19:53.931958 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m12:19:53.935844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:54.427445 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m12:19:54.429314 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      with 

base_parent as ( select * from `first-project-262802`.`ruggable`.`base_rugs_usa_parent` )

, base_links as (
    select
        base_url
        , page_links
        , card_links
        , ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(2)] as internal_name
        , request_time_stamp
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
)

select
    base_links.base_url
    , base_links.page_links
    , base_links.card_links
    , base_links.internal_name
    , base_links.request_time_stamp
    , base_links.dw_insert_timestamp
    , base_parent.pid as pid
from base_links
left join base_parent using (internal_name)
    );
  
[0m12:19:55.303730 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7cbff8e7-3310-4fff-9ba5-474bf3db1d34&page=queryresults
[0m12:19:58.193506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5df956-7d22-4f20-944e-893dfd194c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c80fc10>]}
[0m12:19:58.195126 [info ] [Thread-1  ]: 9 of 9 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (45.1k rows, 1.6 MiB processed)[0m in 4.27s]
[0m12:19:58.195896 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m12:19:58.197319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:58.197723 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m12:19:58.198182 [info ] [MainThread]: 
[0m12:19:58.198576 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 32.55 seconds (32.55s).
[0m12:19:58.200955 [debug] [MainThread]: Command end result
[0m12:19:58.234163 [info ] [MainThread]: 
[0m12:19:58.234543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:58.234773 [info ] [MainThread]: 
[0m12:19:58.235009 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:19:58.236570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.506535, "process_user_time": 3.696968, "process_kernel_time": 2.114464, "process_mem_max_rss": "200753152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:19:58.236965 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:58.236903 after 33.51 seconds
[0m12:19:58.237218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bc4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3e93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c32d040>]}
[0m12:19:58.237456 [debug] [MainThread]: Flushing usage events
[0m13:16:40.841959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c68af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e0160>]}


============================== 13:16:40.844771 | 32942157-9cbe-41d3-bbf4-1709521a221d ==============================
[0m13:16:40.844771 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:16:40.845105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_links', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:41.579534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c2580>]}
[0m13:16:41.607821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14557a2b0>]}
[0m13:16:41.608236 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:16:41.618904 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:16:41.707595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:16:41.707955 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_upsell.sql
[0m13:16:41.708170 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_links.sql
[0m13:16:41.708360 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m13:16:41.881091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1459d6130>]}
[0m13:16:41.943598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145892c40>]}
[0m13:16:41.943905 [info ] [MainThread]: Found 6 seeds, 10 models, 6 sources, 469 macros
[0m13:16:41.944101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1458b2490>]}
[0m13:16:41.944733 [info ] [MainThread]: 
[0m13:16:41.945015 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:41.945478 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:16:41.945720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:42.485860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:16:42.486601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:43.026119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145900eb0>]}
[0m13:16:43.027697 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:16:43.028489 [info ] [MainThread]: 
[0m13:16:43.033187 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:16:43.033813 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_links ................................ [RUN]
[0m13:16:43.034378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_links)
[0m13:16:43.034845 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:16:43.045598 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:16:43.047099 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:16:43.063764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:43.648954 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:16:43.649692 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:16:44.242469 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:90888251-0b8c-422b-b3ab-73976cb891fa&page=queryresults
[0m13:16:46.597821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32942157-9cbe-41d3-bbf4-1709521a221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c816a0>]}
[0m13:16:46.598537 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.stg_links ........................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.56s]
[0m13:16:46.599086 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:16:46.600062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:46.600285 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m13:16:46.600515 [info ] [MainThread]: 
[0m13:16:46.600775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m13:16:46.601308 [debug] [MainThread]: Command end result
[0m13:16:46.641813 [info ] [MainThread]: 
[0m13:16:46.642165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:46.642343 [info ] [MainThread]: 
[0m13:16:46.642516 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:46.643815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8512535, "process_user_time": 3.434929, "process_kernel_time": 1.391559, "process_mem_max_rss": "198180864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:16:46.644116 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:46.644072 after 5.85 seconds
[0m13:16:46.644332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c68af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14557a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145900340>]}
[0m13:16:46.644520 [debug] [MainThread]: Flushing usage events
[0m13:18:46.435477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d80a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705e80>]}


============================== 13:18:46.437764 | 73fb49f1-d308-430a-b35e-77ac9935f7fe ==============================
[0m13:18:46.437764 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:18:46.438099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:46.924985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb8640>]}
[0m13:18:46.952892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b04310>]}
[0m13:18:46.953310 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:18:46.964256 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:18:47.048215 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 2 files changed.
[0m13:18:47.048652 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_parent.sql
[0m13:18:47.048880 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_pads_upsell.sql
[0m13:18:47.049115 [debug] [MainThread]: Partial parsing: deleted file: ruggable://models/2_staging/stg_upsell.sql
[0m13:18:47.049358 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_parent.sql
[0m13:18:47.049586 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_pads_upsell.sql
[0m13:18:47.234833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433c3130>]}
[0m13:18:47.295388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143126460>]}
[0m13:18:47.295727 [info ] [MainThread]: Found 6 seeds, 11 models, 6 sources, 469 macros
[0m13:18:47.295902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433b4040>]}
[0m13:18:47.296856 [info ] [MainThread]: 
[0m13:18:47.297144 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:47.299869 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:18:47.300233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:47.772435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:18:47.773003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:48.281438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433b4040>]}
[0m13:18:48.282501 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:18:48.283000 [info ] [MainThread]: 
[0m13:18:48.285634 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m13:18:48.286317 [info ] [Thread-1  ]: 1 of 11 START sql table model ruggable.base_rugs_usa_category_map .............. [RUN]
[0m13:18:48.286865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m13:18:48.287275 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m13:18:48.297880 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m13:18:48.298925 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m13:18:48.314085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:48.897877 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m13:18:48.898849 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m13:18:49.441584 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12d9408a-b42f-4213-8666-9c2fd3cd665f&page=queryresults
[0m13:18:51.643739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434a8700>]}
[0m13:18:51.644357 [info ] [Thread-1  ]: 1 of 11 OK created sql table model ruggable.base_rugs_usa_category_map ......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.36s]
[0m13:18:51.644866 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m13:18:51.645208 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m13:18:51.645656 [info ] [Thread-1  ]: 2 of 11 START sql table model ruggable.base_rugs_usa_color_map ................. [RUN]
[0m13:18:51.646131 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m13:18:51.646427 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m13:18:51.648968 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m13:18:51.649588 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m13:18:51.652023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:52.213888 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m13:18:52.215829 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m13:18:52.640660 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:29c60ca3-2b3b-44c9-b134-b3cb33544e30&page=queryresults
[0m13:18:55.523569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14349f760>]}
[0m13:18:55.525085 [info ] [Thread-1  ]: 2 of 11 OK created sql table model ruggable.base_rugs_usa_color_map ............ [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.88s]
[0m13:18:55.526149 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m13:18:55.526753 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m13:18:55.527502 [info ] [Thread-1  ]: 3 of 11 START sql table model ruggable.base_rugs_usa_links ..................... [RUN]
[0m13:18:55.528753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m13:18:55.529482 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m13:18:55.534476 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m13:18:55.535688 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m13:18:55.541914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:56.109734 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m13:18:56.113165 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m13:18:56.632889 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c349bf65-b595-4178-9b10-6d9f1d99b382&page=queryresults
[0m13:18:58.883571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434a8700>]}
[0m13:18:58.884544 [info ] [Thread-1  ]: 3 of 11 OK created sql table model ruggable.base_rugs_usa_links ................ [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.36s]
[0m13:18:58.885312 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m13:18:58.885803 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:18:58.886490 [info ] [Thread-1  ]: 4 of 11 START sql table model ruggable.base_rugs_usa_pads_upsell ............... [RUN]
[0m13:18:58.887187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m13:18:58.887648 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m13:18:58.891422 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:18:58.892393 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m13:18:58.895159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:59.401610 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:18:59.403727 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:18:59.908892 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a358df3e-973f-4a90-8a02-3e5e669cc267&page=queryresults
[0m13:19:02.519491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14354b910>]}
[0m13:19:02.521762 [info ] [Thread-1  ]: 4 of 11 OK created sql table model ruggable.base_rugs_usa_pads_upsell .......... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.63s]
[0m13:19:02.522599 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:19:02.522998 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m13:19:02.523521 [info ] [Thread-1  ]: 5 of 11 START sql table model ruggable.base_rugs_usa_parent .................... [RUN]
[0m13:19:02.524017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m13:19:02.524324 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m13:19:02.527646 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m13:19:02.529402 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m13:19:02.531574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:03.066124 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m13:19:03.068064 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:19:03.858071 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:de08a218-c2ed-4f38-acd3-6a6f2f9c6e17&page=queryresults
[0m13:19:06.665181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14352ce20>]}
[0m13:19:06.667605 [info ] [Thread-1  ]: 5 of 11 OK created sql table model ruggable.base_rugs_usa_parent ............... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 4.14s]
[0m13:19:06.668645 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m13:19:06.669476 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:19:06.670379 [info ] [Thread-1  ]: 6 of 11 START sql table model ruggable.base_rugs_usa_variant ................... [RUN]
[0m13:19:06.671019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m13:19:06.671398 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:19:06.675603 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:19:06.677794 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:19:06.683155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:07.192349 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:19:07.196098 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:19:07.587654 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:68ddd571-9c09-4e2d-9000-30346c531404&page=queryresults
[0m13:19:09.836199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14357ccd0>]}
[0m13:19:09.836987 [info ] [Thread-1  ]: 6 of 11 OK created sql table model ruggable.base_rugs_usa_variant .............. [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.17s]
[0m13:19:09.837589 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:19:09.837963 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m13:19:09.838458 [info ] [Thread-1  ]: 7 of 11 START sql table model ruggable.stg_pads_upsell ......................... [RUN]
[0m13:19:09.838917 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_pads_upsell)
[0m13:19:09.839230 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m13:19:09.842522 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m13:19:09.843320 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m13:19:09.845788 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_pads_upsell"
[0m13:19:09.846296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:09.916935 [debug] [Thread-1  ]: On model.ruggable.stg_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , regexp_replace(regexp_replace(size, '"', '_in'), "'", '_ft') as actual_size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:19:10.520463 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:988c5a50-2ab1-41ca-9b40-9bf66968afda&page=queryresults
[0m13:19:13.602305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1434f06a0>]}
[0m13:19:13.604787 [info ] [Thread-1  ]: 7 of 11 OK created sql table model ruggable.stg_pads_upsell .................... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.76s]
[0m13:19:13.606238 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m13:19:13.607008 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m13:19:13.607867 [info ] [Thread-1  ]: 8 of 11 START sql table model ruggable.stg_parent .............................. [RUN]
[0m13:19:13.608506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m13:19:13.608970 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m13:19:13.616239 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m13:19:13.617576 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m13:19:13.622077 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_parent"
[0m13:19:13.623013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:13.701411 [debug] [Thread-1  ]: On model.ruggable.stg_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:19:14.393917 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f6486c22-fb3c-465e-849e-6dadaac4bca7&page=queryresults
[0m13:19:16.724336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143535940>]}
[0m13:19:16.726512 [info ] [Thread-1  ]: 8 of 11 OK created sql table model ruggable.stg_parent ......................... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.12s]
[0m13:19:16.727774 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m13:19:16.728454 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m13:19:16.729265 [info ] [Thread-1  ]: 9 of 11 START sql table model ruggable.stg_category_map ........................ [RUN]
[0m13:19:16.729918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_parent, now model.ruggable.stg_category_map)
[0m13:19:16.730387 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m13:19:16.736827 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m13:19:16.738213 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m13:19:16.744416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:17.318401 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m13:19:17.321574 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m13:19:17.724616 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:97623790-56f4-4f85-ab52-ac82b92a456e&page=queryresults
[0m13:19:20.172072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14353ba30>]}
[0m13:19:20.174076 [info ] [Thread-1  ]: 9 of 11 OK created sql table model ruggable.stg_category_map ................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.44s]
[0m13:19:20.175134 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m13:19:20.175608 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m13:19:20.175990 [info ] [Thread-1  ]: 10 of 11 START sql table model ruggable.stg_color_map .......................... [RUN]
[0m13:19:20.176625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m13:19:20.177082 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m13:19:20.179907 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m13:19:20.180666 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m13:19:20.182457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:20.798073 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m13:19:20.800328 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m13:19:21.240092 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:05bda71d-40a3-4a91-947d-f3ba21e09424&page=queryresults
[0m13:19:23.486958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1435ca430>]}
[0m13:19:23.488086 [info ] [Thread-1  ]: 10 of 11 OK created sql table model ruggable.stg_color_map ..................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.31s]
[0m13:19:23.488750 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m13:19:23.489211 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:19:23.490263 [info ] [Thread-1  ]: 11 of 11 START sql table model ruggable.stg_links .............................. [RUN]
[0m13:19:23.490919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m13:19:23.491301 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:19:23.495084 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:19:23.496052 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:19:23.498521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:23.961497 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:19:23.963514 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:19:24.381808 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2846b627-d246-4bcd-b55d-1fc0198a3d2f&page=queryresults
[0m13:19:26.724366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fb49f1-d308-430a-b35e-77ac9935f7fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14354b910>]}
[0m13:19:26.725852 [info ] [Thread-1  ]: 11 of 11 OK created sql table model ruggable.stg_links ......................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.23s]
[0m13:19:26.726770 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:19:26.728502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:26.728906 [debug] [MainThread]: Connection 'model.ruggable.stg_links' was properly closed.
[0m13:19:26.729378 [info ] [MainThread]: 
[0m13:19:26.729782 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 39.43 seconds (39.43s).
[0m13:19:26.732399 [debug] [MainThread]: Command end result
[0m13:19:26.767692 [info ] [MainThread]: 
[0m13:19:26.768095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:26.768361 [info ] [MainThread]: 
[0m13:19:26.768680 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:19:26.770277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.384266, "process_user_time": 4.318355, "process_kernel_time": 1.857985, "process_mem_max_rss": "198508544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:26.770645 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:26.770584 after 40.38 seconds
[0m13:19:26.770911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d80a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14330b700>]}
[0m13:19:26.771151 [debug] [MainThread]: Flushing usage events
[0m13:25:44.445407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104080a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a05c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a05e20>]}


============================== 13:25:44.448113 | 3d9bf235-8f94-465d-868f-5b35efbabd09 ==============================
[0m13:25:44.448113 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:25:44.448425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:45.164729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b87f0>]}
[0m13:25:45.191144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597fdf0>]}
[0m13:25:45.191510 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:25:45.204042 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:25:45.289317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m13:25:45.289707 [debug] [MainThread]: Partial parsing: added file: ruggable://models/3_final/pads.sql
[0m13:25:45.289915 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_pads_upsell.sql
[0m13:25:45.290107 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_parent.sql
[0m13:25:45.457117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c55130>]}
[0m13:25:45.519080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b29bb0>]}
[0m13:25:45.519377 [info ] [MainThread]: Found 6 seeds, 12 models, 6 sources, 469 macros
[0m13:25:45.519574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a3f640>]}
[0m13:25:45.520484 [info ] [MainThread]: 
[0m13:25:45.520758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:25:45.523254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:25:45.523454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:46.070662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:25:46.071329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:46.616511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105882580>]}
[0m13:25:46.617497 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:25:46.617902 [info ] [MainThread]: 
[0m13:25:46.621850 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m13:25:46.622710 [info ] [Thread-1  ]: 1 of 11 START sql table model ruggable.base_rugs_usa_category_map .............. [RUN]
[0m13:25:46.623220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m13:25:46.623604 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m13:25:46.635168 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m13:25:46.636660 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m13:25:46.650685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:47.182225 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m13:25:47.183156 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m13:25:47.668882 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3056322c-f25c-4f63-87d8-cc4edb1380e2&page=queryresults
[0m13:25:50.092382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e28ac0>]}
[0m13:25:50.092871 [info ] [Thread-1  ]: 1 of 11 OK created sql table model ruggable.base_rugs_usa_category_map ......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.47s]
[0m13:25:50.093301 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m13:25:50.093596 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m13:25:50.093906 [info ] [Thread-1  ]: 2 of 11 START sql table model ruggable.base_rugs_usa_color_map ................. [RUN]
[0m13:25:50.094303 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m13:25:50.094541 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m13:25:50.096605 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m13:25:50.097138 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m13:25:50.098889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:50.579882 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m13:25:50.583089 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m13:25:51.051980 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7722c5e0-0f7c-4b50-8f99-a1523924c7c9&page=queryresults
[0m13:25:53.233334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e28610>]}
[0m13:25:53.234343 [info ] [Thread-1  ]: 2 of 11 OK created sql table model ruggable.base_rugs_usa_color_map ............ [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.14s]
[0m13:25:53.235128 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m13:25:53.235639 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m13:25:53.236348 [info ] [Thread-1  ]: 3 of 11 START sql table model ruggable.base_rugs_usa_links ..................... [RUN]
[0m13:25:53.237151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m13:25:53.237598 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m13:25:53.244046 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m13:25:53.245088 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m13:25:53.248024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:53.722531 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m13:25:53.724282 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m13:25:54.355076 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6847326f-111f-409b-9c0f-113cc12fdbca&page=queryresults
[0m13:25:56.583909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ee42b0>]}
[0m13:25:56.585340 [info ] [Thread-1  ]: 3 of 11 OK created sql table model ruggable.base_rugs_usa_links ................ [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.35s]
[0m13:25:56.586702 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m13:25:56.587649 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:25:56.588570 [info ] [Thread-1  ]: 4 of 11 START sql table model ruggable.base_rugs_usa_pads_upsell ............... [RUN]
[0m13:25:56.589597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m13:25:56.590148 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m13:25:56.594557 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:25:56.595753 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m13:25:56.598789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:25:57.128996 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:25:57.131138 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:25:57.716644 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e4c8cdd4-e7b9-4941-bbf7-58411bf40895&page=queryresults
[0m13:26:00.619154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ee42b0>]}
[0m13:26:00.620341 [info ] [Thread-1  ]: 4 of 11 OK created sql table model ruggable.base_rugs_usa_pads_upsell .......... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.03s]
[0m13:26:00.621087 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:26:00.621578 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m13:26:00.622223 [info ] [Thread-1  ]: 5 of 11 START sql table model ruggable.base_rugs_usa_parent .................... [RUN]
[0m13:26:00.622936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m13:26:00.623334 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m13:26:00.627555 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m13:26:00.628570 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m13:26:00.631569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:01.182006 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m13:26:01.185504 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:26:01.800307 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7fb7ac45-6352-4300-b75f-bd477192b104&page=queryresults
[0m13:26:03.854526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ee42b0>]}
[0m13:26:03.856114 [info ] [Thread-1  ]: 5 of 11 OK created sql table model ruggable.base_rugs_usa_parent ............... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.23s]
[0m13:26:03.857197 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m13:26:03.857820 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:26:03.858655 [info ] [Thread-1  ]: 6 of 11 START sql table model ruggable.base_rugs_usa_variant ................... [RUN]
[0m13:26:03.859507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m13:26:03.859958 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:26:03.867485 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:26:03.868605 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:26:03.872047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:04.459191 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:26:04.460508 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:26:04.970947 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c31ba584-3f24-45a8-90c3-a377e3fa5ad8&page=queryresults
[0m13:26:07.737387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e1bd30>]}
[0m13:26:07.739062 [info ] [Thread-1  ]: 6 of 11 OK created sql table model ruggable.base_rugs_usa_variant .............. [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.88s]
[0m13:26:07.740731 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:26:07.741431 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m13:26:07.742237 [info ] [Thread-1  ]: 7 of 11 START sql table model ruggable.stg_category_map ........................ [RUN]
[0m13:26:07.742949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_category_map)
[0m13:26:07.743399 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m13:26:07.747724 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m13:26:07.748750 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m13:26:07.751780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:08.272308 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m13:26:08.274819 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m13:26:08.759889 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f0737bee-7a25-4e62-a417-2e30d492ef58&page=queryresults
[0m13:26:11.405859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ec88b0>]}
[0m13:26:11.407457 [info ] [Thread-1  ]: 7 of 11 OK created sql table model ruggable.stg_category_map ................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.66s]
[0m13:26:11.408468 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m13:26:11.409137 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m13:26:11.409849 [info ] [Thread-1  ]: 8 of 11 START sql table model ruggable.stg_color_map ........................... [RUN]
[0m13:26:11.410473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m13:26:11.411004 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m13:26:11.416968 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m13:26:11.418383 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m13:26:11.421923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:11.943984 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m13:26:11.946718 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m13:26:12.338820 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bd4bde37-4109-410a-890e-de4986d6f7d9&page=queryresults
[0m13:26:14.636020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e841c0>]}
[0m13:26:14.637522 [info ] [Thread-1  ]: 8 of 11 OK created sql table model ruggable.stg_color_map ...................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.23s]
[0m13:26:14.638408 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m13:26:14.639001 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:26:14.639964 [info ] [Thread-1  ]: 9 of 11 START sql table model ruggable.stg_links ............................... [RUN]
[0m13:26:14.641049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m13:26:14.641607 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:26:14.649446 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:26:14.650547 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:26:14.653684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:15.145532 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:26:15.146744 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:26:15.622831 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:def114ba-8008-4639-86a1-a2b1854b99c9&page=queryresults
[0m13:26:17.871317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130f1f9a0>]}
[0m13:26:17.872705 [info ] [Thread-1  ]: 9 of 11 OK created sql table model ruggable.stg_links .......................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.23s]
[0m13:26:17.873556 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:26:17.874320 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m13:26:17.875369 [info ] [Thread-1  ]: 10 of 11 START sql table model ruggable.stg_pads_upsell ........................ [RUN]
[0m13:26:17.876067 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_links, now model.ruggable.stg_pads_upsell)
[0m13:26:17.876520 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m13:26:17.881229 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m13:26:17.882356 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m13:26:17.885422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:18.385134 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_pads_upsell"
[0m13:26:18.388224 [debug] [Thread-1  ]: On model.ruggable.stg_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , regexp_replace(regexp_replace(size, '"', '_in'), "'", '_ft') as actual_size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
    );
  
[0m13:26:18.899080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:982dcb41-a961-497f-9962-a7c500bab071&page=queryresults
[0m13:26:21.394016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e8edf0>]}
[0m13:26:21.394951 [info ] [Thread-1  ]: 10 of 11 OK created sql table model ruggable.stg_pads_upsell ................... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 3.52s]
[0m13:26:21.395637 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m13:26:21.396089 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m13:26:21.396846 [info ] [Thread-1  ]: 11 of 11 START sql table model ruggable.stg_parent ............................. [RUN]
[0m13:26:21.397683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m13:26:21.398142 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m13:26:21.402545 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m13:26:21.403297 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m13:26:21.405800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:21.920928 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_parent"
[0m13:26:21.923279 [debug] [Thread-1  ]: On model.ruggable.stg_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
    );
  
[0m13:26:22.485038 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d9a0a0a1-e2af-4c89-86ff-e85a86fd86fc&page=queryresults
[0m13:26:25.626266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9bf235-8f94-465d-868f-5b35efbabd09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130edff70>]}
[0m13:26:25.627128 [info ] [Thread-1  ]: 11 of 11 OK created sql table model ruggable.stg_parent ........................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 4.23s]
[0m13:26:25.627739 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m13:26:25.628968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:25.629310 [debug] [MainThread]: Connection 'model.ruggable.stg_parent' was properly closed.
[0m13:26:25.629681 [info ] [MainThread]: 
[0m13:26:25.629994 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 40.11 seconds (40.11s).
[0m13:26:25.631825 [debug] [MainThread]: Command end result
[0m13:26:25.665333 [info ] [MainThread]: 
[0m13:26:25.665703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:25.665922 [info ] [MainThread]: 
[0m13:26:25.666132 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:26:25.668137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 41.272552, "process_user_time": 5.647261, "process_kernel_time": 0.63582, "process_mem_max_rss": "201883648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:26:25.668494 [debug] [MainThread]: Command `dbt run` succeeded at 13:26:25.668425 after 41.27 seconds
[0m13:26:25.668752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104080a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f4dc0>]}
[0m13:26:25.668998 [debug] [MainThread]: Flushing usage events
[0m13:28:33.790696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077453a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077451c0>]}


============================== 13:28:33.793150 | e4a452f6-e79c-453f-857a-cce6c264d0c1 ==============================
[0m13:28:33.793150 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:28:33.793448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_variant', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:34.305950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d91640>]}
[0m13:28:34.332436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d6fe80>]}
[0m13:28:34.332772 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:28:34.343434 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:28:34.425629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:28:34.425973 [debug] [MainThread]: Partial parsing: added file: ruggable://models/2_staging/stg_variant.sql
[0m13:28:34.426185 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/pads.sql
[0m13:28:34.598406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e202130>]}
[0m13:28:34.656956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e203910>]}
[0m13:28:34.657241 [info ] [MainThread]: Found 6 seeds, 13 models, 6 sources, 469 macros
[0m13:28:34.657437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0f9340>]}
[0m13:28:34.658059 [info ] [MainThread]: 
[0m13:28:34.658342 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:34.658783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:28:34.658998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:35.177024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:28:35.177738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:35.697326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0d4d90>]}
[0m13:28:35.698324 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:28:35.699142 [info ] [MainThread]: 
[0m13:28:35.702296 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:28:35.703105 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_variant .............................. [RUN]
[0m13:28:35.703732 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_variant)
[0m13:28:35.704150 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:28:35.716226 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:28:35.717382 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:28:35.748751 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:28:35.749385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:35.812463 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:28:36.631657 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4b5be5e3-5771-4c8b-a62c-6d1ca6068f5c&page=queryresults
[0m13:28:36.836534 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: size at [17:37]; reason: invalidQuery, location: query, message: Unrecognized name: size at [17:37]')
[0m13:28:37.756297 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e3efc0ce-d510-48b3-ab92-29c6bb47e0a9&page=queryresults
[0m13:28:37.876567 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e3efc0ce-d510-48b3-ab92-29c6bb47e0a9&page=queryresults
[0m13:28:37.922872 [debug] [Thread-1  ]: Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: size at [17:37]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:37.924190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a452f6-e79c-453f-857a-cce6c264d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e2ea250>]}
[0m13:28:37.924693 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_variant ..................... [[31mERROR[0m in 2.22s]
[0m13:28:37.925117 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:28:37.925894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:37.926080 [debug] [MainThread]: Connection 'model.ruggable.stg_variant' was properly closed.
[0m13:28:37.926264 [info ] [MainThread]: 
[0m13:28:37.926475 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m13:28:37.926862 [debug] [MainThread]: Command end result
[0m13:28:37.952395 [info ] [MainThread]: 
[0m13:28:37.952777 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:37.952957 [info ] [MainThread]: 
[0m13:28:37.953187 [error] [MainThread]:   Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: size at [17:37]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:37.953357 [info ] [MainThread]: 
[0m13:28:37.953609 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:28:37.954850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2117066, "process_user_time": 4.385475, "process_kernel_time": 0.179396, "process_mem_max_rss": "200474624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:28:37.955212 [debug] [MainThread]: Command `dbt run` failed at 13:28:37.955153 after 4.21 seconds
[0m13:28:37.955452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d914c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0d43d0>]}
[0m13:28:37.955663 [debug] [MainThread]: Flushing usage events
[0m13:28:50.211898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b411c0>]}


============================== 13:28:50.214119 | 70e591cc-2afe-46ac-bceb-a8a55038e367 ==============================
[0m13:28:50.214119 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:28:50.214438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_variant', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:50.660905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e2ef6d0>]}
[0m13:28:50.686553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e33a190>]}
[0m13:28:50.686865 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:28:50.697121 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:28:50.774851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:50.775245 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/2_staging/stg_variant.sql
[0m13:28:50.934797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f182dc0>]}
[0m13:28:50.991629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1bb130>]}
[0m13:28:50.991900 [info ] [MainThread]: Found 6 seeds, 13 models, 6 sources, 469 macros
[0m13:28:50.992090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1b5c40>]}
[0m13:28:50.992712 [info ] [MainThread]: 
[0m13:28:50.992981 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:50.993416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:28:50.993643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:51.499291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:28:51.500050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:52.030396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0dac0>]}
[0m13:28:52.031654 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:28:52.032051 [info ] [MainThread]: 
[0m13:28:52.034272 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:28:52.034774 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.stg_variant .............................. [RUN]
[0m13:28:52.035171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.stg_variant)
[0m13:28:52.035476 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:28:52.045011 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:28:52.045754 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:28:52.074899 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:28:52.075458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:52.137610 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(actual_size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:28:52.913969 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:db238ff2-ec24-43ef-a449-206b357bc13f&page=queryresults
[0m13:28:53.116014 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]; reason: invalidQuery, location: query, message: Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]')
[0m13:28:54.109560 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9d5e9e6c-55cc-4fe5-a8e5-0ea967efbc74&page=queryresults
[0m13:28:54.264122 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9d5e9e6c-55cc-4fe5-a8e5-0ea967efbc74&page=queryresults
[0m13:28:54.305466 [debug] [Thread-1  ]: Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:54.306789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70e591cc-2afe-46ac-bceb-a8a55038e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3abee0>]}
[0m13:28:54.307302 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.stg_variant ..................... [[31mERROR[0m in 2.27s]
[0m13:28:54.307742 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:28:54.308725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:54.308956 [debug] [MainThread]: Connection 'model.ruggable.stg_variant' was properly closed.
[0m13:28:54.309177 [info ] [MainThread]: 
[0m13:28:54.309403 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m13:28:54.309844 [debug] [MainThread]: Command end result
[0m13:28:54.334508 [info ] [MainThread]: 
[0m13:28:54.334840 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:54.335026 [info ] [MainThread]: 
[0m13:28:54.335250 [error] [MainThread]:   Database Error in model stg_variant (models/2_staging/stg_variant.sql)
  Unrecognized name: stockMsg; Did you mean stock_msg? at [34:7]
  compiled Code at target/run/ruggable/models/2_staging/stg_variant.sql
[0m13:28:54.335428 [info ] [MainThread]: 
[0m13:28:54.335607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:28:54.336851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1711135, "process_user_time": 4.666152, "process_kernel_time": 0.152545, "process_mem_max_rss": "200245248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:28:54.337157 [debug] [MainThread]: Command `dbt run` failed at 13:28:54.337109 after 4.17 seconds
[0m13:28:54.337371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e33a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f3e1e20>]}
[0m13:28:54.337602 [debug] [MainThread]: Flushing usage events
[0m13:29:32.025415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106981100>]}


============================== 13:29:32.027460 | b641d9a5-b51a-4b4e-8ee3-cbc970295bf5 ==============================
[0m13:29:32.027460 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:29:32.027792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select base_rugs_usa_variant stg_variant', 'send_anonymous_usage_stats': 'True'}
[0m13:29:32.485964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfadbe0>]}
[0m13:29:32.514025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfebb20>]}
[0m13:29:32.514401 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:29:32.525252 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:29:32.623107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:32.623619 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/1_base/base_rugs_usa_variant.sql
[0m13:29:32.791699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d642f70>]}
[0m13:29:32.848757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d6540a0>]}
[0m13:29:32.849035 [info ] [MainThread]: Found 6 seeds, 13 models, 6 sources, 469 macros
[0m13:29:32.849226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d0cc430>]}
[0m13:29:32.849936 [info ] [MainThread]: 
[0m13:29:32.850210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:29:32.852281 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:29:32.852500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:33.348537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:29:33.349386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:33.858626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfce2e0>]}
[0m13:29:33.860129 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:29:33.860901 [info ] [MainThread]: 
[0m13:29:33.863938 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:29:33.864594 [info ] [Thread-1  ]: 1 of 2 START sql table model ruggable.base_rugs_usa_variant .................... [RUN]
[0m13:29:33.865115 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_variant)
[0m13:29:33.865541 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:29:33.877303 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:29:33.878276 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:29:33.892608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:34.425048 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:29:34.426133 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:29:34.895973 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2935f2b1-97b9-4bf8-80d0-9154e6c0bdcf&page=queryresults
[0m13:29:37.239044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c9016d0>]}
[0m13:29:37.239607 [info ] [Thread-1  ]: 1 of 2 OK created sql table model ruggable.base_rugs_usa_variant ............... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.37s]
[0m13:29:37.240040 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:29:37.240601 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:29:37.240933 [info ] [Thread-1  ]: 2 of 2 START sql table model ruggable.stg_variant .............................. [RUN]
[0m13:29:37.241266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_variant)
[0m13:29:37.241486 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:29:37.243813 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:29:37.244434 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:29:37.246539 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:29:37.246926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:37.309779 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(actual_size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:29:38.173080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:546a7bfc-1ca4-44bd-9ef4-23ddeedd3265&page=queryresults
[0m13:29:40.515101 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b641d9a5-b51a-4b4e-8ee3-cbc970295bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d7a1a60>]}
[0m13:29:40.516212 [info ] [Thread-1  ]: 2 of 2 OK created sql table model ruggable.stg_variant ......................... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.27s]
[0m13:29:40.516959 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:29:40.518325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:40.518733 [debug] [MainThread]: Connection 'model.ruggable.stg_variant' was properly closed.
[0m13:29:40.519130 [info ] [MainThread]: 
[0m13:29:40.519500 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m13:29:40.520323 [debug] [MainThread]: Command end result
[0m13:29:40.553045 [info ] [MainThread]: 
[0m13:29:40.553466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:40.553686 [info ] [MainThread]: 
[0m13:29:40.553915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:29:40.555364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.576408, "process_user_time": 2.981702, "process_kernel_time": 1.897471, "process_mem_max_rss": "200114176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:29:40.555763 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:40.555699 after 8.58 seconds
[0m13:29:40.556026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106376700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cfebb20>]}
[0m13:29:40.556280 [debug] [MainThread]: Flushing usage events
[0m13:35:51.853058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c69c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c69e50>]}


============================== 13:35:51.855845 | 6091cd1f-1620-4319-a10a-507dacad8e7c ==============================
[0m13:35:51.855845 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:35:51.856177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:52.565416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13084d0d0>]}
[0m13:35:52.591008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1e9d0>]}
[0m13:35:52.591281 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:35:52.602990 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:35:52.687798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m13:35:52.688128 [debug] [MainThread]: Partial parsing: added file: ruggable://models/3_final/variants.sql
[0m13:35:52.688307 [debug] [MainThread]: Partial parsing: added file: ruggable://models/3_final/parents.sql
[0m13:35:52.688493 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/pads.sql
[0m13:35:52.850418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130dc5df0>]}
[0m13:35:52.911842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130caf790>]}
[0m13:35:52.912106 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m13:35:52.912288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d9c1f0>]}
[0m13:35:52.913255 [info ] [MainThread]: 
[0m13:35:52.913534 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:35:52.916159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:35:52.916372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:53.453083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m13:35:53.454332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:53.947686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614aa90>]}
[0m13:35:53.948795 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:35:53.949753 [info ] [MainThread]: 
[0m13:35:53.953369 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m13:35:53.954055 [info ] [Thread-1  ]: 1 of 15 START sql table model ruggable.base_rugs_usa_category_map .............. [RUN]
[0m13:35:53.954724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m13:35:53.955235 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m13:35:53.966595 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m13:35:53.967631 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m13:35:53.982618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:54.511540 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_category_map"
[0m13:35:54.512376 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_category_map`
    );
  
[0m13:35:55.092874 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cb3ee84a-9492-4ae9-82c9-58c2ee12f656&page=queryresults
[0m13:35:57.258457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310c3d00>]}
[0m13:35:57.259052 [info ] [Thread-1  ]: 1 of 15 OK created sql table model ruggable.base_rugs_usa_category_map ......... [[32mCREATE TABLE (51.3k rows, 3.4 MiB processed)[0m in 3.30s]
[0m13:35:57.259543 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m13:35:57.259856 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m13:35:57.260275 [info ] [Thread-1  ]: 2 of 15 START sql table model ruggable.base_rugs_usa_color_map ................. [RUN]
[0m13:35:57.260690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m13:35:57.260941 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m13:35:57.263188 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m13:35:57.263744 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m13:35:57.265626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:57.714841 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_color_map"
[0m13:35:57.717041 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_color_map`
    );
  
[0m13:35:58.112522 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9a965534-0161-4d01-b3a4-4418ffa28a12&page=queryresults
[0m13:36:00.317475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310adf10>]}
[0m13:36:00.318002 [info ] [Thread-1  ]: 2 of 15 OK created sql table model ruggable.base_rugs_usa_color_map ............ [[32mCREATE TABLE (17.2k rows, 1004.7 KiB processed)[0m in 3.06s]
[0m13:36:00.318431 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m13:36:00.318711 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m13:36:00.319099 [info ] [Thread-1  ]: 3 of 15 START sql table model ruggable.base_rugs_usa_links ..................... [RUN]
[0m13:36:00.319514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m13:36:00.319768 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m13:36:00.321912 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m13:36:00.322413 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m13:36:00.324076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:00.926518 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_links"
[0m13:36:00.929070 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_links`
      
    
    

    OPTIONS()
    as (
      select 
    base_url
    , page_links
    , card_links
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_links`
    );
  
[0m13:36:01.479749 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:72ab4122-9704-4128-bd0d-7cc9b26b581f&page=queryresults
[0m13:36:03.563997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13115efa0>]}
[0m13:36:03.565588 [info ] [Thread-1  ]: 3 of 15 OK created sql table model ruggable.base_rugs_usa_links ................ [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.24s]
[0m13:36:03.566689 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m13:36:03.567297 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:03.568368 [info ] [Thread-1  ]: 4 of 15 START sql table model ruggable.base_rugs_usa_pads_upsell ............... [RUN]
[0m13:36:03.569574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m13:36:03.570191 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:03.574872 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:36:03.575941 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:03.578841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:04.058405 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m13:36:04.059982 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_pads_upsell`
    );
  
[0m13:36:04.915700 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b16346e2-5b85-4e14-9524-651aa945da3e&page=queryresults
[0m13:36:07.753070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310fb310>]}
[0m13:36:07.756063 [info ] [Thread-1  ]: 4 of 15 OK created sql table model ruggable.base_rugs_usa_pads_upsell .......... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.18s]
[0m13:36:07.756931 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m13:36:07.757384 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m13:36:07.758197 [info ] [Thread-1  ]: 5 of 15 START sql table model ruggable.base_rugs_usa_parent .................... [RUN]
[0m13:36:07.759111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m13:36:07.759539 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m13:36:07.763733 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m13:36:07.765105 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m13:36:07.767918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:08.219220 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_parent"
[0m13:36:08.221770 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName
    , imageType
    , internalName
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_parent`
    );
  
[0m13:36:08.806271 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9c4a209d-3bb4-4ab8-8438-5cdd9f592ae0&page=queryresults
[0m13:36:10.856717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311e92b0>]}
[0m13:36:10.858500 [info ] [Thread-1  ]: 5 of 15 OK created sql table model ruggable.base_rugs_usa_parent ............... [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.10s]
[0m13:36:10.859650 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m13:36:10.860145 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m13:36:10.860943 [info ] [Thread-1  ]: 6 of 15 START sql table model ruggable.base_rugs_usa_variant ................... [RUN]
[0m13:36:10.861826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m13:36:10.862183 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m13:36:10.865881 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m13:36:10.866782 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m13:36:10.869118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:11.352117 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.base_rugs_usa_variant"
[0m13:36:11.354125 [debug] [Thread-1  ]: On model.ruggable.base_rugs_usa_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.base_rugs_usa_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg
    , stockEddMsg
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`raw_rugs_usa_variant`
    );
  
[0m13:36:11.878063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06c1bd5f-ae96-4ac0-b06e-ef4418510dff&page=queryresults
[0m13:36:14.165649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311ad4f0>]}
[0m13:36:14.168017 [info ] [Thread-1  ]: 6 of 15 OK created sql table model ruggable.base_rugs_usa_variant .............. [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.30s]
[0m13:36:14.169339 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m13:36:14.170158 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m13:36:14.171214 [info ] [Thread-1  ]: 7 of 15 START sql table model ruggable.stg_category_map ........................ [RUN]
[0m13:36:14.172071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now model.ruggable.stg_category_map)
[0m13:36:14.172711 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m13:36:14.176620 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m13:36:14.177551 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m13:36:14.180250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:14.747653 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_category_map"
[0m13:36:14.750725 [debug] [Thread-1  ]: On model.ruggable.stg_category_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_category_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_category_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , category_id
    , category_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_category_map`
    );
  
[0m13:36:15.253414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a9e24010-ad14-440e-b210-e8b64119ed7e&page=queryresults
[0m13:36:17.282100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310adf70>]}
[0m13:36:17.284512 [info ] [Thread-1  ]: 7 of 15 OK created sql table model ruggable.stg_category_map ................... [[32mCREATE TABLE (31.8k rows, 3.4 MiB processed)[0m in 3.11s]
[0m13:36:17.285743 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m13:36:17.286631 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m13:36:17.287547 [info ] [Thread-1  ]: 8 of 15 START sql table model ruggable.stg_color_map ........................... [RUN]
[0m13:36:17.288153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m13:36:17.288531 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m13:36:17.292270 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m13:36:17.293197 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m13:36:17.297829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:17.778672 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_color_map"
[0m13:36:17.781718 [debug] [Thread-1  ]: On model.ruggable.stg_color_map: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_color_map"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_color_map`
      
    
    

    OPTIONS()
    as (
      select
    distinct 
    pid
    , color_id
    , color_value
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_color_map`
    );
  
[0m13:36:18.223309 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:321b25db-f55d-404b-abdf-a9ab97f4e3dd&page=queryresults
[0m13:36:20.435031 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311a3790>]}
[0m13:36:20.435565 [info ] [Thread-1  ]: 8 of 15 OK created sql table model ruggable.stg_color_map ...................... [[32mCREATE TABLE (5.6k rows, 1004.7 KiB processed)[0m in 3.15s]
[0m13:36:20.435966 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m13:36:20.436254 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m13:36:20.436589 [info ] [Thread-1  ]: 9 of 15 START sql table model ruggable.stg_links ............................... [RUN]
[0m13:36:20.436906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m13:36:20.437123 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m13:36:20.439423 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m13:36:20.439903 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m13:36:20.441360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:20.955056 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_links"
[0m13:36:20.957997 [debug] [Thread-1  ]: On model.ruggable.stg_links: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_links"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_links`
      
    
    

    OPTIONS()
    as (
      select
    base_url
    , page_links
    , card_links
    , rtrim(ARRAY_REVERSE(SPLIT(card_links,'/'))[SAFE_OFFSET(0)],'-P.html') as pid
    , request_time_stamp
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_links`
    );
  
[0m13:36:21.546506 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:76140d4e-cd61-44a3-be7e-0806738b9193&page=queryresults
[0m13:36:23.783752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311a8640>]}
[0m13:36:23.785081 [info ] [Thread-1  ]: 9 of 15 OK created sql table model ruggable.stg_links .......................... [[32mCREATE TABLE (5.6k rows, 1.4 MiB processed)[0m in 3.35s]
[0m13:36:23.785928 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m13:36:23.786514 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m13:36:23.787860 [info ] [Thread-1  ]: 10 of 15 START sql table model ruggable.stg_pads_upsell ........................ [RUN]
[0m13:36:23.788697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_links, now model.ruggable.stg_pads_upsell)
[0m13:36:23.789227 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m13:36:23.794054 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m13:36:23.795320 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m13:36:23.798695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:24.336685 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_pads_upsell"
[0m13:36:24.339771 [debug] [Thread-1  ]: On model.ruggable.stg_pads_upsell: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_pads_upsell"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_pads_upsell`
      
    
    

    OPTIONS()
    as (
      select 
    size
    , regexp_replace(regexp_replace(size, '"', '_in'), "'", '_ft') as actual_size
    , shape
    , price
    , width
    , sqft
    , type
    , stock
    , height
    , variant
    , p_id as pid
    , pad_id
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_pads_upsell`
    );
  
[0m13:36:24.879547 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fbbcef71-68ff-446f-9409-e3074ed6bbbc&page=queryresults
[0m13:36:28.250876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311c8b80>]}
[0m13:36:28.253265 [info ] [Thread-1  ]: 10 of 15 OK created sql table model ruggable.stg_pads_upsell ................... [[32mCREATE TABLE (97.2k rows, 9.8 MiB processed)[0m in 4.46s]
[0m13:36:28.254221 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m13:36:28.255091 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m13:36:28.255690 [info ] [Thread-1  ]: 11 of 15 START sql table model ruggable.stg_parent ............................. [RUN]
[0m13:36:28.256127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m13:36:28.256388 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m13:36:28.259575 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m13:36:28.260351 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m13:36:28.263180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:28.797051 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_parent"
[0m13:36:28.799539 [debug] [Thread-1  ]: On model.ruggable.stg_parent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_parent"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_parent`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , product_type_id
    , name
    , url
    , origin
    , thickness
    , material
    , weave
    , weave_feature
    , color
    , brand
    , imageName as image_name
    , imageType as image_type
    , internalName as internal_name
    , category
    , min_price
    , max_price
    , availability
    , aggregate
    , clearance
    , long_description
    , shopbyroom
    , dw_insert_timestamp
    , regexp_replace(lower(ARRAY_REVERSE(SPLIT(url,'/'))[SAFE_OFFSET(1)]),'-','_') as inferred_colour_from_url
from `first-project-262802`.`ruggable`.`base_rugs_usa_parent`
    );
  
[0m13:36:29.276500 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cfa853b4-903c-42b5-b7af-b2a5e67225a6&page=queryresults
[0m13:36:31.526811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310f4040>]}
[0m13:36:31.528112 [info ] [Thread-1  ]: 11 of 15 OK created sql table model ruggable.stg_parent ........................ [[32mCREATE TABLE (5.6k rows, 3.5 MiB processed)[0m in 3.27s]
[0m13:36:31.529122 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m13:36:31.529997 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m13:36:31.530736 [info ] [Thread-1  ]: 12 of 15 START sql table model ruggable.stg_variant ............................ [RUN]
[0m13:36:31.531357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_parent, now model.ruggable.stg_variant)
[0m13:36:31.531728 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m13:36:31.535585 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m13:36:31.536589 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m13:36:31.539209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:32.067157 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.stg_variant"
[0m13:36:32.069008 [debug] [Thread-1  ]: On model.ruggable.stg_variant: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.stg_variant"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`stg_variant`
      
    
    

    OPTIONS()
    as (
      select 
    pid
    , variant
    , actual_size
    , regexp_replace(regexp_replace(actual_size, '_in', '"'), '_ft', "'") as size
    , weave_feature
    , weave_cat
    , size_grp
    , shipping_size
    , shape
    , weight
    , price
    , msrp
    , stock_level
    , depletion_level
    , low_stock
    , estimated_delivery_date
    , this_isd_range
    , status
    , origin
    , new_arrival
    , stockMsg as stock_msg
    , stockEddMsg as stocked_edd_message
    , other_stock_core
    , other_stock_compass
    , dw_insert_timestamp
from `first-project-262802`.`ruggable`.`base_rugs_usa_variant`
    );
  
[0m13:36:32.558493 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e5264be0-75fa-4b2c-a9c8-620bc05fad8d&page=queryresults
[0m13:36:35.096991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310f60a0>]}
[0m13:36:35.098465 [info ] [Thread-1  ]: 12 of 15 OK created sql table model ruggable.stg_variant ....................... [[32mCREATE TABLE (38.8k rows, 6.4 MiB processed)[0m in 3.57s]
[0m13:36:35.099371 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m13:36:35.100718 [debug] [Thread-1  ]: Began running node model.ruggable.pads
[0m13:36:35.101635 [info ] [Thread-1  ]: 13 of 15 START sql table model ruggable.pads ................................... [RUN]
[0m13:36:35.102290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_variant, now model.ruggable.pads)
[0m13:36:35.102660 [debug] [Thread-1  ]: Began compiling node model.ruggable.pads
[0m13:36:35.107065 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.pads"
[0m13:36:35.108322 [debug] [Thread-1  ]: Began executing node model.ruggable.pads
[0m13:36:35.111720 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.pads"
[0m13:36:35.112576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:35.186431 [debug] [Thread-1  ]: On model.ruggable.pads: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.pads"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`pads`
      
    
    

    OPTIONS()
    as (
      with

pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , parent as ( select * from `first-project-262802`.`ruggable`.`stg_parent` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    pads.*
    -- , 
from pads
-- left join parent using (pid)
-- left join variant using (pid)
    );
  
[0m13:36:35.833604 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f2532e6d-c2ee-4c1e-bc04-1a3acf0e1167&page=queryresults
[0m13:36:38.904085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13112a130>]}
[0m13:36:38.906490 [info ] [Thread-1  ]: 13 of 15 OK created sql table model ruggable.pads .............................. [[32mCREATE TABLE (96.7k rows, 11.1 MiB processed)[0m in 3.80s]
[0m13:36:38.907848 [debug] [Thread-1  ]: Finished running node model.ruggable.pads
[0m13:36:38.908658 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m13:36:38.909565 [info ] [Thread-1  ]: 14 of 15 START sql table model ruggable.parents ................................ [RUN]
[0m13:36:38.910110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.pads, now model.ruggable.parents)
[0m13:36:38.910436 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m13:36:38.914284 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m13:36:38.915161 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m13:36:38.920208 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.parents"
[0m13:36:38.921026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:38.991704 [debug] [Thread-1  ]: On model.ruggable.parents: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.parents"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`parents`
      
    
    

    OPTIONS()
    as (
      with

parent as ( select * from `first-project-262802`.`ruggable`.`stg_parent` )

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    parent.*
    -- , 
from parent
-- left join pads using (pid)
-- left join variant using (pid)
    );
  
[0m13:36:39.724406 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:026709d1-5f18-4afb-adf8-1fd1a8aeebd4&page=queryresults
[0m13:36:41.783667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707da60>]}
[0m13:36:41.786138 [info ] [Thread-1  ]: 14 of 15 OK created sql table model ruggable.parents ........................... [[32mCREATE TABLE (5.5k rows, 3.6 MiB processed)[0m in 2.87s]
[0m13:36:41.787498 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m13:36:41.787837 [debug] [Thread-1  ]: Began running node model.ruggable.variants
[0m13:36:41.788280 [info ] [Thread-1  ]: 15 of 15 START sql table model ruggable.variants ............................... [RUN]
[0m13:36:41.788681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.parents, now model.ruggable.variants)
[0m13:36:41.788942 [debug] [Thread-1  ]: Began compiling node model.ruggable.variants
[0m13:36:41.791789 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.variants"
[0m13:36:41.792377 [debug] [Thread-1  ]: Began executing node model.ruggable.variants
[0m13:36:41.794700 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.variants"
[0m13:36:41.795318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:41.859773 [debug] [Thread-1  ]: On model.ruggable.variants: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.variants"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`variants`
      
    
    

    OPTIONS()
    as (
      with

variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

-- , parent as ( select * from `first-project-262802`.`ruggable`.`stg_parent` )

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

select
    distinct
    variant.*
    -- , 
from variant
-- left join parent using (pid)
-- left join variant using (pid)
    );
  
[0m13:36:42.489581 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d44cb7e8-2714-4e1a-94fc-c4f897f34ba8&page=queryresults
[0m13:36:45.259927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6091cd1f-1620-4319-a10a-507dacad8e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310c37c0>]}
[0m13:36:45.261352 [info ] [Thread-1  ]: 15 of 15 OK created sql table model ruggable.variants .......................... [[32mCREATE TABLE (38.6k rows, 6.8 MiB processed)[0m in 3.47s]
[0m13:36:45.262317 [debug] [Thread-1  ]: Finished running node model.ruggable.variants
[0m13:36:45.264041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:45.264706 [debug] [MainThread]: Connection 'model.ruggable.variants' was properly closed.
[0m13:36:45.265473 [info ] [MainThread]: 
[0m13:36:45.265973 [info ] [MainThread]: Finished running 15 table models in 0 hours 0 minutes and 52.35 seconds (52.35s).
[0m13:36:45.269653 [debug] [MainThread]: Command end result
[0m13:36:45.306517 [info ] [MainThread]: 
[0m13:36:45.306872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:45.307080 [info ] [MainThread]: 
[0m13:36:45.307270 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m13:36:45.308777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 53.520317, "process_user_time": 6.400128, "process_kernel_time": 0.331653, "process_mem_max_rss": "200196096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:36:45.309118 [debug] [MainThread]: Command `dbt run` succeeded at 13:36:45.309059 after 53.52 seconds
[0m13:36:45.309356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130cae3a0>]}
[0m13:36:45.309612 [debug] [MainThread]: Flushing usage events
[0m14:05:03.821787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108329370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108329190>]}


============================== 14:05:03.824559 | 2cea111b-0c58-4ff3-b9db-eef4b8079f7b ==============================
[0m14:05:03.824559 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:05:03.824887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select parents', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.601859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ae7c0>]}
[0m14:05:04.628078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dd70a30>]}
[0m14:05:04.628395 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:05:04.640437 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:05:04.729156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:04.729529 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/parents.sql
[0m14:05:04.891973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e2ca130>]}
[0m14:05:04.956965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1b9fa0>]}
[0m14:05:04.957264 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m14:05:04.957458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e29b0d0>]}
[0m14:05:04.958087 [info ] [MainThread]: 
[0m14:05:04.958362 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:04.958794 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:05:04.959011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:05.607350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m14:05:05.608099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:06.117505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106816880>]}
[0m14:05:06.119916 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:06.120456 [info ] [MainThread]: 
[0m14:05:06.124053 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m14:05:06.124694 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.parents .................................. [RUN]
[0m14:05:06.125262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.parents)
[0m14:05:06.125682 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m14:05:06.138040 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m14:05:06.139816 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m14:05:06.153284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:06.785835 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.parents"
[0m14:05:06.787938 [debug] [Thread-1  ]: On model.ruggable.parents: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.parents"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`parents`
      
    
    

    OPTIONS()
    as (
      with

parent as ( 
    select 
        distinct
        pid
        , product_type_id
        , name
        , origin
        , thickness
        , material
        , weave
        , weave_feature
        , color
        , brand
        , imageName as image_name
        , imageType as image_type
        , internalName as internal_name
        , category
        , min_price
        , max_price
        , availability
        , aggregate
        , clearance
        , long_description
        , shopbyroom
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`stg_parent` 
)

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    parent.*
    -- , 
from parent
-- left join pads using (pid)
-- left join variant using (pid)
    );
  
[0m14:05:07.379327 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a34ecd79-c585-4366-bca0-5f111687eace&page=queryresults
[0m14:05:07.883769 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: imageName; Did you mean image_name? at [28:11]; reason: invalidQuery, location: query, message: Unrecognized name: imageName; Did you mean image_name? at [28:11]')
[0m14:05:09.325922 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dc4cb2ad-59ee-46cd-98c3-32b99f2cc460&page=queryresults
[0m14:05:09.463848 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:dc4cb2ad-59ee-46cd-98c3-32b99f2cc460&page=queryresults
[0m14:05:09.509015 [debug] [Thread-1  ]: Database Error in model parents (models/3_final/parents.sql)
  Unrecognized name: imageName; Did you mean image_name? at [28:11]
  compiled Code at target/run/ruggable/models/3_final/parents.sql
[0m14:05:09.510308 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cea111b-0c58-4ff3-b9db-eef4b8079f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4c4550>]}
[0m14:05:09.510785 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model ruggable.parents ......................... [[31mERROR[0m in 3.38s]
[0m14:05:09.511252 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m14:05:09.512096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:09.512320 [debug] [MainThread]: Connection 'model.ruggable.parents' was properly closed.
[0m14:05:09.512523 [info ] [MainThread]: 
[0m14:05:09.512731 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m14:05:09.513142 [debug] [MainThread]: Command end result
[0m14:05:09.538974 [info ] [MainThread]: 
[0m14:05:09.539282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:05:09.539456 [info ] [MainThread]: 
[0m14:05:09.539672 [error] [MainThread]:   Database Error in model parents (models/3_final/parents.sql)
  Unrecognized name: imageName; Did you mean image_name? at [28:11]
  compiled Code at target/run/ruggable/models/3_final/parents.sql
[0m14:05:09.539845 [info ] [MainThread]: 
[0m14:05:09.540020 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:05:09.541588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.7688627, "process_user_time": 2.215892, "process_kernel_time": 2.707959, "process_mem_max_rss": "196820992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:09.541906 [debug] [MainThread]: Command `dbt run` failed at 14:05:09.541853 after 5.77 seconds
[0m14:05:09.542138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1b9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e1b9a90>]}
[0m14:05:09.542360 [debug] [MainThread]: Flushing usage events
[0m14:05:33.512323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c5160>]}


============================== 14:05:33.514419 | 18e52cf6-81b9-4123-b21b-2526d1bb757b ==============================
[0m14:05:33.514419 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:05:33.514745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select parents', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:33.985807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c640>]}
[0m14:05:34.011701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785ba60>]}
[0m14:05:34.011998 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:05:34.024428 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:05:34.112342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:34.112798 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/parents.sql
[0m14:05:34.276092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156b8a130>]}
[0m14:05:34.336805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15687b9d0>]}
[0m14:05:34.337085 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m14:05:34.337274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156b59100>]}
[0m14:05:34.337912 [info ] [MainThread]: 
[0m14:05:34.338175 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:34.338614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:05:34.338810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.823360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_ruggable)
[0m14:05:34.823987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:35.298899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15687bc70>]}
[0m14:05:35.300067 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:05:35.300553 [info ] [MainThread]: 
[0m14:05:35.304309 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m14:05:35.305020 [info ] [Thread-1  ]: 1 of 1 START sql table model ruggable.parents .................................. [RUN]
[0m14:05:35.305557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.parents)
[0m14:05:35.305967 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m14:05:35.318080 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m14:05:35.318855 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m14:05:35.333062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:35.883853 [debug] [Thread-1  ]: Writing runtime sql for node "model.ruggable.parents"
[0m14:05:35.884956 [debug] [Thread-1  ]: On model.ruggable.parents: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "node_id": "model.ruggable.parents"} */

  
    

    create or replace table `first-project-262802`.`ruggable`.`parents`
      
    
    

    OPTIONS()
    as (
      with

parent as ( 
    select 
        distinct
        pid
        , product_type_id
        , name
        , origin
        , thickness
        , material
        , weave
        , weave_feature
        , color
        , brand
        , image_name
        , image_type
        , internal_name
        , category
        , min_price
        , max_price
        , availability
        , aggregate
        , clearance
        , long_description
        , shopbyroom
        , dw_insert_timestamp
    from `first-project-262802`.`ruggable`.`stg_parent` 
)

-- , pads as ( select * from `first-project-262802`.`ruggable`.`stg_pads_upsell` )

-- , variant as ( select * from `first-project-262802`.`ruggable`.`stg_variant` )

select
    distinct
    parent.*
    -- , 
from parent
-- left join pads using (pid)
-- left join variant using (pid)
    );
  
[0m14:05:36.351640 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:44623bc8-875a-4658-ad21-15d69271a2b6&page=queryresults
[0m14:05:38.816047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e52cf6-81b9-4123-b21b-2526d1bb757b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fd41640>]}
[0m14:05:38.816554 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ruggable.parents ............................. [[32mCREATE TABLE (3.4k rows, 3.2 MiB processed)[0m in 3.51s]
[0m14:05:38.816973 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m14:05:38.817690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:38.817910 [debug] [MainThread]: Connection 'model.ruggable.parents' was properly closed.
[0m14:05:38.818112 [info ] [MainThread]: 
[0m14:05:38.818327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m14:05:38.818737 [debug] [MainThread]: Command end result
[0m14:05:38.845068 [info ] [MainThread]: 
[0m14:05:38.845411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:38.845589 [info ] [MainThread]: 
[0m14:05:38.845768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:38.847042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.381608, "process_user_time": 2.131388, "process_kernel_time": 2.682451, "process_mem_max_rss": "199180288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:38.847346 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:38.847296 after 5.38 seconds
[0m14:05:38.847559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156539520>]}
[0m14:05:38.847769 [debug] [MainThread]: Flushing usage events
[0m14:23:55.056629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b26e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b261c0>]}


============================== 14:23:55.059285 | 1235779c-542c-4d70-bbfe-052bc876c150 ==============================
[0m14:23:55.059285 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:23:55.059607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:55.798251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6fa8e0>]}
[0m14:23:55.824089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ed30>]}
[0m14:23:55.824371 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:23:55.836528 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:23:55.927127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:55.927514 [debug] [MainThread]: Partial parsing: updated file: ruggable://models/3_final/variants.sql
[0m14:23:56.089216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282f3ee0>]}
[0m14:23:56.100575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128292100>]}
[0m14:23:56.100837 [info ] [MainThread]: Found 6 seeds, 15 models, 6 sources, 469 macros
[0m14:23:56.101021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282da310>]}
[0m14:23:56.102106 [info ] [MainThread]: 
[0m14:23:56.102387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:23:56.105237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_ruggable'
[0m14:23:56.105439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:56.658032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1235779c-542c-4d70-bbfe-052bc876c150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a25b0>]}
[0m14:23:56.660514 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:23:56.661086 [info ] [MainThread]: 
[0m14:23:56.664779 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.665372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_ruggable, now model.ruggable.base_rugs_usa_category_map)
[0m14:23:56.665822 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.677735 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_category_map"
[0m14:23:56.678802 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.679715 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_category_map
[0m14:23:56.680175 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.680687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_category_map, now model.ruggable.base_rugs_usa_color_map)
[0m14:23:56.681115 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.684078 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_color_map"
[0m14:23:56.684849 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.685515 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_color_map
[0m14:23:56.685883 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_links
[0m14:23:56.686229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_color_map, now model.ruggable.base_rugs_usa_links)
[0m14:23:56.686530 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_links
[0m14:23:56.689038 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_links"
[0m14:23:56.689690 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_links
[0m14:23:56.690202 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_links
[0m14:23:56.690534 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.690868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_links, now model.ruggable.base_rugs_usa_pads_upsell)
[0m14:23:56.691198 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.693564 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_pads_upsell"
[0m14:23:56.694035 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.694540 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_pads_upsell
[0m14:23:56.694840 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_parent
[0m14:23:56.695154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_pads_upsell, now model.ruggable.base_rugs_usa_parent)
[0m14:23:56.695427 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_parent
[0m14:23:56.697634 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_parent"
[0m14:23:56.698210 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_parent
[0m14:23:56.698649 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_parent
[0m14:23:56.698915 [debug] [Thread-1  ]: Began running node model.ruggable.base_rugs_usa_variant
[0m14:23:56.699210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_parent, now model.ruggable.base_rugs_usa_variant)
[0m14:23:56.699496 [debug] [Thread-1  ]: Began compiling node model.ruggable.base_rugs_usa_variant
[0m14:23:56.701746 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.base_rugs_usa_variant"
[0m14:23:56.702286 [debug] [Thread-1  ]: Began executing node model.ruggable.base_rugs_usa_variant
[0m14:23:56.702692 [debug] [Thread-1  ]: Finished running node model.ruggable.base_rugs_usa_variant
[0m14:23:56.702962 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_category_map
[0m14:23:56.703224 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.base_rugs_usa_variant, now seed.ruggable.rugs_usa_category_map)
[0m14:23:56.703479 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_category_map
[0m14:23:56.704976 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_category_map
[0m14:23:56.705389 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_category_map
[0m14:23:56.705648 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_color_map
[0m14:23:56.705900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_category_map, now seed.ruggable.rugs_usa_color_map)
[0m14:23:56.706125 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_color_map
[0m14:23:56.708398 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_color_map
[0m14:23:56.708814 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_color_map
[0m14:23:56.709058 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_links
[0m14:23:56.709312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_color_map, now seed.ruggable.rugs_usa_links)
[0m14:23:56.709541 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_links
[0m14:23:56.710887 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_links
[0m14:23:56.711260 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_links
[0m14:23:56.711495 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.711727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_links, now seed.ruggable.rugs_usa_pads_upsell)
[0m14:23:56.711932 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.713290 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.713657 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_pads_upsell
[0m14:23:56.713881 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_parent
[0m14:23:56.714118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_pads_upsell, now seed.ruggable.rugs_usa_parent)
[0m14:23:56.714314 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_parent
[0m14:23:56.715635 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_parent
[0m14:23:56.716069 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_parent
[0m14:23:56.716311 [debug] [Thread-1  ]: Began running node seed.ruggable.rugs_usa_variant
[0m14:23:56.716551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_parent, now seed.ruggable.rugs_usa_variant)
[0m14:23:56.716767 [debug] [Thread-1  ]: Began compiling node seed.ruggable.rugs_usa_variant
[0m14:23:56.718086 [debug] [Thread-1  ]: Began executing node seed.ruggable.rugs_usa_variant
[0m14:23:56.718461 [debug] [Thread-1  ]: Finished running node seed.ruggable.rugs_usa_variant
[0m14:23:56.718687 [debug] [Thread-1  ]: Began running node model.ruggable.stg_category_map
[0m14:23:56.718926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.ruggable.rugs_usa_variant, now model.ruggable.stg_category_map)
[0m14:23:56.719121 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_category_map
[0m14:23:56.720874 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_category_map"
[0m14:23:56.721424 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_category_map
[0m14:23:56.721819 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_category_map
[0m14:23:56.722042 [debug] [Thread-1  ]: Began running node model.ruggable.stg_color_map
[0m14:23:56.722278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_category_map, now model.ruggable.stg_color_map)
[0m14:23:56.722481 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_color_map
[0m14:23:56.724255 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_color_map"
[0m14:23:56.724595 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_color_map
[0m14:23:56.724958 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_color_map
[0m14:23:56.725182 [debug] [Thread-1  ]: Began running node model.ruggable.stg_links
[0m14:23:56.725409 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_color_map, now model.ruggable.stg_links)
[0m14:23:56.725597 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_links
[0m14:23:56.727249 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_links"
[0m14:23:56.727792 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_links
[0m14:23:56.728130 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_links
[0m14:23:56.728336 [debug] [Thread-1  ]: Began running node model.ruggable.stg_pads_upsell
[0m14:23:56.728548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_links, now model.ruggable.stg_pads_upsell)
[0m14:23:56.728735 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_pads_upsell
[0m14:23:56.731135 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_pads_upsell"
[0m14:23:56.731599 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_pads_upsell
[0m14:23:56.731938 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_pads_upsell
[0m14:23:56.732148 [debug] [Thread-1  ]: Began running node model.ruggable.stg_parent
[0m14:23:56.732363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_pads_upsell, now model.ruggable.stg_parent)
[0m14:23:56.732541 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_parent
[0m14:23:56.734163 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_parent"
[0m14:23:56.734474 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_parent
[0m14:23:56.734803 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_parent
[0m14:23:56.735006 [debug] [Thread-1  ]: Began running node model.ruggable.stg_variant
[0m14:23:56.735213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_parent, now model.ruggable.stg_variant)
[0m14:23:56.735389 [debug] [Thread-1  ]: Began compiling node model.ruggable.stg_variant
[0m14:23:56.737023 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.stg_variant"
[0m14:23:56.737788 [debug] [Thread-1  ]: Began executing node model.ruggable.stg_variant
[0m14:23:56.738178 [debug] [Thread-1  ]: Finished running node model.ruggable.stg_variant
[0m14:23:56.738559 [debug] [Thread-1  ]: Began running node model.ruggable.pads
[0m14:23:56.738778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.stg_variant, now model.ruggable.pads)
[0m14:23:56.738975 [debug] [Thread-1  ]: Began compiling node model.ruggable.pads
[0m14:23:56.740872 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.pads"
[0m14:23:56.741396 [debug] [Thread-1  ]: Began executing node model.ruggable.pads
[0m14:23:56.741737 [debug] [Thread-1  ]: Finished running node model.ruggable.pads
[0m14:23:56.741939 [debug] [Thread-1  ]: Began running node model.ruggable.parents
[0m14:23:56.742143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.pads, now model.ruggable.parents)
[0m14:23:56.742314 [debug] [Thread-1  ]: Began compiling node model.ruggable.parents
[0m14:23:56.744260 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.parents"
[0m14:23:56.744694 [debug] [Thread-1  ]: Began executing node model.ruggable.parents
[0m14:23:56.745022 [debug] [Thread-1  ]: Finished running node model.ruggable.parents
[0m14:23:56.745223 [debug] [Thread-1  ]: Began running node model.ruggable.variants
[0m14:23:56.745423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ruggable.parents, now model.ruggable.variants)
[0m14:23:56.745588 [debug] [Thread-1  ]: Began compiling node model.ruggable.variants
[0m14:23:56.747340 [debug] [Thread-1  ]: Writing injected SQL for node "model.ruggable.variants"
[0m14:23:56.747758 [debug] [Thread-1  ]: Began executing node model.ruggable.variants
[0m14:23:56.748072 [debug] [Thread-1  ]: Finished running node model.ruggable.variants
[0m14:23:56.748472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:56.748630 [debug] [MainThread]: Connection 'model.ruggable.variants' was properly closed.
[0m14:23:56.750165 [debug] [MainThread]: Command end result
[0m14:23:56.809888 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m14:23:56.810082 [info ] [MainThread]: Building catalog
[0m14:23:56.813988 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m14:23:56.825086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:56.883609 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "ruggable", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`ruggable`.__TABLES__ tables
    left join `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_variant')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('pads')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('variants')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_variant')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_variant')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('stg_color_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_pads_upsell')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_category_map')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_links')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('base_rugs_usa_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('rugs_usa_parent')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('parents')
                            ) or (
                                upper(table_schema) = upper('ruggable')
                            and upper(table_name) = upper('raw_rugs_usa_variant')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`ruggable`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m14:23:58.153440 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:daa32d44-85de-448d-8463-a07745f90b18&page=queryresults
[0m14:24:00.799903 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/ruggable/target/catalog.json
[0m14:24:00.801440 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.792969, "process_user_time": 2.324906, "process_kernel_time": 2.538205, "process_mem_max_rss": "203685888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:24:00.801746 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:24:00.801702 after 5.79 seconds
[0m14:24:00.801904 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:24:00.802028 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m14:24:00.802175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284eae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ed30>]}
[0m14:24:00.802354 [debug] [MainThread]: Flushing usage events
[0m14:24:19.332574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ccd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ccee0>]}


============================== 14:24:19.334866 | 18550110-eebe-4b5f-a60d-6753de22111f ==============================
[0m14:24:19.334866 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:24:19.335211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/ruggable/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m14:24:19.802453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18550110-eebe-4b5f-a60d-6753de22111f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9b9910>]}
[0m14:24:19.828193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18550110-eebe-4b5f-a60d-6753de22111f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9b9370>]}
[0m14:35:41.082061 [error] [MainThread]: Encountered an error:

[0m14:35:41.117480 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/ahmed/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:35:41.119913 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 681.8372, "process_user_time": 1.525346, "process_kernel_time": 2.721325, "process_mem_max_rss": "185696256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:41.120450 [debug] [MainThread]: Command `dbt docs serve` failed at 14:35:41.120382 after 681.84 seconds
[0m14:35:41.120810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fc6dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fc6df40>]}
[0m14:35:41.121130 [debug] [MainThread]: Flushing usage events
[0m12:28:00.537061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107264ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f9e80>]}


============================== 12:28:00.540193 | 6df1b695-19b5-45f7-a7f0-646f981624c6 ==============================
[0m12:28:00.540193 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:00.540513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:03.931295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6df1b695-19b5-45f7-a7f0-646f981624c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15891a9a0>]}
[0m12:28:03.958722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6df1b695-19b5-45f7-a7f0-646f981624c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11189c340>]}
[0m12:28:03.959177 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:28:03.988457 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:28:04.053791 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:28:04.054107 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:28:04.054328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6df1b695-19b5-45f7-a7f0-646f981624c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105345e0>]}
[0m12:28:04.667485 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analysis.stg_spy_2014_2024' (models/2_staging/stg_spy_2014_2024.sql) depends on a node named 'base_spy_2014_2024' which was not found
[0m12:28:04.690906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2049894, "process_user_time": 3.078124, "process_kernel_time": 2.188118, "process_mem_max_rss": "192200704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:04.693233 [debug] [MainThread]: Command `dbt run` failed at 12:28:04.692843 after 4.21 seconds
[0m12:28:04.693885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107264ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e81040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042e610>]}
[0m12:28:04.694159 [debug] [MainThread]: Flushing usage events
[0m12:29:06.693594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128351ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128351e80>]}


============================== 12:29:06.695683 | 5fec7f62-3bbb-4708-b102-a787dbe3bc83 ==============================
[0m12:29:06.695683 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:06.696022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:07.154787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2c640>]}
[0m12:29:07.186925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107778310>]}
[0m12:29:07.187589 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:29:07.215657 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:29:07.281977 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:29:07.282253 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:29:07.282434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c820>]}
[0m12:29:08.006945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f88a130>]}
[0m12:29:08.065346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f8cda30>]}
[0m12:29:08.065663 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:29:08.065850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f8a2910>]}
[0m12:29:08.066590 [info ] [MainThread]: 
[0m12:29:08.066882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:29:08.069138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:29:08.069345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:08.726520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now create_first-project-262802_stock_analysis)
[0m12:29:08.727643 [debug] [ThreadPool]: Creating schema "database: "first-project-262802"
schema: "stock_analysis"
"
[0m12:29:08.741890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:08.821381 [debug] [ThreadPool]: On create_first-project-262802_stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "create_first-project-262802_stock_analysis"} */
create schema if not exists `first-project-262802`.`stock_analysis`
  
[0m12:29:09.568694 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:aa5cf41a-90cd-49f0-a7b9-bcc9b497f7a4&page=queryresults
[0m12:29:10.181869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_first-project-262802_stock_analysis, now list_first-project-262802_stock_analysis)
[0m12:29:10.182541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:10.735435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665acd0>]}
[0m12:29:10.736360 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:29:10.736811 [info ] [MainThread]: 
[0m12:29:10.741546 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:29:10.742069 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:29:10.742543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:29:10.742825 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:29:10.747675 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:29:10.748227 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:29:10.773179 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:29:10.774334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:10.842865 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:29:11.752585 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:38c36500-96c0-45a0-80e7-84a062b3ad06&page=queryresults
[0m12:29:11.880042 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: date at [18:7]; reason: invalidQuery, location: query, message: Unrecognized name: date at [18:7]')
[0m12:29:12.745945 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c9523eb7-abf3-4636-8257-8b6644d5f71a&page=queryresults
[0m12:29:12.874098 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c9523eb7-abf3-4636-8257-8b6644d5f71a&page=queryresults
[0m12:29:12.918632 [debug] [Thread-1  ]: Database Error in model base_calendar (models/1_base/base_calendar.sql)
  Unrecognized name: date at [18:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_calendar.sql
[0m12:29:12.919888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fb39f70>]}
[0m12:29:12.920376 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model stock_analysis.base_calendar ............. [[31mERROR[0m in 2.18s]
[0m12:29:12.920799 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:29:12.921089 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:29:12.921496 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:29:12.921831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:29:12.922081 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:29:12.924559 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:12.925032 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:29:12.927399 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:12.928030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:12.993427 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:29:14.124503 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:63fe26a1-da2d-496f-a15f-9bdf9b7f1b3e&page=queryresults
[0m12:29:16.502610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fec7f62-3bbb-4708-b102-a787dbe3bc83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fb3dfd0>]}
[0m12:29:16.503351 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.58s]
[0m12:29:16.503895 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:29:16.504533 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:29:16.505027 [info ] [Thread-1  ]: 3 of 4 SKIP relation stock_analysis.stg_spy_2014_2024 .......................... [[33mSKIP[0m]
[0m12:29:16.505525 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:29:16.506060 [debug] [Thread-1  ]: Began running node model.stock_analysis.final_spy_2014_2024
[0m12:29:16.506410 [info ] [Thread-1  ]: 4 of 4 SKIP relation stock_analysis.final_spy_2014_2024 ........................ [[33mSKIP[0m]
[0m12:29:16.506749 [debug] [Thread-1  ]: Finished running node model.stock_analysis.final_spy_2014_2024
[0m12:29:16.507458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:16.507675 [debug] [MainThread]: Connection 'model.stock_analysis.base_spy_2014_2024' was properly closed.
[0m12:29:16.507947 [info ] [MainThread]: 
[0m12:29:16.508216 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m12:29:16.508859 [debug] [MainThread]: Command end result
[0m12:29:16.535277 [info ] [MainThread]: 
[0m12:29:16.535636 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:29:16.535816 [info ] [MainThread]: 
[0m12:29:16.536036 [error] [MainThread]:   Database Error in model base_calendar (models/1_base/base_calendar.sql)
  Unrecognized name: date at [18:7]
  compiled Code at target/run/stock_analysis/models/1_base/base_calendar.sql
[0m12:29:16.536198 [info ] [MainThread]: 
[0m12:29:16.536366 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m12:29:16.537519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.893358, "process_user_time": 5.350007, "process_kernel_time": 0.22381, "process_mem_max_rss": "202604544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:29:16.537799 [debug] [MainThread]: Command `dbt run` failed at 12:29:16.537747 after 9.89 seconds
[0m12:29:16.538018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107778310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d62ee0>]}
[0m12:29:16.538211 [debug] [MainThread]: Flushing usage events
[0m12:29:50.699543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106114b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a99d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a99f40>]}


============================== 12:29:50.701623 | 93ff2aa6-7855-49be-b707-bfc7abdb786e ==============================
[0m12:29:50.701623 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:50.701941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:29:51.149390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe9e4f0>]}
[0m12:29:51.175217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24df0>]}
[0m12:29:51.175530 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:29:51.186205 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:29:51.253106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:51.253493 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m12:29:51.408463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff56cd0>]}
[0m12:29:51.458143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fef9c70>]}
[0m12:29:51.458423 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:29:51.458610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fec8ca0>]}
[0m12:29:51.459492 [info ] [MainThread]: 
[0m12:29:51.459787 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:29:51.462015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:29:51.462237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:51.988650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:29:51.989694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:52.534760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7aa90>]}
[0m12:29:52.536007 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:29:52.536545 [info ] [MainThread]: 
[0m12:29:52.539971 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:29:52.540977 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:29:52.541715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:29:52.542430 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:29:52.553576 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:29:52.554472 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:29:52.587448 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:29:52.588069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:52.652671 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:29:53.616550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:87515d93-72e5-44c9-b038-9433b9bc3323&page=queryresults
[0m12:29:56.680333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c4400>]}
[0m12:29:56.681168 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.14s]
[0m12:29:56.681738 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:29:56.682123 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:29:56.682598 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:29:56.683023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:29:56.683318 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:29:56.686172 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:56.686858 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:29:56.690671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:57.252626 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:29:57.255717 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:29:57.848822 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:48fccd61-3d87-4b80-a837-d92ea8bea2ec&page=queryresults
[0m12:29:59.902271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748a460>]}
[0m12:29:59.903220 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.22s]
[0m12:29:59.904037 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:29:59.904769 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:29:59.905190 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:29:59.905493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m12:29:59.905688 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:29:59.909307 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:29:59.910250 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:29:59.913553 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:29:59.914375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:29:59.986271 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using date
    );
  
[0m12:30:00.509528 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:07efac97-49cb-4236-b9ed-bcf52861a1c3&page=queryresults
[0m12:30:00.510087 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" but got keyword DATE at [16:73]; reason: invalidQuery, location: query, message: Syntax error: Expected "(" but got keyword DATE at [16:73]')
[0m12:30:01.169748 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ef66697f-e128-458a-ad16-3b33b3422c7e&page=queryresults
[0m12:30:01.171452 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ef66697f-e128-458a-ad16-3b33b3422c7e&page=queryresults
[0m12:30:01.211689 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Syntax error: Expected "(" but got keyword DATE at [16:73]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m12:30:01.212128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ff2aa6-7855-49be-b707-bfc7abdb786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f46dbb0>]}
[0m12:30:01.212597 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.31s]
[0m12:30:01.213031 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:30:01.213543 [debug] [Thread-1  ]: Began running node model.stock_analysis.final_spy_2014_2024
[0m12:30:01.213926 [info ] [Thread-1  ]: 4 of 4 SKIP relation stock_analysis.final_spy_2014_2024 ........................ [[33mSKIP[0m]
[0m12:30:01.214192 [debug] [Thread-1  ]: Finished running node model.stock_analysis.final_spy_2014_2024
[0m12:30:01.214849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:01.215041 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m12:30:01.215293 [info ] [MainThread]: 
[0m12:30:01.215504 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m12:30:01.216125 [debug] [MainThread]: Command end result
[0m12:30:01.239448 [info ] [MainThread]: 
[0m12:30:01.239795 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:01.239988 [info ] [MainThread]: 
[0m12:30:01.240243 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Syntax error: Expected "(" but got keyword DATE at [16:73]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m12:30:01.240431 [info ] [MainThread]: 
[0m12:30:01.240611 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m12:30:01.241854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.589343, "process_user_time": 4.895982, "process_kernel_time": 0.19524, "process_mem_max_rss": "198901760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:01.242170 [debug] [MainThread]: Command `dbt run` failed at 12:30:01.242116 after 10.59 seconds
[0m12:30:01.242394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106114b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fddf8e0>]}
[0m12:30:01.242618 [debug] [MainThread]: Flushing usage events
[0m12:30:22.449218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a21ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a21e80>]}


============================== 12:30:22.451655 | 9fab9307-ff3b-44f3-be6e-7510fd608b5b ==============================
[0m12:30:22.451655 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:22.451951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:22.899504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d4640>]}
[0m12:30:22.925352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e20310>]}
[0m12:30:22.925662 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:30:22.936579 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:30:23.004705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:23.005096 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m12:30:23.158637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165393130>]}
[0m12:30:23.208051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f3fdc0>]}
[0m12:30:23.208317 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:30:23.208506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1651714c0>]}
[0m12:30:23.209355 [info ] [MainThread]: 
[0m12:30:23.209648 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:30:23.211823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:30:23.212038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:23.876657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:30:23.877393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:24.373133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165242a30>]}
[0m12:30:24.374537 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:30:24.375099 [info ] [MainThread]: 
[0m12:30:24.378959 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:30:24.380126 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:30:24.380864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:30:24.381287 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:30:24.392092 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:30:24.393067 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:30:24.408013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:24.940483 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:30:24.941390 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:30:25.292574 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8ddf8d55-8b7b-4b84-8228-2aa2a4533894&page=queryresults
[0m12:30:28.472622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439ac70>]}
[0m12:30:28.473179 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.09s]
[0m12:30:28.473632 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:30:28.473930 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:30:28.474345 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:30:28.474715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:30:28.474969 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:30:28.478705 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:30:28.479414 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:30:28.481435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:28.981018 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:30:28.983127 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:30:29.491303 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:af1a43e7-a497-454e-af4f-c8da30121438&page=queryresults
[0m12:30:31.403058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165278430>]}
[0m12:30:31.405340 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.93s]
[0m12:30:31.406357 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:30:31.407337 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:30:31.407796 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:30:31.408281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m12:30:31.408523 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:30:31.411291 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:30:31.412047 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:30:31.414125 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:30:31.414645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:31.477777 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using (date)
    );
  
[0m12:30:32.253113 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ee0b6e0c-9bbe-4ab7-9be8-68dd9ac8923b&page=queryresults
[0m12:30:35.126939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1652781f0>]}
[0m12:30:35.129460 [info ] [Thread-1  ]: 3 of 4 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 31.1 MiB processed)[0m in 3.72s]
[0m12:30:35.130703 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:30:35.132113 [debug] [Thread-1  ]: Began running node model.stock_analysis.final_spy_2014_2024
[0m12:30:35.132655 [info ] [Thread-1  ]: 4 of 4 START sql table model stock_analysis.final_spy_2014_2024 ................ [RUN]
[0m12:30:35.133173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.final_spy_2014_2024)
[0m12:30:35.133498 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.final_spy_2014_2024
[0m12:30:35.137139 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.final_spy_2014_2024"
[0m12:30:35.138318 [debug] [Thread-1  ]: Began executing node model.stock_analysis.final_spy_2014_2024
[0m12:30:35.141424 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.final_spy_2014_2024"
[0m12:30:35.142400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:35.214717 [debug] [Thread-1  ]: On model.stock_analysis.final_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.final_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`final_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      -- with

-- spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


-- select
--     spy_2014_2024.*
-- from spy_2014_2024
    );
  
[0m12:30:35.607664 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:be792793-1c2c-4870-8df1-3edd22ef70b2&page=queryresults
[0m12:30:35.608929 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [21:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [21:5]')
[0m12:30:36.043714 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2f1ac729-4fea-49c9-943c-dd2680a43ef0&page=queryresults
[0m12:30:36.044897 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2f1ac729-4fea-49c9-943c-dd2680a43ef0&page=queryresults
[0m12:30:36.081724 [debug] [Thread-1  ]: Database Error in model final_spy_2014_2024 (models/3_final/final_spy_2014_2024.sql)
  Syntax error: Unexpected ")" at [21:5]
  compiled Code at target/run/stock_analysis/models/3_final/final_spy_2014_2024.sql
[0m12:30:36.082277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fab9307-ff3b-44f3-be6e-7510fd608b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165650ee0>]}
[0m12:30:36.082822 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model stock_analysis.final_spy_2014_2024 ....... [[31mERROR[0m in 0.95s]
[0m12:30:36.083266 [debug] [Thread-1  ]: Finished running node model.stock_analysis.final_spy_2014_2024
[0m12:30:36.084173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:36.084406 [debug] [MainThread]: Connection 'model.stock_analysis.final_spy_2014_2024' was properly closed.
[0m12:30:36.084667 [info ] [MainThread]: 
[0m12:30:36.084909 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.88 seconds (12.88s).
[0m12:30:36.085644 [debug] [MainThread]: Command end result
[0m12:30:36.108606 [info ] [MainThread]: 
[0m12:30:36.108969 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:36.109162 [info ] [MainThread]: 
[0m12:30:36.109409 [error] [MainThread]:   Database Error in model final_spy_2014_2024 (models/3_final/final_spy_2014_2024.sql)
  Syntax error: Unexpected ")" at [21:5]
  compiled Code at target/run/stock_analysis/models/3_final/final_spy_2014_2024.sql
[0m12:30:36.109632 [info ] [MainThread]: 
[0m12:30:36.109847 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:30:36.111255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.714163, "process_user_time": 3.926323, "process_kernel_time": 1.310405, "process_mem_max_rss": "198541312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:36.111595 [debug] [MainThread]: Command `dbt run` failed at 12:30:36.111540 after 13.71 seconds
[0m12:30:36.111836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1653b0cd0>]}
[0m12:30:36.112054 [debug] [MainThread]: Flushing usage events
[0m12:32:34.781529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d39c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d39e50>]}


============================== 12:32:34.784482 | e4620a42-307d-45d8-9e92-9a4daa145f91 ==============================
[0m12:32:34.784482 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:32:34.784843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:35.527832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16629e0d0>]}
[0m12:32:35.555486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cec9d0>]}
[0m12:32:35.555883 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:32:35.567808 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:32:35.640335 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:32:35.640695 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_final/spy_2014_2024.sql
[0m12:32:35.640850 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_final/final_spy_2014_2024.sql
[0m12:32:35.795856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162b33b20>]}
[0m12:32:35.849342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166448670>]}
[0m12:32:35.849605 [info ] [MainThread]: Found 4 models, 2 sources, 469 macros
[0m12:32:35.849796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d2149a0>]}
[0m12:32:35.850646 [info ] [MainThread]: 
[0m12:32:35.850928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:35.853096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:32:35.853293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:36.468242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:32:36.469163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:36.967018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103400190>]}
[0m12:32:36.969027 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:32:36.969703 [info ] [MainThread]: 
[0m12:32:36.974630 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:32:36.976134 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:32:36.976966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:32:36.977513 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:32:36.988677 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:32:36.989508 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:32:37.003509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:37.556744 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:32:37.557645 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:32:38.023710 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0fd16580-8c84-43dc-8802-3c0e70cf03fe&page=queryresults
[0m12:32:41.490949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162bf5640>]}
[0m12:32:41.491727 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.51s]
[0m12:32:41.492316 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:32:41.492711 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:32:41.493228 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:32:41.493691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:32:41.494014 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:32:41.499118 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:32:41.500213 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:32:41.502516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:42.014720 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:32:42.017701 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  extract(year from date) as year
  , extract(month from date) as month
  , extract(day from date) as day
  , date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:32:42.409459 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b6fe7a98-c25f-435e-a5f0-3c2c5f186194&page=queryresults
[0m12:32:44.333676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d36a730>]}
[0m12:32:44.335288 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.84s]
[0m12:32:44.336785 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:32:44.338038 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:32:44.338664 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:32:44.339265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_spy_2014_2024)
[0m12:32:44.339697 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:32:44.344677 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:32:44.345880 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:32:44.348764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:44.866054 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:32:44.868910 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using (date)
    );
  
[0m12:32:45.255701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fcc21313-47ab-4aa3-a867-11cb5daacb07&page=queryresults
[0m12:32:47.810656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d36aa60>]}
[0m12:32:47.811594 [info ] [Thread-1  ]: 3 of 4 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 31.1 MiB processed)[0m in 3.47s]
[0m12:32:47.812332 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:32:47.813331 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m12:32:47.813926 [info ] [Thread-1  ]: 4 of 4 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m12:32:47.814436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m12:32:47.814820 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m12:32:47.818564 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m12:32:47.819569 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m12:32:47.822800 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m12:32:47.823411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:47.898691 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m12:32:48.652877 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e5810859-bb9d-4458-8cd6-5e13fdeeb8e1&page=queryresults
[0m12:32:50.580273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4620a42-307d-45d8-9e92-9a4daa145f91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d3a1460>]}
[0m12:32:50.581417 [info ] [Thread-1  ]: 4 of 4 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 703.1 KiB processed)[0m in 2.77s]
[0m12:32:50.582111 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m12:32:50.583378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:50.583735 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m12:32:50.584139 [info ] [MainThread]: 
[0m12:32:50.584480 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.73 seconds (14.73s).
[0m12:32:50.585594 [debug] [MainThread]: Command end result
[0m12:32:50.613777 [info ] [MainThread]: 
[0m12:32:50.614134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:50.614356 [info ] [MainThread]: 
[0m12:32:50.614707 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:32:50.616126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.887622, "process_user_time": 2.869769, "process_kernel_time": 2.443085, "process_mem_max_rss": "198213632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:32:50.616495 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:50.616437 after 15.89 seconds
[0m12:32:50.616754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162b33670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461b7c0>]}
[0m12:32:50.617007 [debug] [MainThread]: Flushing usage events
[0m12:42:09.046642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577de80>]}


============================== 12:42:09.049375 | be8de2f8-f5d4-41a7-9412-0401fe44e8e6 ==============================
[0m12:42:09.049375 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:42:09.049705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:09.821928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d5a9a0>]}
[0m12:42:09.847642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105720340>]}
[0m12:42:09.847928 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m12:42:09.858446 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:42:09.933019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m12:42:09.933389 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/2_staging/stg_calendar.sql
[0m12:42:09.933613 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m12:42:09.933807 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_spy_2014_2024.sql
[0m12:42:10.089534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f6ee0>]}
[0m12:42:10.142223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126df11f0>]}
[0m12:42:10.142487 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m12:42:10.142672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105720be0>]}
[0m12:42:10.143374 [info ] [MainThread]: 
[0m12:42:10.143644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:10.145926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m12:42:10.146139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:10.752349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m12:42:10.753444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:11.312521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5fa90>]}
[0m12:42:11.314078 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m12:42:11.314868 [info ] [MainThread]: 
[0m12:42:11.319323 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m12:42:11.320098 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m12:42:11.320707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m12:42:11.321187 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m12:42:11.330512 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m12:42:11.331270 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m12:42:11.344482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:11.883530 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m12:42:11.884497 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m12:42:12.455686 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:849114e9-78e3-477c-94bd-7e406df9db61&page=queryresults
[0m12:42:15.539854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232a9610>]}
[0m12:42:15.540602 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.22s]
[0m12:42:15.541193 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m12:42:15.541575 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m12:42:15.542105 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m12:42:15.542644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m12:42:15.542979 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m12:42:15.547840 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m12:42:15.549785 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m12:42:15.552146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:16.037152 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m12:42:16.041399 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m12:42:16.446619 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d1ee8cbd-7a36-477a-ae4b-4f7aaa9ecb6c&page=queryresults
[0m12:42:18.373388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d794f0>]}
[0m12:42:18.375805 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.83s]
[0m12:42:18.377310 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m12:42:18.378015 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m12:42:18.378887 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m12:42:18.379713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m12:42:18.380183 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m12:42:18.385918 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m12:42:18.387208 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m12:42:18.391654 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m12:42:18.393037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:18.471705 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

select
    *
    , case when day_of_date = 1 then TRUE else FALSE end as month_start
    -- , case 
    --     when month_full in () and day_of_date = 30 then TRUE 
    --     when day_of_date = 31 then TRUE 
    --     when day_of_date = 28 or day_of_date = 29 then TRUE 
    --     else FALSE 
    --   end as month_end
from base_calendar
    );
  
[0m12:42:19.144121 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a2cb1e0d-ed59-43c8-be10-decb4dd344f3&page=queryresults
[0m12:42:22.166501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d797f0>]}
[0m12:42:22.167307 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 34.3 MiB processed)[0m in 3.79s]
[0m12:42:22.168012 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m12:42:22.168489 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m12:42:22.169121 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m12:42:22.169694 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m12:42:22.170057 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m12:42:22.173677 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:42:22.174454 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m12:42:22.177368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:22.658811 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m12:42:22.659549 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`base_calendar` using (date)
    );
  
[0m12:42:23.009934 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:59bf2c54-e428-4ab5-a444-ae935d76dc7e&page=queryresults
[0m12:42:25.726539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e18dc0>]}
[0m12:42:25.728969 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 34.4 MiB processed)[0m in 3.56s]
[0m12:42:25.730076 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m12:42:25.731456 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m12:42:25.732119 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m12:42:25.732714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m12:42:25.733545 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m12:42:25.738964 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m12:42:25.741477 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m12:42:25.745380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:26.242399 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m12:42:26.245065 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m12:42:26.583543 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cf280754-1a3b-4b99-8238-d0e3dd50a76c&page=queryresults
[0m12:42:28.603472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be8de2f8-f5d4-41a7-9412-0401fe44e8e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127dfc3a0>]}
[0m12:42:28.605799 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 703.1 KiB processed)[0m in 2.87s]
[0m12:42:28.607105 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m12:42:28.608733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:28.609106 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m12:42:28.609376 [info ] [MainThread]: 
[0m12:42:28.609603 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 18.47 seconds (18.47s).
[0m12:42:28.610409 [debug] [MainThread]: Command end result
[0m12:42:28.632403 [info ] [MainThread]: 
[0m12:42:28.632748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:28.632924 [info ] [MainThread]: 
[0m12:42:28.633103 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:42:28.634263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.636581, "process_user_time": 5.129571, "process_kernel_time": 0.306117, "process_mem_max_rss": "195215360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:42:28.634559 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:28.634508 after 19.64 seconds
[0m12:42:28.634771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126df60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126bd0fd0>]}
[0m12:42:28.634977 [debug] [MainThread]: Flushing usage events
[0m13:01:44.113118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2de50>]}


============================== 13:01:44.116443 | a6ae88b5-5d90-4cb1-b466-d5af613c9ecf ==============================
[0m13:01:44.116443 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:44.116786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:44.990038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c24c0d0>]}
[0m13:01:45.019073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de29d0>]}
[0m13:01:45.019514 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:01:45.032954 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:01:45.112117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:01:45.112536 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m13:01:45.112752 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:01:45.112968 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m13:01:45.279558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5ae9a0>]}
[0m13:01:45.335380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c6a67f0>]}
[0m13:01:45.335660 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:01:45.335849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c22e400>]}
[0m13:01:45.336589 [info ] [MainThread]: 
[0m13:01:45.336865 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:01:45.339136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:01:45.339341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:45.960859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:01:45.961962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:46.478926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430fa90>]}
[0m13:01:46.480226 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:01:46.480775 [info ] [MainThread]: 
[0m13:01:46.485028 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:01:46.485592 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m13:01:46.486103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:01:46.486467 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:01:46.494951 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:01:46.495927 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:01:46.509487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:47.055660 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m13:01:47.056545 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m13:01:47.499826 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b1552c8c-8c57-4721-a0fe-05bc36343ae9&page=queryresults
[0m13:01:50.663743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8e8640>]}
[0m13:01:50.664298 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.18s]
[0m13:01:50.664750 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:01:50.665051 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:01:50.665369 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m13:01:50.665677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:01:50.665920 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:01:50.668510 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:01:50.669757 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:01:50.671880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:51.134917 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m13:01:51.138533 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m13:01:51.598076 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:79268c76-4c17-41c0-8c9d-9c9255f76557&page=queryresults
[0m13:01:53.828444 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c8efe80>]}
[0m13:01:53.829920 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 3.16s]
[0m13:01:53.830782 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:01:53.831634 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:01:53.832909 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:01:53.833740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:01:53.834280 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:01:53.839372 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:01:53.841773 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:01:53.845185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:54.329555 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:01:54.331300 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

select
    *
    , case when day_of_date = 1 then TRUE else FALSE end as month_start
    , case 
        when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
        when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
        when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
        else FALSE 
    end as month_end
from base_calendar
    );
  
[0m13:01:54.710788 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fb29a62f-4fd8-40be-bae1-6287355bf505&page=queryresults
[0m13:01:58.530806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c870f70>]}
[0m13:01:58.532771 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 33.9 MiB processed)[0m in 4.70s]
[0m13:01:58.533561 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:01:58.534601 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:01:58.535393 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m13:01:58.535952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:01:58.536278 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:01:58.539692 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:01:58.540559 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:01:58.544859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:59.054343 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:01:59.057522 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m13:01:59.481178 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:3761e9cb-37a3-4461-a0d3-69bb2a433076&page=queryresults
[0m13:02:02.409617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c931220>]}
[0m13:02:02.410568 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 34.3 MiB processed)[0m in 3.87s]
[0m13:02:02.411261 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:02:02.411995 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:02:02.412527 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m13:02:02.413086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:02:02.413475 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:02:02.416581 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:02:02.418491 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:02:02.421331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:02.948524 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m13:02:02.950267 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m13:02:03.372543 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f92873a7-5714-4be4-9e4a-80f1c77860ba&page=queryresults
[0m13:02:05.367815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6ae88b5-5d90-4cb1-b466-d5af613c9ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c870850>]}
[0m13:02:05.369893 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 701.0 KiB processed)[0m in 2.95s]
[0m13:02:05.370615 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:02:05.371677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:05.371962 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:02:05.372249 [info ] [MainThread]: 
[0m13:02:05.372492 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 20.04 seconds (20.04s).
[0m13:02:05.373394 [debug] [MainThread]: Command end result
[0m13:02:05.397992 [info ] [MainThread]: 
[0m13:02:05.398343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:05.398544 [info ] [MainThread]: 
[0m13:02:05.398743 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:02:05.400046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.345028, "process_user_time": 4.848076, "process_kernel_time": 0.320356, "process_mem_max_rss": "197459968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:02:05.400373 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:05.400314 after 21.35 seconds
[0m13:02:05.400612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b8e8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5463a0>]}
[0m13:02:05.400843 [debug] [MainThread]: Flushing usage events
[0m13:04:30.227267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108341c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108341df0>]}


============================== 13:04:30.230029 | c4abc335-026f-4102-acb0-4e839bf37f2a ==============================
[0m13:04:30.230029 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:04:30.230350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:04:30.981156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a701c0>]}
[0m13:04:31.009998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a4b640>]}
[0m13:04:31.010442 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:04:31.022248 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:04:31.097959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:31.098312 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m13:04:31.257069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1296a3130>]}
[0m13:04:31.310494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830b190>]}
[0m13:04:31.310761 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:04:31.310955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129118730>]}
[0m13:04:31.311664 [info ] [MainThread]: 
[0m13:04:31.311936 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:04:31.314156 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:04:31.314363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:31.881345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:04:31.882476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:32.389573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081be1f0>]}
[0m13:04:32.391092 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:04:32.391871 [info ] [MainThread]: 
[0m13:04:32.395981 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:04:32.396604 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m13:04:32.397127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:04:32.397866 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:04:32.407848 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:04:32.408763 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:04:32.422713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:32.950396 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m13:04:32.953425 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m13:04:33.490803 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:64646f90-bcdc-4602-8364-6adc311f7b52&page=queryresults
[0m13:04:36.868667 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a335b0>]}
[0m13:04:36.869263 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.47s]
[0m13:04:36.869750 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:04:36.870078 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:04:36.870532 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m13:04:36.871019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:04:36.871361 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:04:36.873944 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:04:36.874618 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:04:36.876993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:37.364674 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m13:04:37.366263 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m13:04:37.793610 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9fd8a73d-769a-4334-96f9-69d72e1a4cbf&page=queryresults
[0m13:04:39.563085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12988fdf0>]}
[0m13:04:39.564645 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.69s]
[0m13:04:39.565607 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:04:39.566209 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:04:39.567232 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:04:39.568340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:04:39.569154 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:04:39.573792 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:04:39.574937 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:04:39.578619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:40.089808 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:04:40.091927 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

select
    *
    , case when day_of_date = 1 then TRUE else FALSE end as month_start
    , case 
        when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
        when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
        when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
        else FALSE 
    end as month_end
from base_calendar
    );
  
[0m13:04:40.543958 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:47b8bf83-8034-4e76-a1b8-c443a47af427&page=queryresults
[0m13:04:43.577838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1298a5fa0>]}
[0m13:04:43.578854 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 4.01s]
[0m13:04:43.579620 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:04:43.580618 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:04:43.581306 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m13:04:43.581775 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:04:43.582012 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:04:43.584241 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:04:43.584778 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:04:43.587820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:44.060931 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:04:44.062248 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m13:04:44.374941 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2ee1ae7d-fbbe-4405-b5c0-090ccdcd6633&page=queryresults
[0m13:04:46.857055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129974160>]}
[0m13:04:46.858306 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 35.4 MiB processed)[0m in 3.28s]
[0m13:04:46.859188 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:04:46.860257 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:04:46.861034 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m13:04:46.861491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:04:46.861773 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:04:46.864312 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:04:46.866281 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:04:46.868762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:47.374291 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m13:04:47.375541 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m13:04:47.747018 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2d3f25bb-c8da-45d2-91b3-dccb82bbb0bc&page=queryresults
[0m13:04:49.873466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4abc335-026f-4102-acb0-4e839bf37f2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1298a5fd0>]}
[0m13:04:49.874953 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 721.0 KiB processed)[0m in 3.01s]
[0m13:04:49.875823 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:04:49.877484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:49.877883 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:04:49.878232 [info ] [MainThread]: 
[0m13:04:49.878531 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 18.57 seconds (18.57s).
[0m13:04:49.879619 [debug] [MainThread]: Command end result
[0m13:04:49.912256 [info ] [MainThread]: 
[0m13:04:49.912673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:49.912932 [info ] [MainThread]: 
[0m13:04:49.913170 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:04:49.914715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.735352, "process_user_time": 4.632596, "process_kernel_time": 0.733379, "process_mem_max_rss": "196214784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:04:49.915119 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:49.915057 after 19.74 seconds
[0m13:04:49.915406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a4b640>]}
[0m13:04:49.915683 [debug] [MainThread]: Flushing usage events
[0m13:13:03.266521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112311c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112311e50>]}


============================== 13:13:03.270051 | e3183a3a-5d08-4edd-9814-40320719c9b4 ==============================
[0m13:13:03.270051 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:13:03.270483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:13:04.075320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ff0c0d0>]}
[0m13:13:04.101484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c39d0>]}
[0m13:13:04.101785 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:13:04.113242 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:13:04.186893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:04.187227 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:13:04.343135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160423130>]}
[0m13:13:04.396331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110358a00>]}
[0m13:13:04.396598 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:13:04.396787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160462d60>]}
[0m13:13:04.397518 [info ] [MainThread]: 
[0m13:13:04.397800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:13:04.400033 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:13:04.400241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:04.961164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:13:04.962347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:05.508899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16010d070>]}
[0m13:13:05.509546 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:13:05.509853 [info ] [MainThread]: 
[0m13:13:05.512972 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:13:05.513435 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m13:13:05.513797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:13:05.514052 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:13:05.521099 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:13:05.522027 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:13:05.533962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:06.076789 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m13:13:06.078770 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m13:13:06.516240 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9194523a-77ac-4fa3-95c9-31fb969882cb&page=queryresults
[0m13:13:09.876624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f842640>]}
[0m13:13:09.877342 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.36s]
[0m13:13:09.877831 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:13:09.878158 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:13:09.878615 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m13:13:09.879111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:13:09.879399 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:13:09.881949 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:13:09.883518 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:13:09.885700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:10.405905 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m13:13:10.407985 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m13:13:10.827073 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:bc16a7c8-a72f-4b04-a51f-c53a57481b50&page=queryresults
[0m13:13:12.740036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16070ff10>]}
[0m13:13:12.741395 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.86s]
[0m13:13:12.742290 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:13:12.742913 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:13:12.744069 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:13:12.744889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:13:12.745569 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:13:12.750162 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:13:12.752567 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:13:12.755686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:13.344549 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:13:13.347508 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
        when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
        else False
        end as quarter_start
        , case 
        when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
        else False
        end as quarter_end    
    from month_start_and_end
)

select * from adding_quarter_start_and_end
    );
  
[0m13:13:13.548243 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:081eb53a-1982-4f9d-a34f-2fd7baa812d4&page=queryresults
[0m13:13:13.549911 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: month_start_and_end, message: Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).')
[0m13:13:14.425408 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:08a91ada-d275-4b97-a73a-180eab0a5c1c&page=queryresults
[0m13:13:14.427779 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:08a91ada-d275-4b97-a73a-180eab0a5c1c&page=queryresults
[0m13:13:14.469632 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:13:14.470065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3183a3a-5d08-4edd-9814-40320719c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1607fbf70>]}
[0m13:13:14.470488 [error] [Thread-1  ]: 3 of 5 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 1.73s]
[0m13:13:14.470878 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:13:14.471461 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:13:14.471864 [info ] [Thread-1  ]: 4 of 5 SKIP relation stock_analysis.stg_spy_2014_2024 .......................... [[33mSKIP[0m]
[0m13:13:14.472224 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:13:14.472624 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:13:14.472957 [info ] [Thread-1  ]: 5 of 5 SKIP relation stock_analysis.spy_2014_2024 .............................. [[33mSKIP[0m]
[0m13:13:14.473315 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:13:14.474051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:14.474257 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m13:13:14.474525 [info ] [MainThread]: 
[0m13:13:14.474742 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m13:13:14.475434 [debug] [MainThread]: Command end result
[0m13:13:14.498530 [info ] [MainThread]: 
[0m13:13:14.498871 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:13:14.499050 [info ] [MainThread]: 
[0m13:13:14.499273 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:13:14.499459 [info ] [MainThread]: 
[0m13:13:14.499640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m13:13:14.500869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.305, "process_user_time": 4.351643, "process_kernel_time": 0.837419, "process_mem_max_rss": "194494464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:13:14.501176 [debug] [MainThread]: Command `dbt run` failed at 13:13:14.501128 after 11.31 seconds
[0m13:13:14.501394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100cd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ff0c0d0>]}
[0m13:13:14.501604 [debug] [MainThread]: Flushing usage events
[0m13:19:01.726548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f74b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056042b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056040d0>]}


============================== 13:19:01.729415 | 263aa728-2cab-49d0-8445-88b27a121e41 ==============================
[0m13:19:01.729415 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:19:01.729746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_calendar', 'send_anonymous_usage_stats': 'True'}
[0m13:19:02.541401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a7d90a0>]}
[0m13:19:02.568568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a820610>]}
[0m13:19:02.568912 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:19:02.580308 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:19:02.660005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:02.660429 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:19:02.859299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c022130>]}
[0m13:19:02.919891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c022490>]}
[0m13:19:02.920238 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:19:02.920437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c040d00>]}
[0m13:19:02.921042 [info ] [MainThread]: 
[0m13:19:02.921375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:02.921907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:19:02.922162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:03.497366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:19:03.498100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:04.004266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a8a47f0>]}
[0m13:19:04.005238 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:19:04.005653 [info ] [MainThread]: 
[0m13:19:04.007762 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:19:04.008328 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:19:04.008786 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m13:19:04.009138 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:19:04.018132 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:19:04.019076 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:19:04.032785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:04.567379 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:19:04.569368 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
        when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
        else False
        end as quarter_start
        , case 
        when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
        else False
        end as quarter_end    
    from month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as week_start
        , case 
        when day_of_week = 7 then TRUE
        else False
        end as week_end
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as typical_trading_week_start
        , case 
        when day_of_week = 5 then TRUE
        else False
        end as typical_trading_week_end
    from adding_quarter_start_and_end
)

select * from adding_week_start_and_end
    );
  
[0m13:19:04.757332 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6cc40622-322d-4e9a-b008-4ac99c609e78&page=queryresults
[0m13:19:04.759301 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: month_start_and_end, message: Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).')
[0m13:19:05.295563 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f4071811-04cf-47bb-bc5d-0d90aa8b35c7&page=queryresults
[0m13:19:05.297329 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f4071811-04cf-47bb-bc5d-0d90aa8b35c7&page=queryresults
[0m13:19:05.342630 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:19:05.343930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '263aa728-2cab-49d0-8445-88b27a121e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c10fdf0>]}
[0m13:19:05.344434 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 1.33s]
[0m13:19:05.344867 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:19:05.345646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:05.345871 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m13:19:05.346080 [info ] [MainThread]: 
[0m13:19:05.346293 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m13:19:05.346713 [debug] [MainThread]: Command end result
[0m13:19:05.370515 [info ] [MainThread]: 
[0m13:19:05.370858 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:19:05.371031 [info ] [MainThread]: 
[0m13:19:05.371250 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Table "month_start_and_end" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m13:19:05.371422 [info ] [MainThread]: 
[0m13:19:05.371599 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:19:05.372800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6965003, "process_user_time": 4.651507, "process_kernel_time": 0.278438, "process_mem_max_rss": "196001792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:05.373099 [debug] [MainThread]: Command `dbt run` failed at 13:19:05.373050 after 3.70 seconds
[0m13:19:05.373319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f74b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a820610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eef910>]}
[0m13:19:05.373516 [debug] [MainThread]: Flushing usage events
[0m13:19:41.897912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d1c0>]}


============================== 13:19:41.900459 | ba83c4ad-33fc-403f-ad2a-6b3f9d275541 ==============================
[0m13:19:41.900459 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:19:41.900778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_calendar+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:19:42.402751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dc5b0>]}
[0m13:19:42.428571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed6070>]}
[0m13:19:42.428873 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:19:42.440299 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:19:42.513464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:42.513880 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m13:19:42.667952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff97520>]}
[0m13:19:42.721269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c41d00>]}
[0m13:19:42.721543 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:19:42.721730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138931220>]}
[0m13:19:42.722354 [info ] [MainThread]: 
[0m13:19:42.722626 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:42.724811 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m13:19:42.725014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:43.276685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m13:19:43.277950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:43.773167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440a7c0>]}
[0m13:19:43.774813 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:19:43.775534 [info ] [MainThread]: 
[0m13:19:43.780027 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:19:43.781080 [info ] [Thread-1  ]: 1 of 3 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m13:19:43.781849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m13:19:43.782358 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:19:43.793478 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:19:43.794569 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:19:43.809408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:44.340971 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m13:19:44.341828 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
        when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
        else False
        end as quarter_start
        , case 
        when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
        else False
        end as quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as week_start
        , case 
        when day_of_week = 7 then TRUE
        else False
        end as week_end
        , case 
        when day_of_week = 1 then TRUE
        else False
        end as typical_trading_week_start
        , case 
        when day_of_week = 5 then TRUE
        else False
        end as typical_trading_week_end
    from adding_quarter_start_and_end
)

select * from adding_week_start_and_end
    );
  
[0m13:19:44.726935 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:6537933c-bfa0-45f1-aa52-41baf2542364&page=queryresults
[0m13:19:48.634008 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139812eb0>]}
[0m13:19:48.634865 [info ] [Thread-1  ]: 1 of 3 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 4.85s]
[0m13:19:48.635481 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:19:48.636298 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:19:48.636816 [info ] [Thread-1  ]: 2 of 3 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m13:19:48.637250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:19:48.637574 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:19:48.640857 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:19:48.641917 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:19:48.644332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:49.149637 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:19:49.152184 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m13:19:49.538578 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:954f5f40-2b21-4500-afd5-7e6acdb7cd86&page=queryresults
[0m13:19:52.278464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139812d00>]}
[0m13:19:52.280330 [info ] [Thread-1  ]: 2 of 3 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 36.3 MiB processed)[0m in 3.64s]
[0m13:19:52.281186 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:19:52.282192 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:19:52.282809 [info ] [Thread-1  ]: 3 of 3 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m13:19:52.283265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:19:52.283559 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:19:52.286220 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:19:52.286876 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:19:52.289131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:19:52.807385 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m13:19:52.809116 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m13:19:53.159516 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b80cd5d6-6819-461f-a403-6de98123819d&page=queryresults
[0m13:19:55.354341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba83c4ad-33fc-403f-ad2a-6b3f9d275541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139812dc0>]}
[0m13:19:55.355291 [info ] [Thread-1  ]: 3 of 3 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 735.7 KiB processed)[0m in 3.07s]
[0m13:19:55.356087 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:19:55.357466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:55.357891 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:19:55.358368 [info ] [MainThread]: 
[0m13:19:55.358763 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.64 seconds (12.64s).
[0m13:19:55.359959 [debug] [MainThread]: Command end result
[0m13:19:55.384249 [info ] [MainThread]: 
[0m13:19:55.384673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:55.384889 [info ] [MainThread]: 
[0m13:19:55.385075 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:19:55.386381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.535562, "process_user_time": 2.256592, "process_kernel_time": 2.63183, "process_mem_max_rss": "194691072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:55.386663 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:55.386618 after 13.54 seconds
[0m13:19:55.386860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138a94910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dc5b0>]}
[0m13:19:55.387040 [debug] [MainThread]: Flushing usage events
[0m13:20:23.358753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d34ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d2df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d2fd0>]}


============================== 13:20:23.361484 | 2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8 ==============================
[0m13:20:23.361484 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:20:23.361807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:20:24.072934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104290d90>]}
[0m13:20:24.098685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042951c0>]}
[0m13:20:24.098970 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m13:20:24.110788 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:20:24.186551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:24.186782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:24.206998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b6e7130>]}
[0m13:20:24.217396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b70bcd0>]}
[0m13:20:24.217652 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m13:20:24.217847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b70bca0>]}
[0m13:20:24.218677 [info ] [MainThread]: 
[0m13:20:24.218975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:24.221233 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802_stock_analysis'
[0m13:20:24.221438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:24.698753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abd0a5e-c6f8-451f-b9e9-8fd512a35fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b626040>]}
[0m13:20:24.700132 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m13:20:24.700635 [info ] [MainThread]: 
[0m13:20:24.705548 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m13:20:24.706386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m13:20:24.706990 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m13:20:24.720536 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m13:20:24.721547 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m13:20:24.722253 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m13:20:24.722601 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.723269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m13:20:24.723799 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.728912 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m13:20:24.729597 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.730171 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m13:20:24.730487 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m13:20:24.730800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m13:20:24.731057 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m13:20:24.774301 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m13:20:24.775008 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m13:20:24.775452 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m13:20:24.775864 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.776222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m13:20:24.776521 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.778429 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m13:20:24.778816 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.779164 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m13:20:24.779499 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m13:20:24.779751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m13:20:24.779943 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m13:20:24.781600 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m13:20:24.781991 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m13:20:24.782344 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m13:20:24.782756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:24.782911 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m13:20:24.783491 [debug] [MainThread]: Command end result
[0m13:20:24.837704 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:20:24.837876 [info ] [MainThread]: Building catalog
[0m13:20:24.840648 [debug] [ThreadPool]: Acquiring new bigquery connection 'first-project-262802.information_schema'
[0m13:20:24.852047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:24.910390 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock_analysis`.__TABLES__ tables
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('base_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('stg_calendar')
                            ) or (
                                upper(table_schema) = upper('stock_analysis')
                            and upper(table_name) = upper('spy_2014_2024')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock_analysis`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:20:25.507388 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cce45fc4-42db-403f-9e63-ce901f9cf701&page=queryresults
[0m13:20:27.383588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:27.454153 [debug] [ThreadPool]: On first-project-262802.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "connection_name": "first-project-262802.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `first-project-262802`.`stock`.__TABLES__ tables
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `first-project-262802`.`stock`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('spy_2014_2024')
                            ) or (
                                upper(table_schema) = upper('stock')
                            and upper(table_name) = upper('400_years_of_generated_dates_and_holidays')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMNS columns
    join `first-project-262802`.`stock`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        columns.column_name,
        columns.column_index,
        columns.column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m13:20:28.170630 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:06705e22-506d-471d-8ba4-0b0c33bbd941&page=queryresults
[0m13:20:30.021517 [info ] [MainThread]: Catalog written to /Users/ahmed/Desktop/dbt/stock_analysis/target/catalog.json
[0m13:20:30.022792 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.711782, "process_user_time": 2.816343, "process_kernel_time": 2.010984, "process_mem_max_rss": "196935680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:20:30.023131 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:20:30.023082 after 6.71 seconds
[0m13:20:30.023307 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:20:30.023445 [debug] [MainThread]: Connection 'first-project-262802.information_schema' was properly closed.
[0m13:20:30.023607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d34ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b964d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10425b940>]}
[0m13:20:30.023796 [debug] [MainThread]: Flushing usage events
[0m14:18:37.063643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053842b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053840d0>]}


============================== 14:18:37.066361 | b47513a1-49fa-4865-a775-db9cfffab142 ==============================
[0m14:18:37.066361 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:18:37.066676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_calendar', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:37.817239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e9990a0>]}
[0m14:18:37.843104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e9e0610>]}
[0m14:18:37.843387 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:18:37.855313 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:18:37.931737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:37.932077 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m14:18:38.088744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ede2130>]}
[0m14:18:38.143226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ede2490>]}
[0m14:18:38.143497 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:18:38.143689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f104d00>]}
[0m14:18:38.144207 [info ] [MainThread]: 
[0m14:18:38.144471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:18:38.144929 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:18:38.145130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:38.857627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:18:38.858353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:39.357596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ea647f0>]}
[0m14:18:39.358054 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:18:39.358316 [info ] [MainThread]: 
[0m14:18:39.360290 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:18:39.360726 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:18:39.361092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m14:18:39.361372 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:18:39.368652 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:18:39.370157 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:18:39.381568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:18:39.888261 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:18:39.890354 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    *

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:18:40.337573 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:9270ecb0-7b3f-4f79-aff6-8d03321ca26c&page=queryresults
[0m14:18:40.476046 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: month_start; Did you mean is_month_start? at [36:122]; reason: invalidQuery, location: query, message: Unrecognized name: month_start; Did you mean is_month_start? at [36:122]')
[0m14:18:41.409348 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2eb92f7e-5ce0-49aa-995d-5e7fff230329&page=queryresults
[0m14:18:41.614799 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2eb92f7e-5ce0-49aa-995d-5e7fff230329&page=queryresults
[0m14:18:41.658710 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Unrecognized name: month_start; Did you mean is_month_start? at [36:122]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:18:41.659823 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47513a1-49fa-4865-a775-db9cfffab142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1d2fd0>]}
[0m14:18:41.660260 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 2.30s]
[0m14:18:41.662049 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:18:41.662785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:41.662978 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m14:18:41.663180 [info ] [MainThread]: 
[0m14:18:41.663376 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m14:18:41.663755 [debug] [MainThread]: Command end result
[0m14:18:41.684920 [info ] [MainThread]: 
[0m14:18:41.685289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:18:41.685500 [info ] [MainThread]: 
[0m14:18:41.685764 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  Unrecognized name: month_start; Did you mean is_month_start? at [36:122]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:18:41.685944 [info ] [MainThread]: 
[0m14:18:41.686128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:18:41.687987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6759763, "process_user_time": 2.117748, "process_kernel_time": 2.783078, "process_mem_max_rss": "194691072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:18:41.688319 [debug] [MainThread]: Command `dbt run` failed at 14:18:41.688267 after 4.68 seconds
[0m14:18:41.688537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e9e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456f910>]}
[0m14:18:41.688749 [debug] [MainThread]: Flushing usage events
[0m14:19:45.839481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d31340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d31160>]}


============================== 14:19:45.842727 | b6a88783-a78a-4793-8275-3aebacfa912f ==============================
[0m14:19:45.842727 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:19:45.843042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_calendar', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:46.587093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d12580>]}
[0m14:19:46.613560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412ba2b0>]}
[0m14:19:46.613877 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:19:46.625782 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:19:46.701613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:46.701957 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m14:19:46.858408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429a3130>]}
[0m14:19:46.912046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429d6c10>]}
[0m14:19:46.912315 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:19:46.912500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429c1d30>]}
[0m14:19:46.913039 [info ] [MainThread]: 
[0m14:19:46.913313 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:19:46.913780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:19:46.913982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:47.567652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:19:47.568405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:48.044192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429c1d30>]}
[0m14:19:48.045539 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:19:48.046038 [info ] [MainThread]: 
[0m14:19:48.050860 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:19:48.051681 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:19:48.052266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m14:19:48.053067 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:19:48.064483 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:19:48.066376 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:19:48.081067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:48.604922 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:19:48.606229 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    *

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:19:48.954931 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d1cd1a4b-513c-4013-8e1b-19719120dfcd&page=queryresults
[0m14:19:49.113246 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name is_workday at [13:7]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name is_workday at [13:7]')
[0m14:19:50.016981 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12fe32d7-0fe1-4e4e-983f-d3acbc01cfed&page=queryresults
[0m14:19:50.134771 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:12fe32d7-0fe1-4e4e-983f-d3acbc01cfed&page=queryresults
[0m14:19:50.180804 [debug] [Thread-1  ]: Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  CREATE TABLE has columns with duplicate name is_workday at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:19:50.182245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a88783-a78a-4793-8275-3aebacfa912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142b91e50>]}
[0m14:19:50.182760 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_calendar .............. [[31mERROR[0m in 2.13s]
[0m14:19:50.184593 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:19:50.185481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:50.185703 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m14:19:50.185912 [info ] [MainThread]: 
[0m14:19:50.186136 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m14:19:50.186553 [debug] [MainThread]: Command end result
[0m14:19:50.209188 [info ] [MainThread]: 
[0m14:19:50.209528 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:19:50.209707 [info ] [MainThread]: 
[0m14:19:50.209931 [error] [MainThread]:   Database Error in model stg_calendar (models/2_staging/stg_calendar.sql)
  CREATE TABLE has columns with duplicate name is_workday at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_calendar.sql
[0m14:19:50.210102 [info ] [MainThread]: 
[0m14:19:50.210278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:19:50.211568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4222584, "process_user_time": 2.230652, "process_kernel_time": 2.711803, "process_mem_max_rss": "197378048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:19:50.211874 [debug] [MainThread]: Command `dbt run` failed at 14:19:50.211821 after 4.42 seconds
[0m14:19:50.212079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428f9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142b73fa0>]}
[0m14:19:50.212278 [debug] [MainThread]: Flushing usage events
[0m14:20:31.879806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b85340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b85160>]}


============================== 14:20:31.882301 | 13742e0d-d21c-48b9-b916-ed27991ece13 ==============================
[0m14:20:31.882301 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:20:31.882610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_calendar', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:32.605745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b66580>]}
[0m14:20:32.633590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c7a2b0>]}
[0m14:20:32.633948 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:20:32.646530 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:20:32.718926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:32.719342 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_calendar.sql
[0m14:20:32.874720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146862130>]}
[0m14:20:32.927738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146896c10>]}
[0m14:20:32.928000 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:20:32.928193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146881d30>]}
[0m14:20:32.928723 [info ] [MainThread]: 
[0m14:20:32.928980 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:20:32.929443 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:20:32.929653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:33.492459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:20:33.493426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:34.004734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146881d30>]}
[0m14:20:34.006039 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:20:34.006974 [info ] [MainThread]: 
[0m14:20:34.011119 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:20:34.011968 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:20:34.012628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_calendar)
[0m14:20:34.013171 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:20:34.024887 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:20:34.025881 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:20:34.040000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:20:34.572589 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:20:34.573955 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:20:34.971310 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a7bf258b-52b5-484c-9143-07346e28a4f9&page=queryresults
[0m14:20:39.846402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13742e0d-d21c-48b9-b916-ed27991ece13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379816a0>]}
[0m14:20:39.848292 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 5.83s]
[0m14:20:39.848892 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:20:39.850256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:39.850713 [debug] [MainThread]: Connection 'model.stock_analysis.stg_calendar' was properly closed.
[0m14:20:39.851012 [info ] [MainThread]: 
[0m14:20:39.851317 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m14:20:39.851928 [debug] [MainThread]: Command end result
[0m14:20:39.878309 [info ] [MainThread]: 
[0m14:20:39.878694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:39.878908 [info ] [MainThread]: 
[0m14:20:39.879125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:20:39.880537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.049746, "process_user_time": 2.198981, "process_kernel_time": 2.662558, "process_mem_max_rss": "194822144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:20:39.880891 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:39.880831 after 8.05 seconds
[0m14:20:39.881138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c7a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063707c0>]}
[0m14:20:39.881365 [debug] [MainThread]: Flushing usage events
[0m14:21:10.744028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10398dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10398dee0>]}


============================== 14:21:10.746898 | 5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702 ==============================
[0m14:21:10.746898 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:21:10.747255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:21:11.641570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10367aa00>]}
[0m14:21:11.670916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1534ecc70>]}
[0m14:21:11.671365 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:21:11.684176 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:21:11.769720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:11.770020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:11.792451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153966130>]}
[0m14:21:11.895952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1537ecc70>]}
[0m14:21:11.896320 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m14:21:11.896512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153941a00>]}
[0m14:21:11.897315 [info ] [MainThread]: 
[0m14:21:11.897641 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:21:11.900180 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m14:21:11.900411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:12.430857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m14:21:12.433120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:12.929218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1536a9be0>]}
[0m14:21:12.930186 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m14:21:12.930661 [info ] [MainThread]: 
[0m14:21:12.934649 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m14:21:12.935100 [info ] [Thread-1  ]: 1 of 5 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m14:21:12.935635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m14:21:12.936381 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m14:21:12.948072 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m14:21:12.949443 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m14:21:12.962290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:13.487545 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m14:21:13.489712 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m14:21:13.881244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:b23d110f-e452-4c94-a943-2cdcf102414c&page=queryresults
[0m14:21:17.230894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15371ad90>]}
[0m14:21:17.231380 [info ] [Thread-1  ]: 1 of 5 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.29s]
[0m14:21:17.231781 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m14:21:17.232032 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_spy_2014_2024
[0m14:21:17.232400 [info ] [Thread-1  ]: 2 of 5 START sql table model stock_analysis.base_spy_2014_2024 ................. [RUN]
[0m14:21:17.232769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.base_spy_2014_2024)
[0m14:21:17.232988 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_spy_2014_2024
[0m14:21:17.234927 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_spy_2014_2024"
[0m14:21:17.235423 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_spy_2014_2024
[0m14:21:17.237349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:17.735833 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_spy_2014_2024"
[0m14:21:17.738230 [debug] [Thread-1  ]: On model.stock_analysis.base_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
  date
  , close_last
  , volume
  , open
  , high
  , low
from `first-project-262802`.`stock`.`spy_2014_2024`
    );
  
[0m14:21:18.182145 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:00d67d8f-145a-43bd-a58e-76c2b8fd9fc0&page=queryresults
[0m14:21:20.099290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f8eb0>]}
[0m14:21:20.100724 [info ] [Thread-1  ]: 2 of 5 OK created sql table model stock_analysis.base_spy_2014_2024 ............ [[32mCREATE TABLE (2.5k rows, 118.0 KiB processed)[0m in 2.87s]
[0m14:21:20.101614 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_spy_2014_2024
[0m14:21:20.102216 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m14:21:20.103027 [info ] [Thread-1  ]: 3 of 5 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m14:21:20.103708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_spy_2014_2024, now model.stock_analysis.stg_calendar)
[0m14:21:20.104258 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m14:21:20.107454 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m14:21:20.109406 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m14:21:20.113154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:20.614428 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m14:21:20.617244 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m14:21:21.048298 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5aeffbad-9a97-48c5-89c1-7a3221869660&page=queryresults
[0m14:21:24.683616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036290a0>]}
[0m14:21:24.684807 [info ] [Thread-1  ]: 3 of 5 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.0 MiB processed)[0m in 4.58s]
[0m14:21:24.685711 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m14:21:24.686895 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m14:21:24.687616 [info ] [Thread-1  ]: 4 of 5 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m14:21:24.688389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m14:21:24.689118 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m14:21:24.693749 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m14:21:24.694726 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m14:21:24.696882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:25.172789 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m14:21:25.174508 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      select 
    *
from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024`
left join `first-project-262802`.`stock_analysis`.`stg_calendar` using (date)
    );
  
[0m14:21:25.575675 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:71b6438d-1618-4593-aa9a-4a6f32c343f4&page=queryresults
[0m14:21:28.318045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a4c910>]}
[0m14:21:28.319465 [info ] [Thread-1  ]: 4 of 5 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.1 MiB processed)[0m in 3.63s]
[0m14:21:28.320382 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m14:21:28.321409 [debug] [Thread-1  ]: Began running node model.stock_analysis.spy_2014_2024
[0m14:21:28.322032 [info ] [Thread-1  ]: 5 of 5 START sql table model stock_analysis.spy_2014_2024 ...................... [RUN]
[0m14:21:28.322581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.spy_2014_2024)
[0m14:21:28.323067 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.spy_2014_2024
[0m14:21:28.326640 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.spy_2014_2024"
[0m14:21:28.328085 [debug] [Thread-1  ]: Began executing node model.stock_analysis.spy_2014_2024
[0m14:21:28.330345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:21:28.931763 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.spy_2014_2024"
[0m14:21:28.933387 [debug] [Thread-1  ]: On model.stock_analysis.spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )


select
    spy_2014_2024.*
from spy_2014_2024
    );
  
[0m14:21:29.294470 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d218cd17-c1a0-432a-83c6-124748968b62&page=queryresults
[0m14:21:31.145810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6571ce-ee3a-4ebf-bf9f-52dadc4aa702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a4c100>]}
[0m14:21:31.147225 [info ] [Thread-1  ]: 5 of 5 OK created sql table model stock_analysis.spy_2014_2024 ................. [[32mCREATE TABLE (2.5k rows, 750.5 KiB processed)[0m in 2.82s]
[0m14:21:31.148468 [debug] [Thread-1  ]: Finished running node model.stock_analysis.spy_2014_2024
[0m14:21:31.150639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:31.151140 [debug] [MainThread]: Connection 'model.stock_analysis.spy_2014_2024' was properly closed.
[0m14:21:31.151720 [info ] [MainThread]: 
[0m14:21:31.152163 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.25 seconds (19.25s).
[0m14:21:31.154164 [debug] [MainThread]: Command end result
[0m14:21:31.188628 [info ] [MainThread]: 
[0m14:21:31.189043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:31.189280 [info ] [MainThread]: 
[0m14:21:31.189532 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:21:31.191202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.49632, "process_user_time": 2.750206, "process_kernel_time": 2.729367, "process_mem_max_rss": "191184896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:21:31.191598 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:31.191540 after 20.50 seconds
[0m14:21:31.191865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cccaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103370a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a553d0>]}
[0m14:21:31.192114 [debug] [MainThread]: Flushing usage events
[0m19:01:08.221462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025f5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104281370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104281190>]}


============================== 19:01:08.224257 | 19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c ==============================
[0m19:01:08.224257 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:01:08.224587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select base_calendar+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:01:08.941510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041067c0>]}
[0m19:01:08.967511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1528f0a30>]}
[0m19:01:08.967807 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:01:08.979641 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:01:09.055856 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m19:01:09.056202 [debug] [MainThread]: Partial parsing: added file: stock_analysis://models/3_final/stock_analysis.sql
[0m19:01:09.056357 [debug] [MainThread]: Partial parsing: deleted file: stock_analysis://models/3_final/spy_2014_2024.sql
[0m19:01:09.056557 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/1_base/base_calendar.sql
[0m19:01:09.056736 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:01:09.212363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d3ba30>]}
[0m19:01:09.266973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104106f40>]}
[0m19:01:09.267235 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:01:09.267415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152d306d0>]}
[0m19:01:09.268028 [info ] [MainThread]: 
[0m19:01:09.268301 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:01:09.270477 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:01:09.270688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:09.843180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:01:09.844098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:10.199924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410a580>]}
[0m19:01:10.201885 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:01:10.202460 [info ] [MainThread]: 
[0m19:01:10.207466 [debug] [Thread-1  ]: Began running node model.stock_analysis.base_calendar
[0m19:01:10.208393 [info ] [Thread-1  ]: 1 of 4 START sql table model stock_analysis.base_calendar ...................... [RUN]
[0m19:01:10.209034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.base_calendar)
[0m19:01:10.209457 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.base_calendar
[0m19:01:10.220542 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.base_calendar"
[0m19:01:10.221462 [debug] [Thread-1  ]: Began executing node model.stock_analysis.base_calendar
[0m19:01:10.235984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:10.620249 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.base_calendar"
[0m19:01:10.621291 [debug] [Thread-1  ]: On model.stock_analysis.base_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.base_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`base_calendar`
      
    
    

    OPTIONS()
    as (
      select 
    is_workday
    , is_holiday
    , is_holiday_leave
    , a_date
    , a_date as date
    , extract(year from a_date) as year_of_date
    , extract(month from a_date) as month_of_date
    , extract(day from a_date) as day_of_date
    , day_full
    , day_full_capital_case
    , day_full_lower_case
    , day_abbrev
    , is_weekday
    , is_weekday_by_regex
    , day_of_week
    , day_of_month
    , day_of_year
    , week_of_month
    , format_date('%W', a_date) as week_number
    , trim(month_full) as month_full
    , lower(trim(month_full)) as month_full_lower_case
    , month_abbrev
    , month_number
    , quarter
    , year_short
    , year_full
    , fiscal_quarter
    , fiscal_year
    , fiscal_year_full
    , tomorrow
    , one_week_later
    , one_month_later
    , three_months_later
    , one_year_later
from `first-project-262802`.`stock`.`400_years_of_generated_dates_and_holidays`
    );
  
[0m19:01:11.074350 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ef954c48-772a-4c09-9e63-bfca0cdabcbb&page=queryresults
[0m19:01:14.550089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152201610>]}
[0m19:01:14.550837 [info ] [Thread-1  ]: 1 of 4 OK created sql table model stock_analysis.base_calendar ................. [[32mCREATE TABLE (146.1k rows, 29.8 MiB processed)[0m in 4.34s]
[0m19:01:14.551404 [debug] [Thread-1  ]: Finished running node model.stock_analysis.base_calendar
[0m19:01:14.552155 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_calendar
[0m19:01:14.552626 [info ] [Thread-1  ]: 2 of 4 START sql table model stock_analysis.stg_calendar ....................... [RUN]
[0m19:01:14.553003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.base_calendar, now model.stock_analysis.stg_calendar)
[0m19:01:14.553295 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_calendar
[0m19:01:14.556542 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_calendar"
[0m19:01:14.558690 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_calendar
[0m19:01:14.560859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:14.949601 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_calendar"
[0m19:01:14.952453 [debug] [Thread-1  ]: On model.stock_analysis.stg_calendar: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_calendar"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_calendar`
      
    
    

    OPTIONS()
    as (
      with 

base_calendar as (select * from `first-project-262802`.`stock_analysis`.`base_calendar` )

, adding_month_start_and_end as 
(
    select
        *
        , case when day_of_date = 1 then TRUE else FALSE end as is_month_start
        , case 
            when ( month_full = 'January' or month_full =  'March' or month_full = 'May' or month_full = 'July'or month_full = 'August' or month_full = 'October' or month_full = 'December') and day_of_date = 31 then TRUE 
            when ( month_full = 'April' or month_full =  'June' or month_full = 'September' or month_full = 'November' ) and day_of_date = 30 then TRUE 
            when month_full = 'February' and ( day_of_date = 28 or day_of_date = 29 ) then TRUE 
            else FALSE 
        end as is_month_end   
    from base_calendar
)

, adding_quarter_start_and_end as 
(
    select
        *
        , case 
            when ( month_full = 'January' or month_full =  'April' or month_full = 'July' or month_full = 'October') and is_month_start = TRUE then TRUE
            else False
        end as is_quarter_start
        , case 
            when ( month_full = 'March' or month_full =  'June' or month_full = 'September' or month_full = 'December') and is_month_end = TRUE then TRUE
            else False
        end as is_quarter_end    
    from adding_month_start_and_end
)

, adding_week_start_and_end as 
(
    select
        *
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_week_start
        , case 
            when day_of_week = 7 then TRUE
            else False
        end as is_week_end
        , case 
            when day_of_week = 1 then TRUE
            else False
        end as is_typical_trading_week_start
        , case 
            when day_of_week = 5 then TRUE
            else False
        end as is_typical_trading_week_end
    from adding_quarter_start_and_end
)

, base as (select * from adding_week_start_and_end )

, adding_first_working_day_of_year as 
(
    select
        TRUE as is_first_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_year as 
(
    select
        TRUE as is_last_working_day_of_year
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_month as 
(
    select
        TRUE as is_first_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date asc) = 1
)

, adding_last_working_day_of_month as 
(
    select
        TRUE as is_last_working_day_of_month 
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date ORDER BY date desc) = 1
)

, adding_first_working_day_of_week as 
(
    select
        TRUE as is_first_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date asc) = 1
)

, adding_last_working_day_of_week as 
(
    select
        TRUE as is_last_working_day_of_week
        , *
    from base
    where is_workday = 1
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_of_date, week_of_month ORDER BY date desc) = 1
)


select 
    base.*

    , case when adding_first_working_day_of_year.is_first_working_day_of_year = TRUE then TRUE else FALSE end as is_first_working_day_of_year
    , case when adding_last_working_day_of_year.is_last_working_day_of_year = TRUE then TRUE else FALSE end as is_last_working_day_of_year 
    
    , case when adding_first_working_day_of_month.is_first_working_day_of_month = TRUE then TRUE else FALSE end as is_first_working_day_of_month
    , case when adding_last_working_day_of_month.is_last_working_day_of_month = TRUE then TRUE else FALSE end as is_last_working_day_of_month
    
    , case when adding_first_working_day_of_week.is_first_working_day_of_week = TRUE then TRUE else FALSE end as is_first_working_day_of_week
    , case when adding_last_working_day_of_week.is_last_working_day_of_week = TRUE then TRUE else FALSE end as is_last_working_day_of_week

from base
left join adding_first_working_day_of_year using (date)
left join adding_last_working_day_of_year using (date)
left join adding_first_working_day_of_month using (date)
left join adding_last_working_day_of_month using (date)
left join adding_first_working_day_of_week using (date)
left join adding_last_working_day_of_week using (date)
    );
  
[0m19:01:15.340220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:fea4ccab-96d4-4e86-bd9f-1087ce6774da&page=queryresults
[0m19:01:19.596630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153219460>]}
[0m19:01:19.597836 [info ] [Thread-1  ]: 2 of 4 OK created sql table model stock_analysis.stg_calendar .................. [[32mCREATE TABLE (146.1k rows, 35.6 MiB processed)[0m in 5.04s]
[0m19:01:19.598884 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_calendar
[0m19:01:19.600888 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:01:19.601999 [info ] [Thread-1  ]: 3 of 4 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:01:19.602807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_calendar, now model.stock_analysis.stg_spy_2014_2024)
[0m19:01:19.603261 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:01:19.608719 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:01:19.609833 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:01:19.613191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:20.014441 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:01:20.016181 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

-- , weekly_stats as 
-- (
--     select 
        
--         , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
--     from spy_2014_2024
--     left join calendar using (date)
-- )


select
    base.*
    , daily_stats.avg_daily_price

from base
left join daily_stats using (date)
    );
  
[0m19:01:20.453165 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:8aeeee7c-6e64-478d-8ee8-9d1c039d6aaa&page=queryresults
[0m19:01:23.206702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531cff70>]}
[0m19:01:23.209061 [info ] [Thread-1  ]: 3 of 4 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 3.60s]
[0m19:01:23.209883 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:01:23.210910 [debug] [Thread-1  ]: Began running node model.stock_analysis.stock_analysis
[0m19:01:23.211437 [info ] [Thread-1  ]: 4 of 4 START sql table model stock_analysis.stock_analysis ..................... [RUN]
[0m19:01:23.211889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.stock_analysis.stg_spy_2014_2024, now model.stock_analysis.stock_analysis)
[0m19:01:23.212419 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stock_analysis
[0m19:01:23.216167 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stock_analysis"
[0m19:01:23.217607 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stock_analysis
[0m19:01:23.223585 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stock_analysis"
[0m19:01:23.224298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:01:23.301162 [debug] [Thread-1  ]: On model.stock_analysis.stock_analysis: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stock_analysis"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stock_analysis`
      
    
    

    OPTIONS()
    as (
      -- with

-- spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024` )

-- select
-- *
-- from spy_2014_2024
    );
  
[0m19:01:23.598275 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:74763476-ad72-4eb0-abd4-1d7dfe6b39d7&page=queryresults
[0m19:01:23.600251 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [20:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [20:5]')
[0m19:01:24.369025 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a2c54d75-4eb9-4a6e-ac97-cc7e5def095c&page=queryresults
[0m19:01:24.371101 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:a2c54d75-4eb9-4a6e-ac97-cc7e5def095c&page=queryresults
[0m19:01:24.419020 [debug] [Thread-1  ]: Database Error in model stock_analysis (models/3_final/stock_analysis.sql)
  Syntax error: Unexpected ")" at [20:5]
  compiled Code at target/run/stock_analysis/models/3_final/stock_analysis.sql
[0m19:01:24.419474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a095bc-e637-4d0d-b4f0-1ad1e6b0dd7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531cff70>]}
[0m19:01:24.419970 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model stock_analysis.stock_analysis ............ [[31mERROR[0m in 1.21s]
[0m19:01:24.420385 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stock_analysis
[0m19:01:24.421160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:24.421353 [debug] [MainThread]: Connection 'model.stock_analysis.stock_analysis' was properly closed.
[0m19:01:24.421588 [info ] [MainThread]: 
[0m19:01:24.421794 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 15.15 seconds (15.15s).
[0m19:01:24.422490 [debug] [MainThread]: Command end result
[0m19:01:24.448193 [info ] [MainThread]: 
[0m19:01:24.448549 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:24.448742 [info ] [MainThread]: 
[0m19:01:24.449034 [error] [MainThread]:   Database Error in model stock_analysis (models/3_final/stock_analysis.sql)
  Syntax error: Unexpected ")" at [20:5]
  compiled Code at target/run/stock_analysis/models/3_final/stock_analysis.sql
[0m19:01:24.449235 [info ] [MainThread]: 
[0m19:01:24.449426 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:01:24.451254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.279663, "process_user_time": 2.554413, "process_kernel_time": 2.681144, "process_mem_max_rss": "196182016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:01:24.451603 [debug] [MainThread]: Command `dbt run` failed at 19:01:24.451549 after 16.28 seconds
[0m19:01:24.451827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025f5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b68a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15321d700>]}
[0m19:01:24.452042 [debug] [MainThread]: Flushing usage events
[0m19:03:58.127403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fccac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059443a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059441c0>]}


============================== 19:03:58.129809 | 01956f78-409a-4bb6-a7f1-5bf68e755365 ==============================
[0m19:03:58.129809 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:03:58.130142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:03:58.621814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a25a430>]}
[0m19:03:58.647604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105780ac0>]}
[0m19:03:58.647897 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:03:58.660011 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:03:58.733305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:03:58.733670 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:03:58.886659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a6a0130>]}
[0m19:03:58.939981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a5b6b80>]}
[0m19:03:58.940256 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:03:58.940443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a6e2d60>]}
[0m19:03:58.940972 [info ] [MainThread]: 
[0m19:03:58.941254 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:58.941726 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:03:58.941927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:59.417052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:03:59.417870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:59.773049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a6e2d60>]}
[0m19:03:59.774234 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:03:59.774718 [info ] [MainThread]: 
[0m19:03:59.778642 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:03:59.779495 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:03:59.780186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:03:59.780702 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:03:59.791364 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:03:59.792146 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:03:59.805831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:04:00.271827 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:04:00.272811 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(((open + close_last + high + low)/4.00),2) as avg_weekly_price
    from base
    group by 1,2
    -- order by 1,2
)


select
    base.*
    , daily_stats.avg_daily_price
    , weekly_stats.avg_weekly_price
from base
left join daily_stats using (date)
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:04:00.752115 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:37730258-a91f-4a6d-85fd-60668e1c6c9a&page=queryresults
[0m19:04:00.882760 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column open which is neither grouped nor aggregated at [40:19]; reason: invalidQuery, location: query, message: SELECT list expression references column open which is neither grouped nor aggregated at [40:19]')
[0m19:04:01.978993 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4d6f8328-e454-4bf0-a52c-e27504d96db6&page=queryresults
[0m19:04:02.078096 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4d6f8328-e454-4bf0-a52c-e27504d96db6&page=queryresults
[0m19:04:02.109866 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  SELECT list expression references column open which is neither grouped nor aggregated at [40:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:04:02.111125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01956f78-409a-4bb6-a7f1-5bf68e755365', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a98dd90>]}
[0m19:04:02.111651 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.33s]
[0m19:04:02.112096 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:04:02.114659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:02.114899 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:04:02.115084 [info ] [MainThread]: 
[0m19:04:02.115261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m19:04:02.115618 [debug] [MainThread]: Command end result
[0m19:04:02.134880 [info ] [MainThread]: 
[0m19:04:02.135178 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:04:02.135347 [info ] [MainThread]: 
[0m19:04:02.135559 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  SELECT list expression references column open which is neither grouped nor aggregated at [40:19]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:04:02.135721 [info ] [MainThread]: 
[0m19:04:02.135887 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:04:02.137144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.056911, "process_user_time": 1.956265, "process_kernel_time": 2.709404, "process_mem_max_rss": "194805760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:04:02.137446 [debug] [MainThread]: Command `dbt run` failed at 19:04:02.137399 after 4.06 seconds
[0m19:04:02.137661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fccac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105780ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2abaf0>]}
[0m19:04:02.137859 [debug] [MainThread]: Flushing usage events
[0m19:06:43.699249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104819a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190190>]}


============================== 19:06:43.702138 | 4b6ab590-e294-4051-b86b-993f68443d64 ==============================
[0m19:06:43.702138 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:06:43.702468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:06:44.412416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060167c0>]}
[0m19:06:44.438024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4f0a30>]}
[0m19:06:44.438305 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:06:44.449260 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:06:44.524685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:06:44.525064 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:06:44.678506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9e0f70>]}
[0m19:06:44.732644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5e4df0>]}
[0m19:06:44.732905 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:06:44.733090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c92c7f0>]}
[0m19:06:44.733611 [info ] [MainThread]: 
[0m19:06:44.733868 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:06:44.734329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:06:44.734535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:45.177709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:06:45.178378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:45.555489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c5e4df0>]}
[0m19:06:45.556439 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:06:45.556931 [info ] [MainThread]: 
[0m19:06:45.560984 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:06:45.561661 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:06:45.562246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:06:45.562779 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:06:45.573357 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:06:45.574416 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:06:45.587983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:06:45.966365 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:06:45.967348 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
    -- order by 1,2
)


select
    base.*
    , daily_stats.avg_daily_price
    , weekly_stats.avg_weekly_price
from base
left join daily_stats using (date)
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:06:46.337577 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:451b0197-089e-44d0-9c00-809168eb8ccf&page=queryresults
[0m19:06:46.461105 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: avg_daily_price at [40:21]; reason: invalidQuery, location: query, message: Unrecognized name: avg_daily_price at [40:21]')
[0m19:06:47.257402 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1206b907-8e89-46c2-9813-516997272aaf&page=queryresults
[0m19:06:47.363791 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1206b907-8e89-46c2-9813-516997272aaf&page=queryresults
[0m19:06:47.410766 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price at [40:21]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:06:47.412153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6ab590-e294-4051-b86b-993f68443d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cccdd00>]}
[0m19:06:47.412640 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.85s]
[0m19:06:47.413048 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:06:47.415288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:47.415492 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:06:47.415693 [info ] [MainThread]: 
[0m19:06:47.415900 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m19:06:47.416320 [debug] [MainThread]: Command end result
[0m19:06:47.438820 [info ] [MainThread]: 
[0m19:06:47.439238 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:06:47.439461 [info ] [MainThread]: 
[0m19:06:47.439700 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price at [40:21]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:06:47.439872 [info ] [MainThread]: 
[0m19:06:47.440051 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:06:47.441454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7912774, "process_user_time": 2.072333, "process_kernel_time": 2.719325, "process_mem_max_rss": "195657728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:06:47.441793 [debug] [MainThread]: Command `dbt run` failed at 19:06:47.441738 after 3.79 seconds
[0m19:06:47.442027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104819a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060167c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c954eb0>]}
[0m19:06:47.442239 [debug] [MainThread]: Flushing usage events
[0m19:07:31.205670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065810d0>]}


============================== 19:07:31.207750 | 80214012-848b-437c-8b16-c1e235ce0880 ==============================
[0m19:07:31.207750 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:07:31.208100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:07:31.749237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1445190a0>]}
[0m19:07:31.777940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144560610>]}
[0m19:07:31.778384 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:07:31.791227 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:07:31.869338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:07:31.869752 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:07:32.035801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b5f130>]}
[0m19:07:32.096236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b95730>]}
[0m19:07:32.096594 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:07:32.096790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ba2d00>]}
[0m19:07:32.097466 [info ] [MainThread]: 
[0m19:07:32.097875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:07:32.098553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:07:32.098797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:32.511832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:07:32.512895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:32.884769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ba2d00>]}
[0m19:07:32.886083 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:07:32.887005 [info ] [MainThread]: 
[0m19:07:32.891048 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:07:32.891733 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:07:32.892400 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:07:32.893019 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:07:32.903659 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:07:32.904704 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:07:32.918000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:07:33.278181 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:07:33.278985 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from daily_stats
    group by 1,2
    -- order by 1,2
)


select
    base.*
    , daily_stats.avg_daily_price
    , weekly_stats.avg_weekly_price
from base
left join daily_stats using (date)
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:07:33.666763 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5eccb5c2-b053-4bf4-8d79-802c892bee2b&page=queryresults
[0m19:07:33.780428 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: year_full at [38:9]; reason: invalidQuery, location: query, message: Unrecognized name: year_full at [38:9]')
[0m19:07:34.770704 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0abc815-ad1e-4c1c-ac00-58e9219a0cd0&page=queryresults
[0m19:07:34.868281 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0abc815-ad1e-4c1c-ac00-58e9219a0cd0&page=queryresults
[0m19:07:34.909785 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:07:34.911118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80214012-848b-437c-8b16-c1e235ce0880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c50d00>]}
[0m19:07:34.911625 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.02s]
[0m19:07:34.912058 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:07:34.914354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:34.914552 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:07:34.914746 [info ] [MainThread]: 
[0m19:07:34.914952 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m19:07:34.915362 [debug] [MainThread]: Command end result
[0m19:07:34.937906 [info ] [MainThread]: 
[0m19:07:34.938246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:07:34.938427 [info ] [MainThread]: 
[0m19:07:34.938658 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:07:34.938834 [info ] [MainThread]: 
[0m19:07:34.939015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:07:34.940726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7810855, "process_user_time": 2.75337, "process_kernel_time": 1.667851, "process_mem_max_rss": "198311936", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:07:34.941077 [debug] [MainThread]: Command `dbt run` failed at 19:07:34.941025 after 3.78 seconds
[0m19:07:34.941306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b95670>]}
[0m19:07:34.941519 [debug] [MainThread]: Flushing usage events
[0m19:14:58.722733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d10b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036892b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036890d0>]}


============================== 19:14:58.725650 | 3e9008e3-e082-4a27-b29d-b6e63f4314b6 ==============================
[0m19:14:58.725650 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:14:58.725975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:14:59.469858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1521d90a0>]}
[0m19:14:59.496021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152320610>]}
[0m19:14:59.496329 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:14:59.508079 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:14:59.585597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:14:59.585986 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:14:59.739967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15311f130>]}
[0m19:14:59.794071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153155730>]}
[0m19:14:59.794349 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:14:59.794538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153162d00>]}
[0m19:14:59.795061 [info ] [MainThread]: 
[0m19:14:59.795332 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:14:59.795785 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:14:59.795989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:00.222759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:15:00.223652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:00.591171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153162d00>]}
[0m19:15:00.592758 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:15:00.593432 [info ] [MainThread]: 
[0m19:15:00.597479 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:15:00.598124 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:15:00.598704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:15:00.599174 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:15:00.609243 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:15:00.609998 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:15:00.624167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:15:01.021900 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:15:01.024001 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
    from spy_2014_2024
    left join calendar using (date)
)

, daily_stats as 
(
    select 
        date
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from base
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from daily_stats
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:15:01.465550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ea849c19-24af-45ef-8dcf-77b362bc79d9&page=queryresults
[0m19:15:01.578344 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: year_full at [38:9]; reason: invalidQuery, location: query, message: Unrecognized name: year_full at [38:9]')
[0m19:15:02.482080 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0fc713f-d642-475c-b655-fd40a1279e34&page=queryresults
[0m19:15:02.614132 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c0fc713f-d642-475c-b655-fd40a1279e34&page=queryresults
[0m19:15:02.652351 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:15:02.653693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9008e3-e082-4a27-b29d-b6e63f4314b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153510e80>]}
[0m19:15:02.654203 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.05s]
[0m19:15:02.654634 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:15:02.656929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:02.657180 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:15:02.657398 [info ] [MainThread]: 
[0m19:15:02.657637 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m19:15:02.658072 [debug] [MainThread]: Command end result
[0m19:15:02.678124 [info ] [MainThread]: 
[0m19:15:02.678409 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:15:02.678573 [info ] [MainThread]: 
[0m19:15:02.678776 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: year_full at [38:9]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:15:02.678934 [info ] [MainThread]: 
[0m19:15:02.679111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:15:02.680630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.008225, "process_user_time": 2.079806, "process_kernel_time": 2.792737, "process_mem_max_rss": "194674688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:15:02.680909 [debug] [MainThread]: Command `dbt run` failed at 19:15:02.680862 after 4.01 seconds
[0m19:15:02.681119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d10b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103077910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531673d0>]}
[0m19:15:02.681310 [debug] [MainThread]: Flushing usage events
[0m19:17:50.948346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d19a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105691370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105691190>]}


============================== 19:17:50.951284 | 84724ac4-50d7-4e55-8ef7-ac6254666bab ==============================
[0m19:17:50.951284 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:17:50.951596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:17:51.671983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055167c0>]}
[0m19:17:51.699817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddb0a30>]}
[0m19:17:51.700489 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:17:51.712212 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:17:51.788722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:51.789130 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:17:51.956493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3a0f70>]}
[0m19:17:52.014374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfa4df0>]}
[0m19:17:52.014687 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:17:52.014879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2ec7f0>]}
[0m19:17:52.015426 [info ] [MainThread]: 
[0m19:17:52.015709 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:17:52.016189 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:17:52.016393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:52.452273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:17:52.452921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:52.810815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfa4df0>]}
[0m19:17:52.812160 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:17:52.812657 [info ] [MainThread]: 
[0m19:17:52.817766 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:17:52.818614 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:17:52.819225 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:17:52.820178 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:17:52.831207 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:17:52.832426 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:17:52.847007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:17:53.235030 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:17:53.235688 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from daily_stats
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:17:53.396501 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:0266ef64-933f-4d7a-9a6b-d0d3d96b6dc8&page=queryresults
[0m19:17:53.397917 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: daily_stats, message: Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).')
[0m19:17:54.230587 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c5c7077c-3c69-4eca-97f5-81eb2d532833&page=queryresults
[0m19:17:54.232001 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c5c7077c-3c69-4eca-97f5-81eb2d532833&page=queryresults
[0m19:17:54.274512 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:17:54.275810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84724ac4-50d7-4e55-8ef7-ac6254666bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c690d30>]}
[0m19:17:54.276274 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.46s]
[0m19:17:54.276678 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:17:54.277448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:54.277667 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:17:54.277875 [info ] [MainThread]: 
[0m19:17:54.278085 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m19:17:54.278512 [debug] [MainThread]: Command end result
[0m19:17:54.302866 [info ] [MainThread]: 
[0m19:17:54.303209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:17:54.303387 [info ] [MainThread]: 
[0m19:17:54.303615 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Table "daily_stats" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:17:54.303783 [info ] [MainThread]: 
[0m19:17:54.303968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:17:54.305326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4115396, "process_user_time": 2.05433, "process_kernel_time": 2.765938, "process_mem_max_rss": "195543040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:17:54.305636 [debug] [MainThread]: Command `dbt run` failed at 19:17:54.305586 after 3.41 seconds
[0m19:17:54.305864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d19a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddb0a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508ddc0>]}
[0m19:17:54.306069 [debug] [MainThread]: Flushing usage events
[0m19:18:14.708605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083993a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083991c0>]}


============================== 19:18:14.710762 | 0f9c6648-298d-45d3-b3ea-4b8f4510acea ==============================
[0m19:18:14.710762 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:18:14.711099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:18:15.185820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e41a430>]}
[0m19:18:15.213704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d65e0>]}
[0m19:18:15.214149 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:18:15.226124 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:18:15.303211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:15.303670 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:18:15.474187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ea60130>]}
[0m19:18:15.530452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e976b80>]}
[0m19:18:15.530811 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:18:15.531008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaa0d60>]}
[0m19:18:15.531585 [info ] [MainThread]: 
[0m19:18:15.531886 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:18:15.532397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:18:15.532623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:15.944182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:18:15.944864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:16.299907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaa0d60>]}
[0m19:18:16.301235 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:18:16.301740 [info ] [MainThread]: 
[0m19:18:16.306261 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:18:16.307349 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:18:16.308162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:18:16.308648 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:18:16.319940 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:18:16.321180 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:18:16.336288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:16.714879 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:18:16.715585 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
    );
  
[0m19:18:17.076623 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ab5bd936-c352-4edc-92dc-64d3d097566b&page=queryresults
[0m19:18:20.425251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9c6648-298d-45d3-b3ea-4b8f4510acea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f581670>]}
[0m19:18:20.425957 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.12s]
[0m19:18:20.426520 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:18:20.427607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:20.427846 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:18:20.428066 [info ] [MainThread]: 
[0m19:18:20.428326 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m19:18:20.428827 [debug] [MainThread]: Command end result
[0m19:18:20.454310 [info ] [MainThread]: 
[0m19:18:20.454664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:20.454856 [info ] [MainThread]: 
[0m19:18:20.455054 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:18:20.456471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7953634, "process_user_time": 2.079592, "process_kernel_time": 2.599888, "process_mem_max_rss": "197984256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:18:20.456806 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:20.456750 after 5.80 seconds
[0m19:18:20.457057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14eaa0d60>]}
[0m19:18:20.457275 [debug] [MainThread]: Flushing usage events
[0m19:22:23.704206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104768af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e1130>]}


============================== 19:22:23.706961 | 098b567e-bc24-4348-ae40-f9606e237afe ==============================
[0m19:22:23.706961 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:22:23.707273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:22:24.415810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1ca60>]}
[0m19:22:24.441483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b8220>]}
[0m19:22:24.441768 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:22:24.452692 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:22:24.527897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:24.528349 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:22:24.682464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd20130>]}
[0m19:22:24.737679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb0fa00>]}
[0m19:22:24.737949 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:22:24.738141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e2d00>]}
[0m19:22:24.738674 [info ] [MainThread]: 
[0m19:22:24.738944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:22:24.739418 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:22:24.739619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:25.157017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:22:25.157719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:25.508847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '098b567e-bc24-4348-ae40-f9606e237afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b935730>]}
[0m19:22:25.510036 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:22:25.510529 [info ] [MainThread]: 
[0m19:22:25.515570 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:22:25.516528 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:22:25.517244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:22:25.517839 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:22:25.529255 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:25.530511 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:22:25.544711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:22:25.948455 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:25.950561 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_stats as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
left join weekly_stats using (year_full,month_number)
    );
  
[0m19:22:26.302092 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:1de9f8e2-f134-4866-bb1b-0393baf788b4&page=queryresults
[0m19:22:26.409996 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column month_number in USING clause not found on right side of join at [53:41]; reason: invalidQuery, location: query, message: Column month_number in USING clause not found on right side of join at [53:41]')
[0m19:22:35.864901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043052b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043050d0>]}


============================== 19:22:35.867479 | f84491b9-e4b8-41c6-97d3-27ea0c5a76c1 ==============================
[0m19:22:35.867479 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:22:35.867795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:22:36.376689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387d90a0>]}
[0m19:22:36.402485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138820610>]}
[0m19:22:36.402792 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:22:36.414891 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:22:36.487437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:36.487864 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:22:36.643394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d21130>]}
[0m19:22:36.695956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d55730>]}
[0m19:22:36.696236 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:22:36.696430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d62d00>]}
[0m19:22:36.696963 [info ] [MainThread]: 
[0m19:22:36.697236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:22:36.697692 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:22:36.697896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:37.102744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:22:37.103461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:37.569966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138d62d00>]}
[0m19:22:37.571863 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:22:37.572773 [info ] [MainThread]: 
[0m19:22:37.576944 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:22:37.577937 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:22:37.578690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:22:37.579268 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:22:37.590569 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:37.591548 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:22:37.606161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:22:37.989139 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:22:37.990016 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_stats as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_stats as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)


select
    *
from base
left join weekly_stats using (year_full,week_number)
left join monthly_stats using (year_full,month_number)
    );
  
[0m19:22:38.341870 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:7539e525-99c6-496d-a641-d9d1f873c858&page=queryresults
[0m19:22:41.362016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f84491b9-e4b8-41c6-97d3-27ea0c5a76c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380416d0>]}
[0m19:22:41.362775 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 3.78s]
[0m19:22:41.365439 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:22:41.366372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:41.366625 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:22:41.366873 [info ] [MainThread]: 
[0m19:22:41.367152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m19:22:41.367765 [debug] [MainThread]: Command end result
[0m19:22:41.393137 [info ] [MainThread]: 
[0m19:22:41.393484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:41.393696 [info ] [MainThread]: 
[0m19:22:41.393912 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:22:41.395348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.576778, "process_user_time": 1.977614, "process_kernel_time": 2.682998, "process_mem_max_rss": "195084288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:22:41.395677 [debug] [MainThread]: Command `dbt run` succeeded at 19:22:41.395623 after 5.58 seconds
[0m19:22:41.395908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cbcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041957f0>]}
[0m19:22:41.396127 [debug] [MainThread]: Flushing usage events
[0m19:43:33.162958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b31a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a9250>]}


============================== 19:43:33.165725 | 151c14a7-6d7b-4cc8-b2fa-fd1434749fc6 ==============================
[0m19:43:33.165725 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:43:33.166046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:33.726456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e2deb0>]}
[0m19:43:33.753467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e6ea60>]}
[0m19:43:33.753811 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:43:33.764770 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:43:33.839706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:43:33.840062 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:43:33.991450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125360130>]}
[0m19:43:34.045098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252bb160>]}
[0m19:43:34.045362 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:43:34.045549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12531bee0>]}
[0m19:43:34.046072 [info ] [MainThread]: 
[0m19:43:34.046334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:43:34.046784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:43:34.046983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:34.480041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:43:34.480897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:34.843241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253a26d0>]}
[0m19:43:34.844374 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:43:34.845299 [info ] [MainThread]: 
[0m19:43:34.849745 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:43:34.850453 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:43:34.851087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:43:34.851581 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:43:34.863097 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:43:34.864442 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:43:34.878898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:43:35.280283 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:43:35.281240 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


select
    *
    , daily_price_movement_by_week.avg_daily_price_movement_in_week
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_by_week using (year_full,month_number)
    );
  
[0m19:43:35.717826 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:339c1d85-8969-4598-9963-506c97eef7a7&page=queryresults
[0m19:43:36.052841 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: daily_price_movement at [75:18]; reason: invalidQuery, location: query, message: Unrecognized name: daily_price_movement at [75:18]')
[0m19:43:36.895213 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ff452f90-93b6-4284-a691-10ac525fc6df&page=queryresults
[0m19:43:36.996184 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:ff452f90-93b6-4284-a691-10ac525fc6df&page=queryresults
[0m19:43:37.040275 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: daily_price_movement at [75:18]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:43:37.041670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '151c14a7-6d7b-4cc8-b2fa-fd1434749fc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128594df0>]}
[0m19:43:37.042188 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.19s]
[0m19:43:37.042678 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:43:37.045110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:37.045368 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:43:37.045576 [info ] [MainThread]: 
[0m19:43:37.045789 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m19:43:37.046234 [debug] [MainThread]: Command end result
[0m19:43:37.067732 [info ] [MainThread]: 
[0m19:43:37.068054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:43:37.068230 [info ] [MainThread]: 
[0m19:43:37.068450 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: daily_price_movement at [75:18]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:43:37.068620 [info ] [MainThread]: 
[0m19:43:37.068796 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:43:37.070277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9565184, "process_user_time": 2.002966, "process_kernel_time": 2.706955, "process_mem_max_rss": "195543040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:43:37.070584 [debug] [MainThread]: Command `dbt run` failed at 19:43:37.070533 after 3.96 seconds
[0m19:43:37.070807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b31a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e59ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253a0190>]}
[0m19:43:37.071010 [debug] [MainThread]: Flushing usage events
[0m19:46:37.066134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ef5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c80370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c80190>]}


============================== 19:46:37.068871 | 6a8eeac4-95b9-4ee4-b198-efe3bf921488 ==============================
[0m19:46:37.068871 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:46:37.069181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:46:37.576285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b067c0>]}
[0m19:46:37.602100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1362f0a30>]}
[0m19:46:37.602403 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:46:37.613466 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:46:37.695685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:46:37.696111 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:46:37.851168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1450e0f70>]}
[0m19:46:37.904907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363e4df0>]}
[0m19:46:37.905173 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:46:37.905370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14502c7f0>]}
[0m19:46:37.905894 [info ] [MainThread]: 
[0m19:46:37.906154 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:37.906603 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:46:37.906808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:38.327916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:46:38.328595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:38.694501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363e4df0>]}
[0m19:46:38.697537 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:46:38.698126 [info ] [MainThread]: 
[0m19:46:38.701896 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:38.702934 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:46:38.704049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:46:38.704681 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:46:38.716840 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:38.717915 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:46:38.732986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:39.131739 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:39.132577 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from daily_price_movement_by_week
)


select
    *
    , daily_price_movement_in_week.avg_daily_price_movement_in_week
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,month_number)
    );
  
[0m19:46:39.485997 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:5556a78c-a79d-4cea-bb27-ef6b097a5cc2&page=queryresults
[0m19:46:39.662459 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column month_number in USING clause not found on right side of join at [99:57]; reason: invalidQuery, location: query, message: Column month_number in USING clause not found on right side of join at [99:57]')
[0m19:46:40.790107 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26cd86e6-9505-4350-a343-462300e73755&page=queryresults
[0m19:46:40.883807 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:26cd86e6-9505-4350-a343-462300e73755&page=queryresults
[0m19:46:40.932564 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Column month_number in USING clause not found on right side of join at [99:57]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:40.933970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a8eeac4-95b9-4ee4-b198-efe3bf921488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453ccdf0>]}
[0m19:46:40.934460 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.23s]
[0m19:46:40.934895 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:40.937088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:40.937327 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:46:40.937528 [info ] [MainThread]: 
[0m19:46:40.937742 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m19:46:40.938154 [debug] [MainThread]: Command end result
[0m19:46:40.959258 [info ] [MainThread]: 
[0m19:46:40.959584 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:40.959766 [info ] [MainThread]: 
[0m19:46:40.959983 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Column month_number in USING clause not found on right side of join at [99:57]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:40.960152 [info ] [MainThread]: 
[0m19:46:40.960330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:46:40.961769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9466028, "process_user_time": 2.042285, "process_kernel_time": 2.65544, "process_mem_max_rss": "197246976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:40.962088 [debug] [MainThread]: Command `dbt run` failed at 19:46:40.962036 after 3.95 seconds
[0m19:46:40.962305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ef5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b067c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145054eb0>]}
[0m19:46:40.962501 [debug] [MainThread]: Flushing usage events
[0m19:46:55.088062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104175a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d05430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d05250>]}


============================== 19:46:55.090340 | a053834d-498e-4f73-8e0c-3b334d7a16f9 ==============================
[0m19:46:55.090340 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:46:55.090666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:46:55.541101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d8aeeb0>]}
[0m19:46:55.567127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d8efa60>]}
[0m19:46:55.567429 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:46:55.578200 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:46:55.644819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:46:55.645235 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:46:55.797243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dce0130>]}
[0m19:46:55.853278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc39160>]}
[0m19:46:55.853559 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:46:55.853752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc9bee0>]}
[0m19:46:55.854294 [info ] [MainThread]: 
[0m19:46:55.854565 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:46:55.855047 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:46:55.855254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:56.263113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:46:56.263845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:56.635777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dd226d0>]}
[0m19:46:56.636919 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:46:56.637436 [info ] [MainThread]: 
[0m19:46:56.641823 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:56.642830 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:46:56.643630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:46:56.644198 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:46:56.655868 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:56.656806 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:46:56.671037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:46:57.080101 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:46:57.081106 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from daily_price_movement_by_week
)


select
    *
    , daily_price_movement_in_week.avg_daily_price_movement_in_week
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
    );
  
[0m19:46:57.363872 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:e01badb8-227e-4a7b-a5d9-cac60e960581&page=queryresults
[0m19:46:57.462959 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]; reason: invalidQuery, location: query, message: CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]')
[0m19:46:58.093878 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cfd43049-9cd7-43b1-a894-81ad51891321&page=queryresults
[0m19:46:58.216290 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:cfd43049-9cd7-43b1-a894-81ad51891321&page=queryresults
[0m19:46:58.263921 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:58.265334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a053834d-498e-4f73-8e0c-3b334d7a16f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ddd0c70>]}
[0m19:46:58.265957 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.62s]
[0m19:46:58.266367 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:46:58.267174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:58.267451 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:46:58.267667 [info ] [MainThread]: 
[0m19:46:58.267891 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m19:46:58.268320 [debug] [MainThread]: Command end result
[0m19:46:58.291967 [info ] [MainThread]: 
[0m19:46:58.292313 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:46:58.292503 [info ] [MainThread]: 
[0m19:46:58.292743 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  CREATE TABLE has columns with duplicate name avg_daily_price_movement_in_week at [13:7]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m19:46:58.292922 [info ] [MainThread]: 
[0m19:46:58.293104 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:46:58.294365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2535346, "process_user_time": 2.100844, "process_kernel_time": 2.726821, "process_mem_max_rss": "198344704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:46:58.294671 [debug] [MainThread]: Command `dbt run` failed at 19:46:58.294621 after 3.25 seconds
[0m19:46:58.294896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104175a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d278040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc1a190>]}
[0m19:46:58.295100 [debug] [MainThread]: Flushing usage events
[0m19:47:21.376297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6d160>]}


============================== 19:47:21.378355 | 5bbdf47f-3bba-4aa2-b5d0-639f46e6346d ==============================
[0m19:47:21.378355 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:47:21.378687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:47:21.836100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4e580>]}
[0m19:47:21.861835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f67a2b0>]}
[0m19:47:21.862132 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:47:21.873718 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:47:21.946801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:47:21.947146 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m19:47:22.101225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f8350a0>]}
[0m19:47:22.153988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fc2f490>]}
[0m19:47:22.154258 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:47:22.154451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bbdf47f-3bba-4aa2-b5d0-639f46e6346d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fbbd160>]}
[0m19:47:22.154973 [info ] [MainThread]: 
[0m19:47:22.155246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:22.155708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:47:22.155917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:49.909706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102500a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e79340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e79160>]}


============================== 19:47:49.912399 | b9f5b062-47ab-4fa7-b463-86dc8eaea02b ==============================
[0m19:47:49.912399 [info ] [MainThread]: Running with dbt=1.8.2
[0m19:47:49.912730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'send_anonymous_usage_stats': 'True'}
[0m19:47:50.444315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102738640>]}
[0m19:47:50.471431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e10a60>]}
[0m19:47:50.471774 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m19:47:50.482621 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m19:47:50.557777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:50.558044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:50.578161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fe6130>]}
[0m19:47:50.668187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d78490>]}
[0m19:47:50.668497 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m19:47:50.668687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aeed90>]}
[0m19:47:50.669212 [info ] [MainThread]: 
[0m19:47:50.669498 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:50.669952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m19:47:50.670155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:51.069921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m19:47:51.070687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:51.423741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c17040>]}
[0m19:47:51.424909 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m19:47:51.425343 [info ] [MainThread]: 
[0m19:47:51.428884 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m19:47:51.429519 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m19:47:51.430086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m19:47:51.430669 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m19:47:51.444303 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:47:51.445512 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m19:47:51.460915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:51.869823 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m19:47:51.870818 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)

, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_by_week as 
(
    select
        year_full
        , week_number
        , ifnull(avg_daily_price_week_end,0) - ifnull(avg_daily_price_week_start,0) as daily_price_movement
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)


, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , case 
            when daily_price_movement < 0 then round(daily_price_movement*-1.00,2)
            else daily_price_movement
          end as avg_daily_price_movement_in_week
    from daily_price_movement_by_week
)


select
    *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
    );
  
[0m19:47:52.264781 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4271dd36-3c81-4f5f-b736-4f60435e581f&page=queryresults
[0m19:47:55.298785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9f5b062-47ab-4fa7-b463-86dc8eaea02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135fe2fd0>]}
[0m19:47:55.299453 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (12.2k rows, 37.6 MiB processed)[0m in 3.87s]
[0m19:47:55.299895 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m19:47:55.300654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:55.300850 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m19:47:55.301039 [info ] [MainThread]: 
[0m19:47:55.301233 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m19:47:55.301721 [debug] [MainThread]: Command end result
[0m19:47:55.326884 [info ] [MainThread]: 
[0m19:47:55.327274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:47:55.327456 [info ] [MainThread]: 
[0m19:47:55.327651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:47:55.329033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.46677, "process_user_time": 1.953955, "process_kernel_time": 2.600782, "process_mem_max_rss": "189054976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:47:55.329345 [debug] [MainThread]: Command `dbt run` succeeded at 19:47:55.329297 after 5.47 seconds
[0m19:47:55.329566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102500a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038687c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c15970>]}
[0m19:47:55.329767 [debug] [MainThread]: Flushing usage events
[0m21:26:19.999768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c51c0>]}


============================== 21:26:20.002605 | 02e58f60-0df9-4a33-ac04-e926ee386885 ==============================
[0m21:26:20.002605 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:26:20.002957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:20.548740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156cd9430>]}
[0m21:26:20.576791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086025e0>]}
[0m21:26:20.577194 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:26:20.588155 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:26:20.663314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:20.663699 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:26:20.817159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a3a0130>]}
[0m21:26:20.872779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a086b80>]}
[0m21:26:20.873050 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:26:20.873243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a3e3d60>]}
[0m21:26:20.873779 [info ] [MainThread]: 
[0m21:26:20.874049 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:26:20.874499 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:26:20.874705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:21.319693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:26:21.320503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:21.741172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a3e3d60>]}
[0m21:26:21.742183 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:26:21.742984 [info ] [MainThread]: 
[0m21:26:21.746707 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:26:21.747283 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:26:21.747791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:26:21.748150 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:26:21.757506 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:26:21.758265 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:26:21.770921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:26:22.184994 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:26:22.186026 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , avg_daily_price_week_end - avg_daily_price_week_start as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)






select
    *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
    );
  
[0m21:26:22.642765 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:d453fe98-b346-4410-83ac-2181ea1abe85&page=queryresults
[0m21:26:26.323864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e58f60-0df9-4a33-ac04-e926ee386885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a490f70>]}
[0m21:26:26.324578 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (12.2k rows, 37.6 MiB processed)[0m in 4.58s]
[0m21:26:26.325104 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:26:26.325979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:26.326242 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:26:26.326480 [info ] [MainThread]: 
[0m21:26:26.326749 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m21:26:26.327286 [debug] [MainThread]: Command end result
[0m21:26:26.351271 [info ] [MainThread]: 
[0m21:26:26.351639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:26.351838 [info ] [MainThread]: 
[0m21:26:26.352053 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:26:26.353932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4069757, "process_user_time": 2.171312, "process_kernel_time": 2.508472, "process_mem_max_rss": "195215360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:26.354271 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:26.354212 after 6.41 seconds
[0m21:26:26.354493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086025e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107faf7c0>]}
[0m21:26:26.354707 [debug] [MainThread]: Flushing usage events
[0m21:27:53.668336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104319a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c91370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c91190>]}


============================== 21:27:53.670762 | b758b349-77d5-4229-9eb9-0003474f513b ==============================
[0m21:27:53.670762 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:27:53.671076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:54.179395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b167c0>]}
[0m21:27:54.205291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13676fa30>]}
[0m21:27:54.205578 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:27:54.216871 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:27:54.290817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:54.291212 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:27:54.446454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d5ff70>]}
[0m21:27:54.499394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137864df0>]}
[0m21:27:54.499662 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:27:54.499858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bac7f0>]}
[0m21:27:54.500402 [info ] [MainThread]: 
[0m21:27:54.500685 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:27:54.501154 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:27:54.501353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:54.916873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:27:54.917724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:55.312994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137864df0>]}
[0m21:27:55.315221 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:27:55.315853 [info ] [MainThread]: 
[0m21:27:55.319807 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:27:55.320685 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:27:55.321358 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:27:55.321800 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:27:55.333420 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:27:55.334857 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:27:55.349608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:27:55.757876 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:27:55.758839 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , avg_daily_price_week_end - avg_daily_price_week_start as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , avg_daily_price_month_end - avg_daily_price_month_start as avg_daily_price_movement_in_month
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:27:56.237468 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:036cd787-a161-4017-bdea-c87c6798509d&page=queryresults
[0m21:28:02.358383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b758b349-77d5-4229-9eb9-0003474f513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e050d90>]}
[0m21:28:02.360143 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (256.7k rows, 37.6 MiB processed)[0m in 7.04s]
[0m21:28:02.360796 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:28:02.361900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:02.362248 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:28:02.362562 [info ] [MainThread]: 
[0m21:28:02.362886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m21:28:02.363538 [debug] [MainThread]: Command end result
[0m21:28:02.391810 [info ] [MainThread]: 
[0m21:28:02.392154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:02.392329 [info ] [MainThread]: 
[0m21:28:02.392522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:28:02.394238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.775276, "process_user_time": 2.001826, "process_kernel_time": 2.63291, "process_mem_max_rss": "195608576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:28:02.394569 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:02.394521 after 8.78 seconds
[0m21:28:02.394780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104319a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b167c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568ca60>]}
[0m21:28:02.394981 [debug] [MainThread]: Flushing usage events
[0m21:29:03.938805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d14b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568d0d0>]}


============================== 21:29:03.941714 | 9b2211fc-4a5c-4895-a81d-b72d9b3b2010 ==============================
[0m21:29:03.941714 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:29:03.942044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:04.512976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1452da0a0>]}
[0m21:29:04.539988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145320610>]}
[0m21:29:04.540356 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:29:04.555002 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:29:04.631586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:04.632063 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:29:04.789334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14581f130>]}
[0m21:29:04.845400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145857730>]}
[0m21:29:04.845702 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:29:04.845888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145860d00>]}
[0m21:29:04.846420 [info ] [MainThread]: 
[0m21:29:04.846700 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:29:04.847177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:29:04.847395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:05.249789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:29:05.250207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:05.628896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145860d00>]}
[0m21:29:05.629913 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:29:05.630334 [info ] [MainThread]: 
[0m21:29:05.634098 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:29:05.634754 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:29:05.635295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:29:05.635717 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:29:05.645921 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:29:05.647232 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:29:05.661390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:29:06.049803 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:29:06.050925 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , avg_daily_price_week_end - avg_daily_price_week_start as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , avg_daily_price_month_end - avg_daily_price_month_start as avg_daily_price_movement_in_month
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:29:06.390556 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:40acab2b-cade-4b7f-a12e-978075ceefb8&page=queryresults
[0m21:29:10.367320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b2211fc-4a5c-4895-a81d-b72d9b3b2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b056d0>]}
[0m21:29:10.368099 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.73s]
[0m21:29:10.368670 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:29:10.369713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:10.370009 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:29:10.370274 [info ] [MainThread]: 
[0m21:29:10.370559 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m21:29:10.371125 [debug] [MainThread]: Command end result
[0m21:29:10.397619 [info ] [MainThread]: 
[0m21:29:10.397987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:10.398211 [info ] [MainThread]: 
[0m21:29:10.398440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:29:10.399918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5118504, "process_user_time": 2.10919, "process_kernel_time": 2.597521, "process_mem_max_rss": "198082560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:29:10.400255 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:10.400202 after 6.51 seconds
[0m21:29:10.400490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d14b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a68280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145320610>]}
[0m21:29:10.400717 [debug] [MainThread]: Flushing usage events
[0m21:31:16.453660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106078ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f11c0>]}


============================== 21:31:16.456500 | 0c1c369e-9d53-4047-b110-6b55314c6947 ==============================
[0m21:31:16.456500 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:31:16.456818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:31:16.967561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145359430>]}
[0m21:31:16.993667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782e5e0>]}
[0m21:31:16.993986 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:31:17.006327 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:31:17.079081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:31:17.079445 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:31:17.232288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479a0130>]}
[0m21:31:17.286105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1478b6b80>]}
[0m21:31:17.286383 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:31:17.286573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479e3d60>]}
[0m21:31:17.287099 [info ] [MainThread]: 
[0m21:31:17.287362 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:31:17.287838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:31:17.288041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:17.698949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:31:17.699677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:18.060779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479e3d60>]}
[0m21:31:18.061727 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:31:18.062168 [info ] [MainThread]: 
[0m21:31:18.065522 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:31:18.066088 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:31:18.066600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:31:18.067111 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:31:18.077141 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:31:18.078195 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:31:18.091319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:31:18.504961 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:31:18.506158 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:31:18.994615 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:11abd81e-1cb4-4b0b-84d0-da07f4a90606&page=queryresults
[0m21:31:22.357575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c1c369e-9d53-4047-b110-6b55314c6947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141480670>]}
[0m21:31:22.358287 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.29s]
[0m21:31:22.358842 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:31:22.359834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:22.360075 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:31:22.360316 [info ] [MainThread]: 
[0m21:31:22.360589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m21:31:22.361129 [debug] [MainThread]: Command end result
[0m21:31:22.386780 [info ] [MainThread]: 
[0m21:31:22.387154 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:22.387354 [info ] [MainThread]: 
[0m21:31:22.387552 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:31:22.389131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.982792, "process_user_time": 1.995651, "process_kernel_time": 2.67232, "process_mem_max_rss": "195985408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:22.389489 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:22.389425 after 5.98 seconds
[0m21:31:22.389711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106078ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1479e0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145359430>]}
[0m21:31:22.389934 [debug] [MainThread]: Flushing usage events
[0m21:34:02.200344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d04280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d040a0>]}


============================== 21:34:02.202849 | 86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2 ==============================
[0m21:34:02.202849 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:34:02.203173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:34:02.738986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14604f3d0>]}
[0m21:34:02.765864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772df10>]}
[0m21:34:02.766170 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m21:34:02.777745 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:34:02.854464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:02.854831 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m21:34:03.006961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146660130>]}
[0m21:34:03.060513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466a6790>]}
[0m21:34:03.060786 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m21:34:03.060968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460996a0>]}
[0m21:34:03.061485 [info ] [MainThread]: 
[0m21:34:03.061738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:34:03.062200 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m21:34:03.062405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:03.476346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m21:34:03.476747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:03.839096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460996a0>]}
[0m21:34:03.840285 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:34:03.840799 [info ] [MainThread]: 
[0m21:34:03.845784 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m21:34:03.846925 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m21:34:03.847779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m21:34:03.848212 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m21:34:03.859449 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:34:03.860350 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m21:34:03.875034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:34:04.296639 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m21:34:04.297758 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
    );
  
[0m21:34:04.785229 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:62858420-602f-4bb6-af5b-a953a563c848&page=queryresults
[0m21:34:08.193795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f3a94b-f5c7-4d08-b01a-fcdcdc982fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145880700>]}
[0m21:34:08.194608 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 4.35s]
[0m21:34:08.195176 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m21:34:08.196206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:08.196506 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m21:34:08.196775 [info ] [MainThread]: 
[0m21:34:08.197068 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m21:34:08.197645 [debug] [MainThread]: Command end result
[0m21:34:08.225143 [info ] [MainThread]: 
[0m21:34:08.225492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:08.225696 [info ] [MainThread]: 
[0m21:34:08.225904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:34:08.227395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0743585, "process_user_time": 2.064804, "process_kernel_time": 2.615027, "process_mem_max_rss": "196165632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:34:08.227764 [debug] [MainThread]: Command `dbt run` succeeded at 21:34:08.227706 after 6.07 seconds
[0m21:34:08.228010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14604f3d0>]}
[0m21:34:08.228251 [debug] [MainThread]: Flushing usage events
[0m00:13:19.954038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515160>]}


============================== 00:13:19.956842 | b9b886c0-9f82-4a94-86df-75dba239c0a4 ==============================
[0m00:13:19.956842 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:13:19.957150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:13:20.507913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f6580>]}
[0m00:13:20.533783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141639190>]}
[0m00:13:20.534066 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:13:20.545741 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:13:20.621235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:13:20.621571 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m00:13:20.775099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416f60a0>]}
[0m00:13:20.828915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141aef490>]}
[0m00:13:20.829188 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m00:13:20.829378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a711f0>]}
[0m00:13:20.829904 [info ] [MainThread]: 
[0m00:13:20.830168 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:20.830641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:13:20.830843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:21.252879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:13:21.253426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:21.654137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416bb580>]}
[0m00:13:21.655339 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:13:21.655870 [info ] [MainThread]: 
[0m00:13:21.659810 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m00:13:21.660587 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m00:13:21.661267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m00:13:21.661775 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m00:13:21.672960 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:13:21.673743 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m00:13:21.688799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:13:22.107292 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:13:22.108295 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_end)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_month using (year_full)
    left join last_avg_daily_price_per_month using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m00:13:22.611093 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:2ab23ea9-8150-4fb6-9f7d-81e718eab3d2&page=queryresults
[0m00:13:22.720747 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]; reason: invalidQuery, location: query, message: Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]')
[0m00:13:23.472841 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c60cca95-3861-423e-a8e4-2d8888304ab6&page=queryresults
[0m00:13:23.573850 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:c60cca95-3861-423e-a8e4-2d8888304ab6&page=queryresults
[0m00:13:23.617053 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:13:23.618331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9b886c0-9f82-4a94-86df-75dba239c0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142010f10>]}
[0m00:13:23.618979 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 1.96s]
[0m00:13:23.619407 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m00:13:23.621543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:23.621738 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m00:13:23.621922 [info ] [MainThread]: 
[0m00:13:23.622141 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m00:13:23.622556 [debug] [MainThread]: Command end result
[0m00:13:23.643290 [info ] [MainThread]: 
[0m00:13:23.643588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:13:23.643757 [info ] [MainThread]: 
[0m00:13:23.643976 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:13:23.644138 [info ] [MainThread]: 
[0m00:13:23.644324 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:13:23.646119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7418041, "process_user_time": 2.00632, "process_kernel_time": 2.686671, "process_mem_max_rss": "195330048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:13:23.646415 [debug] [MainThread]: Command `dbt run` failed at 00:13:23.646367 after 3.74 seconds
[0m00:13:23.646628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b9caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ecc5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f6580>]}
[0m00:13:23.646835 [debug] [MainThread]: Flushing usage events
[0m00:14:26.540403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10229caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c15310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c15130>]}


============================== 00:14:26.542605 | 60a785c9-2d15-4d16-b13e-eb2519647261 ==============================
[0m00:14:26.542605 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:14:26.542943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:27.023566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a51a60>]}
[0m00:14:27.049773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bec220>]}
[0m00:14:27.050079 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:14:27.064154 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:14:27.137371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:27.137727 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m00:14:27.293891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152c9f130>]}
[0m00:14:27.347377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b8b610>]}
[0m00:14:27.347648 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m00:14:27.347833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102216d00>]}
[0m00:14:27.348348 [info ] [MainThread]: 
[0m00:14:27.348609 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:27.349054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:14:27.349256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:27.774386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:14:27.774957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:28.175925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c6b20>]}
[0m00:14:28.177034 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:14:28.177426 [info ] [MainThread]: 
[0m00:14:28.180247 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m00:14:28.180831 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m00:14:28.181320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m00:14:28.181683 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m00:14:28.193032 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:14:28.193842 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m00:14:28.208613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:14:28.623033 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:14:28.624175 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_month using (year_full)
    left join last_avg_daily_price_per_month using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m00:14:29.071117 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:4768415a-49da-43da-bb31-718ca2502fa5&page=queryresults
[0m00:14:29.188164 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]; reason: invalidQuery, location: query, message: Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]')
[0m00:14:30.401662 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:34d0505c-f6a7-4958-8141-1ec3df6f00b5&page=queryresults
[0m00:14:30.506365 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:34d0505c-f6a7-4958-8141-1ec3df6f00b5&page=queryresults
[0m00:14:30.550949 [debug] [Thread-1  ]: Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:14:30.552396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a785c9-2d15-4d16-b13e-eb2519647261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a11be0>]}
[0m00:14:30.552931 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model stock_analysis.stg_spy_2014_2024 ......... [[31mERROR[0m in 2.37s]
[0m00:14:30.553384 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m00:14:30.555804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:30.556016 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m00:14:30.556216 [info ] [MainThread]: 
[0m00:14:30.556425 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m00:14:30.556837 [debug] [MainThread]: Command end result
[0m00:14:30.579127 [info ] [MainThread]: 
[0m00:14:30.579533 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:30.579716 [info ] [MainThread]: 
[0m00:14:30.579958 [error] [MainThread]:   Database Error in model stg_spy_2014_2024 (models/2_staging/stg_spy_2014_2024.sql)
  Unrecognized name: avg_daily_price_year_end; Did you mean avg_daily_price_month_end? at [145:17]
  compiled Code at target/run/stock_analysis/models/2_staging/stg_spy_2014_2024.sql
[0m00:14:30.580205 [info ] [MainThread]: 
[0m00:14:30.580431 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:14:30.581910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.088018, "process_user_time": 2.054272, "process_kernel_time": 2.664519, "process_mem_max_rss": "195510272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:14:30.582278 [debug] [MainThread]: Command `dbt run` failed at 00:14:30.582222 after 4.09 seconds
[0m00:14:30.582560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10229caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152825700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a51a60>]}
[0m00:14:30.582794 [debug] [MainThread]: Flushing usage events
[0m00:20:00.187094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10278cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104105280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041050a0>]}


============================== 00:20:00.189697 | f220fa5f-9819-480c-81ee-ad9f981c4b94 ==============================
[0m00:20:00.189697 [info ] [MainThread]: Running with dbt=1.8.2
[0m00:20:00.190036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ahmed/.dbt', 'log_path': '/Users/ahmed/Desktop/dbt/stock_analysis/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_spy_2014_2024', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:00.696907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13428f3d0>]}
[0m00:20:00.722810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2df10>]}
[0m00:20:00.723114 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m00:20:00.734997 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m00:20:00.804564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:20:00.804884 [debug] [MainThread]: Partial parsing: updated file: stock_analysis://models/2_staging/stg_spy_2014_2024.sql
[0m00:20:00.958858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13709f130>]}
[0m00:20:01.013484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1370e7790>]}
[0m00:20:01.013757 [info ] [MainThread]: Found 5 models, 2 sources, 469 macros
[0m00:20:01.013953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342d8970>]}
[0m00:20:01.014503 [info ] [MainThread]: 
[0m00:20:01.014785 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:20:01.015267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_first-project-262802'
[0m00:20:01.015471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:01.471661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_first-project-262802, now list_first-project-262802_stock_analysis)
[0m00:20:01.472137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:20:01.826719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1342d8970>]}
[0m00:20:01.828108 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m00:20:01.828616 [info ] [MainThread]: 
[0m00:20:01.832112 [debug] [Thread-1  ]: Began running node model.stock_analysis.stg_spy_2014_2024
[0m00:20:01.832810 [info ] [Thread-1  ]: 1 of 1 START sql table model stock_analysis.stg_spy_2014_2024 .................. [RUN]
[0m00:20:01.833385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_first-project-262802_stock_analysis, now model.stock_analysis.stg_spy_2014_2024)
[0m00:20:01.833762 [debug] [Thread-1  ]: Began compiling node model.stock_analysis.stg_spy_2014_2024
[0m00:20:01.845671 [debug] [Thread-1  ]: Writing injected SQL for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:20:01.846727 [debug] [Thread-1  ]: Began executing node model.stock_analysis.stg_spy_2014_2024
[0m00:20:01.861960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:20:02.270246 [debug] [Thread-1  ]: Writing runtime sql for node "model.stock_analysis.stg_spy_2014_2024"
[0m00:20:02.271922 [debug] [Thread-1  ]: On model.stock_analysis.stg_spy_2014_2024: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "stock_analysis", "target_name": "prod", "node_id": "model.stock_analysis.stg_spy_2014_2024"} */

  
    

    create or replace table `first-project-262802`.`stock_analysis`.`stg_spy_2014_2024`
      
    
    

    OPTIONS()
    as (
      with 

spy_2014_2024 as ( select * from `first-project-262802`.`stock_analysis`.`base_spy_2014_2024` )

, calendar as ( select * from `first-project-262802`.`stock_analysis`.`stg_calendar` )

, base as 
(
    select 
        *
        , round(((open + close_last + high + low)/4.00),2) as avg_daily_price
    from spy_2014_2024
    left join calendar using (date)
)

, weekly_price as 
(
    select 
        year_full
        , week_number
        , round(avg(avg_daily_price),2) as avg_weekly_price
    from base
    group by 1,2
)

, monthly_price as 
(
    select 
        year_full
        , month_number
        , round(avg(avg_daily_price),2) as avg_monthly_price
    from base
    group by 1,2
)




, first_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_week as 
(
    select 
        year_full
        , week_number
        , avg_daily_price as avg_daily_price_week_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, week_number ORDER BY date desc) = 1
)

, daily_price_movement_in_week as 
(
    select
        year_full
        , week_number
        , round(avg_daily_price_week_end - avg_daily_price_week_start,2) as avg_daily_price_movement_in_week
        , round(((avg_daily_price_week_end/avg_daily_price_week_start)-1)*100.00,2) as avg_daily_price_movement_in_week_pct
    from base
    left join first_avg_daily_price_per_week using (year_full,week_number)
    left join last_avg_daily_price_per_week using (year_full,week_number)
)




, first_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date asc) = 1
)

, last_avg_daily_price_per_month as 
(
    select 
        year_full
        , month_number
        , avg_daily_price as avg_daily_price_month_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date, month_number ORDER BY date desc) = 1
)

, daily_price_movement_in_month as 
(
    select
        year_full
        , month_number
        , round(avg_daily_price_month_end - avg_daily_price_month_start,2) as avg_daily_price_movement_in_month
        , round(((avg_daily_price_month_end/avg_daily_price_month_start)-1)*100.00,2) as avg_daily_price_movement_in_month_pct
    from base
    left join first_avg_daily_price_per_month using (year_full,month_number)
    left join last_avg_daily_price_per_month using (year_full,month_number)
)






, first_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_start
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date asc) = 1
)

, last_avg_daily_price_per_year as 
(
    select 
        year_full
        , avg_daily_price as avg_daily_price_year_end
    from base
    QUALIFY ROW_NUMBER() OVER (PARTITION BY year_of_date ORDER BY date desc) = 1
)

, daily_price_movement_in_year as 
(
    select
        year_full
        , round(avg_daily_price_year_end - avg_daily_price_year_start,2) as avg_daily_price_movement_in_year
        , round(((avg_daily_price_year_end/avg_daily_price_year_start)-1)*100.00,2) as avg_daily_price_movement_in_year_pct
    from base
    left join first_avg_daily_price_per_year using (year_full)
    left join last_avg_daily_price_per_year using (year_full)
)




select
    distinct *
from base
left join weekly_price using (year_full,week_number)
left join monthly_price using (year_full,month_number)
left join daily_price_movement_in_week using (year_full,week_number)
left join daily_price_movement_in_month using (year_full,month_number)
left join daily_price_movement_in_year using (year_full)
    );
  
[0m00:20:02.693418 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=first-project-262802&j=bq:US:f861bb7f-e5f2-4993-9e94-879bf1c4ee32&page=queryresults
[0m00:20:42.931143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f220fa5f-9819-480c-81ee-ad9f981c4b94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ac0700>]}
[0m00:20:42.933145 [info ] [Thread-1  ]: 1 of 1 OK created sql table model stock_analysis.stg_spy_2014_2024 ............. [[32mCREATE TABLE (2.5k rows, 37.6 MiB processed)[0m in 41.10s]
[0m00:20:42.933988 [debug] [Thread-1  ]: Finished running node model.stock_analysis.stg_spy_2014_2024
[0m00:20:42.935385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:42.935781 [debug] [MainThread]: Connection 'model.stock_analysis.stg_spy_2014_2024' was properly closed.
[0m00:20:42.936077 [info ] [MainThread]: 
[0m00:20:42.936460 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.92 seconds (41.92s).
[0m00:20:42.937058 [debug] [MainThread]: Command end result
[0m00:20:42.966309 [info ] [MainThread]: 
[0m00:20:42.966872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:20:42.967356 [info ] [MainThread]: 
[0m00:20:42.967565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:20:42.969430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 42.83317, "process_user_time": 2.023225, "process_kernel_time": 2.648026, "process_mem_max_rss": "194822144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:20:42.969914 [debug] [MainThread]: Command `dbt run` succeeded at 00:20:42.969838 after 42.83 seconds
[0m00:20:42.970188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10278cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347f9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347f9400>]}
[0m00:20:42.970413 [debug] [MainThread]: Flushing usage events
